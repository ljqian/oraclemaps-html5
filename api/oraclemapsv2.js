/*! jQuery v1.7.2 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cu(a){if(!cj[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),b.appendChild(ck);if(!cl||!ck.createElement)cl=(ck.contentWindow||ck.contentDocument).document,cl.write((f.support.boxModel?"<!doctype html>":"")+"<html><body>"),cl.close();d=cl.createElement(a),cl.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ck)}cj[a]=e}return cj[a]}function ct(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function cs(){cq=b}function cr(){setTimeout(cs,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bD.test(a)?d(a,e):b_(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)});else if(!c&&f.type(b)==="object")for(var e in b)b_(a+"["+e+"]",b[e],c,d);else d(a,b)}function b$(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bZ(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bS,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bZ(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=bZ(a,c,d,e,"*",g));return l}function bY(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bO),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bB(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?1:0,g=4;if(d>0){if(c!=="border")for(;e<g;e+=2)c||(d-=parseFloat(f.css(a,"padding"+bx[e]))||0),c==="margin"?d+=parseFloat(f.css(a,c+bx[e]))||0:d-=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0;return d+"px"}d=by(a,b);if(d<0||d==null)d=a.style[b];if(bt.test(d))return d;d=parseFloat(d)||0;if(c)for(;e<g;e+=2)d+=parseFloat(f.css(a,"padding"+bx[e]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+bx[e]))||0);return d+"px"}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;b.nodeType===1&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?b.outerHTML=a.outerHTML:c!=="input"||a.type!=="checkbox"&&a.type!=="radio"?c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(f.expando),b.removeAttribute("_submit_attached"),b.removeAttribute("_change_attached"))}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c,i[c][d])}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?+d:j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){if(typeof c!="string"||!c)return null;var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h,i){var j,k=d==null,l=0,m=a.length;if(d&&typeof d=="object"){for(l in d)e.access(a,c,l,d[l],1,h,f);g=1}else if(f!==b){j=i===b&&e.isFunction(f),k&&(j?(j=c,c=function(a,b,c){return j.call(e(a),c)}):(c.call(a,f),c=null));if(c)for(;l<m;l++)c(a[l],d,j?f.call(a[l],l,c(a[l],d)):f,i);g=1}return g?a:k?c.call(a):m?c(a[0],d):h},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m,n=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?n(g):h==="function"&&(!a.unique||!p.has(g))&&c.push(g)},o=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,j=!0,m=k||0,k=0,l=c.length;for(;c&&m<l;m++)if(c[m].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}j=!1,c&&(a.once?e===!0?p.disable():c=[]:d&&d.length&&(e=d.shift(),p.fireWith(e[0],e[1])))},p={add:function(){if(c){var a=c.length;n(arguments),j?l=c.length:e&&e!==!0&&(k=a,o(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){j&&f<=l&&(l--,f<=m&&m--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&p.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(j?a.once||d.push([b,c]):(!a.once||!e)&&o(b,c));return this},fire:function(){p.fireWith(this,arguments);return this},fired:function(){return!!i}};return p};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p=c.createElement("div"),q=c.documentElement;p.setAttribute("className","t"),p.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=p.getElementsByTagName("*"),e=p.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=p.getElementsByTagName("input")[0],b={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:p.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},f.boxModel=b.boxModel=c.compatMode==="CSS1Compat",i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete p.test}catch(r){b.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",function(){b.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),i.setAttribute("name","t"),p.appendChild(i),j=c.createDocumentFragment(),j.appendChild(p.lastChild),b.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,j.removeChild(i),j.appendChild(p);if(p.attachEvent)for(n in{submit:1,change:1,focusin:1})m="on"+n,o=m in p,o||(p.setAttribute(m,"return;"),o=typeof p[m]=="function"),b[n+"Bubbles"]=o;j.removeChild(p),j=g=h=p=i=null,f(function(){var d,e,g,h,i,j,l,m,n,q,r,s,t,u=c.getElementsByTagName("body")[0];!u||(m=1,t="padding:0;margin:0;border:",r="position:absolute;top:0;left:0;width:1px;height:1px;",s=t+"0;visibility:hidden;",n="style='"+r+t+"5px solid #000;",q="<div "+n+"display:block;'><div style='"+t+"0;display:block;overflow:hidden;'></div></div>"+"<table "+n+"' cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",d=c.createElement("div"),d.style.cssText=s+"width:0;height:0;position:static;top:0;margin-top:"+m+"px",u.insertBefore(d,u.firstChild),p=c.createElement("div"),d.appendChild(p),p.innerHTML="<table><tr><td style='"+t+"0;display:none'></td><td>t</td></tr></table>",k=p.getElementsByTagName("td"),o=k[0].offsetHeight===0,k[0].style.display="",k[1].style.display="none",b.reliableHiddenOffsets=o&&k[0].offsetHeight===0,a.getComputedStyle&&(p.innerHTML="",l=c.createElement("div"),l.style.width="0",l.style.marginRight="0",p.style.width="2px",p.appendChild(l),b.reliableMarginRight=(parseInt((a.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)===0),typeof p.style.zoom!="undefined"&&(p.innerHTML="",p.style.width=p.style.padding="1px",p.style.border=0,p.style.overflow="hidden",p.style.display="inline",p.style.zoom=1,b.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display="block",p.style.overflow="visible",p.innerHTML="<div style='width:5px;'></div>",b.shrinkWrapBlocks=p.offsetWidth!==3),p.style.cssText=r+s,p.innerHTML=q,e=p.firstChild,g=e.firstChild,i=e.nextSibling.firstChild.firstChild,j={doesNotAddBorder:g.offsetTop!==5,doesAddBorderForTableAndCells:i.offsetTop===5},g.style.position="fixed",g.style.top="20px",j.fixedPosition=g.offsetTop===20||g.offsetTop===15,g.style.position=g.style.top="",e.style.overflow="hidden",e.style.position="relative",j.subtractsBorderForOverflowNotVisible=g.offsetTop===-5,j.doesNotIncludeMarginInBodyOffset=u.offsetTop!==m,a.getComputedStyle&&(p.style.marginTop="1%",b.pixelMargin=(a.getComputedStyle(p,null)||{marginTop:0}).marginTop!=="1%"),typeof d.style.zoom!="undefined"&&(d.style.zoom=1),u.removeChild(d),l=p=d=null,f.extend(b,j))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h,i,j=this[0],k=0,m=null;if(a===b){if(this.length){m=f.data(j);if(j.nodeType===1&&!f._data(j,"parsedAttrs")){g=j.attributes;for(i=g.length;k<i;k++)h=g[k].name,h.indexOf("data-")===0&&(h=f.camelCase(h.substring(5)),l(j,h,m[h]));f._data(j,"parsedAttrs",!0)}}return m}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!";return f.access(this,function(c){if(c===b){m=this.triggerHandler("getData"+e,[d[0]]),m===b&&j&&(m=f.data(j,a),m=l(j,a,m));return m===b&&d[1]?this.data(d[0]):m}d[1]=c,this.each(function(){var b=f(this);b.triggerHandler("setData"+e,d),f.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1)},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){var d=2;typeof a!="string"&&(c=a,a="fx",d--);if(arguments.length<d)return f.queue(this[0],a);return c===b?this:this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise(c)}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,f.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,f.prop,a,b,arguments.length>1)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.type]||f.valHooks[g.nodeName.toLowerCase()];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h,i=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;i<g;i++)e=d[i],e&&(c=f.propFix[e]||e,h=u.test(e),h||f.attr(a,e,""),a.removeAttribute(v?e:c),h&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0,coords:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/(?:^|\s)hover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(
a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler,g=p.selector),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:g&&G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=f.event.special[c.type]||{},j=[],k,l,m,n,o,p,q,r,s,t,u;g[0]=c,c.delegateTarget=this;if(!i.preDispatch||i.preDispatch.call(this,c)!==!1){if(e&&(!c.button||c.type!=="click")){n=f(this),n.context=this.ownerDocument||this;for(m=c.target;m!=this;m=m.parentNode||this)if(m.disabled!==!0){p={},r=[],n[0]=m;for(k=0;k<e;k++)s=d[k],t=s.selector,p[t]===b&&(p[t]=s.quick?H(m,s.quick):n.is(t)),p[t]&&r.push(s);r.length&&j.push({elem:m,matches:r})}}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){q=j[k],c.currentTarget=q.elem;for(l=0;l<q.matches.length&&!c.isImmediatePropagationStopped();l++){s=q.matches[l];if(h||!c.namespace&&!s.namespace||c.namespace_re&&c.namespace_re.test(s.namespace))c.data=s.data,c.handleObj=s,o=((f.event.special[s.origType]||{}).handle||s.handler).apply(q.elem,g),o!==b&&(c.result=o,o===!1&&(c.preventDefault(),c.stopPropagation()))}}i.postDispatch&&i.postDispatch.call(this,c);return c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9||d===11){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));o.match.globalPOS=p;var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.globalPOS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")[\\s/>]","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){return f.access(this,function(a){return a===b?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f
.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){return f.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(f.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(g){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,function(a,b){b.src?f.ajax({type:"GET",global:!1,url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||f.isXMLDoc(a)||!bc.test("<"+a.nodeName+">")?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g,h,i,j=[];b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);for(var k=0,l;(l=a[k])!=null;k++){typeof l=="number"&&(l+="");if(!l)continue;if(typeof l=="string")if(!_.test(l))l=b.createTextNode(l);else{l=l.replace(Y,"<$1></$2>");var m=(Z.exec(l)||["",""])[1].toLowerCase(),n=bg[m]||bg._default,o=n[0],p=b.createElement("div"),q=bh.childNodes,r;b===c?bh.appendChild(p):U(b).appendChild(p),p.innerHTML=n[1]+l+n[2];while(o--)p=p.lastChild;if(!f.support.tbody){var s=$.test(l),t=m==="table"&&!s?p.firstChild&&p.firstChild.childNodes:n[1]==="<table>"&&!s?p.childNodes:[];for(i=t.length-1;i>=0;--i)f.nodeName(t[i],"tbody")&&!t[i].childNodes.length&&t[i].parentNode.removeChild(t[i])}!f.support.leadingWhitespace&&X.test(l)&&p.insertBefore(b.createTextNode(X.exec(l)[0]),p.firstChild),l=p.childNodes,p&&(p.parentNode.removeChild(p),q.length>0&&(r=q[q.length-1],r&&r.parentNode&&r.parentNode.removeChild(r)))}var u;if(!f.support.appendChecked)if(l[0]&&typeof (u=l.length)=="number")for(i=0;i<u;i++)bn(l[i]);else bn(l);l.nodeType?j.push(l):j=f.merge(j,l)}if(d){g=function(a){return!a.type||be.test(a.type)};for(k=0;j[k];k++){h=j[k];if(e&&f.nodeName(h,"script")&&(!h.type||be.test(h.type)))e.push(h.parentNode?h.parentNode.removeChild(h):h);else{if(h.nodeType===1){var v=f.grep(h.getElementsByTagName("script"),g);j.splice.apply(j,[k+1,0].concat(v))}d.appendChild(h)}}}return j},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bp=/alpha\([^)]*\)/i,bq=/opacity=([^)]*)/,br=/([A-Z]|^ms)/g,bs=/^[\-+]?(?:\d*\.)?\d+$/i,bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,bu=/^([\-+])=([\-+.\de]+)/,bv=/^margin/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Top","Right","Bottom","Left"],by,bz,bA;f.fn.css=function(a,c){return f.access(this,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)},a,c,arguments.length>1)},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=by(a,"opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bu.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(by)return by(a,c)},swap:function(a,b,c){var d={},e,f;for(f in b)d[f]=a.style[f],a.style[f]=b[f];e=c.call(a);for(f in b)a.style[f]=d[f];return e}}),f.curCSS=f.css,c.defaultView&&c.defaultView.getComputedStyle&&(bz=function(a,b){var c,d,e,g,h=a.style;b=b.replace(br,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b))),!f.support.pixelMargin&&e&&bv.test(b)&&bt.test(c)&&(g=h.width,h.width=c,c=e.width,h.width=g);return c}),c.documentElement.currentStyle&&(bA=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f==null&&g&&(e=g[b])&&(f=e),bt.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),by=bz||bA,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth!==0?bB(a,b,d):f.swap(a,bw,function(){return bB(a,b,d)})},set:function(a,b){return bs.test(b)?b+"px":b}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bq.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bp,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bp.test(g)?g.replace(bp,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,{display:"inline-block"},function(){return b?by(a,"margin-right"):a.style.marginRight})}})}),f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)}),f.each({margin:"",padding:"",border:"Width"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++)f[a+bx[d]+b]=e[d]||e[d-2]||e[0];return f}}});var bC=/%20/g,bD=/\[\]$/,bE=/\r?\n/g,bF=/#.*$/,bG=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bI=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bJ=/^(?:GET|HEAD)$/,bK=/^\/\//,bL=/\?/,bM=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bN=/^(?:select|textarea)/i,bO=/\s+/,bP=/([?&])_=[^&]*/,bQ=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bR=f.fn.load,bS={},bT={},bU,bV,bW=["*/"]+["*"];try{bU=e.href}catch(bX){bU=c.createElement("a"),bU.href="",bU=bU.href}bV=bQ.exec(bU.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bR)return bR.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bM,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bN.test(this.nodeName)||bH.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bE,"\r\n")}}):{name:b.name,value:c.replace(bE,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b$(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b$(a,b);return a},ajaxSettings:{url:bU,isLocal:bI.test(bV[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bW},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bY(bS),ajaxTransport:bY(bT),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?ca(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cb(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bG.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bF,"").replace(bK,bV[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bO),d.crossDomain==null&&(r=bQ.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bV[1]&&r[2]==bV[2]&&(r[3]||(r[1]==="http:"?80:443))==(bV[3]||(bV[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),bZ(bS,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bJ.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bL.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bP,"$1_="+x);d.url=y+(y===d.url?(bL.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bW+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=bZ(bT,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join("&").replace(bC,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=typeof b.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n);try{m.text=h.responseText}catch(a){}try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,co,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cq;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(ct("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),(e===""&&f.css(d,"display")==="none"||!f.contains(d.ownerDocument.documentElement,d))&&f._data(d,"olddisplay",cu(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(ct("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(ct("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o,p,q;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]);if((k=f.cssHooks[g])&&"expand"in k){l=k.expand(a[g]),delete a[g];for(i in l)i in a||(a[i]=l[i])}}for(g in a){h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cu(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cm.test(h)?(q=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),q?(f._data(this,"toggle"+i,q==="show"?"hide":"show"),j[q]()):j[h]()):(m=cn.exec(h),n=j.cur(),m?(o=parseFloat(m[2]),p=m[3]||(f.cssNumber[i]?"":"px"),p!=="px"&&(f.style(this,i,(o||1)+p),n=(o||1)/j.cur()*n,f.style(this,i,n+p)),m[1]&&(o=(m[1]==="-="?-1:1)*o+n),j.custom(n,o,p)):j.custom(n,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:ct("show",1),slideUp:ct("hide",1),slideToggle:ct("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cq||cr(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){f._data(e.elem,"fxshow"+e.prop)===b&&(e.options.hide?f._data(e.elem,"fxshow"+e.prop,e.start):e.options.show&&f._data(e.elem,"fxshow"+e.prop,e.end))},h()&&f.timers.push(h)&&!co&&(co=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cq||cr(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(cp.concat.apply([],cp),function(a,b){b.indexOf("margin")&&(f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cv,cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?cv=function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(e){}if(!d||!f.contains(c,a))return d?{top:d.top,left:d.left}:{top:0,left:0};var g=b.body,h=cy(b),i=c.clientTop||g.clientTop||0,j=c.clientLeft||g.clientLeft||0,k=h.pageYOffset||f.support.boxModel&&c.scrollTop||g.scrollTop,l=h.pageXOffset||f.support.boxModel&&c.scrollLeft||g.scrollLeft,m=d.top+k-i,n=d.left+l-j;return{top:m,left:n}}:cv=function(a,b,c){var d,e=a.offsetParent,g=a,h=b.body,i=b.defaultView,j=i?i.getComputedStyle(a,null):a.currentStyle,k=a.offsetTop,l=a.offsetLeft;while((a=a.parentNode)&&a!==h&&a!==c){if(f.support.fixedPosition&&j.position==="fixed")break;d=i?i.getComputedStyle(a,null):a.currentStyle,k-=a.scrollTop,l-=a.scrollLeft,a===e&&(k+=a.offsetTop,l+=a.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(a.nodeName))&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),g=e,e=a.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&d.overflow!=="visible"&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),j=d}if(j.position==="relative"||j.position==="static")k+=h.offsetTop,l+=h.offsetLeft;f.support.fixedPosition&&j.position==="fixed"&&(k+=Math.max(c.scrollTop,h.scrollTop),l+=Math.max(c.scrollLeft,h.scrollLeft));return{top:k,left:l}},f.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){f.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;if(!d)return null;if(c===d.body)return f.offset.bodyOffset(c);return cv(c,d,d.documentElement)},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);f.fn[a]=function(e){return f.access(this,function(a,e,g){var h=cy(a);if(g===b)return h?c in h?h[c]:f.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:a[e];h?h.scrollTo(d?f(h).scrollLeft():g,d?g:f(h).scrollTop()):a[e]=g},a,e,arguments.length,null)}}),f.each({Height:"height",Width:"width"},function(a,c){var d="client"+a,e="scroll"+a,g="offset"+a;f.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,c,"padding")):this[c]():null},f.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,c,a?"margin":"border")):this[c]():null},f.fn[c]=function(a){return f.access(this,function(a,c,h){var i,j,k,l;if(f.isWindow(a)){i=a.document,j=i.documentElement[d];return f.support.boxModel&&j||i.body&&i.body[d]||j}if(a.nodeType===9){i=a.documentElement;if(i[d]>=i[e])return i[d];return Math.max(a.body[e],i[e],a.body[g],i[g])}if(h===b){k=f.css(a,c),l=parseFloat(k);return f.isNumeric(l)?l:k}f(a).css(c,h)},c,a,arguments.length,null)}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
var ouilib;(function(){function a(b,d){if(!b){b={}}var b=b||{};b.config=b.config||{defaultViewportWidth:undefined,defaultViewportHeight:undefined,defaultLayoutDir:undefined,defaultLogLevel:"FINEST",defaultLogHandler:undefined,embeddedResourcesMap:undefined,preventTimerStart:false,frameRate:undefined,environment:undefined,base:".",catchAllEventListener:undefined,silverlight:undefined};b.setUp=function(e){if(b.LayoutDirEnum.RTL.equalIgnoreCase(b.config.defaultLayoutDir)){b.layoutDir=b.LayoutDirEnum.RTL}else{b.layoutDir=b.LayoutDirEnum.LTR}if(b.EnvironmentEnum.MOBILE.equalIgnoreCase(b.config.environment)){b.environment=b.EnvironmentEnum.MOBILE}else{b.environment=b.EnvironmentEnum.DESKTOP}b.deviceOrientation=b.DeviceOrientationEnum.LANDSCAPE;b.viewportWidth=0;if(b.isPositiveNumber(b.config.defaultViewportWidth)){b.viewportWidth=b.config.defaultViewportWidth}b.viewportHeight=0;if(b.isPositiveNumber(b.config.defaultViewportHeight)){b.viewportHeight=b.config.defaultViewportHeight}b.viewportBounds={x:0,y:0,width:b.viewportWidth,height:b.viewportHeight};b.tree=new b.scene.Tree();b.timer=new b.timing.Timer(b.config.frameRate);b.tree.setContainer(e);b.rootNode=b.tree.userLayer;b.focusManager=new b.focus.FocusManager(b.rootNode);b.tooltipManager=new b.tooltip.TooltipManager();b.resourcesManager=new b.utils.ResourcesManager();b.rootNode.addEventListener(b.ViewEvents.USER_EVENTS_SUPPORTED,b.events.setUserEventsSupported);b.rootNode.addEventListener(b.ViewEvents.ABOUT_INFO_REQUEST,function(f){f.returnValue=b.aboutInfo});if(b.config.preventTimerStart!==true){b.timer.start()}};(function(){b.NO_OP=function(){};b.BASE_VALUE="base";b.FillEnum={REMOVE:"REMOVE",FREEZE:"FREEZE",_LEGACY:"_LEGACY"};b.DEFAULT_TAG="defaultTag";b.TAGS={LAYOUT_DIR:"layoutDir",PAINT:"paint",GEOM:"geom",TRANSFO_SET:"transfoSet",TRANSFO:"transfo",SENSITIVITY:"sensitivity",VISIBILITY:"visibility",DISPLAY:"display",OPACITY:"opacity",NAME:"name",CLIP:"clip",CURSOR:"cursor",FOCUSABLE:"focusable",DESC:"desc",FILTER:"filter",LAYOUT:"layout",PREF_SIZE:"prefSize",SRC:"src"};b.EnvironmentEnum={DESKTOP:"DESKTOP",MOBILE:"MOBILE"};b.DeviceOrientationEnum={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"};b.FiltersEnum={NONE:"NONE",BLUR:"BLUR",DROP_SHADOW:"DROP_SHADOW",DROP_SHADOW_KNOCKED_OUT:"DROP_SHADOW_KNOCKED_OUT"};b.CursorTypeEnum={AUTO:"AUTO",DEFAULT:"DEFAULT",MOVE:"MOVE",POINTER:"POINTER",TEXT:"TEXT",WAIT:"WAIT",NONE:"NONE",CUSTOM:"CUSTOM"};b.TextAlignEnum={LINE_BEGIN:"LINE_BEGIN",CENTER:"CENTER",LINE_END:"LINE_END",JUSTIFY:"JUSTIFY"};b.LineCapEnum={BUTT:"BUTT",ROUND:"ROUND",SQUARE:"SQUARE"};b.DirectionEnum={UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",TO_LINE_BEGIN:"TO_LINE_BEGIN",TO_LINE_END:"TO_LINE_END"};b.OrientationEnum={VERTICAL:"VERTICAL",HORIZONTAL:"HORIZONTAL"};b.LineJoinEnum={MITER:"MITER",ROUND:"ROUND",BEVEL:"BEVEL"};b.FontWeightEnum={NORMAL:"NORMAL",BOLD:"BOLD"};b.FontStyleEnum={NORMAL:"NORMAL",ITALIC:"ITALIC"};b.LayoutDirEnum={LTR:"LTR",RTL:"RTL"};b.NodeAlign={TOP:0,CENTER:0.5,BOTTOM:1,LINE_BEGIN:0,LINE_END:1};b._BoundsType={DEFAULT:0,LAYOUT:1,STROKED:2};b.KeyCode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,MULTIPLY:106,PLUS:107,MINUS:109,DIVIDE:111,DASH:189,FORWARD_SLASH:191,BACK_SLASH:220};b.PreserveAspectRatioEnum={NONE:"NONE",MIN:"MIN",MAX:"MAX"};b.WindingRuleEnum={EVEN_ODD:"EVEN_ODD",NON_ZERO:"NON_ZERO"};b.AUTO="AUTO";b.QuoteStyleEnum={ENT_COMPAT:"ENT_COMPAT",ENT_QUOTES:"ENT_QUOTES",ENT_NOQUOTES:"ENT_NOQUOTES"};b.GENERIC_FONTS={SERIF:"serif",SANS_SERIF:"sans-serif",CURSIVE:"cursive",MONOSPACE:"monospace"}})();b.LogLevel={OFF:"OFF",ERROR:"ERROR",SEVERE:"SEVERE",WARNING:"WARNING",INFO:"INFO",FINEST:"FINEST",ALL:"ALL",LOG:"LOG"};var c;b.log=c=function(){var o=b.LogLevel,f={OFF:0,SEVERE:1,WARNING:2,INFO:3,FINEST:4,ALL:5};var n=[],j=0,i=[],p,l,h,e,k;p=function(){k.release()};function m(w,u){var r=n,t,s,v=r.length;for(s=0;s<v;s++){t=r[s];if(typeof t==="function"){t.call(null,w,u)}else{t.log(w,u)}}}function q(s,r){if(i.length===j){i.shift()}i.push({level:s,message:r})}function g(s){var r=o.INFO;if(typeof s==="string"){s=s.toUpperCase()}if(o.hasOwnProperty(s)){r=o[s]}return r}k=function(r,u,s){var t,v;if(u!==undefined&&u!==null){r=g(r);if(e){u=e(u,s)}if(r===o.ERROR){throw new Error(u)}else{t=f[h];v=f[r];if(v<=t){if(j>0){q(r,u)}else{m(r,u)}}}}};k.setLevel=function(r){h=g(r)};k.setFormatter=function(r){if(typeof r==="function"){e=r}};k.error=function(s,r){k(o.ERROR,s,r)};k.severe=function(s,r){k(o.SEVERE,s,r)};k.warn=k.warning=function(s,r){k(o.WARNING,s,r)};k.info=function(s,r){k(o.INFO,s,r)};k.finest=function(s,r){k(o.FINEST,s,r)};k.addLogHandler=function(r){if(typeof r==="function"||(r!==undefined&&typeof r.log==="function")){n.push(r)}};k.delay=function(r,s){if(l!==undefined){clearTimeout(l)}k.hold(s);l=setTimeout(p,r)};k.hold=function(r){j=r>0?r:500};k.release=function(){var r,s=i.length;if(s>0){m(o.LOG,">>>> releasing "+s+" logs.");while(s--){r=i.shift();m(r.level,r.message)}m(o.LOG,">>>> end logs release")}j=0};k.setLevel(b.config.defaultLogLevel||b.LogLevel.FINEST);k.addLogHandler(b.config.defaultLogHandler);return k}();b.ns=function(j){var g=undefined,f=undefined,k,e,h,m,l;if(typeof j==="string"){for(h=0,m=j.length;h<m;h++){l=j.charAt(h);if((l===".")||((l>="a")&&(l<="z"))||((l>="A")&&(l<="Z"))||((l>="0")&&(l<="9"))){continue}else{c.error("ERR__NAMESPACE__ILLEGAL_CHAR",j)}}k=j.split(".");f=undefined;if(k[0]==="oui"){f=b}if(f===undefined||f.length===0){c.error("ERR__NS__ROOT_FAIL",k[0])}for(h=1,m=k.length;h<m;h++){e=k[h];f[e]=f[e]||{};f=f[e]}g=f}else{c.error("ERR__NS__INV_STR",[j,typeof j])}return g};(function(){b.ns("oui.lang");b.lang.AspectSupport={addAspect:function(g,f,j,i){var h=this[g],e;if(b.isA(h,Function)&&b.isA(f,Function)){if(j===true){e=function(){arguments.callee.aspect.apply(this,arguments);return arguments.callee.nextMethod.apply(this,arguments)}}else{e=function(){var k=arguments.callee.nextMethod.apply(this,arguments);arguments.callee.aspect.apply(this,arguments);return k}}e.nextMethod=h;e.aspect=f;e.aspectName=i;this[g]=e}},removeAspect:function(f,e){var h=this[f],g=undefined;while(h!==undefined){if(h.aspect===e){if(g!==undefined){g.nextMethod=h.nextMethod}else{this[f]=h.nextMethod}break}else{g=h;h=h.nextMethod}}}}})();(function(){b.ns("oui.lang");var e={superClass:false,__configs:false,events:true};b.lang.Class={mixin:function(j,i,g){var h=b.lang.Class;if(j===null||j===undefined){c.error("ERR__MIX__INV_TARGET")}else{if(i===null||i===undefined||h._isStrictObject(i)===false){c.error("ERR__MIX__INV_SRC")}else{if(g===undefined){g=true}if(h._isClass(j)){h.merge(j.prototype,i,g,e)}else{if(h._isStrictObject(j)){h.merge(j,i,g,e)}else{c.error("ERR__MIX__INV_TARGET")}}h._copyConfigs(j,i)}}},defineProperties:function(n,j,h,m,i,g){m=m||false;i=i||false;g=g||false;if(Object.defineProperty){if(f._isClass(n)){n=n.prototype}for(var l in j){if(h||!n.hasOwnProperty(l)){try{Object.defineProperty(n,l,{value:j[l],writeable:m,configurable:i,enumerable:g})}catch(k){n[l]=j[l]}}}}else{f.mixin(n,j,h)}},_copyConfigs:function(l,j){var n,m,i,g,h,k;if(j.__configs!==undefined){if(l.__configs===undefined){l.__configs={}}for(n in j.__configs){if(l.__configs[n]===undefined){b.lang.PropertiesUtil.addConfig(l,{},n)}m=j.__configs[n].definitionClass.prototype;i=j.__configs[n].configClass.prototype;g=l.__configs[n].definitionClass.prototype;h=l.__configs[n].configClass.prototype;for(k in m){if(i[k]===undefined){c.error("ERR__CONFIG__NO_DEFAULT",k)}if(g[k]===undefined&&h[k]===undefined){g[k]=m[k];h[k]=i[k]}else{c.error("ERR__CONFIG__DUP_PROP",k)}}}}},merge:function(k,h,g,j){j=j||{};for(var i in h){if(!j.hasOwnProperty(i)&&(g||!k.hasOwnProperty(i))){k[i]=h[i]}else{if(j[i]===true){if(k[i]===undefined){k[i]={}}this.merge(k[i],h[i],g,j)}}}if(h.hasOwnProperty("toString")&&g){k.toString=h.toString}},extend:function(j,g){var h=b.lang.Class,i;if(j===undefined||j===null||!h._isClass(j)){c.error("ERR__EXT__INV_CHILD")}else{if(g===undefined||g===null||!h._isClass(g)){c.error("ERR__EXT__INV_PARENT")}else{if(j.superClass!==undefined){c.error("ERR__EXT__MULT_INHERIT")}i=function(){};i.prototype=g.prototype;j.prototype=new i();j.prototype.constructor=j;j.superClass=g}}},isA:function(i,h){var g=false,j=b.lang.Class;if(typeof i==="boolean"){g=(h===Boolean)}else{if(typeof i==="number"){g=(h===Number)}else{if(typeof i==="string"){g=(h===String)}else{if(h===Function){g=(typeof i==="function"||i===Date)}else{if(h!==undefined&&h!==null&&i!==undefined&&i!==null){if(i.constructor===h){g=true}else{if(j._isClass(h)&&i instanceof h){g=true}else{if(i.constructor!==undefined){g=j._inheritsFrom(i.constructor,h)}}}}}}}}return g},isAny:function(h){var k=arguments.length,g=false;for(var j=1;j<k;j++){if(b.isA(h,arguments[j])){g=true;break}}return g},_isStrictObject:function(g){return g.constructor===Object},_isClass:function(g){return(g.constructor===Function||(b.as3Class!==undefined&&g.constructor===b.as3Class))},_inheritsFrom:function(j,i){var g=false,h=j.superClass;if(j===i){g=true}else{if(h!==undefined){g=arguments.callee(h,i)}}return g},declare:function(l){var m,h,o,j,k,p;if(b.isA(l,Object)===false){c.error("ERR__DECL__INV_CLASS_DEF")}m=l.name;if(b.isA(m,String)===false||m.indexOf(".")<0){c.error("ERR__DECL__INV_CLASS_NAME")}j=m.lastIndexOf(".");h=b.ns(m.substr(0,j));m=m.substr(j+1);if(l.isAbstract===true){o=function(){c.error("ERR__ABSTR_CLASS",l.name)}}else{o=function(){this.init.apply(this,arguments)}}if(h[m]!==undefined){c.error("ERR__DECL__DUP_CLASS",l.name)}h[m]=o;if(b.isA(l.extend,Function)===true){b.extend(o,l.extend)}if(b.isA(l.mixins,Array)===true){for(k=0,p=l.mixins.length;k<p;k++){b.mixin(o,l.mixins[k])}}var g=[{name:"styleDef",call:b.addStyleSupport},{name:"modelDef",call:b.addModelSupport},{name:"propertiesDef",call:b.addPropertiesSupport},{name:"resourcesDef",call:b.addI18nSupport},{name:"jsonDef",call:b.addJSONLoaderSupport},{name:"eventsDef",call:b.addEventsSupport}];for(k=0,p=g.length;k<p;k++){if(b.isA(l[g[k].name],Object)===true){g[k].call(o,l[g[k].name])}}if(b.isA(l.membersDef,Object)===true){b.mixin(o,l.membersDef)}return o}};var f=b.lang.Class;b.merge=f.merge;b.extend=f.extend;b.mixin=f.mixin;b.isA=f.isA;b.isAny=f.isAny;b.declare=f.declare;b.defineProperties=f.defineProperties})();(function(){b.ns("oui.lang");b.mixin(b,{isChar:function(e){return typeof e==="string"&&e.length===1},isStringNotEmpty:function(e){return typeof e==="string"&&e.length>0},isValueInEnum:function(f,e){return typeof f==="string"&&e!==undefined&&e.hasOwnProperty(f)},isPositiveNumber:function(f,e){return typeof f==="number"&&(e===true?f>0:f>=0)},isFiniteNumber:function(e){return typeof e==="number"&&isFinite(e)},isFinitePositiveNumber:function(f,e){return typeof f==="number"&&isFinite(f)&&(e===true?f>0:f>=0)},isNumberInRange:function(g,e,h){var f;if(h===true){f=b.isArrayOfType(e,{type:Number})&&e.length===2&&!isNaN(e[0])&&!isNaN(e[1])}else{f=true}return f&&typeof g==="number"&&!isNaN(g)&&g>=e[0]&&g<=e[1]},isFunctionWithArgCount:function(e,f){return typeof e==="function"&&e.length===f},isArrayOfType:function(f,g,l,m,k){var e=true,j,h;if(g===undefined||g===null||g.type===undefined){e=false}else{if(f&&f.constructor===Array){j=f.length;if(l!==undefined){if(k===true&&typeof l!=="number"){e=false}if(j<l){e=false}}if(m!==undefined){if(k===true&&typeof m!=="number"){e=false}if(j>m){e=false}}for(h=0;h<j&&e===true;h++){e=b.isValueValid(f[h],g)}}else{e=false}}return e},isArrayOfProperties:function(l,e,f,m,k){var n=true,h=null,j,g;if(e===undefined||e===null){n=false}else{if(l&&l.constructor===Array){j=l.length;if(f!==undefined){if(k===true&&typeof f!=="number"){n=false}if(j<f){n=false}}if(m!==undefined){if(k===true&&typeof m!=="number"){n=false}if(j>m){n=false}}for(g=0;g<j&&n===true;g++){h=l[g];n=h!==undefined&&h!==null&&h.constructor===Object&&b.isObjectValid(h,e,true)}}else{n=false}}return n},isMapOfType:function(h,f){var e=true;if(f===undefined||f===null||f.type===undefined){e=false}else{if(typeof h==="object"){for(var g in h){if(h.hasOwnProperty(g)===true){e=b.isValueValid(h[g],f)}}}else{e=false}}return e},isMapOfProperties:function(k,g,h,f,i){var e=false,j;if(g!==undefined&&g!==null&&k!==undefined&&k!==null&&k.constructor===Object){if(typeof h!=="boolean"){h=true}e=true;for(j in k){if(k.hasOwnProperty(j)===true){e=b.isObjectValid(k[j],g,h,f);if(e===false&&i===true){e=b.isMapOfProperties(k[j],g,h,f,i)}if(e===false){break}}}}return e},isObjectValid:function(l,k,h,i){var n=false,f=false,m=false,e,j,g;if(k!==undefined&&l!==undefined&&k!==null&&l!==null){for(e in k){if(k[e]!==undefined){j=l[e];g=k[e];if(j!==undefined){f=b.isValueValid(j,g,h);n=f}else{m=m||!l.hasOwnProperty(e);n=!h}if(n!==true){break}}}if(n===true&&h===false&&i===true&&m===true){if(f===true){for(e in k){if(l.hasOwnProperty(e)===false){g=k[e];l[e]=g.defaultValue}}}else{n=false}}}return n},inheritsFrom:function(h,i,f){var e=false,g=true;if(f!==false){g=b.isA(i,Function)}if(g&&b.isA(h,Function)){e=b.lang.Class._inheritsFrom(h,i)}return e}})})();(function(){b.ns("oui.lang");var e="(&amp;|&lt;|&gt;|&quot;|&#039;)",f=new RegExp(e,"gi"),g=new RegExp("^"+e+"$","i");b.mixin(b,{currentTimeMillis:function(){return new Date().getTime()},hasOwnValue:function(k,m,j){var l,i=false,h;if(k!==undefined){if(typeof m==="string"&&j===true){h=m.toLowerCase();for(l in k){if(k.hasOwnProperty(l)&&k[l].toLowerCase()===h){i=true;break}}}else{for(l in k){if(k.hasOwnProperty(l)&&k[l]===m){i=true;break}}}}return i},supportsEvents:function(h){return h!==null&&h!==undefined&&b.isA(h.addEventListener,Function)},getValidIndex:function(h,k){var l,j;if(h<0){j=h%k;l=(j===0)?0:k+(h%k)}else{if(h>0){l=(h<k)?h:h%k}else{l=0}}return l},isValueOfType:function(m,l,n){var h=false;if(l===Object){h=true}else{if(m!==undefined&&m!==null&&l!==undefined&&l!==null){if(l===String||l===Number||l===Boolean||l===Array||l===Date||l===Function){h=(m.constructor===l)}else{if(l.constructor===Object&&m.constructor===Object){h=(b.isObjectValid(m,l,n)===true)}else{if(l.constructor===Function){h=b.isA(m,l)}else{if(l.constructor===Array){var i=l.length;for(var k=0;k<i;k++){if(m===l[k]){h=true;break}}}}}}}}return h},isValueInConstraint:function(l,n,j){var k=null,i=null,h=true;if(n!==undefined&&n!==null){h=false;if(n.constructor===Function){k=n;i=[l]}else{if(n.constructor===Array&&n.length>0&&n[0]!==undefined&&n[0]!==null&&n[0].constructor===Function){k=n[0];i=n.concat();i[0]=l}}}if(j===undefined){j=null}if(k!==null){try{h=k.apply(j,i)}catch(m){c.info("INFO__CONSTRAINT_FAIL",[m.message,l,n,j])}}return h},isValueValid:function(j,i,k){var h=false;if(i.type!==undefined){h=b.isValueOfType(j,i.type,k)}else{h=b.isValueOfType(j,i,k)}if(h===true&&i.constraint!==undefined){h=b.isValueInConstraint(j,i.constraint)}return h},buildDefaults:function(i,l){var h=l,j,k;if(typeof h!=="object"||h===null){h={}}for(k in i){j=i[k];if(j!==null&&j!==undefined&&j.constructor===Object){if(j.defaultValue!==undefined){h[k]=j.defaultValue}else{if(j.type!==undefined&&j.type.constructor===Object){j=j.type}h[k]=b.buildDefaults(j)}}}return h},applyProperties:function(k,l,j,h){var i={};if(k!==null&&k!==undefined&&j!==null&&j!==undefined){b._applyPropertiesImpl(k,l,j,h,i)}return i},_applyPropertiesImpl:function(h,o,k,s,u){var i,r,l,m,j,q,t,n=b._applyPropertiesImpl;for(i in h){l=k[i];r=h[i];m=o[i];if(l!==undefined&&r!==m){if(l.type===undefined){if(l.constructor===Object){n(r,m,l,s,u)}}else{if(l.type.constructor===Object){n(r,m,l.type,s,u)}else{j=false;q=undefined;j=b.isValueOfType(r,l.type,false);if(j===true){q=r}else{if(l.convertor!==undefined){t={value:undefined,validValue:false};l.convertor(r,t);j=(t.validValue===true);q=t.value}}if(j===true&&l.comparator!==undefined){j=!l.comparator(m,r)}if(j===true&&l.constraint!==undefined){j=b.isValueInConstraint(q,l.constraint,s)}if(j===true){o[i]=q;if(l.tag!==undefined){u[l.tag]=true}else{u[b.DEFAULT_TAG]=true}}}}}}},xmlSpecialChars:function(o,h,j){var m,l,k,p;if(b.QuoteStyleEnum[h]===undefined){h=b.QuoteStyleEnum.ENT_COMPAT}if(j===false){m=o.split(f);for(k=0,p=m.length;k<p;k++){l=m[k];if(l.match(g)===null){m[k]=l.replace(/&/g,"&amp;")}}o=m.join("")}else{o=o.replace(/&/g,"&amp;")}o=o.replace(/</g,"&lt;");o=o.replace(/>/g,"&gt;");if(h===b.QuoteStyleEnum.ENT_COMPAT){o=o.replace(/"/g,"&quot;")}else{if(h===b.QuoteStyleEnum.ENT_QUOTES){o=o.replace(/"/g,"&quot;");o=o.replace(/'/g,"&#039;")}}return o}})})();(function(){var e={indexOf:function(h){var f=-1,g,j=this.length;for(g=0;g<j;g++){if(this[g]===h){f=g;break}}return f},contains:function(f){return(this.indexOf(f)>=0)},remove:function(h,g){var f,j=this.length;for(f=j-1;f>=0;f--){if(this[f]===h){this.splice(f,1);if(g===false){break}}}return this},getItemAt:function(f){var g=b.getValidIndex(f,this.length);return this[g]},equals:function(j,h){var g,f=false;if(j!==null&&j!==undefined&&j.constructor===Array&&j.length===this.length){f=true;g=this.length;if(h===true){while(f===true&&g--){if(this[g].constructor===Array){f=this[g].equals(j[g],h)}}}else{while(f===true&&g--){f=(this[g]===j[g])}}}return f},move:function(f,g){var h;if(b.isPositiveNumber(f)&&b.isPositiveNumber(g)&&f!==g){h=this.splice(f,1)[0];this.splice(g,0,h)}return this}};b.defineProperties(Array,e,false,true,true,false)})();(function(){var e={isLetter:function(g){var h=this.charAt(0),f=false;if(b.isA(g,Number)&&g<this.length){h=this.charAt(g)}if(h!==undefined){f=(((h>="a")&&(h<="z"))||((h>="A")&&(h<="Z")))}return f},isDigit:function(g){var h=this.charAt(0),f=false;if(b.isA(g,Number)&&g<this.length){h=this.charAt(g)}if(h!==undefined){f=((h>="0")&&(h<="9"))}return f},isLetterOrDigit:function(f){return(this.isLetter(f)||this.isDigit(f))},startsWith:function(g){var f=false;if(g!==undefined){f=(this.indexOf(g)===0)}return f},endsWith:function(h){var f=false,g;if(h!==undefined){g=this.length-h.length;f=(this.lastIndexOf(h)===g)}return f},equalIgnoreCase:function(g){var f=false;if(typeof g==="string"){f=(this.toLowerCase()===g.toLowerCase())}return f},trim:function(){return this.replace(/^\s+|\s+$/g,"")}};b.defineProperties(String,e,false,true,true,false)})();(function(){var g=24*60*60*1000,e=1,h=4;var f={getWeekOfYear:function(i,m){var l,j,k,n;if(isFinite(i)===false){i=e}if(isFinite(m)===false){m=h}l=(7+this.getDay()-i)%7;j=(this.getDayOfYear()-l+6)/7;k=new Date(this.getFullYear(),0,m);n=(7+k.getDay()-i)%7;if(m-n<1){j++}return Math.floor(j)},getWeekOfMonth:function(j,m){var l,i,k,n;if(isFinite(j)===false){j=e}if(isFinite(m)===false){m=h}l=(7+this.getDay()-j)%7;i=(this.getDate()-l+6)/7;k=new Date(this.getFullYear(),this.getMonth(),m);n=(7+k.getDay()-j)%7;if(m-n<1){i++}return Math.floor(i)},getDayOfYear:function(){var k=this.getFullYear(),n=this.getMonth(),j=this.getDate(),i=new Date(k,0,1,12,0,0),m=new Date(k,n,j,12,0,0),l=(m.getTime()-i.getTime())/g;return(Math.round(l)+1)},isDST:function(){var i=new Date(this.getFullYear(),0,1,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds());return(this.getTimezoneOffset()!==i.getTimezoneOffset())},incDate:function(i){var j=this.getDate();if(isFinite(i)){j+=i}else{j++}this.setDate(j)}};b.defineProperties(Date,f,false,true,true,false)})();(function(){var e={signum:function(g){var f;if((typeof g!=="number")||isNaN(g)===true){f=NaN}else{if(g<0){f=-1}else{if(g>0){f=1}else{f=0}}}return f}};b.merge(Math,e,false)})();(function(){b.ns("oui.defs");var l=function(u,s,t,x,v,o,r){var q,p,w;if(!b.isValueOfType(t,s)||!b.isValueInConstraint(t,o)){if(r===undefined){r=["def=",t];if(b.isA(o,Array)){r.push(" with constraints: ");for(q=1,p=o.length;q<p;q++){r.push(o[q],", ")}}}c.error("ERR__DEFS__INV",[r,"oui.defs."+u])}else{if(x!==undefined&&!b.isA(x,String)){c.error("ERR__DEFS__INV",["tag","oui.defs."+u])}else{w={type:s,constraint:o,defaultValue:t,convertor:v,tag:x}}}return w};var f=function(q,p,o,r){var n=false;if(q===null){n=o}else{if(q===undefined){n=r}else{n=b.isValueOfType(q,p,true)}}return n};var j=function(p,r,o,q){var n=false;if(p===null){n=o}else{if(p===undefined){n=q}else{n=b.isValueInConstraint(p,r)}}return n};var k=function(o,n){if(o===1||o==="1"||o==="true"||o==="TRUE"){n.validValue=true;n.value=true}else{if(o===0||o==="0"||o==="false"||o==="FALSE"){n.validValue=true;n.value=false}}};var m=function(o,n){if(o!==undefined&&o!==null){n.validValue=true;n.value=o.toString()}};var e=function(o,n){if(b.isA(o,String)){var p=parseFloat(o);if(isNaN(p)===false){n.valueValid=true;n.value=p}}};var g=function(p,o){if(b.isA(p,String)){var n=Date.parse(p);if(isNaN(n)===false){o.validValue=true;o.value=new Date(n)}}};var i=function(n){var p=undefined;var o=n.convertor;if(o!==undefined){p=function(t,q){var v=[].concat(t);var u=v.length;var r;for(var s=0;s<u;s++){r=b.isValueOfType(v[s],n.type,false);if(r===false){q.validValue=false;o(v[s],q);if(q.validValue===true){r=q.validValue;v[s]=q.value}}if(r===false){break}}if(s===u){q.validValue=true;q.value=v}else{q.validValue=false}}}return p};var h=function(n,o){return n.equals(o)};b.mixin(b.defs,{_createDef:l,Boolean:function(o,n){return l("Boolean",Boolean,o,n,k)},String:function(o,n){return l("String",String,o,n,m)},Char:function(o,n){return l("Char",String,o,n,m,b.isChar)},Number:function(o,n){return l("Number",Number,o,n,e)},FiniteNumber:function(o,n){return l("FiniteNumber",Number,o,n,e,b.isFiniteNumber)},FinitePositiveNumber:function(o,n){return l("FinitePositiveNumber",Number,o,n,e,b.isFinitePositiveNumber)},PositiveNumber:function(o,n){return l("PositiveNumber",Number,o,n,e,b.isPositiveNumber)},StrictlyPositiveNumber:function(o,n){return l("StrictlyPositiveNumber",Number,o,n,e,[b.isPositiveNumber,true])},NumberInRange:function(o,q,n){var r=[b.isNumberInRange,o,true];var p=l("NumberInRange",Number,q,n,e,r);r[2]=false;return p},Enum:function(q,o,n){var s=[];for(var r in q){if(q.hasOwnProperty(r)){s.push(r)}}return l("Enum",s,o,n)},Date:function(o,n){return l("Date",Date,o,n,g)},MapOfProperties:function(r,s,p,o,q,n){return l("MapOfProperties",Object,s,n,undefined,[b.isMapOfProperties,r,p,o,q])},MapOfType:function(o,p,n){return l("MapOfType",Object,p,n,undefined,[b.isMapOfType,o])},ArrayOfProperties:function(o,s,t,q,n){var r=[b.isArrayOfProperties,o,s,t,true];var p=l("ArrayOfProperties",Array,q,n,undefined,r);r[4]=false;return p},ArrayOfType:function(o,s,u,q,n,t){var r=[b.isArrayOfType,o,s,u,true];var p=l("ArrayOfType",Array,q,n,i(o),r);if(t===true){p.comparator=h}r[4]=false;return p},ObjectOfType:function(p,r,o,q,n){return l("ObjectOfType",Object,r,n,undefined,[f,p,o,q])},ObjectOfConstraint:function(p,r,o,q,n){return l("ObjectOfConstraint",Object,r,n,undefined,[j,p,o,q])},Function:function(p,o,n){return l("Function",Function,o,n,undefined,[b.isFunctionWithArgCount,p])},Class:function(r,p,n){var q=[b.inheritsFrom,r];var o=l("Class",Function,p,n,undefined,q);q[2]=false;return o}})})();(function(){b.ns("oui.lang");b.lang.PropertiesSupport={_initProperties:function(e){this._properties=new this.Properties();this.setProperties(e)},setProperties:function(f){var e=this._properties.updateObject(f);for(var g in e){if(e[g]===true){this.onPropertiesUpdate(g)}}},applyProperties:function(e){this.setProperties(e)},onPropertiesUpdate:function(e){}}})();(function(){b.ns("oui.lang");b.lang.BindingSupport={applyBinding:function(h,f,g,j,i,e){var k=this[i];if(b.isA(k,Function)){this._applyBinding(h,f,g,j,k,e)}},_applyBinding:function(m,f,j,e,o,s){var q=this[j],k=undefined,r,g,p,l,h;if(s===true&&q!==undefined){k=this._computeBinding(m,q,f,this);o.call(this,k)}r=this[e];if(r===undefined||f===r){p=this.firstChild;while(p!==null){p._applyBinding(m,f,j,e,o,true);p=p.nextSibling}}else{g=this.getOutOfBindingScopeChildren(j);for(l=0,h=g.length;l<h;l++){g[l]._applyBinding(m,f,j,e,o,true)}}},getOutOfBindingScopeChildren:function(e){return[]},_computeBinding:function(h,i,f,g){var e=undefined;if(i.constructor===String){e=this._computeStringBinding(h,i,f,g)}else{if(i.constructor===Object){e=this._computeObjectBinding(h,i,f,g)}else{if(i.constructor===Function){e=i.call(f,h,g)}}}return e},_computeStringBinding:function(j,l,e,f){var o=undefined,n=undefined,m=0,k=l.charAt(0),h,g;if(k==="@"){n=l.slice(1).split(".");m=n.length;if(m>0){o=j;for(h=0;h<m;h++){o=o[n[h]]}}}else{if(k==="$"){g=e[l.slice(1)];if(g!==undefined&&g.constructor===Function){o=g.call(e,j,f)}}}return o},_computeObjectBinding:function(i,f,g,h){var e={},j;for(j in f){if(f.hasOwnProperty(j)){e[j]=this._computeBinding(i,f[j],g,h)}}return e}}})();(function(){b.ns("oui.lang");b.lang.LinkedListSupport={addLinkedList:function(C,u,n,B,g,h,A,l,x,y,s,r,v,m,w,o,i,z,k,q){var t=C.prototype,j,p,e;if(b.isA(i,String)===false){i="_numChildren"}t[n]=null;t[B]=null;t[g]=null;t[h]=null;t[A]=null;t[i]=0;if(b.isA(m,String)&&b.isA(t[m],Function)){j=function(D){return this[m](D)}}if(j===undefined){j=function(D){return b.isA(D,u)}}if(b.isA(w,String)===true){p=t[w]}if(p===undefined){p=function(D){}}if(b.isA(o,String)===true){e=t[o]}if(e===undefined){e=function(D){}}var f="_safe"+x.charAt(0).toUpperCase()+x.slice(1);t[l]=function(D){return this[s](D)};t[s]=function(F,I){var D,E,G,H;if(j.call(this,F)===true){E=true;G=this;while(G&&G!==F){G=G[g]}if(G!==null){E=false;c.warn("WARN__HRCHY_REQ__INSERT_ANCEST")}}else{E=false;c.warn("WARN__HRCHY_REQ__INV_TYPE")}if(E===true){H=F[g];if(H!==null){H[f](F,(H===this))}if(I===undefined||I===null){if(this[A]!==null){F[B]=this[A];this[A][n]=F}else{F[B]=null;this[h]=F}F[n]=null;this[A]=F;D=F}else{if(I===this[h]){this[h]=F;F[n]=I;F[B]=null;I[B]=F;D=F}else{if(I[g]===this){I[B][n]=F;F[B]=I[B];I[B]=F;F[n]=I;D=F}else{c.warn("WARN__NOTFOUND__INSERT")}}}if(D!==undefined){F[g]=this;p.call(this,F,I,(H===this));this[i]++}}return D};t[f]=function(E,D){if(this[h]===E){this[h]=E[n];if(this[A]===E){this[A]=null}}else{if(this[A]===E){this[A]=E[B]}}if(E[B]!==null){E[B][n]=E[n]}if(E[n]!==null){E[n][B]=E[B]}E[B]=null;E[n]=null;E[g]=null;if(D!==true){e.call(this,E,false,true)}this[i]--};t[x]=function(E){var D;if(E!==undefined&&E!==null&&E[g]===this){this[f](E,false);D=E}else{c.warn("WARN__NOTFOUND__REMOVE")}return D};t[y]=function(){var D=this[h],E;if(D!==null){while(D){E=D[n];D[g]=null;D[B]=null;D[n]=null;e.call(this,D,true,(E===null));D=E}this[h]=null;this[A]=null;this[i]=0}};t[r]=function(G,E){var D;if(b.isA(E,u)&&E[g]===this){var F=E.nextSibling;this[x](E);this[s](G,F);D=E}return D};t[v]=function(){return(this[h]!==null)};if(b.isA(z,String)===true){t[z]=function(D){var F=null,E=this[i];if(D>=0&&D<E){F=this[h];E=0;while(E<D){F=F[n];E++}}return F}}if(b.isA(k,String)===true){t[k]=function(E){var D=0,F=this[h];while(F!==null&&F!==E){F=F[n];D++}return(F===E)?D:-1}}if(b.isA(q,String)===true){t[q]=function(E,D){var F=this[z](D);this[s](E,F)}}}}})();(function(){b.ns("oui.lang");function f(m,l){return function(){return this[m][l]}}function k(n,m){var l=m.concat();return function(){var p=this[n],o,q=l.length;for(o=0;o<q;o++){p=p[l[o]]}return p}}function i(l){return function(m){if(m.length===1){return f(l,m[0])}else{return k(l,m)}}}function h(l,m){return function(n){var o={};o[m]=n;this[l](o)}}function e(l,n){var m=n.concat();return function(r){var s={},p=s,o,q=m.length;for(o=0;o<q-1;o++){p[m[o]]={};p=p[m[o]]}p[m[q-1]]=r;this[l](s)}}function j(l){return function(m){if(m.length===1){return h(l,m[0])}else{return e(l,m)}}}b.lang.PropertiesUtil={addConfig:function(w,l,t,u,o){var n=t+"Definition",p=function(){},r=this._getSuperConfig(w,t),v,m,q,s,x;if(r!==undefined){v=r.__configs[t].definitionClass;m=r.__configs[t].configClass;b.extend(p,v)}b.mixin(p,l);s=function(y){return function(A){var C,B,z;if(A!==undefined){C=function(){};if(y!==undefined){b.extend(C,y)}for(B in A){C.prototype[B]=A[B]}this.definition=new C();b.buildDefaults(this.definition,this)}else{z=this.compounds;for(B in z){if(z.hasOwnProperty(B)){this[B]=new z[B]()}}}}}(v);q={updateObject:function(z,y){return b.applyProperties(z,this,this.definition,y)},definition:new p(),compounds:{}};this._getDefaultsAndCompounds(q.definition,q,q.compounds);if(m!==undefined){b.extend(s,m)}b.mixin(s,q);x=w;if(b.isA(w,Function)){x=w.prototype}if(u){this._addAccessors(l,"get",[],i("_"+t.toLowerCase()),x,true)}if(o){this._addAccessors(l,"set",[],j("apply"+t),x,false)}if(w.constructor===Function){w.prototype[n]=p;w.prototype[t]=s;w[n]=l}if(w.__configs===undefined){w.__configs={}}w.__configs[t]={definitionClass:p,configClass:s}},_addAccessors:function(q,v,y,u,t,x){var l,m,s,r,o,w;if(q!==undefined){if(!this._isCompound(q)){m="";r=y.length;for(s=0;s<r;s++){o=y[s];if(o.length>0){m+=o.charAt(0).toUpperCase()+o.slice(1)}}l=u(y);if(x){t[m.charAt(0).toLowerCase()+m.slice(1)]=l}t[v+m]=l}else{w=q;if(q.type!==undefined){w=q.type}for(o in w){if(w.hasOwnProperty(o)===true){y.push(o);this._addAccessors(w[o],v,y,u,t,x);y.pop()}}}}},_getSuperConfig:function(l,n){var m=l.superClass;if(m!==undefined){if(m.__configs===undefined||m.__configs[n]===undefined){m=this._getSuperConfig(m,n)}}return m},_isCompound:function(l){return(l.type===undefined&&l.constructor===Object)||(l.type!==undefined&&l.type.constructor===Object)},_compoundedDefaultsFactory:function(m){var l={},n={},o;this._getDefaultsAndCompounds(m,n,l);o=function(){for(var q in l){if(l.hasOwnProperty(q)===true){this[q]=new l[q]()}}};o.prototype=n;return o},_getDefaultsAndCompounds:function(m,o,l){var q,n;for(n in m){if((q=m[n])!==null&&q!==undefined&&q.constructor===Object){if(this._isCompound(q)){l[n]=this._compoundedDefaultsFactory(q)}else{o[n]=q.defaultValue}}}}};var g=b.lang.PropertiesUtil;b.addStyleSupport=function(l,m){g.addConfig(l,m,"Style",true,true)};b.addModelSupport=function(l,m){g.addConfig(l,m,"Model",false,false)};b.addPropertiesSupport=function(l,m){g.addConfig(l,m,"Properties",true,true)}})();(function(){b.declare({name:"oui.geom.Matrix",membersDef:{init:function(l,j,n,m,k,i){if(arguments.length>=1&&b.isA(l,Number)&&b.isA(j,Number)&&b.isA(n,Number)&&b.isA(m,Number)&&b.isA(k,Number)&&b.isA(i,Number)){this.a=l;this.b=j;this.c=n;this.d=m;this.tx=k;this.ty=i}else{this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0}},_safeTranslate:function(i,j){this.tx+=this.a*i+this.c*j;this.ty+=this.b*i+this.d*j;return this},_safeRotate:function(p,j,r){var l=(j!==0||r!==0),i,q,k=Math.cos(p),o=Math.sin(p);if(l===true){this._safeTranslate(j,r)}i=this.a;q=this.c;this.a=i*k+q*o;this.c=i*-o+q*k;i=this.b;q=this.d;this.b=i*k+q*o;this.d=i*-o+q*k;if(l===true){this._safeTranslate(-j,-r)}return this},_safeScale:function(i,j){this.a*=i;this.c*=j;this.b*=i;this.d*=j;return this},set:function(i){if(b.isA(i,b.geom.Matrix)){this.a=i.a;this.b=i.b;this.c=i.c;this.d=i.d;this.tx=i.tx;this.ty=i.ty}return this},isIdentity:function(){return this.tx===0&&this.ty===0&&this.a===1&&this.b===0&&this.c===0&&this.d===1},concat:function(i){if(b.isA(i,b.geom.Matrix)){this._concat(i)}return this},_concat:function(o){var n,m,l;n=this.a;m=this.c;l=this.tx;this.a=n*o.a+m*o.b;this.c=n*o.c+m*o.d;this.tx=n*o.tx+m*o.ty+l;n=this.b;m=this.d;l=this.ty;this.b=n*o.a+m*o.b;this.d=n*o.c+m*o.d;this.ty=n*o.tx+m*o.ty+l},batchTransformCoords:function(q){var l=q.length?q.length:0,s,o,t,r,p,n,m,k,j;if(l%2===0&&l>1){r=this.a;p=this.b;n=this.c;m=this.d;k=this.tx;j=this.ty;t=[];while(l--){s=q[--l];o=q[l+1];t[l]=r*s+n*o+k;t[l+1]=p*s+m*o+j}}else{t=[]}return t},transformCoords:function(i,j){return{x:this.a*i+this.c*j+this.tx,y:this.b*i+this.d*j+this.ty}},transformPoint:function(i){i[0]=this.a*i[0]+this.c*i[1]+this.tx;i[1]=this.b*i[0]+this.d*i[1]+this.ty},determinant:function(){return(this.a*this.d)-(this.b*this.c)},inverse:function(){var i,j=this.determinant();if(j!==0){i=new b.geom.Matrix();i.a=this.d/j;i.b=-this.b/j;i.c=-this.c/j;i.d=this.a/j;i.tx=(this.c*this.ty-this.tx*this.d)/j;i.ty=(this.tx*this.b-this.a*this.ty)/j}else{c.error("ERR__MTX__INVERSE")}return i},clone:function(){var i=new b.geom.Matrix();i.a=this.a;i.b=this.b;i.c=this.c;i.d=this.d;i.tx=this.tx;i.ty=this.ty;return i},equals:function(k,i){var j=false;if(b.isA(k,b.geom.Matrix)){if(i===undefined||i===0){j=k.a===this.a&&k.c===this.c&&k.tx===this.tx&&k.b===this.b&&k.d===this.d&&k.ty===this.ty}else{j=Math.abs(k.a-this.a)<i&&Math.abs(k.c-this.c)<i&&Math.abs(k.tx-this.tx)<i&&Math.abs(k.b-this.b)<i&&Math.abs(k.d-this.d)<i&&Math.abs(k.ty-this.ty)<i}}return j}}});b.geom.Matrix.IDENTITY=new b.geom.Matrix();function h(j){var i=j.length;return function(){var l=arguments,k=[];k.push.apply(k,l);if(k.length>0&&typeof k[0]==="number"){if(i===3&&l[1]===undefined){k[1]=0;k[2]=0}else{if(l[i-1]===undefined){k[i-1]=k[i-2]}}j.apply(this,k)}return this}}var g=b.geom.Matrix.prototype,e={},f;for(f in g){if(f.indexOf("_safe")===0){e[f.charAt(5).toLowerCase()+f.substr(6)]=h(g[f])}}b.mixin(b.geom.Matrix,e)})();(function(){var j="([+-]?\\d+(\\.\\d+)?)";var h="translate\\(\\s*"+j+"\\s*,\\s*"+j+"\\s*\\)";var g="matrix\\(\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*,\\s*"+j+"\\s*\\)";var e=new RegExp(h,"g");var f=new RegExp(g,"g");var i=function(m,k){var l,n=null;f.lastIndex=0;e.lastIndex=0;if(b.isA(m,Array)&&m.length===6){n=new b.geom.Matrix(m[0],m[1],m[2],m[3],m[4],m[5])}else{l=f.exec(m);if(l===null){l=e.exec(m);if(l!==null){n=new b.geom.Matrix(1,0,0,1,parseFloat(l[1]),parseFloat(l[3]))}}else{n=new b.geom.Matrix(parseFloat(l[1]),parseFloat(l[3]),parseFloat(l[5]),parseFloat(l[7]),parseFloat(l[9]),parseFloat(l[11]))}}if(n===null){k.validValue=false}else{k.validValue=true;k.value=n}};b.mixin(b.defs,{Matrix:function(l,k){return b.defs._createDef("Matrix",b.geom.Matrix,l,k,i)}})})();(function(){b.ns("oui.geom");function f(h,g,i){return h+(g-h)*i}function e(h,g){return(h+g)/2}b.mixin(b.geom,{DEG_TO_RAD:Math.PI/180,DEFAULT_PADDING:5,computeBounds:function(l){var m,h,k,j,g,o,n;m=l.length?l.length:0;if(m%2===0&&m>1){j=l[0];o=l[0];g=l[1];n=l[1];for(k=2;k<m;k+=2){j=l[k]<j?l[k]:j;o=l[k]>o?l[k]:o;g=l[k+1]<g?l[k+1]:g;n=l[k+1]>n?l[k+1]:n}h={x:j,y:g,width:o-j,height:n-g}}return h},intersectRect:function(k,j,p){var r=undefined,l,i,h,q,g,o,n,m;if(k!==undefined&&j!==undefined){if(p!==true){if((l=k.x)<=(o=j.x+j.width)&&(g=j.x)<=(i=k.x+k.width)&&(h=k.y)<=(m=j.y+j.height)&&(n=j.y)<=(q=k.y+k.height)){r={x:l>g?l:g,y:h>n?h:n};r.width=(i>o?o:i)-r.x;r.height=(q>m?m:q)-r.y}}else{if((l=k.x)<(o=j.x+j.width)&&(g=j.x)<(i=k.x+k.width)&&(h=k.y)<(m=j.y+j.height)&&(n=j.y)<(q=k.y+k.height)){r={x:l>g?l:g,y:h>n?h:n};r.width=(i>o?o:i)-r.x;r.height=(q>m?m:q)-r.y}}}return r},calculateAngle:function(g,k,i,h){var j=Math.atan2(h,i)-Math.atan2(k,g);if(j<0){j+=2*Math.PI}return j},distSq:function(h,j,g,i){return(h-g)*(h-g)+(j-i)*(j-i)},dist:function(h,j,g,i){return Math.sqrt(b.geom.distSq(h,j,g,i))},centroid:function(m,j,g){var l=0,k=0,o=m.length,h=o-1;while(h>=0){l+=m[h][j];k+=m[h][g];h--}return{x:(l/o),y:(k/o)}},dotprod:function(g,j,i,h){return(g*i)+(j*h)},ptSegDistSq:function(i,m,h,k,o,n){var l,g,j;h-=i;k-=m;o-=i;n-=m;l=o*h+n*k;if(l<=0){g=0}else{o=h-o;n=k-n;l=o*h+n*k;if(l<=0){g=0}else{g=l*l/(h*h+k*k)}}j=o*o+n*n-g;if(j<0){j=0}return j},isPointInEllipse:function(h,l,g,k,j,i){h=(h-g)/j;l=(l-k)/i;return(h*h+l*l)<=1},isPointInTriangle:function(r,p,s,q,G,F,m,k){var z=b.geom.dotprod,j=m-s,i=k-q,o=G-s,n=F-q,E=r-s,C=p-q,D=z(j,i,j,i),B=z(j,i,o,n),A=z(j,i,E,C),h=z(o,n,o,n),g=z(o,n,E,C),l=1/(D*h-B*B),w=(h*A-B*g)*l,t=(D*g-B*A)*l;return(w>=0)&&(t>=0)&&(w+t<=1)},isValidRect:function(g){return g!==undefined&&g!==null&&!isNaN(g.x)&&!isNaN(g.y)&&g.width>=0&&g.height>=0},computeBoundedPosition:function(r,u,s,j){var o=b.geom,v=null,h,g,m,p,k,i,t,q,n,l;if(b.isFiniteNumber(s)===false){s=o.DEFAULT_PADDING}if(o.isValidRect(r)&&o.isValidRect(u)){h=r.x;g=r.y;m=r.width;p=r.height;k=u.x;i=u.y;t=u.width;q=u.height;if(j!==undefined){n=2*j.x-(h+m);l=2*j.y-(g+p)}v={x:h,y:g};if(t>m){if(h<k+s){v.x=k+s}else{if(h+m>k+t-s){v.x=k+t-s-m;if(j!==undefined&&j.x>v.x&&j.x<v.x+m&&j.y>v.y&&j.y<v.y+p&&n>=k+s&&n+m<=k+t-s){v.x=n}}}}else{if(t===m){v.x=k}}if(q>p){if(g<i+s){v.y=i+s}else{if(g+p>i+q-s){v.y=i+q-s-p;if(j!==undefined&&j.x>v.x&&j.x<v.x+m&&j.y>v.y&&j.y<v.y+p&&l>=i+s&&l+p<=i+q-s){v.y=l}}}}else{if(q===p){v.y=i}}}return v},getBoxCtrlPts:function(h,k,j,g){var i=[];if(j>0&&g>0){i.push(h,k,h+j,k,h+j,k+g,h,k+g)}else{if(j>0){i.push(h,k,h+j,k)}else{if(g>0){i.push(h,k,h,k+g)}else{i.push(h,k)}}}return i},crossCloseSegment:function(j,l,i,k,h,m){var g=0;if(j!==i||l!==k){g+=b.geom.crossLineSegment(j,l,i,k,h,m)}return g},crossLineSegment:function(j,l,i,k,h,m){var g;if((h<j&&h<i)||(h>j&&h>i)||(m>l&&m>k)||(j===i)){g=0}else{if(h==j){g=j<i?0:-1}else{if(h==i){g=j<i?1:0}else{if((m-l)-(k-l)*(h-j)/(i-j)<0){g=(j<i)?1:-1}else{g=0}}}}return g},crossQuadSegment:function(i,m,h,l,g,j,n,k){var o;if((n<i&&n<h&&n<g)||(n>i&&n>h&&n>g)||(k>m&&k>l&&k>j)||(i===h&&h===g)){o=0}else{o=b.geom.crossLineSegment(i,m,h,l,n,k)+b.geom.crossLineSegment(h,l,g,j,n,k)}return o},crossCubicSegment:function(i,o,h,m,g,k,q,j,n,l){var p;if((n<i&&n<h&&n<g&&n<q)||(n>i&&n>h&&n>g&&n>q)||(l>o&&l>m&&l>k&&l>j)||(i===h&&h===g&&g===q)){p=0}else{p=b.geom.crossLineSegment(i,o,h,m,n,l)+b.geom.crossLineSegment(h,m,g,k,n,l)+b.geom.crossLineSegment(g,k,q,j,n,l)}return p},cubic2Quadratic:function(x,w,H,G,l,j,z,y){var t=e(x,H),s=e(w,G),n=e(H,l),m=e(G,j),k=e(l,z),i=e(j,y),B=e(t,n),A=e(s,m),J=e(n,k),I=e(m,i),q=f(x,t,3/4),o=f(w,s,3/4),D=f(B,J,1/8),C=f(A,I,1/8),L=f(J,B,1/8),K=f(I,A,1/8),r=f(z,k,3/4),p=f(y,i,3/4),v=e(q,D),u=e(o,C),F=e(B,J),E=e(A,I),h=e(L,r),g=e(K,p);return[q,o,v,u,D,C,F,E,L,K,h,g,r,p,z,y]},quadratic2Cubic:function(p,o,l,k,i,g){var j=p+(2/3)*(l-p),h=o+(2/3)*(k-o),n=j+(1/3)*(i-p),m=h+(1/3)*(g-o);return[j,h,n,m,i,g]},_isFlatQuad:function(i,p,l,j,g,o,k,h){var m,q,n=b.geom.dist;if(h===undefined||h<0){m=2/k;q=n(i,p,l,j)+n(l,j,g,o)-n(i,p,g,o)}else{m=h*h;q=b.geom.ptSegDistSq(i,p,g,o,l,j)}return q<m},_isFlatCubic:function(i,s,p,l,o,k,g,r,m,h){var n,t,q=b.geom.dist;if(h===undefined||h<0){n=2/m;t=q(i,s,p,l)+q(p,l,o,k)+q(o,k,g,r)-q(i,s,g,r)}else{var j=b.geom.ptSegDistSq;n=h*h;t=Math.max(j(i,s,g,r,p,l),j(i,s,g,r,o,k))}return t<n},flattenQuad:function(j,r,o,m,g,q,p,n,i){var w=b.geom.flattenQuad,h=b.geom._isFlatQuad,v,u,l,k,t,s;if(n<=0||h(j,r,o,m,g,q,n,i)){p.push(g,q)}else{n--;v=(j+o)/2;u=(r+m)/2;l=(o+g)/2;k=(m+q)/2;t=(v+l)/2;s=(u+k)/2;w(j,r,v,u,t,s,p,n,i);w(t,s,l,k,g,q,p,n,i)}},flattenCubic:function(v,h,r,B,p,A,u,g,t,y,z){var s=b.geom.flattenCubic,C=b.geom._isFlatCubic,q,n,E,l,D,k,x,j,w,i,o,m;if(y<=0||C(v,h,r,B,p,A,u,g,y,z)){t.push(u,g)}else{y--;q=(r+p)/2;n=(B+A)/2;E=(v+r)/2;l=(h+B)/2;D=(E+q)/2;k=(l+n)/2;w=(p+u)/2;i=(A+g)/2;x=(q+w)/2;j=(n+i)/2;o=(D+x)/2;m=(k+j)/2;s(v,h,E,l,D,k,o,m,t,y,z);s(o,m,x,j,w,i,u,g,t,y,z)}}})})();(function(){var e=function(j,l,h,k,g,i){return(h-j)*(i-l)-(k-l)*(g-j)};var f=function(j,o,h,m,g,l){var p,n,k,q=(h-j),i=(m-o);p=((g-j)*q+(l-o)*i)/(q*q+i*i);n=j+p*(h-j);k=o+p*(m-o);return(n-g)*(n-g)+(k-l)*(k-l)};b.mixin(b.geom,{computeConvexHull:function(h){var g,i=h.length;if(i>2&&(i%2)===0){g=this._quickHull(h)}else{if(i===2){g=[h[0],h[1]]}else{g=[]}}return g},_quickHull:function(y){var t=[],p=y.length,h,q,s,v;for(s=h=q=0;s<p;s+=2){v=y[s];if(y[q]<v||(y[q]===v&&y[q+1]<y[s+1])){q=s}if(y[h]>v||(y[h]===v&&y[h+1]>y[s+1])){h=s}}if(q===h){t.push(y[q],y[q+1])}else{var u=[],g=[],o=y[q],m=y[q+1],k=y[h],j=y[h+1],w;for(s=0;s<p;s+=2){if(s===q||s===h){continue}w=e(o,m,k,j,y[s],y[s+1]);if(w>0){u.push(y[s],y[s+1])}else{if(w<0){g.push(y[s],y[s+1])}}}t.push(k,j);b.geom._quickHullRecurse(k,j,o,m,u,t);t.push(o,m);b.geom._quickHullRecurse(o,m,k,j,g,t)}return t},_quickHullRecurse:function(j,s,h,r,v,m){var l,k=v.length,g,p,u,t,q,o;if(k>0){l=b.geom._farthestPointIndex(j,s,h,r,v);g=v[l];p=v[l+1];u=[];t=[];for(l=0;l<k;l+=2){q=v[l];o=v[l+1];if((q===j&&o===s)||(q===h&&o===r)){continue}else{if(e(g,p,j,s,q,o)>0){u.push(q,o)}else{if(e(h,r,g,p,q,o)>0){t.push(q,o)}}}}b.geom._quickHullRecurse(j,s,g,p,u,m);m.push(g,p);b.geom._quickHullRecurse(g,p,h,r,t,m)}},_farthestPointIndex:function(h,q,g,p,s){var k,j=s.length,t=-1,r=-1,o,m,l;for(k=0;k<j;k+=2){o=s[k];m=s[k+1];if((o===h&&m===q)||(o===g&&m===p)){continue}l=f(h,q,g,p,o,m);if(l>r){r=l;t=k}}return t}})})();(function(){b.UIEvents={ACTIVATE:"activate",FOCUS_IN:"focusIn",FOCUS_OUT:"focusOut"};b.MouseEvents={CLICK:"click",DBL_CLICK:"dblClick",MOUSE_DOWN:"mouseDown",MOUSE_UP:"mouseUp",MOUSE_OVER:"mouseOver",MOUSE_OUT:"mouseOut",MOUSE_MOVE:"mouseMove",MOUSE_ENTER:"mouseEnter",MOUSE_LEAVE:"mouseLeave",MOUSE_WHEEL:"mouseWheel"};b.KeyEvents={KEY_DOWN:"keyDown",KEY_UP:"keyUp"};b.SyncEvents={BEGIN:"begin",END:"end",REPEAT:"repeat"};b.DragEvents={DRAG:"drag",DRAG_START:"dragStart",DRAG_END:"dragEnd"};b.TouchEvents={TOUCH_START:"touchStart",TOUCH_END:"touchEnd",TOUCH_MOVE:"touchMove",TOUCH_ENTER:"touchEnter",TOUCH_LEAVE:"touchLeave"};b.GenericGestureEvents={GESTURE_START:"gestureStart",GESTURE_CHANGE:"gestureChange",GESTURE_END:"gestureEnd"};b.GestureEvents={TAP:"tap",DBL_TAP:"dblTap",TOUCH_LONG_PRESS:"touchLongPress",PRESS_AND_TAP:"pressAndTap",SWIPE:"swipe",PINCH:"pinch"};b.GestureEventPhases={BEGIN:"Begin",CHANGE:"Change",CANCEL:"Cancel",END:"End"};b.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};b.ViewEvents={LOAD:"load",VIEWPORT_RESIZE:"viewportResize",RELEASE_FOCUS:"releaseFocus",FOCUS_COMPONENT:"focusComponent",BLUR_COMPONENT:"blurComponent",USER_EVENTS_SUPPORTED:"userEventsSupported",ABOUT_INFO_REQUEST:"aboutInfoRequest",DEVICE_ORIENTATION:"deviceOrientation"}})();(function(){b.ns("oui.events");var e="CAPTURE",f="BUBBLE";b.events.EventSupport={_snapshotListeners:function(k){var j=[],i=[],m=[],h=[],g=[],l=this;k=k.toLowerCase();while(l!==null&&l!==undefined){j.push(l);l._appendListeners(k,i,m,h,g);l=l.parentNode}return{nodes:j,bubbleListeners:i,captureListeners:m,bubbleIndices:h,captureIndices:g}},_appendListeners:function(j,l,h,g,i){var k=this.listeners;i.push(h.length);if(k!==undefined&&k[j]!==undefined){h.push.apply(h,k[j][e]);l.push.apply(l,k[j][f])}g.push(l.length-1)},_invokeListener:function(h,g){if(h!==undefined&&h!==null){if(h.handleEvent!==undefined){h.handleEvent(g)}else{h.call(null,g)}}},_checkListeners:function(){if(this.listeners===undefined){this.listeners={}}},_isValidListener:function(g){return(typeof g==="function"||(g!==null&&g!==undefined&&typeof g.handleEvent==="function"))},_removeItem:function(j,h){for(var g=j.length-1;g>-1;g--){if(j[g]===h){j.splice(g,1)}}},addEventListener:function(l,m,h){var n,g,k,j=false;if(typeof l==="string"&&this._isValidListener(m)){l=l.toLowerCase();this._checkListeners();if(this.listeners[l]===undefined){this.listeners[l]={};this.listeners[l][e]=[];this.listeners[l][f]=[]}n=h===true?e:f;g=this.listeners[l][n];k=g.length;while(k--&&!j){j=(m===g[k])}if(!j){g.push(m)}}},removeEventListener:function(i,j,h){var g,k;if(typeof i==="string"&&this._isValidListener(j)&&this.listeners!==undefined){i=i.toLowerCase();g=this.listeners[i];if(g!==undefined){k=h===true?e:f;this._removeItem(g[k],j)}}},_preventDefault:function(g){this.defaultPrevented=true;if(g!==true&&this.preventNativeDefault!==undefined){this.preventNativeDefault()}},_stopPropagation:function(g){this.stopped=true;if(g!==true&&this.stopNativePropagation!==undefined){this.stopNativePropagation()}},_stopImmediatePropagation:function(g){this.stoppedImmediate=true;this.stopPropagation(g)},dispatchEvent:function(g){var r,m,s,h,k,n,u,w,o,v,l,t,q,p;if(g!==undefined&&g!==null&&typeof g.type==="string"){g.timeStamp=b.currentTimeMillis();r=!(g.bubbles===false);m=(g.cancelable===true);s=null;if(typeof g.defaultAction==="function"){s=g.defaultAction}g.CAPTURING_PHASE=1;g.AT_TARGET=2;g.BUBBLING_PHASE=3;g.preventDefault=b.events.EventSupport._preventDefault;g.stopPropagation=b.events.EventSupport._stopPropagation;g.stopImmediatePropagation=b.events.EventSupport._stopImmediatePropagation;h=this._snapshotListeners(g.type);k=h.nodes;n=h.captureListeners;u=h.bubbleListeners;w=h.captureIndices;o=h.bubbleIndices;g.eventPhase=g.CAPTURING_PHASE;g.target=this;g.stopped=false;g.stoppedImmediate=false;g.defaultPrevented=false;v=n.length-1;for(q=k.length-1;q>0&&g.stopped===false;q--){g.currentTarget=k[q];for(p=v;p>=w[q]&&g.stoppedImmediate===false;p--){this._invokeListener(n[v],g);v--}}g.eventPhase=g.AT_TARGET;g.currentTarget=this;l=0;if(g.stopped!==true){for(p=v;p>=0&&g.stoppedImmediate===false;p--){this._invokeListener(n[v],g);v--}for(p=0;p<=o[0]&&g.stoppedImmediate===false;p++){this._invokeListener(u[l],g);l++}}if(r){g.eventPhase=g.BUBBLING_PHASE;t=k.length;for(q=1;q<t&&g.stopped===false;q++){g.currentTarget=k[q];for(p=l;p<=o[q]&&g.stoppedImmediate===false;p++){this._invokeListener(u[l],g);l++}}}if(s!==null&&(m===false||g.defaultPrevented!==true)){s.call(null,g)}}},getDefaultActivateAction:function(){var g=undefined;if(this.activateAction!==undefined){g=this.activateAction}else{if(b.isA(this.getActivateAction,Function)){g=this.getActivateAction()}}return g},handler:function(k,i,h,g,l){var j=null,m=null;if(k!==undefined&&k!==null){if(typeof k==="string"){if(typeof this[k]==="function"){j=this;m=this[k]}}else{if(typeof k==="function"){m=k}else{if(typeof k.handleEvent==="function"){j=k;m=k.handleEvent}}}}if(m===null){c.error("ERR__EVT__INV_HANDLER")}return function(n){if(b.isValueInConstraint(n,l)===true){if(g===true){n.stopPropagation()}if(h===true){n.preventDefault()}m.call(j,n,i)}}}}})();(function(){b.ns("oui.events");var i=b.events;var f=function(s,r){var p;var q=Math.min(s.length,r.length);for(p=0;p<q;p++){if(s[p]!==r[p]){break}}return(p-1)};var j={};var m,o,k;var g=function(){i._stopNextNativeMouseEvent(this.type,this.clientX,this.clientY)};var n={mousedown:function(p,q){if(m===undefined||q!==m.target||p.clientX!==m.clientX||p.clientY!==m.clientY){k=1}else{k++}if(p.hasOwnProperty("detail")===false){p.detail=k}m=p},mouseup:function(p,q){if(m===undefined||q!==m.target||p.clientX!==m.clientX||p.clientY!==m.clientY){k=1}if(p.hasOwnProperty("detail")===false){p.detail=k}}};var l={mouseover:function(p){i.handleEnter(p.target,p.relatedTarget,b.MouseEvents.MOUSE_ENTER,p)},mouseout:function(p){i.handleLeave(p.target,p.relatedTarget,b.MouseEvents.MOUSE_LEAVE,p)},mousedown:function(p){var q=p.target,r=q;if(b.focus.isFocusableTarget(q)!==true){r=b.focus.getFocusableAncestor(q)}if(r!==null){b.focusManager.requestFocus(r,p);r.dispatchEvent({type:b.UIEvents.ACTIVATE,defaultAction:r.getDefaultActivateAction()})}},mouseup:function(s){var r=b.MouseEvents.CLICK,q=b.MouseEvents.DBL_CLICK,p;if(m!==undefined&&s.target===m.target&&s.clientX===m.clientX&&s.clientY===m.clientY){p={type:r,clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,userX:s.userX,userY:s.userY,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,altKey:s.altKey,button:s.button,detail:s.detail,defaultAction:null,stopNativePropagation:g};s.target.dispatchEvent(p);if(o!==undefined&&p.target===o.target&&p.userX===o.userX&&p.userY===o.userY&&p.button===o.button&&p.detail%2===0&&p.timeStamp-o.timeStamp<500){p.target.dispatchEvent({type:q,clientX:p.clientX,clientY:p.clientY,pageX:p.pageX,pageY:p.pageY,userX:p.userX,userY:p.userY,ctrlKey:p.ctrlKey,altKey:p.altKey,shiftKey:p.shiftKey,button:p.button,detail:p.detail,defaultAction:null,stopNativePropagation:g})}o=p}}};var e={KEYS:"KEYS",MOUSE:"MOUSE",WHEEL:"WHEEL",TOUCHES:"TOUCHES",GESTURES:"GESTURES"};var h=function(){this._initProperties()};b.mixin(h,b.lang.PropertiesSupport);b.mixin(h,{onPropertiesUpdate:function(q){var p=this._properties.fromPlatform;switch(q){case e.KEYS:i.toggleNativeKeys(p.keyEvents);break;case e.MOUSE:i.toggleNativeMouse(p.mouseEvents);break;case e.WHEEL:i.toggleNativeWheel(p.wheelEvents);break;case e.TOUCHES:i.toggleNativeTouches(p.touchEvents);break;case e.GESTURES:i.toggleNativeGestures(p.gestureEvents);break;default:}}});b.addPropertiesSupport(h,{fromPlatform:{keyEvents:b.defs.Boolean(false,e.KEYS),mouseEvents:b.defs.Boolean(false,e.MOUSE),wheelEvents:b.defs.Boolean(false,e.WHEEL),touchEvents:b.defs.Boolean(false,e.TOUCHES),gestureEvents:b.defs.Boolean(false,e.GESTURES)},fromContainer:{keyEvents:b.defs.Boolean(true),mouseEvents:b.defs.Boolean(true),wheelEvents:b.defs.Boolean(true),touchEvents:b.defs.Boolean(true),gestureEvents:b.defs.Boolean(true)},dispatchMouseEventsOnTouch:b.defs.Boolean(true)});b.mixin(b.events,{_userEventsSupport:new h(),setUserEventsSupported:function(p){i._userEventsSupport.applyProperties(p)},getUserEventsSupported:function(){var p=i._userEventsSupport;return{fromPlatform:{keyEvents:p.fromPlatformKeyEvents(),mouseEvents:p.fromPlatformMouseEvents(),wheelEvents:p.fromPlatformWheelEvents(),touchEvents:p.fromPlatformTouchEvents(),gestureEvents:p.fromPlatformGestureEvents()},fromContainer:{keyEvents:p.fromContainerKeyEvents(),mouseEvents:p.fromContainerMouseEvents(),wheelEvents:p.fromContainerWheelEvents(),touchEvents:p.fromContainerTouchEvents(),gestureEvents:p.fromContainerGestureEvents()},dispatchMouseEventsOnTouch:p.dispatchMouseEventsOnTouch()}},toggleNativeKeys:function(p){},toggleNativeMouse:function(p){},toggleNativeWheel:function(p){},toggleNativeTouches:function(p){},toggleNativeGestures:function(p){},addEventsSupport:function(x,r){var v=x.superClass,u=x.prototype,y={},w,p,t,s,q;if(b.isA(r,Array)){t={};for(s=0,q=r.length;s<q;s++){b.mixin(t,r[s])}r=t}if(v!==undefined&&v.prototype.events!==undefined){y.prototype=v.prototype.events}for(p in r){if(r.hasOwnProperty(p)){w=r[p];y[p]=w;t=w.charAt(0).toUpperCase()+w.substr(1);u["on"+t]=i._createOnEventMethod(w);u["off"+t]=i._createOffEventMethod(w);u["on"+t+"At"]=i._createOnEventAtMethod(w)}}u.events=y},_createOnEventMethod:function(p){return function(r,q){this.addEventListener(p,r,q)}},_createOffEventMethod:function(p){return function(r,q){this.removeEventListener(p,r,q)}},_createOnEventAtMethod:function(p){return function(s){if(s===undefined){s=0}var q=p+"",r=""+s;if(this._eventDescCache===undefined){this._eventDescCache={}}if(this._eventDescCache[q]===undefined){this._eventDescCache[q]={}}if(this._eventDescCache[q][r]===undefined){this._eventDescCache[q][r]={source:this,type:p,offset:s}}return this._eventDescCache[q][r]}},dispatchExternalEvent:function(p){if(typeof b.config.catchAllEventListener==="function"&&p!==null&&p!==undefined){p.domId=b.config.domId;b.config.catchAllEventListener(p,p.domId)}},handleExternalEvent:function(x){var z=i._userEventsSupport,A=undefined,r,v,s,q=z.fromContainerKeyEvents(),u=z.fromContainerMouseEvents(),y=z.fromContainerWheelEvents(),t=z.fromContainerTouchEvents(),w=z.fromContainerGestureEvents();if(x===null){c.warn("WARN__EVT__NPE")}else{if(x!==undefined){r={type:x.type};v=null;if(b.hasOwnValue(b.KeyEvents,r.type,true)){if(q===true){r.cancelable=true;v=b.focusManager.getFocusOwner();r.keyCode=x.keyCode;i._getKeyModifiers(r,x)}}else{if(b.MouseEvents.MOUSE_WHEEL.equalIgnoreCase(r.type)){if(y===true){v=i._getNodeFromContainer(x);if(v!==undefined&&v!==null){i._getEventCoordsFromContainer(r,x,v);i._getKeyModifiers(r,x);if(typeof x.delta==="number"){r.delta=x.delta}else{r.delta=0}}}}else{if(b.hasOwnValue(b.MouseEvents,r.type,true)){if(u===true){v=i._getNodeFromContainer(x);if(v!==undefined&&v!==null){i._getEventCoordsFromContainer(r,x,v);i._getKeyModifiers(r,x);if(typeof x.button==="number"){r.button=x.button}else{r.button=0}}}}else{if(b.hasOwnValue(b.TouchEvents,r.type,true)){if(t===true){v=i._getNodeFromContainer(x);if(v!==undefined&&v!==null){i._getEventCoordsFromContainer(r,x,v);i._getKeyModifiers(r,x)}}}else{if(b.hasOwnValue(b.GenericGestureEvents,r.type,true)){if(w===true){v=b.rootNode;r.rotation=x.rotation;r.scale=x.scale}}else{v=b.rootNode;for(s in x){if(s!=="type"){r[s]=x[s]}}}}}}}if(v!==null){i._dispatchEventTo(v,r)}A=r.returnValue}}return A},_dispatchKeyEvent:function(r){var p,q=b.focusManager.getFocusOwner();if(q!==null){p=i._createAPIEvent(r,true);i._getKeyEventArgs(p,r);i._dispatchEventTo(q,p)}},_dispatchMouseEvent:function(r){var p,q=i._getAPITarget(r);if(q!==null){p=i._createAPIEvent(r);i._getMouseEventArgs(p,r,q);i._dispatchEventTo(q,p)}},_dispatchTouchEvent:function(r){var q=i._createAPIEvent(r,true);var y=r.changedTouches;var B=y.length;var E,w,s,u;var A=[];if(q.type===b.TouchEvents.TOUCH_START){for(E=0;E<B;E++){w=y[E];s=i._createAPITouchValue(w);if(s!==undefined){u={touchValue:s,relatedTarget:null};j[w.identifier]=u;i._handleTouchEnterLeave(w,u);A.push(s)}}}else{for(E=0;E<B;E++){w=y[E];u=j[w.identifier];if(u!==undefined){s=u.touchValue;i._updateAPITouchValue(w,s);i._handleTouchEnterLeave(w,u);A.push(s)}}}var p=r.targetTouches;var D=p.length;var z=[];for(E=0;E<D;E++){w=p[E];u=j[w.identifier];if(u!==undefined){z.push(u.touchValue)}}var C=r.touches;var v=C.length;var x=[];for(E=0;E<v;E++){w=C[E];u=j[w.identifier];if(u!==undefined){x.push(u.touchValue)}}q.changedTouches=A;q.targetTouches=z;q.touches=x;i._getKeyModifiers(q,r);i._getGestureEventArgs(q,r);if(A.length>0&&A[0].target!==undefined&&A[0].target!==null){i._dispatchEventTo(A[0].target,q)}},_handleTouchEnterLeave:function(r,q){var s=i._getAPITarget(r);if(s!==null){var p=q.relatedTarget;if(s!==p){if(p!==null){i.handleLeave(p,s,b.TouchEvents.TOUCH_LEAVE,q.touchValue)}i.handleEnter(s,p,b.TouchEvents.TOUCH_ENTER,q.touchValue)}q.relatedTarget=s}},handleEnter:function(v,p,s,u){var t=v.getAncestors();var q=-1;if(p!==null){q=f(t,p.getAncestors())}for(var r=q+1;r<t.length;r++){t[r].dispatchEvent({type:s,clientX:u.clientX,clientY:u.clientY,userX:u.userX,userY:u.userY,ctrlKey:u.ctrlKey,shiftKey:u.shiftKey,altKey:u.altKey,relatedTarget:p,bubbles:false})}},handleLeave:function(v,p,s,u){var t=v.getAncestors();var q=-1;if(p!==null){q=f(t,p.getAncestors())}for(var r=t.length-1;r>q;r--){t[r].dispatchEvent({type:s,clientX:u.clientX,clientY:u.clientY,userX:u.userX,userY:u.userY,ctrlKey:u.ctrlKey,shiftKey:u.shiftKey,altKey:u.altKey,relatedTarget:p,bubbles:false})}},_createAPITouchValue:function(){},_updateAPITouchValue:function(){return null},_dispatchGestureEvent:function(q){var p=i._createAPIEvent(q,true);i._getGestureEventArgs(p,q);i._dispatchEventTo(b.rootNode,p)},_createAPIEvent:function(p,q){return{type:i._getAPIEventType(p),cancelable:q,preventNativeDefault:i._preventNativeDefault(p),stopNativePropagation:i._stopNativePropagation(p)}},_dispatchEventTo:function(t,s){var p=s.type.toLowerCase(),r=n[p],q=l[p];if(r!==undefined){r(s,t)}t.dispatchEvent(s);if(q!==undefined){q(s)}b.tree.layout()},_getKeyModifiers:function(q,p){q.ctrlKey=p.ctrlKey;q.shiftKey=p.shiftKey;q.altKey=p.altKey},_getNodeFromContainer:function(s){var r=null,q=s.clientX,p=s.clientY,t=s.delta;if(isFinite(q)&&isFinite(p)){r=b.tree.getNodeAt(q,p)}else{if(isFinite(t)){r=b.rootNode}}return r},_getEventCoordsFromContainer:function(p,t,s){var r=t.clientX,q=t.clientY,u=s.globalToLocal(r,q);p.clientX=r;p.clientY=q;p.pageX=t.pageX;p.pageY=t.pageY;p.userX=u.x;p.userY=u.y},_getAPIEventType:function(p){return undefined},_preventNativeDefault:function(p){return function(){p.preventDefault()}},_stopNativePropagation:function(p){return function(){p.stopPropagation()}},_stopNextNativeMouseEvent:function(q,p,r){},_getAPITarget:function(p){return null},_getKeyEventArgs:function(q,p){},_getMouseEventArgs:function(q,p,r){},_getGestureEventArgs:function(q,p){},_dispatchMouseEventFromTouch:function(p,q){var r;if(i._userEventsSupport.dispatchMouseEventsOnTouch()===true){r={type:q,clientX:p.clientX,clientY:p.clientY,userX:p.userX,userY:p.userY,ctrlKey:p.ctrlKey,shiftKey:p.shiftKey,altKey:p.altKey};i._dispatchEventTo(p.target,r)}}});b.addEventsSupport=b.events.addEventsSupport})();(function(){var o=b.events,t=null,x=b.MouseEvents,z=b.KeyEvents,A=b.TouchEvents,r=b.GenericGestureEvents,s=b.CursorTypeEnum,m={},h={},p="mousedown",g="mouseup",w="mouseover",C="mouseout",u="mousemove",n="keydown",i="keyup",e="touchstart",l="touchmove",f="touchend",q="gesturestart",k="gesturechange",j="gestureend";m[p]=x.MOUSE_DOWN;m[g]=x.MOUSE_UP;m[u]=x.MOUSE_MOVE;m[w]=x.MOUSE_OVER;m[C]=x.MOUSE_OUT;m[n]=z.KEY_DOWN;m[i]=z.KEY_UP;m[e]=A.TOUCH_START;m[l]=A.TOUCH_MOVE;m[f]=A.TOUCH_END;m[q]=r.GESTURE_START;m[k]=r.GESTURE_CHANGE;m[j]=r.GESTURE_END;h[s.AUTO]="auto";h[s.DEFAULT]="default";h[s.MOVE]="move";h[s.POINTER]="pointer";h[s.TEXT]="text";h[s.WAIT]="wait";h[s.NONE]="none";h[s.CUSTOM]="none";function y(D){var F=o._getAPITarget(D),E;E={type:D.type,apiTarget:F,clientX:D.clientX,clientY:D.clientY,ctrlKey:D.ctrlKey,shiftKey:D.shiftKey,altKey:D.altKey,detail:D.detail,button:D.button,stopPropagation:function(){D.stopPropagation()},preventDefault:function(){D.preventDefault()}};if(F!==null){o._dispatchMouseEvent(E)}if(F!==t){if(t!==null){E.type=C;E.apiTarget=t;E.apiRelatedTarget=F;E.stopPropagation=b.NO_OP;E.preventDefault=b.NO_OP;o._dispatchMouseEvent(E)}if(F!==null){E.type=w;E.apiTarget=F;E.apiRelatedTarget=t;E.stopPropagation=b.NO_OP;E.preventDefault=b.NO_OP;o._dispatchMouseEvent(E)}}t=F}function v(D){D.apiTarget=t;D.apiRelatedTarget=null;o._dispatchMouseEvent(D);t=null}function B(D){return(D?"add":"remove")+"EventListener"}b.mixin(b.events,{_stopNextNativeMouseEvent:function(G,D,I){var E=b.tree.canvas,F=G.toLowerCase(),H;H=function(J){var K=o._canvasClientToRootCoords(J);if(D===K.x&&I===K.y){J.stopPropagation()}E.removeEventListener(F,H,true)};E.addEventListener(F,H,true)},_getAPIEventType:function(D){return m[D.type]},_getAPITarget:function(D){var E=null,F;if(D.apiTarget===undefined){F=this._canvasClientToRootCoords(D);E=b.tree.getNodeAt(F.x,F.y)}else{E=D.apiTarget}return E},_getKeyEventArgs:function(E,D){E.keyCode=D.keyCode;this._getKeyModifiers(E,D)},_getMouseEventArgs:function(E,D,G){var F=D.type,H=this._canvasClientToRootCoords(D);this._setCanvasCoords(E,D,G,H);this._getKeyModifiers(E,D);if(D.button!==undefined){E.button=D.button}if(F===w){E.relatedTarget=D.apiRelatedTarget;this._setCanvasCursor(G)}else{if(F===C){E.relatedTarget=D.apiRelatedTarget;this._setCanvasCursor(null)}}},_createAPITouchValue:function(D){var F,E=this._canvasClientToRootCoords(D),G=b.tree.getNodeAt(E.x,E.y);if(G!==undefined&&G!==null){F={identifier:D.identifier,target:G};this._setCanvasCoords(F,D,G,E)}return F},_updateAPITouchValue:function(D,F){var E=this._canvasClientToRootCoords(D);this._setCanvasCoords(F,D,F.target,E)},_getGestureEventArgs:function(E,D){E.rotation=D.rotation;E.scale=D.scale},_canvasClientToRootCoords:function(D){var E=b.tree.getCanvasRootClientCoords();return{x:(D.clientX-E.x),y:(D.clientY-E.y)}},_setCanvasCoords:function(D,F,G,E){var H=G.globalToLocal(E.x,E.y);D.clientX=E.x;D.clientY=E.y;D.userX=H.x;D.userY=H.y;D.screenX=F.screenX;D.screenY=F.screenY},toggleNativeKeys:function(E){var F=b.tree.document,D=B(E);F[D](n,this._dispatchKeyEvent,false);F[D](i,this._dispatchKeyEvent,false)},toggleNativeMouse:function(F){var E=b.tree.canvas,D=B(F);E[D](p,this._dispatchMouseEvent,false);E[D](g,this._dispatchMouseEvent,false);E[D](u,y,false);E[D](C,v,false)},toggleNativeTouches:function(F){var E=b.tree.canvas,D=B(F);E[D](e,this._dispatchTouchEvent,false);E[D](l,this._dispatchTouchEvent,false);E[D](f,this._dispatchTouchEvent,false)},toggleNativeGestures:function(F){var E=b.tree.canvas,D=B(F);E[D](q,this._dispatchGestureEvent,false);E[D](k,this._dispatchGestureEvent,false);E[D](j,this._dispatchGestureEvent,false)},_setCanvasCursor:function(E){var D=b.tree.canvas,F=s.AUTO;while(E!==null&&F===s.AUTO){F=E.cursor();E=E.parentNode}D.style.cursor=h[F]}})})();(function(){b.ns("oui.events");b.events.addDragSupport=function(l){var i,j,o,e,n,m,k,f,h,g;j=function(p){var r,q,v,t,u,s,x,w;p.stopPropagation();p.preventDefault();if(p.changedTouches===undefined){r=p.clientX;q=p.clientY}else{w=p.changedTouches[0];r=w.clientX;q=w.clientY}x=n.globalToLocal(r,q);v=x.x;t=x.y;x=n.globalToLocal(h,g);u=x.x;s=x.y;n.dispatchEvent({type:b.DragEvents.DRAG,cancelable:true,dragClientX:(r-h),dragClientY:(q-g),dragUserX:(v-u),dragUserY:(t-s),clientX:r,clientY:q,userX:v,userY:t,shiftKey:p.shiftKey,ctrlKey:p.ctrlKey,defaultAction:n.getDefaultDragAction()});h=r;g=q};o=function(p){var s,q,u,t,x,w,B,y,r,A,z=arguments.callee;l.offMouseMove(j);l.offMouseUp(z);l.offTouchMove(j);l.offTouchEnd(z);l.offMouseLeave(z);if(n!==undefined){B=n.globalToLocal(m,k);x=B.x;w=B.y;s=h;q=g;y=false;r=false;if(p!==undefined&&p!==null){if(p.changedTouches===undefined){s=p.clientX;q=p.clientY}else{var v=p.changedTouches[0];s=v.clientX;q=v.clientY}y=p.shiftKey;r=p.ctrlKey;A=p.timeStamp-f}B=n.globalToLocal(s,q);u=B.x;t=B.y;n.dispatchEvent({type:b.DragEvents.DRAG_END,cancelable:true,shiftKey:y,ctrlKey:r,clientX:s,clientY:q,userX:u,userY:t,totalDragClientX:(s-m),totalDragClientY:(q-k),totalDragUserX:(u-x),totalDragUserY:(t-w),totalDragTime:A});n=undefined}};e=function(){l.onMouseLeave(o)};i=function(t){var v=t.target,s,r,u=t.touches,p,q=false,w;if(u!==undefined){if(u.length===1){p=u[0]}else{q=true}}if(q===true){o(t)}else{while(v!==undefined&&v!==null&&v.draggable()===false){v=v.parentNode}if(v!==undefined&&v!==null){n=v;if(p===undefined){s=t.clientX;r=t.clientY}else{s=p.clientX;r=p.clientY}w=n.globalToLocal(s,r);n.dispatchEvent({type:b.DragEvents.DRAG_START,cancelable:true,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,clientX:s,clientY:r,userX:w.x,userY:w.y,defaultAction:e,stopDrag:o});m=h=s;k=g=r;f=t.timeStamp;l.onMouseMove(j);l.onMouseUp(o);l.onTouchMove(j);l.onTouchEnd(o)}}};l.onMouseDown(i);l.onTouchStart(i)}})();var b=b||{};(function(){var e=function(t,u,n,p,i,m,k,l,s,h,r,o,q){var j=document.createEvent("MouseEvents");j.initMouseEvent(t,u,n,window,p,i.x,i.y,m,k,l,h,s,r,o,q);return j};var g=function(u,w,n,q,i,m,k,l,t,h,s,p,r,v,o,x){var j=document.createEvent("TouchEvent");j.initTouchEvent(u,w,n,window,q,i.x,i.y,m,k,l,h,t,s,p,r,v,o,x);return j};var f=function(h){return{x:h.screenX,y:h.screenY}};b.addGestureSupport=function(m,q,l,t,j,k,h){var r,p,i,s,u,o,n={};q=q||e;l=l||g;t=t||f;if(j===undefined||typeof j!=="number"){j=500}if(k===undefined||typeof k!=="number"){k=800}if(h===undefined||typeof h!=="number"){h=40}s=function(v){return function(){var y=n[v.identifier],w,x;if(y!==undefined&&y.longPressTimeoutID!==undefined){w=y.event;x=q("touchlongpress",true,true,v.identifier,t(v),v.clientX,v.clientY,w.ctrlKey,w.shiftKey,w.altKey,w.metaKey,0,v.target);v.target.dispatchEvent(x);delete y.longPressTimeoutID}}};p=function(x){var w=x.changedTouches,v,y=w.length,z,A;for(v=0;v<y;v++){A=w[v];z=n[A.identifier];if(z.longPressTimeoutID!==undefined&&Math.abs(A.clientX-z.clientX)>h&&Math.abs(A.clientY-z.clientY)>h){clearTimeout(z.longPressTimeoutID);delete z.longPressTimeoutID}}};u=function(w){var v;if(w.detail>1&&w.timeStamp-o.timeStamp<j){v=q("dbltap",true,true,w.detail,t(w),w.clientX,w.clientY,w.ctrlKey,w.shiftKey,w.altKey,w.metaKey,0,w.target);w.target.dispatchEvent(v)}o=w};i=function(x){var C,A,B,z,v,w,D,y;m.removeEventListener("touchend",i,true);if(x.fake!==true){C=x.changedTouches;B=C.length;for(A=0;A<B;A++){z=C[A];v=n[z.identifier];if(v!==undefined){if(v.longPressTimeoutID!==undefined){clearTimeout(v.longPressTimeoutID);delete v.longPressTimeoutID}if(Math.abs(z.clientX-v.clientX)<h&&Math.abs(z.clientY-v.clientY)<h&&x.timeStamp-v.timeStamp<j){x.stopPropagation(true);w=l.call(null,"touchend",true,true,x.detail,t.call(null,x),x.clientX,x.clientY,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey,x.touches,x.targetTouches,x.changedTouches,x.scale,x.rotation);w.fake=true;x.target.dispatchEvent(w);if(w.defaultPrevented===true){x.preventDefault()}if(w.stopped===true){x.stopPropagation()}y=1;if(o!==undefined&&Math.abs(z.clientX-o.clientX)<h&&Math.abs(z.clientY-o.clientY)<h){y=o.detail+1}D=q.call(null,"tap",true,true,y,t.call(null,z),z.clientX,z.clientY,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey,0,x.target);x.target.dispatchEvent(D);u(D)}delete n[z.identifier]}}}};r=function(y){var x=y.changedTouches,w,z=x.length,A,v;for(w=0;w<z;w++){A=x[w];v={identifier:A.identifier,screenX:A.screenX,screenY:A.screenY,clientX:A.clientX,clientY:A.clientY,event:y};n[A.identifier]=v;v.timeStamp=y.timeStamp;v.longPressTimeoutID=setTimeout(s(A,n),k)}m.addEventListener("touchmove",p,true);m.addEventListener("touchend",i,true)};m.addEventListener("touchstart",r,true)}})();(function(){b.ns("oui.events");b.events.addPressNTapSupport=function(e){var f=undefined;e.onTouchStart(function(g){f=g});e.onTouchMove(function(){f=undefined});e.onTap(function(g){if(f!==undefined){if(g.identifier!==f.identifier){f.target.dispatchEvent({type:b.GestureEvents.PRESS_AND_TAP,clientX:f.clientX,clientY:f.clientY,userX:f.userX,userY:f.userY,tapClientX:(g.clientX-f.clientX),tapClientY:(g.clientX-f.clientY),tapUserX:(g.userX-f.userX),tapUserY:(g.userY-f.userY),ctrlKey:f.ctrlKey,shiftKey:f.shiftKey})}f=undefined}});e.onTouchEnd(function(g){if(f!==undefined&&g.identifier===f.identifier){f=undefined}})}})();(function(){var g=20;var e=0.2;var f=function(j,h){var i=b.geom.centroid(j.touches,"clientX","clientY");b.rootNode.dispatchEvent({type:b.GestureEvents.PINCH,clientX:i.x,clientY:i.y,userX:i.x,userY:i.y,phase:b.GestureEventPhases[h],scale:j.scale,rotation:j.rotation,preventNativeDefault:function(){j.preventNativeDefault()}})};b.ns("oui.events");b.events.addPinchSupport=function(i){var j=false,h=false;i.onTouchStart(function(){j=false;h=false});i.onTouchMove(function(k){if(j===false){if(Math.abs(k.rotation)>g){if(h===true){f(k,"CANCEL")}j=true}else{if(h===true){f(k,"CHANGE")}else{if(Math.abs(k.scale-1)>e){h=true;f(k,"BEGIN")}}}}});i.onTouchEnd(function(k){if(h===true&&j===false){if(Math.abs(k.rotation)>g){f(k,"CANCEL");j=true}else{f(k,"END");j=true}}})}})();(function(){var e=10;var j=Math.PI/4;var h=function(m,o,l,n){var q,p=Math.atan2((n-o),(l-m));if(Math.abs(p)<j){q=b.DirectionEnum.RIGHT}else{if(Math.abs(p-Math.PI/2)<j){q=b.DirectionEnum.DOWN}else{if(Math.abs(p+Math.PI/2)<j){q=b.DirectionEnum.UP}else{q=b.DirectionEnum.LEFT}}}return q};var k=function(m,n){var l=m.length;while(l--){if(n===m[l].identifier){break}}return m[l]};var i=function(s,o,r,m){var n=o.screenX-s.screenX,l=o.screenY-s.screenY,q=m.screenX-r.screenX,p=m.screenY-r.screenY;return b.geom.dotprod(n,l,q,p)>=0};var f=function(o){var s=[],n=o.length,m,t,q,p,r=Number.MAX_VALUE,l;while(n--){t=o[n].target.getAncestors();if(t.length<r){r=t.length;l=n}s.push(t)}q=s.splice(l,1)[0];for(n=0;n<r;n++){p=q[n];m=s.length;while(m--){if(s[m][n]!==p){break}}if(m>=0){break}}return q[n-1]};var g=function(l,n){var m=f(l);if(m!==undefined&&m!==null){m.dispatchEvent({type:b.GestureEvents.SWIPE,phase:b.GestureEventPhases[n.phase],direction:n.direction,translate:n.translate,velocity:n.velocity})}};b.ns("oui.events");b.events.SwipeSupport={_forEachChangedTouch:function(q,p,l){var o=q.changedTouches,r=q.timeStamp,m,s=o.length;for(m=0;m<s&&(l===null||!l());m++){this[p](o[m],r)}},_handleStartedTouch:function(m){var l=this._touchesStarted;if(l!==undefined){if(k(l,m.identifier)===undefined){this._touchesStarted.push(m)}else{if(this._nTouchesEnded>0){this._touchesStarted=undefined}}}else{this._touchesStarted=[m];this._touchesMoved={};this._nTouchesMoved=0;this._nTouchesEnded=0;this._centroid=undefined;this._gestureInfo=undefined}},_handleMovedTouch:function(v,m){var o=this._gestureInfo,t,C,l,n,B,y,r,w,D,p,s=0,x=0,A=0,z=true,q=v.identifier,u=k(this._touchesStarted,q);if(u===undefined){if(o!==undefined){o.phase="CANCEL";g(this._touchesStarted,o)}this._touchesStarted=undefined}else{if(this._touchesMoved[q]===undefined){this._nTouchesMoved++}this._touchesMoved[q]=v;n=this._touchesStarted.length;B=this._nTouchesMoved;if(B===n){if(o===undefined){C={};t=this._centroid;if(t===undefined){t=b.geom.centroid(this._touchesStarted,"screenX","screenY");this._centroid=t}y=this._touchesStarted[0];r=this._touchesMoved[y.identifier];for(w=0;w<n;w++){D=this._touchesStarted[w];p=this._touchesMoved[D.identifier];x+=b.geom.dist(D.screenX,D.screenY,t.x,t.y);s=b.geom.dist(p.screenX,p.screenY,t.x,t.y);A+=s;z=z&&i(y,r,D,p);C[D.identifier]={lastMovedTouch:p,distanceToCentroid:s}}x/=n;A/=B;l=Math.abs(x-A);if(l>e){this._startGestureTime=m;o={phase:"BEGIN",centroid:t,meanDistances:x,newMeanDistances:A,touchesInfo:C,duration:1};if(z===true){o.direction=h(u.screenX,u.screenY,v.screenX,v.screenY);o.translate=l;o.velocity=l/o.duration;g(this._touchesStarted,o)}else{this._touchesStarted=undefined}this._gestureInfo=o}}else{this._updateGestureEvent(v,m,false)}}}},_updateGestureEvent:function(p,o,s){var r=this._gestureInfo,n=r.touchesInfo[p.identifier],m,q,l;if(n!==undefined){m=b.geom.dist(p.screenX,p.screenY,this._centroid.x,this._centroid.y);q=r.newMeanDistances+(m-n.distanceToCentroid)/this._touchesStarted.length;r.newMeanDistances=q;r.duration=(o-this._startGestureTime);l=Math.abs(r.meanDistances-q);if((s===true)||(r.direction===h(n.lastMovedTouch.screenX,n.lastMovedTouch.screenY,p.screenX,p.screenY))){if(s===true){r.phase="END"}else{r.phase="CHANGE"}r.translate=l;r.velocity=l/r.duration;g(this._touchesStarted,r)}else{r.phase="CANCEL";g(this._touchesStarted,r);this._touchesStarted=undefined}n.lastMovedTouch=p;n.distanceToCentroid=m}else{r.phase="CANCEL";g(this._touchesStarted,r);this._touchesStarted=undefined}},_handleEndedTouch:function(m,l){this._nTouchesEnded++;if(this._gestureInfo!==undefined){this._updateGestureEvent(m,l,true);if(this._touchesStarted.length===this._nTouchesEnded){this._touchesStarted=undefined}}else{this._touchesStarted=undefined}}};b.events.addSwipeSupport=function(m){var n=b.events.SwipeSupport,l;l=function(){return(this._touchesStarted===undefined)};m.onTouchStart(function(o){return n._forEachChangedTouch(o,"_handleStartedTouch",null)});m.onTouchMove(function(o){return n._forEachChangedTouch(o,"_handleMovedTouch",l)});m.onTouchEnd(function(o){return n._forEachChangedTouch(o,"_handleEndedTouch",l)})}})();(function(){b.ns("oui.focus");b.mixin(b.focus,{getFocusableAncestor:function(f){var e=null;if(f.parentNode!==null){if(b.focus.isFocusableTarget(f.parentNode)===true){e=f.parentNode}else{e=b.focus.getFocusableAncestor(f.parentNode)}}return e},getFocusableDescendant:function(g,f){var h=null,k,e=true,j,i;if(f===false){e=false}j=e?"firstChild":"lastChild";i=e?"nextSibling":"previousSibling";k=g[j];while(k!==null){if(k._style.display===true){if(k._style.focusable===true){h=k;break}else{h=b.focus.getFocusableDescendant(k,e);if(h!==null){break}}}k=k[i]}return h},isFocusableTarget:function(e){return e._style.display===true&&e._style.focusable===true}})})();(function(){b.declare({name:"oui.focus.FocusManager",mixins:[b.events.EventSupport],membersDef:{init:function(e){if(b.isA(e,b.graphics.AbstractGraphicNode)===false){e=null}this.rootFocusNode=e;this.focusOwner=e;b.rootNode.addEventListener(b.ViewEvents.FOCUS_COMPONENT,this.handler("_onFocusComponent"));b.rootNode.addEventListener(b.ViewEvents.BLUR_COMPONENT,this.handler("_onBlurComponent"));b.rootNode.onKeyDown(b.focus.DefaultFocus)},getRootFocusNode:function(){return this.rootFocusNode},getFocusOwner:function(){return this.focusOwner},setFocusOutlineStrokeStyle:function(e){if(b.isA(e,b.style.Paint)){this._strokeFocusOutline=e}},requestFocus:function(e,f){if(b.isA(e,b.graphics.AbstractGraphicNode)&&e.getFocusable()===true){this._moveFocus(this._getValidFocusOwner(e),f)}},releaseFocus:function(){b.events.dispatchExternalEvent({type:b.ViewEvents.RELEASE_FOCUS})},_onFocusComponent:function(){if(this.focusOwner!==this.rootFocusNode){var e=this.focusOwner;this.focusOwner=this.rootFocusNode;this._moveFocus(e,undefined,true)}},_onBlurComponent:function(){this._dispatchFocusOutEvent(null);this._onBlurComponentImpl()},_onBlurComponentImpl:function(){},moveFocusDirection:function(f){if(b.isA(f,Boolean)===false){f=true}var e=this._getValidFocusOwner(this.focusOwner);e=this._moveFocusDirection(e,f);if(e===null){e=this._lookForFocusableNode(this.rootFocusNode,f)}this._moveFocus(e)},_getValidFocusOwner:function(e){var g=e.getAncestors(),k=g.length,h=null,f,j=false;for(f=0;f<k;f++){h=g[f];if(h===this.rootFocusNode){j=true}if(h.getDisplay()===false){break}}if(j===false){h=null}return h},_moveFocus:function(e,f,g){if(e!==null&&e!==this.focusOwner){this._dispatchFocusOutEvent(e,f);this._dispatchFocusInEvent(e,f,g);this.focusOwner=e;this._moveFocusImpl(this.focusOwner)}},_moveFocusImpl:function(e){},reFocus:function(){if(this.focusOwner!==null){this._reFocusImpl(this.focusOwner)}},_reFocusImpl:function(e){},_moveFocusDirection:function(i,h){var g=null,f,e;if(i!==null){f=h?i.nextSibling:i.previousSibling;while(f!==null&&g===null){g=this._lookForFocusableNode(f,h);f=h?f.nextSibling:f.previousSibling}e=i.parentNode;if(g===null&&e!==null){g=this._moveFocusDirection(e,h)}}return g},_lookForFocusableNode:function(g,f){var e=null;if(g.getDisplay()===true){if(g.getFocusable()){e=g}else{var h=(f===true)?g.firstChild:g.lastChild;while(h!==null&&e===null){e=this._lookForFocusableNode(h,f);if(f===true){h=h.nextSibling}else{h=h.previousSibling}}}}return e},_dispatchFocusInEvent:function(h,e,g){if(h!==undefined){var f=false,i=false;if(e!==undefined&&e!==null){f=(e.shiftKey===true)?true:false;i=(e.ctrlKey===true)?true:false}h.dispatchEvent({type:b.UIEvents.FOCUS_IN,target:h,relatedTarget:this.focusOwner,cancelable:true,shiftKey:f,ctrlKey:i,defaultAction:this._drawFocusOutline(h),refocus:g})}},_drawFocusOutline:function(f){var e=this;return function(){var k=f.getLayoutBounds(b.tree.focusLayer),g=f.getFocusOutlineOffset(),j=k.width+g*2,h=k.height+g*2,i;if(j>0&&h>0){i=new b.graphics.Rectangle({x:k.x-g,y:k.y-g,width:j,height:h,fill:b.NO_PAINT,stroke:e._strokeFocusOutline!==undefined?e._strokeFocusOutline:b.GRAY});b.tree.focusLayer.appendChild(i)}}},_clearFocusOutline:function(){return function(){b.tree.focusLayer.removeChildren()}},_dispatchFocusOutEvent:function(g,e){if(this.focusOwner!==null){var f=false,h=false;if(e!==undefined&&e!==null){f=(e.shiftKey===true)?true:false;h=(e.ctrlKey===true)?true:false}this.focusOwner.dispatchEvent({type:b.UIEvents.FOCUS_OUT,target:this.focusOwner,relatedTarget:g,cancelable:true,shiftKey:f,ctrlKey:h,defaultAction:this._clearFocusOutline()})}}}})})();(function(){b.ns("oui.focus");var e=b.KeyCode;b.focus.DefaultFocus={handleEvent:function(g){var f=b.focusManager;if(g.type.equalIgnoreCase(b.KeyEvents.KEY_DOWN)===true){switch(g.keyCode){case e.TAB:if(g.shiftKey===true){f.moveFocusDirection(false)}else{f.moveFocusDirection(true)}break;case e.LEFT_ARROW:f.moveFocusDirection(false);break;case e.RIGHT_ARROW:f.moveFocusDirection(true);break;case e.ESC:f.releaseFocus();break;case e.ENTER:case e.SPACEBAR:g.target.dispatchEvent({type:b.UIEvents.ACTIVATE,defaultAction:g.target.getDefaultActivateAction()});break;default:break}}}}})();(function(){var e=b.KeyCode;b.declare({name:"oui.focus.FocusRing",membersDef:{init:function(){},handleEvent:function(g){var f=false;if(g.type.equalIgnoreCase(b.KeyEvents.KEY_DOWN)===true){this._initRootFocusNode(g);switch(g.keyCode){case e.TAB:if(g.shiftKey===true){f=this.moveFocusBackwardAction(g)}else{f=this.moveFocusForwardAction(g)}break;case e.LEFT_ARROW:f=this.moveFocusBackwardAction(g);break;case e.RIGHT_ARROW:f=this.moveFocusForwardAction(g);break;case e.ESC:f=this.moveFocusLevelUpAction(g);break;case e.ENTER:if((g.ctrlKey!==true)&&(g.shiftKey!==true)){f=this.moveFocusLevelDownAction(g)}break}}if(f===true){g.stopPropagation()}},moveFocusLevelDownAction:function(g){var i=false,f=b.focusManager.getFocusOwner(),h;if(f!==null){h=b.focus.getFocusableDescendant(f);if(h!==null){i=true;b.focusManager.requestFocus(h,g)}}return i},moveFocusLevelUpAction:function(g){var i=false,f=b.focusManager.getFocusOwner(),h;if(f!==null){h=b.focus.getFocusableAncestor(f.parentNode);if(h!==null){i=true;b.focusManager.requestFocus(h,g)}}return i},moveFocusForwardAction:function(f){return this.moveFocusAction(true,f)},moveFocusBackwardAction:function(f){return this.moveFocusAction(false,f)},moveFocusAction:function(j,i){var m=false,f=b.focusManager,h=f.getFocusOwner(),k=f._moveFocusDirection(h,j),l=this._getRootFocusNode(),g;if(k===null){k=b.focus.getFocusableDescendant(b.rootNode,j)}if(h!==l){g=b.focus.getFocusableAncestor(h);if(k!==null&&k.isDescendant(g)!==true){k=b.focus.getFocusableDescendant(g,j)}}else{k=null}if(k!==null){m=true;f.requestFocus(k,i)}return m},_getRootFocusNode:function(){return this._rootFocusNode},_initRootFocusNode:function(f){var g=f.currentTarget;if(g._style.focusable!==true||g._style.display!==true){g=b.focus.getFocusableDescendant(g)}this._rootFocusNode=g}}})})();(function(){var j=b.KeyCode,i=b.DirectionEnum,e=i.UP,h=i.DOWN,f=i.LEFT,g=i.RIGHT;b.declare({name:"oui.focus.SpatialFocus",mixins:[b.events.EventSupport],membersDef:{init:function(l,k){this._keyDownFilter=this._defaultKeyDownFilter;this._focusContainer=null;if(b.isA(l,b.graphics.AbstractGraphicNode)===true){l.onFocusIn(this.handler("_onFocusIn"));this._focusContainer=l}if(b.isA(k,Function)===true){this._keyDownFilter=k}},_defaultKeyDownFilter:function(k){return((k.ctrlKey!==true)&&(k.shiftKey!==true))},_onFocusIn:function(k){var l=k.relatedTarget;if(l._focusPoint!==undefined){delete l._focusPoint}},handleEvent:function(l){var k=(l.keyCode===j.TAB);if(this._keyDownFilter(l)===true){switch(l.keyCode){case j.LEFT_ARROW:this._moveFocus(l,f);k=true;break;case j.RIGHT_ARROW:this._moveFocus(l,g);k=true;break;case j.UP_ARROW:this._moveFocus(l,e);k=true;break;case j.DOWN_ARROW:this._moveFocus(l,h);k=true;break;default:}}if(k===true){l.stopPropagation()}},_moveFocus:function(k,m){this._cacheFocusableNodes();var l=this._getFocusableItem(k.target,m);if(l!==null){l._focusPoint=this._newFocusPoint;b.focusManager.requestFocus(l,k)}},_cacheFocusableNodes:function(){var l=b.focus.getFocusableDescendant(this._focusContainer),k;this._focusableNodes=[];if(l!==null){this._focusableNodes.push(l);k=b.focusManager._moveFocusDirection(l,true);while(k!==null){this._focusableNodes.push(k);k=b.focusManager._moveFocusDirection(k,true)}}},_getFocusableItem:function(x,w){var y=null,n=this._getNodeInfos(x,w),o=n.center,t,p,l,k,m,v,r,q,s,u=this._focusableNodes.length;this._updateEntryPoint(n);for(r=0;r<u;r++){q=this._focusableNodes[r];if(q!==x){t=false;switch(w){case e:s=this._getNodeInfos(q,h);if(s.center.y<o.y){t=true}break;case h:s=this._getNodeInfos(q,e);if(s.center.y>o.y){t=true}break;case f:s=this._getNodeInfos(q,g);if(s.center.x<o.x){t=true}break;case g:s=this._getNodeInfos(q,f);if(s.center.x>o.x){t=true}break;default:}if(t===true){p=this._getNewFocusPoint(this._entryPoint,s.nodeBorder);k=this._computeFocusDistance(n,s,p);if((l===undefined)||(k<l)){l=k;m=b.geom.dist(o.x,o.y,s.center.x,s.center.y);y=q;this._newFocusPoint=p}else{if(l===k){v=b.geom.dist(o.x,o.y,s.center.x,s.center.y);if(v<m){y=q;this._newFocusPoint=p}}}}}}return y},_getNodeInfos:function(o,r){var p=o.getLayoutBounds(this._focusContainer),m=p.x,l=p.y,s=p.width,k=p.height,n={x:m+s/2,y:l+k/2},q;switch(r){case e:q={x1:m,y1:l,x2:m+s,y2:l};break;case h:q={x1:m,y1:l+k,x2:m+s,y2:l+k};break;case f:q={x1:m,y1:l,x2:m,y2:l+k};break;case g:q={x1:m+s,y1:l,x2:m+s,y2:l+k};break;default:}return{center:n,bounds:p,node:o,nodeBorder:q}},_updateEntryPoint:function(o){var k=false,n=o.node,l=o.bounds,m;if(n._focusPoint!==undefined){m=n._focusPoint;if(m.x>=l.x&&m.x<=l.x+l.width&&m.y>=l.y&&m.y<=l.y+l.height){this._entryPoint=m;k=true}}if(k===false){n._focusPoint=o.center;this._entryPoint=n._focusPoint}},_getNewFocusPoint:function(l,m){var k={};if(m.x1!==m.x2){if(l.x<m.x1){k.x=m.x1}else{if(l.x>m.x2){k.x=m.x2}else{k.x=l.x}}}else{k.x=m.x1}if(m.y1!==m.y2){if(l.y<m.y1){k.y=m.y1}else{if(l.y>m.y2){k.y=m.y2}else{k.y=l.y}}}else{k.y=m.y1}return k},_computeFocusDistance:function(k,q,o){var l=this._getEuclideanDistance(o);var p=k.nodeBorder,u=0,s=0,t=0,n=0,r,m;if(p.x1!==p.x2){s=Math.abs(o.y-p.y1);t=Math.abs(o.x-this._entryPoint.x)}else{u=Math.abs(o.x-p.x1);n=Math.abs(o.y-this._entryPoint.y)}r=0;m=b.geom.intersectRect(k.bounds,q.bounds);if(m!==undefined){r=Math.sqrt(m.width*m.height)}return(l+u+s+t+n-r)},_getEuclideanDistance:function(k){var m=this._entryPoint,l;if((m.x===k.x)||(m.y===k.y)){l=0}else{l=b.geom.dist(m.x,m.y,k.x,k.y)}return l}}})})();(function(){b.ns("oui.utils");var e=76,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";b.utils.base64Encoder=function(l){var p=0,r=l.length,j="",n=0,g=0,m=0,q,h,k,o;while(n<=r){if((n%3)===0&&n!==0){m>>=8;m&=16777215;q=m;q>>=18;q&=63;j+=f.charAt(q);g++;q=m;q>>=12;q&=63;j+=f.charAt(q);g++;q=m;q>>=6;q&=63;j+=f.charAt(q);g++;q=m;q&=63;j+=f.charAt(q);g++;m=0;if(g>=e){j+="\r";j+="\n";g=0}if(r-n<3){break}}q=l[p++];m|=(256+q)%256;m<<=8;n++}h=(r-n)%3;if(h!==0){m=0;for(k=0;k<3;k++){if(k<h){q=l[p++];m|=(256+q)%256;m<<=8;n++}else{m|=0;m<<=8}}m>>=8;m&=16777215;q=m;if(h>=1){q>>=18;q&=63;j+=f.charAt(q);q=m;q>>=12;q&=63;j+=f.charAt(q)}if(h>=2){q=m;q>>=6;q&=63;j+=f.charAt(q)}if(h>=3){q=m;q&=63;j+=f.charAt(q)}for(o=3;o>h;o--){j+="="}}if(j.length===0){c.error("ERR__BASE64")}return j}})();(function(){b.ns("oui.utils");b.utils.JSONLoader={load:function(m,k,e,l,h){var o=null,j=b.utils.JSONLoader.loadDescription,g,f;if(m!==undefined&&m!==null){if(m.constructor===Array){o=k;if(o===undefined||o===null){o=new b.graphics.Group()}for(g=0,f=m.length;g<f;g++){j(m[g],o,e,l,h)}}else{if(m.constructor===Object){if(k!==undefined&&k!==null){j(m,k,e,l,h);o=k}else{o=j(m,null,e,l,h)}}}}return o},loadDescription:function(n,m,e,o,k){var p=undefined,j,f,l,h,g;if(n!==undefined){j=b.utils.JSONLoader.CPGL_JSON_FACTORY[n.type];if(j!==undefined){p=j.call(null,n,e,o,k);f=n.name;if(e!==undefined&&e!==null){if(o===false){if(n.shortcutName!==undefined){l=n.shortcutName}}else{if(f!==undefined){l=f}}if(l!==undefined&&k!==undefined){l=k+l}if(l!==undefined){e[l]=p}}if(m!==undefined&&m!==null){if(f!==undefined&&m!==e){m[f]=p}if(p.constructor===Array){g=p.length;for(h=0;h<g;h++){m.appendChild(p[h])}}else{m.appendChild(p)}}}}return p},addJSONLoaderSupport:function(e,h){var g=b.utils.JSONLoader,f="";if(!b.inheritsFrom(e,b.scene.AbstractNode)){c.error("ERR__JSONLOAD__INV_CLASS")}if(b.isA(h.type,String)){f=h.type}if(f.length>0){if(g.CPGL_JSON_FACTORY[f]===undefined){g.CPGL_JSON_FACTORY[f]=g._getFactory(e,h.factory)}else{c.warn("WARN__JSONLOAD__DUP_TYPE")}}else{c.warn("WARN__JSONLOAD__EMPTY_STR")}},_getFactory:function(f,e){var h;if(b.isA(e,Function)){h=e}else{var g=f;h=function(i){return new g(i,i.name)}}return h},CPGL_JSON_FACTORY:{array:function(g){var e=[],f,h;if(b.isA(g.length,Number)&&g.of!==undefined){for(f=0,h=g.length;f<h;f++){e[f]=b.utils.JSONLoader.loadDescription(g.of)}}return e}}};b.load=b.utils.JSONLoader.load;b.addJSONLoaderSupport=b.utils.JSONLoader.addJSONLoaderSupport})();(function(){var g=new RegExp("^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})\\/\\S+$","");var i=b.config.hasOwnProperty("base")?b.config.base+"/":"";var e=function(k){if(g.test(k)===false&&k.startsWith("/")===false&&k.startsWith("data")===false){k=i+k}return k};var h=function(k){if(k.startsWith(i)){k=k.substring(i.length)}return k};var j=0;b.declare({name:"oui.utils.ImageLoader",mixins:[b.events.EventSupport],eventsDef:{COMPLETE:"complete",ERROR:"error"},membersDef:{init:function(){},load:function(k){var l=this;j++;if(b.tree.isPlatformAvailable()===true){this._loadImpl(e(k))}else{b.tree.addEventListener(b.tree.events.PLATFORM_AVAILABLE,function(){l._loadImpl(k)})}},_loadImpl:function(k){},_dispatchCompleteEvent:function(l,n,m,k,o){this.dispatchEvent({type:this.events.COMPLETE,url:h(l),data:n,width:m,height:k,info:o,defaultAction:this._onLoadCompleteDefaultAction});j--},_dispatchErrorEvent:function(k,l){this.dispatchEvent({type:this.events.ERROR,url:h(k),message:l});j--},_onLoadCompleteDefaultAction:function(){b.tree.layout()}}});var f=function(){return(j!==0)};b.hasImagesLoading=f})();(function(){b.mixin(b.utils.ImageLoader,{_loadImpl:function(e){var f=new Image();f.onload=this.handler("_canvasCompleteListener");f.onerror=this.handler("_canvasErrorListener");f.onabort=this.handler("_canvasAbortListener");f.src=e},_canvasCompleteListener:function(f){var e=f.target;this._dispatchCompleteEvent(e.src,e,e.width,e.height)},_canvasErrorListener:function(e){this._dispatchErrorEvent(e.target.src)},_canvasAbortListener:function(e){this._dispatchErrorEvent(e.target.src)}})})();(function(){b.declare({name:"oui.utils.ResourcesManager",membersDef:{init:function(){this._resources={};this._initEmbeddedResourcesImpl()},requestResource:function(f,e){var g=this._resources[f];if(g===undefined){this._loadResource(f,f,e)}else{if(g.data===null){g.observers.push(e)}else{this._notifyObserver(e,g)}}},hasResource:function(e){return(this._resources[e]!==undefined)},removeObserver:function(f,e){var h=this._resources[f],j,g;if(h!==undefined){j=h.observers;g=j.length;while(g--){if(j[g]===e){j.splice(g,1);break}}}},_initEmbeddedResourcesImpl:function(){},_notifyObservers:function(f){var e=f.observers.pop();while(e!==undefined){this._notifyObserver(e,f);e=f.observers.pop()}b.tree.layout()},_notifyObserver:function(e,f){if(b.isA(e,Function)){e.call(null,f)}else{if(e!==null&&e!==undefined&&b.isA(e.resourceUpdate,Function)){e.resourceUpdate(f)}}},_loadResource:function(g,j,f){var h=this,i,e;i={url:g,data:null,width:0,height:0,observers:[f]};this._resources[g]=i;e=new b.utils.ImageLoader();e.onComplete(function(k){h._onLoadComplete(k,i)});e.onError(function(){h._onLoadError(i)});e.load(j)},_onLoadComplete:function(e,f){f.width=e.width;f.height=e.height;this._onLoadCompleteImpl(e,f);this._notifyObservers(f)},_onLoadCompleteImpl:function(e){},_onLoadError:function(e){delete this._resources[e.url];c.warn("WARN__RES_MGR__LOAD_FAIL",e.url)},attemptBase64Encoding:function(e){return undefined}}})})();(function(){b.mixin(b.utils.ResourcesManager,{_initEmbeddedResourcesImpl:function(){var e,f,g=b.config.embeddedResourcesMap;if(g!==undefined){for(e in g){if(g.hasOwnProperty(e)){f=g[e];this._loadResource(e,f.data);delete f.data}}}},_onLoadCompleteImpl:function(e,f){f.data=e.data},attemptBase64Encoding:function(f){var e=undefined,g=b.config.embeddedResourcesMap;if(g!==undefined&&g[f]!==undefined){e=this._resources[f].data.src}return e}})})();(function(){var e="Obj_";var f=0;b.declare({name:"oui.scene.AbstractNode",isAbstract:true,mixins:[b.events.EventSupport,b.lang.AspectSupport],membersDef:{init:function(g){this.dirtyMarkers={};this._id=e+f++;this.name="";this.setName(g);this._onNodeCreated();this._updateShadowMode=false},load:function(h,g){if(g===undefined){g=this}return b.load(h,g)},setName:function(g){if(typeof g==="string"){this.name=g;this.notifyNodeEvent(b.TAGS.NAME)}},getName:function(){return this.name},getFullName:function(){var g=this.name;if(this.parentNode!==null){g=this.parentNode.getFullName()+"."+g}return g},getElementById:function(i){var g=null,h;if(this._id===i){g=this}else{h=this.firstChild;while(h!==null&&g===null){g=h.getElementById(i);h=h.nextSibling}}return g},getElementsByName:function(h,g){var i;if(g===undefined){g=[]}i=this.firstChild;while(i!==null){if(i.name===h){g.push(i)}i.getElementsByName(h,g);i=i.nextSibling}return g},getFirstElementByName:function(h){var g=undefined,i=this.firstChild;while(i!==null&&g===undefined){if(i.name===h){g=i}else{g=i.getFirstElementByName(h)}i=i.nextSibling}return g},getId:function(){return this._id},_onNodeCreated:function(){this._createShadowNode()},_isValidAppendChild:function(g){return b.isA(g,b.scene.AbstractNode)},_onNodeInserted:function(i,g,h){if(g===null||g===undefined){this._appendShadowChild(i)}else{this._insertBeforeShadow(i,g)}if(h!==true){i._onParentChanged()}this._onChildrenChanged()},_onNodeRemoved:function(i,h,g){i._onParentChanged();if(h===false){this._removeShadowChild(i);this._onChildrenChanged()}else{if(g===true){this._removeShadowChildren();this._onChildrenChanged()}}},isDescendant:function(h){var g=false;if(this.parentNode===h){g=true}else{if(this.parentNode!==null){g=this.parentNode.isDescendant(h)}}return g},_createShadowNode:function(){},_appendShadowChild:function(g){},_insertBeforeShadow:function(h,g){},_removeShadowChild:function(g){},_removeShadowChildren:function(){},getAncestors:function(){var h=this,g=[];while(h!==null&&h!==undefined){g.unshift(h);h=h.parentNode}return g},bringToFront:function(){var g=this.parentNode;if(g!==null&&g.lastChild!==this){g.insertBefore(this,null)}},sendToBack:function(){var g=this.parentNode;if(g!==null&&g.firstChild!==this){g.insertBefore(this,g.firstChild)}},bringForward:function(){var g=this.parentNode,h=this.nextSibling;if(g!==null&&h!==null){g.insertBefore(this,h.nextSibling)}},sendBackward:function(){var g=this.parentNode,h=this.previousSibling;if(g!==null&&h!==null){g.insertBefore(this,h)}},notifyNodeEvent:function(g){if(this._updateShadowMode===true){this.notifyNodeEventImpl(g)}else{this.dirtyMarkers[g]=true}},notifyNodeEventImpl:function(g,h){},_preParentChangedImpl:function(){},_onParentChanged:function(){var g=false;this._preParentChangedImpl();if(this.parentNode!==null){g=this.parentNode._updateShadowMode}this._setUpdateShadowMode(g)},_onChildrenChanged:function(){},_setUpdateShadowMode:function(g,k){var j,i,h;if(this._updateShadowMode!==g){this._updateShadowMode=g;j=this.firstChild;while(j!==null){j._setUpdateShadowMode(g,true);j=j.nextSibling}if(g===true){i=this.dirtyMarkers;for(h in i){if(i[h]===true){this.notifyNodeEventImpl(h,k)}}this.dirtyMarkers={}}}},dispatchNodeEventDown:function(g){var h;this.notifyNodeEvent(g);h=this.firstChild;while(h!==null){h.dispatchNodeEventDown(g);h=h.nextSibling}}}});b.lang.LinkedListSupport.addLinkedList(b.scene.AbstractNode,b.scene.AbstractNode,"nextSibling","previousSibling","parentNode","firstChild","lastChild","appendChild","removeChild","removeChildren","insertBefore","replaceChild","hasChildNodes","_isValidAppendChild","_onNodeInserted","_onNodeRemoved","childrenCount","getChildAt","getChildIndex","setChildIndex")})();(function(){b.mixin(b.scene.AbstractNode,{paintToCanvas:function(e){}})})();(function(){var f=function(r,s,l,n,h,k,i,j,q,g,p,m,o){return{type:r,canBubble:s,cancelable:l,detail:n,screenX:h.x,screenY:h.y,clientX:k,clientY:i,ctrlKey:j,shiftKey:q,altKey:g,metaKey:p,button:m,relatedTarget:o,preventNativeDefault:b.NO_OP,stopNativePropagation:b.NO_OP}};var e=function(s,u,l,o,h,k,i,j,r,g,q,n,p,t,m,v){return{type:s,canBubble:u,cancelable:l,detail:o,screenX:h.x,screenY:h.y,clientX:k,clientY:i,ctrlKey:j,shiftKey:r,altKey:g,metaKey:q,touches:n,targetTouches:p,changedTouches:t,scale:m,rotation:v,preventNativeDefault:b.NO_OP,stopNativePropagation:b.NO_OP}};b.declare({name:"oui.scene.Tree",mixins:[b.events.EventSupport,b.lang.AspectSupport],membersDef:{events:{PLATFORM_AVAILABLE:"platformAvailable"},init:function(){this.userLayer=this._createLayer("userLayer");this.focusLayer=this._createLayer("focusLayer");this.tooltipLayer=this._createLayer("tooltipLayer");this.layers=[this.userLayer,this.focusLayer,this.tooltipLayer];this._isPlatformAvailable=false;this.addEventListener(this.events.PLATFORM_AVAILABLE,this.handler("_onPlatformAvailable"));this._initImpl()},setContainer:function(g){this._setContainerImpl(g)},destroy:function(){b.timer.stop();b.events._userEventsSupport.setProperties({fromPlatform:{keyEvents:false,mouseEvents:false,wheelEvents:false,touchEvents:false,gestureEvents:false}});this._destroyImpl()},layout:function(){var g,j,h=this.layers;for(g=0,j=h.length;g<j;g++){h[g].layout()}},setLayoutDir:function(g){var h,k,j=this.layers;if((g===b.LayoutDirEnum.RTL||g===b.LayoutDirEnum.LTR)&&g!==b.layoutDir){b.layoutDir=g;for(h=0,k=j.length;h<k;h++){j[h].dispatchNodeEventDown(b.TAGS.LAYOUT_DIR)}}if(typeof this._setLayoutDirImpl==="function"){this._setLayoutDirImpl()}},getNodeAt:function(g,m){var j=null,h,l=this.layers,k=l.length;for(h=k-1;h>=0&&j===null;h--){j=this._getChildAtImpl(l[h],g,m)}return j},getElementById:function(l){var h=null,g,k=this.layers,j=k.length;for(g=j-1;g>=0&&h===null;g--){h=k[g].getElementById(l)}return h},isPlatformAvailable:function(){return this._isPlatformAvailable},_createLayer:function(g){var h=new b.graphics.Group(undefined,g);b.events.addDragSupport(h);b.events.addPressNTapSupport(h);b.events.addPinchSupport(h);b.events.addSwipeSupport(h);b.addGestureSupport(h,f,e);return h},_initShadowTree:function(g){g._createShadowNode();var h=g.firstChild;while(h!==null){this._initShadowTree(h);g._appendShadowChild(h);h=h.nextSibling}g.invalidateLayout()},_onPlatformAvailable:function(){var j,l,h,k=this.layers,g=(b.environment===b.EnvironmentEnum.MOBILE);this._enableTreeManipulationImpl();b.events._userEventsSupport.setProperties({fromPlatform:{keyEvents:true,mouseEvents:g?false:true,wheelEvents:true,touchEvents:true,gestureEvents:true}});for(j=0,l=k.length;j<l;j++){h=k[j];this._initShadowTree(h);this._attachLayerImpl(h);h._setUpdateShadowMode(true)}this.layout();this._isPlatformAvailable=true},_updateViewport:function(i,h){var g=b.viewportWidth,j=b.viewportHeight;if(g!==i||j!==h){b.viewportWidth=i;b.viewportHeight=h;b.viewportBounds.width=i;b.viewportBounds.height=h;this.userLayer.dispatchEvent({type:b.ViewEvents.VIEWPORT_RESIZE,oldViewportWidth:g,oldViewportHeight:j,newViewportWidth:i,newViewportHeight:h});this.layout()}},_updateDeviceOrientation:function(g){if(b.deviceOrientation!==g){b.deviceOrientation=g;this.userLayer.dispatchEvent({type:b.ViewEvents.DEVICE_ORIENTATION,orientation:b.deviceOrientation})}},_initImpl:function(){},_setContainerImpl:function(g){},_destroyImpl:function(){},_getChildAtImpl:function(h,g,i){return h.hitTest(g,i)},_enableTreeManipulationImpl:function(){},_attachLayerImpl:function(g){}}})})();(function(){b.mixin(b.scene.Tree,{_setContainerImpl:function(h){var f,e,g;this.document=h.ownerDocument;g=this.document.defaultView;f=this._createCanvasElement(0,0);f.setAttribute("style",["-webkit-user-select: none;","-webkit-touch-callout: none;","-webkit-tap-highlight-color: transparent;"].join(""));this.canvas=f;this._canvasDirtyFlag=true;this._offscreenBuffers=[];if(f.getContext===undefined){e=this.document.createElement("div");e.innerHTML="Your web browser does not support Canvas";h.appendChild(e);c.error("ERR__CNV__NO_SUPPORT")}this.context2d=f.getContext("2d");this.context2d.globalCompositeOperation="copy";h.appendChild(this.canvas);this.offscreen=this._createCanvasElement(0,0);this.offscreen2d=this.offscreen.getContext("2d");b.timer.addEventListener(b.timer.TIMER_EVENT,this.handler("_timerCallback"));this._orientationHandler=this.handler("_onCanvasDeviceOrientationChanged");g.addEventListener("orientationchange",this._orientationHandler,false);g.addEventListener("resize",this._orientationHandler,false);this._resizeCanvas();this._onCanvasDeviceOrientationChanged();this.dispatchEvent({type:this.events.PLATFORM_AVAILABLE})},_destroyImpl:function(){var f,e=this.document.defaultView;this.removeAspect("layout",this.renderCanvas);e.removeEventListener("orientationchange",this._orientationHandler,false);e.removeEventListener("resize",this._orientationHandler,false);f=this._offscreenBuffers.pop();while(f){f.width=0;f.height=0;f=this._offscreenBuffers.pop()}this.canvas.width=0;this.canvas.height=0;this.offscreen.width=0;this.offscreen.height=0;delete this.canvas;delete this.context2d;delete this.offscreen;delete this.offscreen2d;delete this.document},_enableTreeManipulationImpl:function(){var e=this.handler("markCanvasAsDirty"),f=b.scene.AbstractNode.prototype;f._appendShadowChild=e;f._insertBeforeShadow=e;f._removeShadowChild=e;f._removeShadowChildren=e;f=b.graphics.Text.prototype;f.getVisualBoundsImpl=f.getCanvasVisualBounds;f=b.graphics.TextBlock.prototype;f.getVisualBoundsImpl=f.getCanvasVisualBounds},_setLayoutDirImpl:function(){if(b.layoutDir===b.LayoutDirEnum.RTL){this.canvas.setAttribute("dir","rtl")}else{this.canvas.setAttribute("dir","ltr")}this.markCanvasAsDirty()},_createCanvasElement:function(f,e){var g=this.document.createElement("canvas");g.width=f;g.height=e;g.innerHTML="EPM BI UI Graphics";return g},renderCanvas:function(){var j,g,f,e,h;if(this._canvasDirtyFlag===true){j=this.offscreen2d;g=b.viewportBounds;j.clearRect(0,0,g.width,g.height);f=this.layers;for(e=0,h=f.length;e<h;e++){f[e].paintToCanvas(j,g)}this.context2d.drawImage(this.offscreen,0,0);this._canvasDirtyFlag=false}},markCanvasAsDirty:function(){this._canvasDirtyFlag=true},createOffscreenCanvas:function(f,e){var g;if(this._offscreenBuffers.length===0){g=this._createCanvasElement(f,e)}else{g=this._offscreenBuffers.pop();g.width=f;g.height=e}return g},disposeOffscreenCanvas:function(e){this._offscreenBuffers.push(e)},_timerCallback:function(){if(this.canvas.parentNode===null){this.destroy()}else{this._resizeCanvas()}},_resizeCanvas:function(){var f=this.canvas.parentNode.getBoundingClientRect(),h=Math.floor(f.width),e=Math.floor(f.height),g=this.canvas;if(h!==g.width||e!==g.height){if(g.width===0||g.height===0){if(h!==0&&e!==0){this.addAspect("layout",this.renderCanvas)}}else{if(h===0||e===0){this.removeAspect("layout",this.renderCanvas)}}g.width=h;g.height=e;this.context2d.globalCompositeOperation="copy";this.offscreen.width=h;this.offscreen.height=e;this.markCanvasAsDirty();this._updateViewport(h,e)}},_onCanvasDeviceOrientationChanged:function(){var e,f,g=this.document.defaultView;if(g.orientation!==undefined){e=Math.abs(g.orientation)===90?b.DeviceOrientationEnum.LANDSCAPE:b.DeviceOrientationEnum.PORTRAIT}else{f=g.screen;e=f.width>f.height?b.DeviceOrientationEnum.LANDSCAPE:b.DeviceOrientationEnum.PORTRAIT}this._updateDeviceOrientation(e)},getCanvasRootClientCoords:function(){var e=this.canvas.getBoundingClientRect();return{x:e.left,y:e.top}}})})();(function(){b.declare({name:"oui.timing.Timer",mixins:[b.events.EventSupport],membersDef:{TIMER_EVENT:"TIMER_EVENT",DEFAULT_FRAME_RATE:25,init:function(e){if(b.isFinitePositiveNumber(e,true)){this.frameRate=e}else{this.frameRate=this.DEFAULT_FRAME_RATE}},start:function(){var f=this;var e=function(){f.dispatchEvent({type:f.TIMER_EVENT});b.tree.layout()};if(this.startImpl){this.startImpl(e)}else{if(setInterval){this.currentIntervalID=setInterval(e,1000/this.frameRate)}else{c.error("ERR__TIMER__START")}}},stop:function(){if(this.stopImpl){this.stopImpl()}else{if(this.currentIntervalID&&clearInterval){clearInterval(this.currentIntervalID);this.currentIntervalID=undefined}else{c.error("ERR__TIMER__STOP")}}}}})})();(function(){var f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;var e=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame;if(f!==undefined){b.mixin(b.timing.Timer,{startImpl:function(j){var g,h,i=0;g=function(){i=f(g,b.tree.canvas);j()};h=function(){e(i);i=0};this._cancelAnimate=h;g()},stopImpl:function(){if(this._cancelAnimate!==undefined){this._cancelAnimate();delete this._cancelAnimate}}})}else{c.warn("WARN__CNV__REQ_ANIM_FRAME")}})();(function(){var e="trigger",i=1000,g="begin",h="end",f={source:{type:Object,constraint:b.supportsEvents,defaultValue:null},type:b.defs.String(""),offset:b.defs.PositiveNumber(0)};b.declare({name:"oui.timing.TimeInterval",mixins:[b.events.EventSupport,b.lang.PropertiesSupport],membersDef:{init:function(j){this._plugged=true;this._active=false;this._beginSyncValues=[];this._endSyncValues=[];this._eventValues=[];this._initProperties(j);this._timerHandler=this.handler("_onTimer")},_onTimer:function(m){var l=m.timeStamp,j=this._beginTime,k=this._endTime;if(l>=j&&k>=j){if(this._active===false){this.dispatchEvent({type:this.events.BEGIN,bubbles:false,syncTime:j});this._curBegin=j;this._curEnd=j+this._simpleDur;this._active=true;this._start(j)}this._repeat(l);if(l>=k){this._stop(k);this._active=false;b.timer.removeEventListener(b.timer.TIMER_EVENT,this._timerHandler);this.dispatchEvent({type:this.events.END,bubbles:false,syncTime:k,scheduled:!(k<this._curEnd)})}else{this._play(l)}}},_start:function(j){},_play:function(j){},_stop:function(j){},beginAt:function(j){this._beginSyncAt(b.currentTimeMillis(),j)},endAt:function(j){this._endSyncAt(b.currentTimeMillis(),j)},_beginSyncAt:function(l,m){var k=this._properties,j;if(isFinite(m)&&m>0){l+=m*i}this._simpleDur=k.dur*i;j=this._simpleDur;if(k.repeatDur!==0&&k.repeatCount!==0){j=Math.min(k.repeatDur*i,k.repeatCount*this._simpleDur)}else{if(k.repeatDur!==0){j=k.repeatDur*i}else{if(k.repeatCount!==0){j=k.repeatCount*this._simpleDur}}}this._endTime=l+j;this._beginTime=l;this._sync(g,this._beginTime);this._sync(h,this._endTime);b.timer.addEventListener(b.timer.TIMER_EVENT,this._timerHandler)},_endSyncAt:function(j,k){if(isFinite(k)&&k>0){j+=k*i}if(j<this._endTime){this._endTime=j;this._sync(h,this._endTime)}},_sync:function(k,o){var n=(k===g)?this._beginSyncValues:this._endSyncValues,j,m=n.length,l;for(j=0;j<m;j++){l=n[j];l.target[l.funcName](o,l.offset)}},_repeat:function(j){var l=this._beginTime,o=this._endTime,r=this._simpleDur,p=this._curBegin,q=this._curEnd,k,m,n;if(j>=q&&q<o){k=Math.floor((p-l)/r);n=Math.floor((j-p)/r);for(m=1;m<=n&&q<o;m++){p+=r;q+=r;this.dispatchEvent({type:this.events.REPEAT,bubbles:false,syncTime:p,detail:k+m})}this._curBegin=p;this._curEnd=q}},onPropertiesUpdate:function(j){if(j===e){this.plug()}},addBeginEvent:function(j){this._addEvent(j,"beginEvents",g,[])},addEndEvent:function(j){this._addEvent(j,"endEvents",h,[true])},_addEvent:function(k,o,n,j){var m=this._properties,l;if(m[o].length===0){m[o]=[]}l=m[o];if(b.isObjectValid(k,f,true)){l.push(k);if(this._plugged===true){this._plug(k,n,j)}}},plug:function(){var k,j,l;this.unplug();k=this._properties.beginEvents;for(j=0,l=k.length;j<l;j++){this._plug(k[j],g)}k=this._properties.endEvents;for(j=0,l=k.length;j<l;j++){this._plug(k[j],h)}this._plugged=true},_plug:function(n,k){var j=this,m="_"+k+"SyncAt",o=n.offset,l;if(n.type===g||n.type===h){l={target:j,funcName:m,offset:o};n.source._addSyncValue(n.type,l)}else{l=function(p){j[m](p.timeStamp,o)};n.source.addEventListener(n.type,l)}this._eventValues.push({desc:n,data:l})},unplug:function(){var j=this._eventValues,k,o,m,l;for(k=0,o=j.length;k<o;k++){m=j[k].desc;l=j[k].data;if(m.type===g||m.type===h){m.source._removeSyncValue(m.type,l)}else{m.source.removeEventListener(m.type,l)}}j.length=0;this._plugged=false},_addSyncValue:function(j,l){var k=(j===g)?this._beginSyncValues:this._endSyncValues;k.push(l)},_removeSyncValue:function(k,n){var m=(k===g)?this._beginSyncValues:this._endSyncValues,j,l=m.length;for(j=0;j<l;j++){if(m[j]===n){m.splice(j,1)}}}},eventsDef:[b.SyncEvents],propertiesDef:{dur:b.defs.PositiveNumber(0),repeatDur:b.defs.PositiveNumber(0),repeatCount:b.defs.PositiveNumber(0),beginEvents:b.defs.ArrayOfProperties(f,0,Number.MAX_VALUE,[],e),endEvents:b.defs.ArrayOfProperties(f,0,Number.MAX_VALUE,[],e)}});b.timing.eventTriggerDefinition=f})();(function(){b.ns("oui.anim");b.mixin(b.anim,{interpolateDiscrete:function(h,f,g){var e;if(g<=0.5){e=h}else{e=f}return e},interpolateNumber:function(g,e,f){return g+(e-g)*f},interpolateColor:function(f,e,g){return new b.style.Color(f.red()+(e.red()-f.red())*g,f.green()+(e.green()-f.green())*g,f.blue()+(e.blue()-f.blue())*g,f.alpha()+(e.alpha()-f.alpha())*g)}})})();(function(){var e=b.FillEnum;b.declare({name:"oui.anim.AbstractAnimation",isAbstract:true,extend:b.timing.TimeInterval,membersDef:{_stop:function(g){var f=this._properties.fill;if(f===e.REMOVE||(f===e._LEGACY&&g<this._curEnd)){this._play(this._curBegin)}else{this._play(g)}},_progress:function(g,h,k){var i,f=this._properties.easeIn,j=this._properties.easeOut;if(k<g){i=0}else{if(k>h||g===h){i=1}else{i=(k-g)/(h-g);if(f===true&&j===false){i*=i}else{if(f===false&&j===true){i=1-(1-i)*(1-i)}else{if(f===true&&j===true){if(i<0.5){i*=2*i}else{i=1-2*(1-i)*(1-i)}}}}}}return i}},propertiesDef:{easeIn:b.defs.Boolean(false),easeOut:b.defs.Boolean(false),fill:b.defs.Enum(e,e.FREEZE)}})})();(function(){var j=b.anim.AbstractAnimation.prototype,l=b.BASE_VALUE,i=b.anim.interpolateDiscrete,f=b.anim.interpolateNumber,h=b.anim.interpolateColor,e="ANIM_TAG",k,g;k=function(o,m,n){return b.anim.interpolateDiscrete(o,m,n)};g={interpolator:b.defs.Function(3,k),beginValue:b.defs.ObjectOfType(Object,l,true,false),endValue:b.defs.ObjectOfType(Object,l,true,false)};b.declare({name:"oui.anim.AnimateStyle",extend:b.anim.AbstractAnimation,membersDef:{onPropertiesUpdate:function(m){var n=this._properties.targetNode;if(m===e){if(n!==undefined){this._checkInterpolators(this._properties.animValues,n.StyleDefinition.prototype)}}else{j.onPropertiesUpdate.call(this,m)}},_checkInterpolators:function(q,o){var n,p,m,r;if(o===undefined){o={}}for(n in q){if(q.hasOwnProperty(n)){p=q[n];m=o[n];if(p.interpolator===undefined){this._checkInterpolators(p,m)}else{if(p.interpolator!==k){p._interpolate=p.interpolator}else{if(m!==undefined){r=m.type;if(r===Boolean){p._interpolate=i}else{if(r===Number){p._interpolate=f}else{if(r===b.style.Color||(r===b.style.Paint&&b.isA(p.beginValue,b.style.Color)&&b.isA(p.endValue,b.style.Color))){p._interpolate=h}else{p._interpolate=k}}}}else{if(b.isA(p.beginValue,Boolean)&&b.isA(p.endValue,Boolean)){p._interpolate=i}else{if(b.isA(p.beginValue,Number)&&b.isA(p.endValue,Number)){p._interpolate=f}else{if(b.isA(p.beginValue,b.style.Color)&&b.isA(p.endValue,b.style.Color)){p._interpolate=h}else{p._interpolate=k}}}}}}}}},_start:function(){var m=this._properties;this._resolveBaseValues(m.animValues,m.targetNode._style)},_play:function(n){var m=this._properties;m.targetNode.applyStyle(this._buildStyleObjectFor(m.animValues,this._progress(this._curBegin,this._curEnd,n)))},_resolveBaseValues:function(q,o){var m,p,n;for(m in q){p=q[m];n=o[m];if(p.hasOwnProperty("_interpolate")){if(p.beginValue===l){p._beginVal=n}else{p._beginVal=p.beginValue}if(p.endValue===l){p._endVal=n}else{p._endVal=p.endValue}}else{this._resolveBaseValues(p,n)}}},_buildStyleObjectFor:function(q,n){var m,p,o={};for(m in q){p=q[m];if(p.hasOwnProperty("_interpolate")){o[m]=p._interpolate(p._beginVal,p._endVal,n)}else{o[m]=this._buildStyleObjectFor(p,n)}}return o}},propertiesDef:{targetNode:{type:Object,constraint:function(m){return(m===undefined)||(b.isA(m.applyStyle,Function)&&b.isA(m.StyleDefinition,Function))},defaultValue:undefined,tag:e},animValues:b.defs.MapOfProperties(g,{},false,true,true,e)}})})();(function(){var f=b.anim.AbstractAnimation.prototype,h="t",e="s",g="r";b.declare({name:"oui.anim.AnimateTransform",extend:b.anim.AbstractAnimation,membersDef:{init:function(j,i){f.init.call(this,j,i);this._interpolatedValue=new b.geom.Matrix();this._transforms=[]},translate:function(j,l,i,k){if(isFinite(j)&&isFinite(l)&&isFinite(i)&&isFinite(k)){this._transforms.push({type:h,x0:j,x1:i,y0:l,y1:k})}},rotate:function(l,k,j,i){if(isFinite(l)&&isFinite(k)){this._transforms.push({type:g,a0:l/180*Math.PI,a1:k/180*Math.PI,cx:j?j:0,cy:i?i:0})}},scale:function(j,l,i,k){if(isFinite(j)&&isFinite(l)&&isFinite(i)&&isFinite(k)){this._transforms.push({type:e,x0:j,x1:i,y0:l,y1:k})}},resetTransforms:function(){this._transforms.length=0},_play:function(p){var j=this._progress(this._curBegin,this._curEnd,p),n=this._transforms,l,o=n.length,k,m=this._interpolatedValue;m.init();for(l=0;l<o;l++){k=n[l];if(k.type===h){m._safeTranslate(k.x0+j*(k.x1-k.x0),k.y0+j*(k.y1-k.y0))}else{if(k.type===g){m._safeRotate(k.a0+j*(k.a1-k.a0),k.cx,k.cy)}else{if(k.type===e){m._safeScale(k.x0+j*(k.x1-k.x0),k.y0+j*(k.y1-k.y0))}}}}this._properties.targetNode.setTransformMatrix(m)}},propertiesDef:{targetNode:b.defs.ObjectOfType(b.scene.AbstractNode,undefined,false,true)}})})();(function(){b.declare({name:"oui.anim.AnimateCallback",extend:b.anim.AbstractAnimation,membersDef:{_play:function(e){this._properties.callback.call(this,this._progress(this._curBegin,this._curEnd,e))}},propertiesDef:{callback:{type:Function,defaultValue:b.NO_OP}}})})();(function(){b.ns("oui.anim");b.anim.EffectsSupport={_effectOn:function(h,g,k,l,f,j){var i,e=h+"Effect";if(this[e]===undefined){i={targetNode:this,dur:j,animValues:{}};i.animValues[k]={beginValue:l,endValue:f};this[e]=new b.anim.AnimateStyle(i)}this[e].addBeginEvent(g)},showOn:function(e){this._effectOn("show",e,"display",false,true,0)},hideOn:function(e){this._effectOn("hide",e,"display",true,false,0)},fadeOn:function(h,i,g,j,e){var f=null;if(b.isA(this,b.graphics.Group)||b.isA(this,b.graphics.Image)){f=new b.anim.AnimateStyle({targetNode:this,animValues:{opacity:{beginValue:i,endValue:g}},dur:j})}else{f=new b.anim.AnimateStyle({targetNode:this,animValues:{fillOpacity:{beginValue:i,endValue:g},strokeOpacity:{beginValue:i,endValue:g}},dur:j})}f.addBeginEvent(h);if(b.isA(e,String)){this[e]=f}},slideOn:function(i,j,l,k,h,g,f){var e=new b.anim.AnimateTransform({targetNode:this,dur:j,beginEvents:[i]});e.translate(l,k,h,g);if(b.isA(f,String)){this[f]=e}},scaleOn:function(g,f,i,h,n,k,l){var m,j,e;e=new b.anim.AnimateTransform({targetNode:this,dur:f,beginEvents:[g]});m=(n!==undefined?n:0);j=(k!==undefined?k:0);e.translate(m,j,m,j);e.scale(i,i,h,h);e.translate(-m,-j,-m,-j);if(b.isA(l,String)){this[l]=e}}}})();(function(){var g={src:b.defs.String(""),hotspotX:b.defs.FinitePositiveNumber(0),hotspotY:b.defs.FinitePositiveNumber(0)};var i=function(l){return b.isValueInEnum(l,b.CursorTypeEnum)||b.isValueOfType(l,g,true)};var e=function(l){return b.isValueInEnum(l,b.FiltersEnum)||b.isA(l,b.filters.AbstractFilter)};var k=function(m,l){return(m===l)||b.isFinitePositiveNumber(m)};var j=function(p,o,l){var r,q,n,m;l.value={};for(r in o){if(p[r]!==undefined){q=p[r];n=o[r];if(n.constructor===Object){m={validValue:false};j(q,n,m);if(m.validValue){l.value[r]=m.value}}else{if(n===true){l.value[r]=q;l.validValue=true}}}}};var f=function(p,o,l){var r,q,n,m;l.value={};for(r in p){if(p[r]!==undefined){q=p[r];n=o[r];if(n!==undefined&&n.constructor===Object){m={validValue:false};f(q,n,m);if(m.validValue){l.value[r]=m.value}}else{if(n!==false){l.value[r]=q;l.validValue=true}}}}};var h=function(n,l){var m=b.style.makeColor(n);if(m!==null){l.validValue=true;l.value=m}};b.mixin(b.defs,{Paint:function(m,l){return b.defs._createDef("Paint",b.style.Paint,m,l,h)},Color:function(q,p,n,o,m){var l=[q,p,n,o],s=b.style.makeColor(l);return b.defs._createDef("Color",b.style.Color,s,m,h,undefined,l)},Image:function(o,n,m,l){return{src:b.defs.String(o,l),width:b.defs.FinitePositiveNumber(n,l),height:b.defs.FinitePositiveNumber(m,l)}},Cursor:function(m,l){return b.defs._createDef("Cursor",Object,m,l,undefined,i)},FilterEffect:function(m,l){return b.defs._createDef("FilterEffect",Object,m,l,undefined,e)},Size:function(m,l){return b.defs._createDef("Size",Object,m,l,undefined,[k,m])},PropertyFilter:function(m,n,l){return{type:"PropertyFilter",convertor:function(p,o){if(typeof p==="object"){if(m===true){f(p,n,o)}else{j(p,n,o)}}else{o.validValue=false}},tag:l}}});b.mixin(b.defs,{FontStyle:function(n,u,o,t){var s=255,l=0,m=0,p=0;var q;if(b.isA(t,b.style.Paint)){q=t}else{if(b.isA(t,Array)&&t.length>=3){l=t[0];m=t[1];p=t[2];if(t.length>3){s=t[3]}q=new b.style.Color(l,m,p,s)}else{q=b.black}}return{fontFamily:b.defs.String(n),fontSize:b.defs.FinitePositiveNumber(u),fontWeight:b.defs.Enum(b.FontWeightEnum,o),fill:b.defs.Paint(q)}},Padding:function(p,o,n,m,l){return{top:b.defs.PositiveNumber(p,l),bottom:b.defs.PositiveNumber(m,l),lineBegin:b.defs.PositiveNumber(o,l),lineEnd:b.defs.PositiveNumber(n,l)}},ImageStyle:{src:b.defs.String("images/aria_14x14.png"),width:b.defs.FinitePositiveNumber(14),height:b.defs.FinitePositiveNumber(14)}})})();(function(){b.declare({name:"oui.style.Paint",membersDef:{init:function(){},getOpacity:function(){return 1}}})})();(function(){b.mixin(b.style.Paint,{toCanvasStyle:function(){return"rgba(255,255,255,0)"}})})();(function(){b.declare({name:"oui.style.NoPaint",extend:b.style.Paint});b.NO_PAINT=new b.style.NoPaint()})();(function(){var e=[0,255];b.declare({name:"oui.style.Color",extend:b.style.Paint,membersDef:{init:function(l,j,i,k){this._properties=new this.Properties();this._properties.updateObject({red:l,green:j,blue:i,alpha:k});this._onPropertyChanged()},applyProperties:function(j){var i=this._properties.updateObject(j);if(i[b.DEFAULT_TAG]===true){this._onPropertyChanged()}},_onPropertyChanged:function(){var k=this._properties,j,i,l,m;k.red=Math.round(k.red);k.green=Math.round(k.green);k.blue=Math.round(k.blue);k.alpha=Math.round(k.alpha);j=this._getHexChannel(k.red);i=this._getHexChannel(k.green);l=this._getHexChannel(k.blue);m=this._getHexChannel(k.alpha);this._hexRGBstr=j+i+l;this._hexRGBAstr=j+i+l+m;this._hexARGBstr=m+j+i+l;this._onPropertyChangedImpl()},_onPropertyChangedImpl:function(){},modify:function(j){var k=0;var i=this._properties;if(b.isA(j,Number)===true){if(j<0){k=0}else{if(j>1){k=1}else{k=j}}}return new b.style.Color(i.red*k,i.green*k,i.blue*k,i.alpha)},setColor:function(j){if(b.isA(j,b.style.Color)){var i=j._properties;this.applyProperties({red:i.red,green:i.green,blue:i.blue,alpha:i.alpha})}},setARGB:function(l,k,j,i){this.applyProperties({red:k,green:j,blue:i,alpha:l})},setOpacity:function(i){this.setAlpha(i*255)},getOpacity:function(){return this._properties.alpha/255},getHexRGB:function(){return this._hexRGBstr},getHexARGB:function(){return this._hexARGBstr},getHexRGBA:function(){return this._hexRGBAstr},_getHexChannel:function(i){var j="";if(i<16){j="0"}return j+i.toString(16)}},propertiesDef:{red:b.defs.NumberInRange(e,0),green:b.defs.NumberInRange(e,0),blue:b.defs.NumberInRange(e,0),alpha:b.defs.NumberInRange(e,255)}});var h="([0-9a-f])",g="([0-9a-f]{2})",f=new RegExp("^#"+g+g+g+g+"?$|^#"+h+h+h+"$");b.style.makeColor=function(m){var i=null,l,k,o,n,j;if(b.isA(m,String)){m=m.trim().toLowerCase();if(b.style.CSS_COLORS.hasOwnProperty(m)){i=b[m]}if((j=f.exec(m))!==null){l=parseInt(j[1]||j[5]+j[5],16);k=parseInt(j[2]||j[6]+j[6],16);o=parseInt(j[3]||j[7]+j[7],16);n=255;if(j[4]!==undefined){n=parseInt(j[4],16)}i=new b.style.Color(l,k,o,n)}}else{if(b.isA(m,Array)&&(m.length===3||m.length===4)){l=m[0];k=m[1];o=m[2];n=255;if(m.length===4){n=m[3]}if(b.isNumberInRange(l,e)&&b.isNumberInRange(k,e)&&b.isNumberInRange(o,e)&&b.isNumberInRange(n,e)){i=new b.style.Color(l,k,o,n)}}}return i}})();(function(){b.mixin(b.style.Color,{_onPropertyChangedImpl:function(){var e=this._properties;if(e.alpha===255){this._canvasColor="#".concat(this._hexRGBstr)}else{this._canvasColor="rgba(".concat(e.red,",",e.green,",",e.blue,",",(e.alpha/255),")")}},toCanvasStyle:function(){return this._canvasColor}})})();b.style=b.style||{};(function(){var f,e;f={aliceBlue:"#F0F8FF",antiqueWhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedAlmond:"#FFEBCD",blue:"#0000FF",blueViolet:"#8A2BE2",brown:"#A52A2A",burlyWood:"#DEB887",cadetBlue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerBlue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkBlue:"#00008B",darkCyan:"#008B8B",darkGoldenRod:"#B8860B",darkGray:"#A9A9A9",darkGreen:"#006400",darkKhaki:"#BDB76B",darkMagenta:"#8B008B",darkOliveGreen:"#556B2F",darkOrange:"#FF8C00",darkOrchid:"#9932CC",darkRed:"#8B0000",darkSalmon:"#E9967A",darkSeaGreen:"#8FBC8F",darkSlateBlue:"#483D8B",darkSlateGray:"#2F4F4F",darkTurquoise:"#00CED1",darkViolet:"#9400D3",deepPink:"#FF1493",deepSkyBlue:"#00BFFF",dimGray:"#696969",dodgerBlue:"#1E90FF",fireBrick:"#B22222",floralWhite:"#FFFAF0",forestGreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostWhite:"#F8F8FF",gold:"#FFD700",goldenRod:"#DAA520",gray:"#808080",green:"#008000",greenYellow:"#ADFF2F",honeyDew:"#F0FFF0",hotPink:"#FF69B4",indianRed:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderBlush:"#FFF0F5",lawnGreen:"#7CFC00",lemonChiffon:"#FFFACD",lightBlue:"#ADD8E6",lightCoral:"#F08080",lightCyan:"#E0FFFF",lightGoldenRodYellow:"#FAFAD2",lightGrey:"#D3D3D3",lightGreen:"#90EE90",lightPink:"#FFB6C1",lightSalmon:"#FFA07A",lightSeaGreen:"#20B2AA",lightSkyBlue:"#87CEFA",lightSlateGray:"#778899",lightSteelBlue:"#B0C4DE",lightYellow:"#FFFFE0",lime:"#00FF00",limeGreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumAquaMarine:"#66CDAA",mediumBlue:"#0000CD",mediumOrchid:"#BA55D3",mediumPurple:"#9370D8",mediumSeaGreen:"#3CB371",mediumSlateBlue:"#7B68EE",mediumSpringGreen:"#00FA9A",mediumTurquoise:"#48D1CC",mediumVioletRed:"#C71585",midnightBlue:"#191970",mintCream:"#F5FFFA",mistyRose:"#FFE4E1",moccasin:"#FFE4B5",navajoWhite:"#FFDEAD",navy:"#000080",oldLace:"#FDF5E6",olive:"#808000",oliveDrab:"#6B8E23",orange:"#FFA500",orangeRed:"#FF4500",orchid:"#DA70D6",paleGoldenRod:"#EEE8AA",paleGreen:"#98FB98",paleTurquoise:"#AFEEEE",paleVioletRed:"#D87093",papayaWhip:"#FFEFD5",peachPuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderBlue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosyBrown:"#BC8F8F",royalBlue:"#4169E1",saddleBrown:"#8B4513",salmon:"#FA8072",sandyBrown:"#F4A460",seaGreen:"#2E8B57",seaShell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyBlue:"#87CEEB",slateBlue:"#6A5ACD",slateGray:"#708090",snow:"#FFFAFA",springGreen:"#00FF7F",steelBlue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",transparent:"#FFFFFF00",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whiteSmoke:"#F5F5F5",yellow:"#FFFF00",yellowGreen:"#9ACD32"};b.style.CSS_COLORS=f;if(typeof b.style.makeColor==="function"){for(e in f){if(f.hasOwnProperty(e)){b[e.replace(/(.)([A-Z])/g,"$1_$2").toUpperCase()]=b[e.toLowerCase()]=b[e]=b.style.makeColor(f[e])}}}for(e in f){if(f.hasOwnProperty(e)){f[e.toLowerCase()]=f[e]}}})();(function(){b.declare({name:"oui.style.GradientStop",mixins:[b.lang.PropertiesSupport],membersDef:{init:function(e){this._initProperties(e)}},propertiesDef:{color:b.defs.Color(0,0,0,255),offset:b.defs.NumberInRange([0,1],0)}})})();(function(){b.declare({name:"oui.style.GradientPaint",isAbstract:true,extend:b.style.Paint,mixins:[b.lang.PropertiesSupport],membersDef:{init:function(e){this._initImpl();this._initProperties(e)},onPropertiesUpdate:function(){this._onUpdateImpl()},addGradientStop:function(i,e){if(this._properties.stops.length===0){this._properties.stops=[]}var h=new b.style.GradientStop({offset:i,color:e});var g=this._properties.stops;var j=g.length;var f=0;while(f<=j-1&&i>=g[f].getOffset()){f++}g.splice(f,0,h);this.onPropertiesUpdate()},_initImpl:function(){},_onUpdateImpl:function(){}},propertiesDef:{useObjectBoundingBox:b.defs.Boolean(true),stops:b.defs.ArrayOfType({type:b.style.GradientStop},0,undefined,[],undefined)}})})();(function(){b.declare({name:"oui.style.LinearGradient",extend:b.style.GradientPaint,propertiesDef:{x1:b.defs.FiniteNumber(0),y1:b.defs.FiniteNumber(0),x2:b.defs.FiniteNumber(1),y2:b.defs.FiniteNumber(0)}});b.mixin(b.style,{deriveGradient:function(g,h,e){var i,f=new b.style.LinearGradient({x1:0,y1:0,x2:0,y2:1});if(e===undefined){e=0.8}i=g.modify(e);if(h===true){f.addGradientStop(0,g);f.addGradientStop(1,i)}else{f.addGradientStop(0,i);f.addGradientStop(1,g)}return f}})})();(function(){b.mixin(b.style.LinearGradient,{toCanvasStyle:function(e,j){var m=this._properties,n=m.stops,l=n.length,f,g,k,h;if(m.useObjectBoundingBox===true){f=j.createLinearGradient(m.x1*e.width+e.x,m.y1*e.height+e.y,m.x2*e.width+e.x,m.y2*e.height+e.y)}else{f=j.createLinearGradient(m.x1,m.y1,m.x2,m.y2)}for(h=0;h<l;h++){k=n[h];g=k.getColor();f.addColorStop(k.getOffset(),g.toCanvasStyle())}return f}})})();(function(){b.declare({name:"oui.style.RadialGradient",extend:b.style.GradientPaint,propertiesDef:{cx:b.defs.FiniteNumber(0.5),cy:b.defs.FiniteNumber(0.5),radius:b.defs.FiniteNumber(0.5)}})})();(function(){b.mixin(b.style.RadialGradient,{toCanvasStyle:function(e,k){var n=this._properties,o=n.stops,m=o.length,j,g,l,f,h;if(n.useObjectBoundingBox===true){f=Math.min(e.width,e.height);j=k.createRadialGradient(n.cx*e.width+e.x,n.cy*e.height+e.y,0,n.cx*e.width+e.x,n.cy*e.height+e.y,n.radius*f)}else{j=k.createRadialGradient(n.cx,n.cy,0,n.cx,n.cy,n.radius)}for(h=0;h<m;h++){l=o[h];g=l.getColor();j.addColorStop(l.getOffset(),g.toCanvasStyle())}return j}})})();(function(){b.ns("oui.style");var t=b.GENERIC_FONTS.SANS_SERIF,q=b.GENERIC_FONTS.SERIF,e=b.GENERIC_FONTS.MONOSPACE,g=b.GENERIC_FONTS.CURSIVE;var o=[["Arial","'Helvetica Neue'","Helvetica",t],["'Arial Black'","Gadget",t],["'Comic Sans MS'","'Comic Sans'","Textile",g],["'Courier New'","Courier",e],["Georgia",q],["Impact","Charcoal",t],["'Lucida Console'","Monaco",e],["'Lucida Sans Unicode'","'Lucida Grande'",t],["'Palatino Linotype'","'Book Antiqua'","Palatino",q],["Tahoma","Geneva",t],["'Times New Roman'","Times",q],["'Trebuchet MS'","Trebuchet",t],["Verdana","Geneva",t],["'MS Sans Serif'","Geneva",t],["'MS Serif'","'New York'",q]];b.cssFonts={};var p,h,l,k,r,s,f;for(p=0,h=o.length;p<h;p++){r=o[p];for(l=0,k=r.length-1;l<k;l++){f=r[l].replace(/'/gi,"").toLowerCase();if(b.cssFonts.hasOwnProperty(f)===false){s=r.slice();s.splice(l,1);s.unshift(r[l]);b.cssFonts[f]=s.join(",")}}}})();(function(){b.ns("oui.text.locales");b.text.locales.en_US={eras:["BC","AD"],months:[{l:"January",s:"Jan"},{l:"February",s:"Feb"},{l:"March",s:"Mar"},{l:"April",s:"Apr"},{l:"May",s:"May"},{l:"June",s:"Jun"},{l:"July",s:"Jul"},{l:"August",s:"Aug"},{l:"September",s:"Sep"},{l:"October",s:"Oct"},{l:"November",s:"Nov"},{l:"December",s:"Dec"}],days:[{l:"Sunday",s:"Sun"},{l:"Monday",s:"Mon"},{l:"Tuesday",s:"Tue"},{l:"Wednesday",s:"Wed"},{l:"Thursday",s:"Thu"},{l:"Friday",s:"Fri"},{l:"Saturday",s:"Sat"}],ampm:["AM","PM"],timezones:{0:{std:{l:"Greenwich Mean Time",s:"GMT"},dst:{l:"Greenwich Mean Time",s:"GMT"}},480:{std:{l:"Pacific Standard Time",s:"PST"},dst:{l:"Pacific Daylight Time",s:"PDT"}},420:{std:{l:"Mountain Standard Time",s:"MST"},dst:{l:"Mountain Daylight Time",s:"MDT"}},360:{std:{l:"Central Standard Time",s:"CST"},dst:{l:"Central Daylight Time",s:"CDT"}},300:{std:{l:"Eastern Standard Time",s:"EST"},dst:{l:"Eastern Daylight Time",s:"EDT"}},600:{std:{l:"Hawaii Standard Time",s:"HST"},dst:{l:"Hawaii Standard Time",s:"HST"}},540:{std:{l:"Alaska Standard Time",s:"AKST"},dst:{l:"Alaska Standard Time",s:"AKST"}},240:{std:{l:"Atlantic Standard Time",s:"AST"},dst:{l:"Atlantic Daylight Time",s:"ADT"}},210:{std:{l:"Newfoundland Standard Time",s:"NST"},dst:{l:"Newfoundland Daylight Time",s:"NDT"}}},shortDate:"M/d/yy",medDate:"d-MMM-yy",longDate:"MMMM d, yyyy",fullDate:"EEEE MMMM d, yyyy G",date:"d-MMMM-yy",shortTime:"h:mm a",medTime:"h:mm:ss a",longTime:"h:mm:ss a z",fullTime:"h:mm:ss;S 'o''clock' a z",time:"h:mm:ss a"}})();b.text=b.text||{};(function(){var t,e="0",s="#",i="0",j="E",p="+",k="-",v="\u221E";t=function(){};t.prototype={tempMinIntegerDigits:0,minDecimalPlaces:0,maxDecimalPlaces:0,minIntegerPlaces:1,maxIntegerPlaces:1,prefix:"",suffix:"",integerPattern:"",decimalPattern:"",grouping:3,percentMode:false,permilleMode:false,color:null};var f=function(y){var B,z=0,A=y.length,x=false;if(y.charAt(z)===j&&A>1){x=true;z+=1;B=y.charAt(z);if(B===p||B===k){z+=1}for(;z<A;z++){if(y.charAt(z)===e){continue}else{x=false;break}}}return x};var l=function(D,x,y){var z=false,A=false,F=D.length>0,E,C,B;for(C=0,B=D.length;C<B;C++){E=D.charAt(C);if(E===s||E===e){continue}else{if(E===x){if(z){F=false;break}else{z=true}}else{if(E===y){if(A){F=false;break}else{if(z){F=false;break}else{A=true}}}else{if(E===j){F=f(D.substring(C,B));break}else{F=false;break}}}}}return F};var h=function(A,y){var B,x,z;B=A.indexOf("[");x=A.indexOf("]");if(B>-1&&x>B){z=A.substring(B+1,x).toLowerCase();if(b.style.CSS_COLORS.hasOwnProperty(z)){y.color=b.style.CSS_COLORS[z]}else{if(z.match(/^(0x)?[0-9a-fA-F]{6}$/)){y.color="#"+z.replace("0x","")}}if(y.color!==null){A=A.substring(0,B)+A.substring(x+1)}}return A};var q=function(I,D,x){var y=I.length,L=I.indexOf(s),z=I.indexOf(e),C=I.indexOf(x),H=I.indexOf("%"),B=I.indexOf("\u2030"),M,E,F,G,K,A,J;if(L<0){L=y-1}if(z<0){z=y-1}if(C<0){C=y-1}F=I.lastIndexOf(s);G=I.lastIndexOf(e);K=I.lastIndexOf(x);A=Math.min(L,C,z);A=A<0?0:A;J=Math.max(F,G,K);D.prefix=I.substring(0,A);D.suffix=I.substring(J+1,y);if(A>J+1||(H>=0&&B>=0)||(H>=0&&H!==I.lastIndexOf("%"))||(B>=0&&B!==I.lastIndexOf("\u2030"))){I=""}else{I=I.substring(A,J+1);if(H>0){D.percentMode=true;M=H;E="%"}else{if(B>0){D.permilleMode=true;M=B;E="\u2030"}}if(M>=A&&M<=J){I=I.replace(E,"");D.suffix=E+D.suffix}}return I};var g=function(A,y,x){var z=A.lastIndexOf(x);if(z>0){y.grouping=A.length-z-1}else{y.grouping=-1}};var m=function(y,x){x.minDecimalPlaces=0;x.maxDecimalPlaces=0;if(y.length>0){x.minDecimalPlaces=y.lastIndexOf(e)>-1?y.lastIndexOf(e)+1:0;x.maxDecimalPlaces=y.length}};var w=function(B,y,x){var A,D,z,C;y.minIntegerPlaces=0;y.maxIntegerPlaces=0;for(z=0,C=B.length;z<C;z++){D=B.charAt(z);if(D===e){y.minIntegerPlaces++;y.maxIntegerPlaces++}if(D===s){y.maxIntegerPlaces++}}A=B.lastIndexOf(x);y.tempMinIntegerDigits=A;if(y.tempMinIntegerDigits===-1){y.tempMinIntegerDigits=y.minIntegerPlaces}};var o=function(D,A,z,y){var x=D.split(j),C,E,B;A.exponent=0;if(x.length===2){C=x[1];B=0;E=C.charAt(B);if(E===p){B+=1}A.exponent=C.length-B}else{A.exponent=0}C=x[0].split(z);if(z===y&&C.length===3){A.intPattern=C[0];A.intPattern+=y;A.intPattern+=C[1];A.decPattern=C[2]}else{if(C.length===2){A.intPattern=C[0];A.decPattern=C[1]}else{A.intPattern=x[0];A.decPattern=""}}};var u=function(A,z,y){var x=new t();A=h(A,x);A=q(A,x,z);if(l(A,z,y)){o(A,x,z,y);g(x.intPattern,x,y);m(x.decPattern,x);w(x.intPattern,x,y)}else{x=null}return x};var n=function(E,A,z,y){var F="",x="",B,C=0,D=0;if(E>0){x=E.toString()}if(x!==undefined){A-=x.length}if(A>0){for(C=0;C<A;C++){F+=i}if(x!==undefined){x=F+x}}if(z>0&&x.length>z){B=[];for(C=x.length-1;C>=0;C--){if(D===z-1&&C>0){B.unshift(y,x.charAt(C));D=0}else{B.unshift(x.charAt(C));D++}}x=B.join("")}return x};var r=function(D,C,y,x){var E="",z=0,B="",A;if(D>0){A=C-Math.floor(C);for(z=0;z<x;z++){A*=10;if(Math.floor(A)===0){B+=i}else{break}}if(z<x){B+=D.toString()}z=B.length-1;while(B.charAt(z)===i&&z>=y){z--}B=B.substring(0,z+1)}if(B!==undefined){y-=B.length}if(y>0){for(z=0;z<y;z++){E+=i}B+=E}return B};b.text.NumberFormatter=function(B){var z=".",D=",",y=null,x=null,A,C=null;this.applyPattern=function(K){var G,J,F="",I=0,H="",L="",E;if(typeof K==="string"&&K.length>0&&K!==A){G=K.indexOf("{");J=K.indexOf("}");if(G===0&&J>=2){F=K.substring(G+1,J);I=F.length;if(J>2){H=F.charAt(I-1);L=F.charAt(I-2)}else{H="\uFFFF";L=F.charAt(I-1)}if(H!==L&&!H.match(/[0-9a-zA-Z]/)&&!L.match(/[0-9a-zA-Z]/)){z=H;D=L;K=K.substring(J+1)}}E=K.split(";");if(E!==undefined&&E.length>0){y=u(E[0],z,D);if(E.length>1&&E[1]!==undefined&&E[1].length>0){x=u(E[1],z,D)}else{x=y}}else{y=null;x=null}A=K}};this.format=function(L){var U,G,H="",R,N,I,O,S,T,K,P,Q,J,F,E;if(typeof L!=="number"||y===null){U=""}else{G=L<0?x:y;C=G.color;R=G.exponent;N=G.tempMinIntegerDigits;I=G.minIntegerPlaces;O=G.minDecimalPlaces;S=G.maxDecimalPlaces;if(L<0&&y===x){H+=k}if(L<0){L=-L}if(G.percentMode){L*=100}else{if(G.permilleMode){L*=1000}}T=0;K=0;if(R>0){K=Math.floor(Math.log(L)/Math.log(10));if(K!==Infinity){P=K;if(I!==0){K-=I-1}T=(L/Math.pow(10,K));K=P-(N-1)}else{T=L}}else{T=L}T+=5*Math.pow(10,-S-1);Q=Math.floor(T);J=T-Q;F=Math.pow(10,-S);E=Math.floor(J/F);U=n(Q,I,G.grouping,D);if(O>0||E>0){U+=z}U+=r(E,T,O,S);if(R>0){if(K===Infinity||K===-Infinity){if(Math.abs(L)<1){U=i}else{U=v}}else{U+=j;if(K<0){U+=k}else{U+=p}for(var M=1;M<R;M++){U+=i}U+=Math.abs(K).toString()}}if(U.length>0&&D===U.charAt(0)){U=U.substring(1,U.length)}if(U.length===0){U=i}U=(G.prefix+H+U+G.suffix)}return U};this.getColor=function(){return C};this.hasColor=function(){return C!==null};this.applyPattern(B)};b.formatNumber=function(y,x){return new b.text.NumberFormatter(y).format(x)}})();(function(){var e=/\|/,f=/(?:#|<)/;b.declare({name:"oui.text.ChoiceFormatter",membersDef:{init:function(g){this.applyPattern(g)},applyPattern:function(q){var h=q.split(e),m,j,r,g,s,k,l,p,o;if(h!==undefined&&h!==null&&h.length>0){o=[];for(m=0,j=h.length;m<j;m++){r=h[m];g=r.match(f);if(g!==null){s=r.indexOf(g);k=r.substring(0,s);l=r.substring(s+1);p={format:l,open:(g=="<"),min:parseInt(k,10),max:Number.POSITIVE_INFINITY};if(o.length>0){o[o.length-1].max=p.min}o.push(p)}}}this.choiceElements=o},format:function(m){var g,l=this.choiceElements,h,j,p=l.length,k=l[0],o=l[p-1];if(isNaN(m)||m<=k.min){g=k.format}else{if(m>=o.max){g=o.format}else{for(j=0;j<p;j++){h=l[j];if((h.open===false&&h.min===m)||(h.min<m&&m<h.max)){g=h.format;break}}}}return g}}});b.formatChoice=function(h,g){return new b.text.ChoiceFormatter(h).format(g)}})();(function(){var v=b.text.locales.en_US,m="G",f="y",C="M",w="w",h="W",s="D",o="d",A="F",l="E",z="a",x="H",i="k",B="K",t="h",n="m",q="s",j="S",k="z",u="Z",y="short",p="medium",g="long",r="full";function e(G,F){var D="",E=G.toString();for(F-=E.length;F>0;F--){D+="0"}return D+E}b.declare({name:"oui.text.DateFormatter",membersDef:{init:function(D,E){this.applyPattern(D,E)},applyPattern:function(F,H){var E,K,J,D,I,G;F=this._fixPattern(F,H);this.dateElements=[];if(F!==undefined){for(E=0,K=F.length;E<K;E++){J=F.charAt(E);if(this._isSupportedToken(J)===false){G=undefined;if(J.isLetter()){}else{if(J==="'"){D="";I=E+1;while(I<K){J=F.charAt(I);if(J==="'"){if(F.charAt(I+1)==="'"){D+=J;I+=2}else{break}}else{D+=J;I+=1}}if(I>=K){I=E}else{this.dateElements.push(D)}E=I}else{this.dateElements.push(J)}}}else{if((G!==undefined)&&(J===G.type)){G.size++}else{G={type:J,size:1};this.dateElements.push(G)}}}}},_fixPattern:function(E,F){var D;if(E===undefined||E===null){D=F?v.time:v.date}else{switch(E){case y:D=F?v.shortTime:v.shortDate;break;case p:D=F?v.medTime:v.medDate;break;case g:D=F?v.longTime:v.longDate;break;case r:D=F?v.fullTime:v.fullDate;break;default:D=E;break}}return D},_isSupportedToken:function(D){return(D===m||D===f||D===C||D===w||D===h||D===s||D===o||D===A||D===l||D===z||D===x||D===i||D===B||D===t||D===n||D===q||D===j||D===k||D===u)},format:function(K){var I="",F,E,G,D,H,J,L;if(b.isA(K,Date)){F=K}else{F=new Date();F.setDate(K)}for(G=0,D=this.dateElements.length;G<D;G++){E=this.dateElements[G];if(b.isA(E,Object)){switch(E.type){case m:I+=v.eras[F.getFullYear()>0?1:0];break;case f:H=F.getFullYear().toString();if(E.size<4){I+=H.substring(H.length-2)}else{I+=H}break;case C:H=F.getMonth();if(E.size<3){I+=e(H+1,E.size)}else{if(E.size<4){I+=v.months[H].s}else{I+=v.months[H].l}}break;case w:I+=e(F.getWeekOfYear(),E.size);break;case h:I+=e(F.getWeekOfMonth(),E.size);break;case s:I+=e(F.getDayOfYear(),E.size);break;case o:I+=e(F.getDate(),E.size);break;case A:I+=e(F.getDay(),E.size);break;case l:H=F.getDay();if(E.size<4){I+=v.days[H].s}else{I+=v.days[H].l}break;case z:I+=v.ampm[F.getHours()<12?0:1];break;case x:I+=e(F.getHours(),E.size);break;case i:I+=e(((F.getHours()+23)%24)+1,E.size);break;case B:I+=e(F.getHours()%12,E.size);break;case t:I+=e(((F.getHours()+11)%12)+1,E.size);break;case n:I+=e(F.getMinutes(),E.size);break;case q:I+=e(F.getSeconds(),E.size);break;case j:I+=e(F.getMilliseconds(),E.size);break;case k:H=F.getTimezoneOffset();if(F.isDST()){J=(H+60).toString();L="dst"}else{J=H.toString();L="std"}if(v.timezones.hasOwnProperty(J)){H=v.timezones[J];if(E.size<4){I+=H[L].s}else{I+=H[L].l}}else{I+="GMT"+(H>0?"-":"+")+Math.floor(H/60)+":"+e((H%60),2)}break;case u:H=F.getTimezoneOffset();I+=(H>0?"-":"+")+e(Math.floor(H/60),2)+e((H%60),2);break;default:c.error("ERR__FORMAT__ILLEGAL_DATE_PATTERN",E)}}else{I+=E.toString()}}return I}}});b.text.DateFormatter.setLocale=function(D){if(typeof D==="string"&&b.text.locales.hasOwnProperty(D)===true){v=b.text.locales[D]}};b.formatDate=function(E,D){return new b.text.DateFormatter(E).format(D)}})();(function(){var e={NUMBER:"number",CHOICE:"choice",DATE:"date",TIME:"time"};b.declare({name:"oui.text.FormatElement",membersDef:{init:function(k,j,i){var h,f,g;if(b.isFinitePositiveNumber(k)){this.argIndex=k}else{c.error("ERR__FORMAT__ILLEGAL_ARG_INDEX")}h=b.isA(j,String);f=b.isA(i,String);if(h&&f){switch(j){case e.NUMBER:g=new b.text.NumberFormatter(i);break;case e.CHOICE:g=new b.text.ChoiceFormatter(i);break;case e.DATE:g=new b.text.DateFormatter(i);break;case e.TIME:g=new b.text.DateFormatter(i,true);break;default:c.error("ERR__FORMAT__ILLEGAL_ARG_TYPE",j)}this.type=j}else{if(h&&!f){c.error("ERR__FORMAT__ILLEGAL_ARG_NO_STYLE")}else{if(!h&&f){c.error("ERR__FORMAT__ILLEGAL_ARG_NO_TYPE")}}}this.format=function(m){var l;if(this.accepts(m)){if(g!==undefined){l=g.format(m)}else{l=(m===null?"null":m.toString())}}else{c.error("ERR__FORMAT__ILLEGAL_ARG_VALUE")}return l}},accepts:function(h){var g=true,f=this.type;if(f!==undefined){if(f===e.NUMBER||f===e.CHOICE){g=b.isA(h,Number)}else{if(f===e.DATE||f===e.TIME){g=b.isA(h,Date)}}}return g},toString:function(){return"{"+this.argIndex+"}"}}});b.text.FormatElement.TypeEnum=e})();(function(){var e=/\{\d+(?:\,(?:choice|number|date|time)\,(?:[^\{]|\{[^\{]+\})+)?\}/g;b.declare({name:"oui.text.MessageFormatter",membersDef:{init:function(f){this.applyPattern(f)},applyPattern:function(q){var h=q.match(e),p=q.split(e),o,j,m,t,l,r,s,g,f,k,u=[];if(h!==undefined&&p!==undefined&&h!==null&&p!==null&&h.length>0&&p.length>0){for(o=0,j=h.length;o<j;o++){m=undefined;l=undefined;r=undefined;s=h[o];g=s.indexOf(",");if(g<0){t=s.substring(1,s.length-1);m=parseInt(t,10)}else{m=parseInt(s.substring(1,g),10);f=s.indexOf(",",g+1);l=s.substring(g+1,f);r=s.substring(f+1,s.length-1)}k=new b.text.FormatElement(m,l,r);u.push(p[o]);u.push(k)}u.push(p[h.length])}else{u.push(q)}this.parsedPattern=u},format:function(){var g="",k,j=this.parsedPattern.length,m,f,h,l;for(k=0;k<j;k++){m=this.parsedPattern[k];if(b.isA(m,b.text.FormatElement)){f=arguments[m.argIndex];if(f!==undefined){h=m.format(f);if(m.type===b.text.FormatElement.TypeEnum.CHOICE){l=new b.text.MessageFormatter(h);h=l.format.apply(l,arguments)}g+=h}else{g+=m.toString()}}else{if(b.isA(m,String)){g+=m}}}return g}}});b.formatMessage=function(h,g){var f=new b.text.MessageFormatter(h);return f.format.apply(f,g)}})();(function(){b.declare({name:"oui.text.WordIterator",membersDef:{_WORD_REGEXP:new RegExp("\\S+","g"),init:function(e){this._words=this._computeWordBoundaries(e);this._wordCount=this._words.length;this._currWord=null},first:function(){var e=null;if(this._wordCount>0){e=this._words[0]}this._currWord=e;return e},last:function(){var e=null;if(this._wordCount>0){e=this._words[this._wordCount-1]}this._currWord=e;return e},next:function(){var g=null,h=this._wordCount,f,e;if(h>0){f=this._currWord;e=0;if(f!==null){e=f.wordIndex+1}if(e<h){g=this._words[e]}}this._currWord=g;return g},previous:function(){var g=null,f=this._wordCount,e,h;if(f>0){e=this._currWord;h=f-1;if(e!==null){h=e.wordIndex-1}if(h>=0){g=this._words[h]}}this._currWord=g;return g},current:function(){return this._currWord},wordAt:function(l){var k=this._words,f=this._wordCount,h=null,j=0,g,e=null;if(this._currWord!==null){j=this._currWord.wordIndex}for(g=j;g<f;g++){e=k[g];if(l<e.beginIndex){break}else{if(l<=k[g].endIndex){h=e;break}}}this._currWord=e;return h},_computeWordBoundaries:function(i){var g=[],e,h,f=0;while((e=this._WORD_REGEXP.exec(i))!==null){h=e[0];g.push({beginIndex:e.index,endIndex:e.index+(h.length-1),length:h.length,value:h,wordIndex:f});f++}return g}}})})();(function(){var e="\n";b.declare({name:"oui.text.LineBreakMeasurer",membersDef:{init:function(f){this._textValue=f.textValue();this._position=0;this._wordIterator=new b.text.WordIterator(this._textValue);this._wordIterator.first();this._initOffsetLimits();this._initImpl(f)},nextLine:function(g){var f=this._nextLineImpl(g);if(f!==null&&f.leading===undefined){f.leading=this._computeLeadingApproximation(f)}return f},replaceText:function(g,j,i){var h=this._textValue,f=h.length;if(g<0||j>f||g>j){c.error("ERR__LINEBREAK__ILLEGAL_REPLACE_ARG")}this._textValue="";if(g!==0){this._textValue+=h.slice(0,g)}if(i!==null){this._textValue+=i}if(j!==f){this._textValue+=h.slice(j)}this._position=0;this._wordIterator.init(this._textValue);this._wordIterator.first();this._initOffsetLimits();this._replaceTextImpl(g,j,i)},getRawText:function(){return this._textValue},getTextLength:function(){return this._textValue.length},_initImpl:function(f){},_nextLineImpl:function(l){var k=this._getCurrentOffsetLimit(),n=null,i=this._wordIterator,j=this._position,g=j,f=i.current(),m,h;if(f!==null){m=f.endIndex+1;if(m>k||this._measureImpl(j,m)>l){g=this._fitChars(l,k);h=true}else{g=this._fitWords(l,k);h=false}this._updateOffsetLimit(g);if(g>j){n=this._createLineObjImpl(j,g,h);this._position=g}}return n},_measureImpl:function(g,f){return 0},_createLineObjImpl:function(h,f,g){return{textValue:this._textValue.substring(h,f),textBlockBeginIndex:h,lastWordTruncated:g,lineWidth:0,lineHeight:0,ascent:0,descent:0,userData:null}},_replaceTextImpl:function(f,h,g){},_initOffsetLimits:function(){this._offsetLimits=this._findOffsetLimits(this._textValue);this._offsetLimitsCount=this._offsetLimits.length;this._currOffsetLimit=0},_findOffsetLimits:function(g){var f=[],j=0,h=g.length;for(j=0;j<h;j++){if(e===g.charAt(j)){f.push(j+1)}}return f},_getCurrentOffsetLimit:function(){var f=this._textValue.length;if(this._currOffsetLimit<this._offsetLimitsCount){f=this._offsetLimits[this._currOffsetLimit]}return f},_updateOffsetLimit:function(f){if(f===this._offsetLimits[this._currOffsetLimit]){this._currOffsetLimit++}},_fitChars:function(g,f){var i=this._position,h=this._position+1;while(h<f&&this._measureImpl(i,h)<=g){h++}return h},_fitWords:function(g,f){var h=this._wordIterator.current(),j=this._position,i=j;while(h!==null&&(h.endIndex+1)<=f&&this._measureImpl(j,h.endIndex+1)<=g){i=h.endIndex+1;h=this._wordIterator.next()}if(h!==null&&i!==j&&i!==f){if(h.beginIndex>f){i=f}else{i=h.beginIndex}}return i},_computeLeadingApproximation:function(f){return(f.ascent+f.descent)*0.2}}})})();(function(){b.mixin(b.text.LineBreakMeasurer,{_initImpl:function(e){this._font=e.getCanvasFont();this._fontSize=e.fontSize();this._canvasTextMeasurer=b.tree.canvas.getContext("2d")},_measureImpl:function(h,e){var f,g=this._canvasTextMeasurer;g.save();g.font=this._font;f=g.measureText(this._textValue.substring(h,e));g.restore();return f.width},_createLineObjImpl:function(k,e,h){var j=this._canvasTextMeasurer,f=this._textValue.substring(k,e),i=this._fontSize,g;j.save();j.font=this._font;g=j.measureText(f);j.restore();return{textValue:f,textBlockBeginIndex:k,textBlockEndIndex:e,lastWordTruncated:h,lineWidth:g.width,lineHeight:i,ascent:i,descent:0,userData:null}}})})();(function(){var e="FILTER_EVENT";b.declare({name:"oui.filters.AbstractFilter",isAbstract:true,mixins:[b.events.EventSupport],membersDef:{init:function(f){this._style=new this.Style();this.applyStyle(f)},applyStyle:function(f){var g=this._style.updateObject(f),h;if(this.shadowFilter!==undefined){for(h in g){if(g.hasOwnProperty(h)){this._updateShadowFilter(h)}}}this.dispatchEvent({type:e})},_getFilteredBounds:function(f){return f},_getShadowFilter:function(){if(this.shadowFilter===undefined){this.shadowFilter=this._createShadowFilter()}return this.shadowFilter},_createShadowFilter:function(){},_updateShadowFilter:function(f){}}});b.filters.FILTER_EVENT=e})();(function(){b.mixin(b.filters.AbstractFilter,{applyCanvasFilter:function(e,f){return e}})})();(function(){var e={RADIUS:"RADIUS"};b.declare({name:"oui.filters.Blur",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(g){var f=this._style.radius;return{x:g.x-f,y:g.y-f,width:g.width+2*f,height:g.height+2*f}},_styleTags:e}});b.addStyleSupport(b.filters.Blur,{radius:b.defs.FinitePositiveNumber(3,e.RADIUS)})})();(function(){var e={COLOR:"COLOR",OPACITY:"OPACITY",RADIUS:"RADIUS",ANGLE:"ANGLE",OFFSET:"OFFSET",KNOCKOUT:"KNOCKOUT"};b.declare({name:"oui.filters.DropShadow",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(g){var h=this._style;var j=h.angle*Math.PI/180;var l=h.offset;var o=h.radius;var p=g.x+l*Math.cos(j)-o;var n=g.y+l*Math.sin(j)-o;var k=g.width+2*o;var m=g.height+2*o;var i=Math.min(g.x,p);var q=Math.min(g.y,n);var r=Math.max(g.x+g.width,p+k);var f=Math.max(g.y+g.height,n+m);return{x:i,y:q,width:r-i,height:f-q}},_styleTags:e},styleDef:{color:b.defs.Color(0,0,0,255,e.COLOR),opacity:b.defs.NumberInRange([0,1],0.5,e.OPACITY),radius:b.defs.FinitePositiveNumber(2,e.RADIUS),angle:b.defs.NumberInRange([0,360],45,e.ANGLE),offset:b.defs.FinitePositiveNumber(2,e.OFFSET),knockout:b.defs.Boolean(false,e.KNOCKOUT)}})})();(function(){b.mixin(b.filters.DropShadow,{applyCanvasFilter:function(h,e){var g,n,f=this._style,k=f.color,i=f.angle*Math.PI/180,m=f.offset,q=f.radius,l=m*Math.cos(i),j=m*Math.sin(i),p=Math.floor(e.x+l-q),o=Math.floor(e.y+j-q);g=b.tree.createOffscreenCanvas(e.width,e.height);n=g.getContext("2d");n.translate(-p,-o);n.shadowColor="rgba(".concat(k.getRed(),",",k.getGreen(),",",k.getBlue(),",",(f.opacity*k.getOpacity()),")");n.shadowOffsetX=l;n.shadowOffsetY=j;n.shadowBlur=q;n.drawImage(h,p,o);if(f.knockout===true){n.globalCompositeOperation="destination-out";n.drawImage(h,p,o)}b.tree.disposeOffscreenCanvas(h);return g}})})();(function(){var e={STRENGTH:"STRENGTH",COLOR:"COLOR",OPACITY:"OPACITY"};b.declare({name:"oui.filters.Glow",extend:b.filters.AbstractFilter,membersDef:{_getFilteredBounds:function(f){var g=this._style.strength;return{x:f.x-g,y:f.y-g,width:f.width+2*g,height:f.height+2*g}},_styleTags:e}});b.addStyleSupport(b.filters.Glow,{color:b.defs.Color(255,255,255,255,e.COLOR),strength:b.defs.FinitePositiveNumber(3,e.STRENGTH)})})();(function(){b.mixin(b.filters.Glow,{applyCanvasFilter:function(i,e){var g,k,f=this._style,j=f.color,h=f.strength,m=Math.floor(e.x-h),l=Math.floor(e.y-h);g=b.tree.createOffscreenCanvas(e.width,e.height);k=g.getContext("2d");k.translate(-m,-l);k.shadowColor="rgba(".concat(j.getRed(),",",j.getGreen(),",",j.getBlue(),",",j.getOpacity(),")");k.shadowBlur=h;k.drawImage(i,m,l);b.tree.disposeOffscreenCanvas(i);return g}})})();(function(){b.mixin(b.filters,{DEFAULT_BLUR:new b.filters.Blur(),DEFAULT_LTR_SHADOW:new b.filters.DropShadow(),DEFAULT_RTL_SHADOW:new b.filters.DropShadow({angle:135}),DEFAULT_LTR_KNOCKOUT_SHADOW:new b.filters.DropShadow({knockout:true}),DEFAULT_RTL_KNOCKOUT_SHADOW:new b.filters.DropShadow({knockout:true,angle:135})})})();(function(){var e=b.scene.AbstractNode.prototype,f=b.TAGS;b.declare({name:"oui.graphics.AbstractGraphicNode",isAbstract:true,extend:b.scene.AbstractNode,mixins:[b.lang.BindingSupport,b.anim.EffectsSupport],membersDef:{init:function(g,h){e.init.call(this,h);this._globalTransformMatrix=undefined;this._globalTransformMatrixInv=undefined;this._layoutDirty=true;this._layoutPositionDirty=true;this._layoutBox=undefined;this._previousLayoutBox=undefined;this._filterEffect=undefined;this._ctrlPts=[];this._style=new this.Style();this._style.transform=new b.geom.Matrix();this._transformMatrix=this._style.transform;if(g!==undefined&&g!==null){this.styleBinding=g.styleBinding;this.dataBinding=g.dataBinding;this.resourcesBinding=g.resourcesBinding}this.applyStyle(g)},notifyNodeEvent:function(h){var g=this.parentNode;if(h===f.TRANSFO){this.clearGlobalTransformMatrix();if(g!==null&&this.preventParentInvalidateLayout!==true){g._clearCtrlPts();g.invalidateLayout()}}else{if(h===f.LAYOUT_DIR){this._onLayoutDirChanged()}}e.notifyNodeEvent.call(this,h)},_onParentChanged:function(){this.clearGlobalTransformMatrix();e._onParentChanged.call(this)},_onChildrenChanged:function(){this._clearCtrlPts();this.invalidateLayout();e._onChildrenChanged.call(this)},onPropertyChanged:function(){},onStyleChanged:function(g){if(g===b.DEFAULT_TAG){this.onPropertyChanged()}else{if(g===f.VISIBILITY||g===f.SENSITIVITY||g===f.DESC){this.notifyNodeEvent(g)}else{if(g===f.LAYOUT||g===f.PREF_SIZE){this.invalidateLayout()}else{if(g===f.DISPLAY||g===f.CLIP){this._clearCtrlPts();this.invalidateLayout();this.notifyNodeEvent(g)}else{if(g===f.FILTER){this._updateFilterEffect();this.notifyNodeEvent(g)}else{if(g===f.CURSOR){this._onCursorChanged();this.notifyNodeEvent(g)}else{if(g===f.TRANSFO_SET){this._style.transform=this._style.transform.clone();this._transformMatrix=this._style.transform;this.notifyNodeEvent(f.TRANSFO)}}}}}}}},applyStyle:function(g){var h,i;if(g!==undefined){h=this._style.updateObject(g);for(i in h){if(h[i]===true){this.onStyleChanged(i)}}}},applyStyleBinding:function(i,h,g){this._applyBinding(i,h,"styleBinding","styleBindingScope",this.applyStyle,g)},applyDataBinding:function(i,h,g){this._applyBinding(i,h,"dataBinding","dataBindingScope",this.applyStyle,g)},applyResourcesBinding:function(i,h,g){this._applyBinding(i,h,"resourcesBinding","resourcesBindingScope",this.applyStyle,g)},requestFocus:function(){if(b.focusManager){b.focusManager.requestFocus(this)}},getDefaultDragAction:function(){return function(g){var h=g.target;if(h!==undefined&&h.draggable()===true){h.translate(g.dragUserX,g.dragUserY)}}},translate:function(h,g){if(h!==0||g!==0){this._transformMatrix.translate(h,g);this.notifyNodeEvent(f.TRANSFO)}return this},scale:function(h,g){this._transformMatrix.scale(h,g);this.notifyNodeEvent(f.TRANSFO);return this},rotate:function(i,g,j){var h=i/180*Math.PI;this._transformMatrix.rotate(h,g,j);this.notifyNodeEvent(f.TRANSFO);return this},setTranslation:function(g,h){if(this._transformMatrix.tx!==g||this._transformMatrix.ty!==h){this._transformMatrix.tx=g;this._transformMatrix.ty=h;this.notifyNodeEvent(f.TRANSFO)}},getTranslation:function(){return{x:this._transformMatrix.tx,y:this._transformMatrix.ty}},resetTransform:function(){this._style.transform=b.geom.Matrix.IDENTITY.clone();this._transformMatrix=this._style.transform;this.notifyNodeEvent(f.TRANSFO)},getTransformMatrix:function(){return this._transformMatrix.clone()},setTransformMatrix:function(g){this._transformMatrix.set(g);this.notifyNodeEvent(f.TRANSFO)},getGlobalTransformMatrix:function(){return this._safeGetGlobalTransformMatrix().clone()},getGlobalTransformMatrixInv:function(){return this._safeGetGlobalTransformMatrixInv().clone()},_safeGetGlobalTransformMatrixInv:function(){if(this._globalTransformMatrixInv===undefined){this._globalTransformMatrixInv=this._safeGetGlobalTransformMatrix().inverse()}return this._globalTransformMatrixInv},_safeGetGlobalTransformMatrix:function(){var g=this._globalTransformMatrix;if(g===undefined){if(this.parentNode!==null){g=this.parentNode._safeGetGlobalTransformMatrix();if(this._transformMatrix.isIdentity()===false){g=g.clone();g._concat(this._transformMatrix)}}else{g=this._transformMatrix}this._globalTransformMatrix=g}return g},clearGlobalTransformMatrix:function(g){var h;if(this._globalTransformMatrix!==undefined||this._globalTransformMatrixInv!==undefined){this._globalTransformMatrix=undefined;this._globalTransformMatrixInv=undefined;h=this.firstChild;while(h!==null){h.clearGlobalTransformMatrix(true);h=h.nextSibling}}this._clearGlobalTransformMatrixImpl(g)},_clearGlobalTransformMatrixImpl:function(g){},_transformCtrlPts:function(h,i){var g=this._clipCtrlPts(this._getCtrlPts(i));if(h!==null&&h.isIdentity()===false){g=h.batchTransformCoords(g)}return g},_clipCtrlPts:function(g){var j=g,h=this._style.clip,i;if(h[2]>=0&&h[3]>=0){i=b.geom.intersectRect({x:h[0],y:h[1],width:h[2],height:h[3]},b.geom.computeBounds(g));if(i===undefined){j=[]}else{j=b.geom.getBoxCtrlPts(i.x,i.y,i.width,i.height)}}return j},getLayoutBounds:function(h){this.layout();var g=this._transformMatrix;if(h!==undefined&&h.getGlobalTransformMatrixInv!==undefined){g=h.getGlobalTransformMatrixInv();g._concat(this._safeGetGlobalTransformMatrix())}return this._getBoundsImpl(g,b._BoundsType.LAYOUT)},getLocalBounds:function(){if(this._localBoundsCache===undefined){var g=this._getCtrlPts(b._BoundsType.STROKED);g=this._clipCtrlPts(g);this._localBoundsCache=b.geom.computeBounds(g)}return this._localBoundsCache},_getBoundsImpl:function(g,h){return b.geom.computeBounds(this._transformCtrlPts(g,h))},getTransformToNode:function(j){var h=new b.geom.Matrix(),i,g;if(b.isA(j,b.graphics.AbstractGraphicNode)===true){i=this.getGlobalTransformMatrix();g=j.getGlobalTransformMatrixInv();h.concat(g);h.concat(i)}return h},_getCtrlPts:function(i){var g,h=this._ctrlPts;if(i!==b._BoundsType.LAYOUT||this._style.display===true){i=this._fixBoundsType(i);if(h[i]===undefined){h[i]=this._computeCtrlPts(i)}g=h[i]}else{g=[]}return g},_fixBoundsType:function(g){return g},_clearCtrlPts:function(){this._ctrlPts.length=0;this._localBoundsCache=undefined;var g=this.parentNode;if(g!==null&&g._ctrlPts.length>0){g._clearCtrlPts()}},localToGlobal:function(g,h){return this._safeGetGlobalTransformMatrix().transformCoords(g,h)},globalToLocal:function(g,h){return this._safeGetGlobalTransformMatrixInv().transformCoords(g,h)},hitTest:function(h,j){var g=null,i=this._style;if(i.display===true&&i.visibility===true&&i.pointerSensitivity===true){g=this._hitTest(h,j)}return g},_hitTest:function(g,i){var h=this.globalToLocal(g,i);return this._isWithinBounds(h.x,h.y)?this:null},_isWithinBounds:function(h,g,j){var i=this.getLocalBounds();if(typeof j!=="number"){j=0}return i!==undefined&&h>=i.x-j&&h<=i.x+i.width+j&&g>=i.y-j&&g<=i.y+i.height+j},_updateFilterEffect:function(){if(this._filterEffectListener===undefined){this._filterEffectListener=this._getFilterEffectListener()}var h=this._style.filter,i=this._filterEffect,g=(b.layoutDir===b.LayoutDirEnum.LTR);if(i!==undefined){i.removeEventListener(this._filterEffectListener)}if(b.isA(h,b.filters.AbstractFilter)){i=h}else{if(h===b.FiltersEnum.BLUR){i=b.filters.DEFAULT_BLUR}else{if(h===b.FiltersEnum.DROP_SHADOW){i=g?b.filters.DEFAULT_LTR_SHADOW:b.filters.DEFAULT_RTL_SHADOW}else{if(h===b.FiltersEnum.DROP_SHADOW_KNOCKED_OUT){i=g?b.filters.DEFAULT_LTR_KNOCKOUT_SHADOW:b.filters.DEFAULT_RTL_KNOCKOUT_SHADOW}else{i=undefined}}}}if(i!==undefined){i.addEventListener(b.filters.FILTER_EVENT,this._filterEffectListener)}this._filterEffect=i},_getFilterEffectListener:function(){var g=this;return function(){g.notifyNodeEvent(f.FILTER)}},_onCursorChanged:function(){var j=this,i=null;var h=function(m){if(i!==null){var l=j._style.customCursor.hotSpot;i.setTranslation(m.clientX-l.x,m.clientY-l.y)}};var g=function(l){if(i===null){i=b.load(j._style.customCursor.definition);if(i!==null){i.setPointerSensitivity(false);h(l);b.tree.userLayer.appendChild(i);j.onMouseMove(h)}}};var k=function(){if(i!==null){j.offMouseMove(h);b.tree.userLayer.removeChild(i);i=null}};if(this._style.cursor!==b.CursorTypeEnum.CUSTOM){this.offMouseOver(g);this.offMouseOut(k)}else{this.onMouseOver(g);this.onMouseOut(k)}},getPreferredLayoutBox:function(i){var h,k=this._style.display,g=this._style.layout,j;if(i===undefined||i===null){i={}}if(k===true){j=g.padding;if(g.preferredWidth>=0){i.width=g.preferredWidth}if(g.preferredHeight>=0){i.height=g.preferredHeight}if(i.width===undefined||i.height===undefined){h=this._getContentPreferredLayoutBox();if(i.width===undefined){i.width=h.width+j.lineBegin+j.lineEnd}if(i.height===undefined){i.height=h.height+j.top+j.bottom}}}else{i.width=0;i.height=0}return i},_getContentPreferredLayoutBox:function(){this.layout();var h=this._getBoundsImpl(this._transformMatrix,b._BoundsType.LAYOUT);var g={width:0,height:0};if(h!==undefined){g.width=h.width;g.height=h.height}return g},setLayoutBox:function(h,l,k,g){var j=this._style.layout.padding.lineBegin,i=this._style.layout.padding.top;if(b.layoutDir===b.LayoutDirEnum.RTL){j=this._style.layout.padding.lineEnd}this._layoutBox={x:h+j,y:l+i,width:k-this._style.layout.padding.lineBegin-this._style.layout.padding.lineEnd,height:g-i-this._style.layout.padding.bottom};if(this._layoutBox.width<0){this._layoutBox.width=0}if(this._layoutBox.height<0){this._layoutBox.height=0}if(this._layoutDirty===false){if(this._previousLayoutBox===undefined){this._layoutDirty=true}else{if(this._previousLayoutBox.width!==this._layoutBox.width||this._previousLayoutBox.height!==this._layoutBox.height){this._layoutDirty=true}else{if(this._previousLayoutBox.x!==this._layoutBox.x||this._previousLayoutBox.y!==this._layoutBox.y){this._layoutPositionDirty=true}}}}this._previousLayoutBox=this._layoutBox;this.layout()},layout:function(){if(this._layingOut!==true){if(this._layoutDirty===true){this._layingOut=true;if(this._style.display===true){this._safeLayout()}this._layoutDirty=false;this._layoutPositionDirty=false;this._layingOut=false}else{if(this._layoutPositionDirty===true){this._layingOut=true;if(this._style.display===true){this._positionInLayoutBox()}this._layoutPositionDirty=false;this._layingOut=false}}}},_safeLayout:function(){},_positionInLayoutBox:function(){var n=this._transformMatrix,i=this._layoutBox,j=this._style.layout,m,l,k,o,h,g;if(i!==undefined){k=j.hAlign;h=n.tx;g=n.ty;o=this._getBoundsImpl(n,b._BoundsType.LAYOUT);if(o===undefined){o={x:h,y:g,width:0,height:0}}if(j.xAnchor<0){m=j.hAlign}else{m=j.xAnchor}if(b.layoutDir===b.LayoutDirEnum.RTL){m=1-m;k=1-k}m*=o.width;if(j.yAnchor<0){l=j.vAlign}else{l=j.yAnchor}l*=o.height;this.setTranslation(h-m-o.x+i.x+k*i.width,g-l-o.y+i.y+j.vAlign*i.height)}},invalidateLayout:function(){if(this._layingOut!==true&&this._layoutDirty!==true){this._layoutDirty=true;this._layoutPositionDirty=true;this._layoutBox=undefined;this._previousLayoutBox=undefined;if(this._ctrlPts.length>0){this._clearCtrlPts()}if(this.parentNode!==null&&this.preventParentInvalidateLayout!==true){this.parentNode.invalidateLayout()}}},_onLayoutDirChanged:function(){this.invalidateLayout()}},eventsDef:[b.MouseEvents,b.KeyEvents,b.DragEvents,b.TouchEvents,b.GenericGestureEvents,b.GestureEvents,b.UIEvents]});b.addStyleSupport(b.graphics.AbstractGraphicNode,{transform:b.defs.Matrix(b.geom.Matrix.IDENTITY,f.TRANSFO_SET),clip:b.defs.ArrayOfType({type:Number},4,4,[0,0,-1,-1],f.CLIP,true),cursor:b.defs.Enum(b.CursorTypeEnum,b.CursorTypeEnum.AUTO,f.CURSOR),customCursor:{definition:b.defs.ArrayOfProperties({type:b.defs.String("image")},1,undefined,[{type:"image"}]),hotSpot:{x:b.defs.FinitePositiveNumber(0),y:b.defs.FinitePositiveNumber(0)}},description:b.defs.String("",f.DESC),display:b.defs.Boolean(true,f.DISPLAY),draggable:b.defs.Boolean(false),filter:b.defs.FilterEffect(b.FiltersEnum.NONE,f.FILTER),focusable:b.defs.Boolean(false,f.FOCUSABLE),focusOutlineOffset:b.defs.Number(2),layout:{hAlign:b.defs.NumberInRange([0,1],b.NodeAlign.CENTER,f.LAYOUT),vAlign:b.defs.NumberInRange([0,1],b.NodeAlign.CENTER,f.LAYOUT),hWeight:b.defs.FinitePositiveNumber(0,f.LAYOUT),vWeight:b.defs.FinitePositiveNumber(0,f.LAYOUT),xAnchor:b.defs.FiniteNumber(-1,f.LAYOUT),yAnchor:b.defs.FiniteNumber(-1,f.LAYOUT),padding:b.defs.Padding(0,0,0,0,f.LAYOUT),preferredWidth:b.defs.FiniteNumber(-1,f.PREF_SIZE),preferredHeight:b.defs.FiniteNumber(-1,f.PREF_SIZE),isLayoutChild:b.defs.Boolean(true,f.LAYOUT)},pointerSensitivity:b.defs.Boolean(true,f.SENSITIVITY),tooltip:b.defs.ObjectOfConstraint([function(g){return b.isA(g,String)||b.isA(g,b.graphics.AbstractGraphicNode)}],null,true,false),visibility:b.defs.Boolean(true,f.VISIBILITY),cacheAsBitmap:b.defs.Boolean(false)})})();(function(){var e=b.TAGS;b.mixin(b.graphics.AbstractGraphicNode,{notifyNodeEventImpl:function(f,g){if(f!==e.SENSITIVITY&&f!==e.DESC&&f!==e.CURSOR){if(f!==e.TRANSFO){this._clearOffscreenCanvasCache(g!==true)}b.tree.markCanvasAsDirty()}},_clearGlobalTransformMatrixImpl:function(f){this._clearOffscreenCanvasCache(!f)},paintToCanvas:function(k,m){var g=this._style,n,l,j,o,f,h,i;if(this._isViewableInCanvas()===true){o=this._safeGetGlobalTransformMatrix();f=this._getBoundsImpl(o,b._BoundsType.STROKED);if(f!==undefined){h=this._filterEffect;if(h!==undefined){f=this._filterEffect._getFilteredBounds(f)}m=b.geom.intersectRect(f,m,true);if(m!==undefined){k.save();l=this._cacheAsOffscreenCanvas();if(l===true){f.x=Math.floor(f.x);f.y=Math.floor(f.y)}j=this._offscreenCanvasCache;if(j===undefined){if(l===true){f.width=Math.ceil(f.width);f.height=Math.ceil(f.height);j=b.tree.createOffscreenCanvas(f.width,f.height);n=j.getContext("2d");n.translate(-f.x,-f.y);n.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}else{n=k;o=this._transformMatrix;n.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}i=g.clip;if(i[2]>=0&&i[3]>=0){n.beginPath();n.rect(i[0],i[1],i[2],i[3]);n.clip()}this._paintSelfToCanvas(n,m);if(h!==undefined){j=h.applyCanvasFilter(j,f)}this._offscreenCanvasCache=j}if(j!==undefined){o=this.parentNode._safeGetGlobalTransformMatrixInv();k.transform(o.a,o.b,o.c,o.d,o.tx,o.ty);this._paintOffscreenToCanvas(k,j,f.x,f.y)}k.restore()}}}},_isViewableInCanvas:function(){return this._style.display===true&&this._style.visibility===true},_cacheAsOffscreenCanvas:function(){return this._filterEffect!==undefined||this._style.cacheAsBitmap===true},_clearOffscreenCanvasCache:function(f){if(this._offscreenCanvasCache!==undefined){b.tree.disposeOffscreenCanvas(this._offscreenCanvasCache);this._offscreenCanvasCache=undefined}if(f&&this.parentNode!==null){this.parentNode._clearOffscreenCanvasCache(f)}},_paintSelfToCanvas:function(f,g){},_paintOffscreenToCanvas:function(g,h,f,i){g.drawImage(h,f,i)}})})();(function(){var e=b.graphics.AbstractGraphicNode.prototype,f=b.TAGS;b.declare({name:"oui.graphics.AbstractShape",isAbstract:true,extend:b.graphics.AbstractGraphicNode,membersDef:{onStyleChanged:function(g){if(g===f.PAINT){this.notifyNodeEvent(g)}else{if(g===f.GEOM){this._clearCtrlPts();this.invalidateLayout();this.notifyNodeEvent(g)}else{e.onStyleChanged.call(this,g)}}},_fixBoundsType:function(h){var g=this._style;if(h===b._BoundsType.LAYOUT||(h===b._BoundsType.STROKED&&(g.stroke===b.NO_PAINT||g.strokeThickness===0))){h=b._BoundsType.DEFAULT}return h},getFillBounds:function(){return b.geom.computeBounds(this._clipCtrlPts(this._getCtrlPts(b._BoundsType.DEFAULT)))},_isValidAppendChild:function(){return false},_safeLayout:function(){this._positionInLayoutBox()},_hitTest:function(h,l){var g=null,i=this._style,k=true,j;if(i.fill!==b.NO_PAINT){j=this.globalToLocal(h,l);if(this.hitTestOnFill(j.x,j.y)===true){g=this}else{k=false}}if(g===null&&i.stroke!==b.NO_PAINT&&i.strokeThickness>0){j=j||this.globalToLocal(h,l);if(this.hitTestOnStroke(j.x,j.y,k)===true){g=this}}return g},hitTestOnFill:function(h,g){return false},hitTestOnStroke:function(i,h,g){return false}},styleDef:{fill:b.defs.Paint(b.black,f.PAINT),fillOpacity:b.defs.NumberInRange([0,1],1,f.PAINT),fixedStrokeWidth:b.defs.Boolean(false,f.PAINT),snapToGrid:b.defs.Boolean(true,f.PAINT),stroke:b.defs.Paint(b.NO_PAINT,f.PAINT),strokeOpacity:b.defs.NumberInRange([0,1],1,f.PAINT),strokeThickness:b.defs.FinitePositiveNumber(1,f.PAINT),strokeLineJoin:b.defs.Enum(b.LineJoinEnum,b.LineJoinEnum.MITER,f.PAINT),strokeLineCap:b.defs.Enum(b.LineCapEnum,b.LineCapEnum.BUTT,f.PAINT),strokeMiterLimit:b.defs.FinitePositiveNumber(3,f.PAINT),strokeDashArray:b.defs.ArrayOfType(b.defs.StrictlyPositiveNumber(1),undefined,undefined,[],f.PAINT)}})})();(function(){var g=b.graphics.AbstractGraphicNode.prototype;var f={};f[b.LineCapEnum.BUTT]="butt";f[b.LineCapEnum.ROUND]="round";f[b.LineCapEnum.SQUARE]="square";var e={};e[b.LineJoinEnum.MITER]="miter";e[b.LineJoinEnum.ROUND]="round";e[b.LineJoinEnum.BEVEL]="bevel";b.mixin(b.graphics.AbstractShape,{_isViewableInCanvas:function(){var h=this._style;return g._isViewableInCanvas.call(this)&&((h.fill!==b.NO_PAINT&&h.fillOpacity>0)||(h.stroke!==b.NO_PAINT&&h.strokeOpacity>0&&h.strokeThickness>0))},_setCanvasFill:function(i){var h=this._style;i.globalAlpha=h.fillOpacity;i.fillStyle=h.fill.toCanvasStyle(this.getFillBounds(),i)},_setCanvasStroke:function(i){var h=this._style;i.globalAlpha=h.strokeOpacity;i.strokeStyle=h.stroke.toCanvasStyle(this.getLocalBounds(),i);i.lineWidth=h.strokeThickness;i.lineCap=f[h.strokeLineCap];i.lineJoin=e[h.strokeLineJoin];i.miterLimit=h.strokeMiterLimit}})})();(function(){var h="move",k="close",o="line",l="curve",j="quad",q=b.geom.DEG_TO_RAD,m=Math.PI/2,s={M:"moveTo",L:"lineTo",H:"horizontalLineTo",V:"verticalLineTo",Q:"quadTo",T:"smoothQuadTo",C:"curveTo",S:"smoothCurveTo",Z:"closePath",A:"arc",aM:"arcMoveTo",aL:"arcLineTo"};b.graphics.PathTypeEnum={MOVE_TO:h,CLOSE:k,LINE_TO:o,CURVE_TO:l,QUAD_TO:j};b.declare({name:"oui.graphics.PathCommands",membersDef:{init:function(t,p){this.set(t,p)},set:function(t,p){this.resetPath();if(b.isA(t,String)){this._parseString(t,p)}},resetPath:function(){this.dataTypes=[];this.dataValues=[];this.curX=0;this.curY=0;this.lastMoveToX=0;this.lastMoveToY=0;this.lastQuadCtrlX=0;this.lastQuadCtrlY=0;this.lastCubicCtrlX=0;this.lastCubicCtrlY=0;this._hasCubics=false;this._hasQuads=false},toString:function(A,D,v){var u=this.dataTypes,t=this.dataValues,C,w=u.length,E=[],B=0,I=(A===true)?" ":"",H,G="Z",x="M",y="L",p="Q",F="C";if(typeof D==="function"){H=D}else{if(typeof D==="number"){H=function(z){return z.toFixed(D)}}else{H=function(z){return z}}}if(v){G=v.CLOSE;x=v.MOVE_TO;y=v.LINE_TO;p=v.QUAD_TO;F=v.CURVE_TO}for(C=0;C<w;C++){switch(u[C]){case k:E.push(G,I);break;case h:E.push(x,I,H(t[B++]),",",H(t[B++]),I);break;case o:E.push(y,I,H(t[B++]),",",H(t[B++]),I);break;case j:E.push(p,I,H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++]),I);break;case l:E.push(F,I,H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++])," ",H(t[B++]),",",H(t[B++]),I);break;default:break}}return E.join("").trim()},isPointInPath:function(t,v,u){var p=this._countPathCrossings(t,v);if(u===b.WindingRuleEnum.NON_ZERO){p=(p!==0)}else{p=(p%2)!==0}return p},_isPointOnStrokedPath:function(D,C,z){var M=false,t=this.flatten(),G=t.dataTypes,E=t.dataValues,J,H=G.length,L=0,K=z*z,I=b.geom.ptSegDistSq,F,B,A,w,v,u,p;for(J=0;J<H&&M===false;J++){F=G[J];if(F===h){u=w=E[L++];p=v=E[L++];M=(D===w&&C===v)}else{if(F===k){B=u;A=p}else{B=E[L++];A=E[L++]}M=I(w,v,B,A,D,C)<K;w=B;v=A}}return M},_getStrokeCtrlPts:function(y){var v=[],p=this.flatten(),G=p.dataTypes,D=p.dataValues,I,H=G.length,F,J=0,A,z,x,w,u,t,C,B,E;for(I=0;I<H;I++){F=G[I];if(F===h){u=x=D[J++];t=w=D[J++];v.push(x,w)}else{A=(F===k)?u:D[J++];z=(F===k)?t:D[J++];C=A-x;B=z-w;E=y;if(C!==0||B!==0){E=E/Math.sqrt(C*C+B*B);C=C*E;B=B*E;v.push(x-B,w+C,A-B,z+C,A+B,z-C,x+B,w-C)}x=A;w=z}}return v},flatten:function(x,t){var C,u,p,B,v,z,w,y,A;if(this._hasCubics===true||this._hasQuads===true){C=new b.graphics.PathCommands();if(typeof x!=="number"){x=5}u=this.dataTypes;p=this.dataValues;v=u.length;for(B=0,y=0,A=[];B<v;B++){switch(u[B]){case k:C.closePath();break;case h:C._M(p[y++],p[y++]);break;case o:C._L(p[y++],p[y++]);break;case j:b.geom.flattenQuad(p[y-2],p[y-1],p[y++],p[y++],p[y++],p[y++],A,x,t);z=0;w=A.length;while(z<w){C._L(A[z++],A[z++])}A.length=0;break;case l:b.geom.flattenCubic(p[y-2],p[y-1],p[y++],p[y++],p[y++],p[y++],p[y++],p[y++],A,x,t);z=0;w=A.length;while(z<w){C._L(A[z++],A[z++])}A.length=0;break;default:break}}}else{C=this}return C},snap:function(E,v,J){var D=this.dataTypes,C=this.dataValues,B,A,z,w,u,p,K,I,t,G,H,L,F=D.length;if(typeof J!=="number"){J=0}if(v){t=v.inverse()}for(H=0,L=0;H<F;H++){switch(D[H]){case h:u=z=C[L++];p=w=C[L++];break;case k:z=u;w=p;break;case o:B=K=C[L++];A=I=C[L++];if(v){G=v.transformCoords(z,w);z=G.x;w=G.y;G=v.transformCoords(B,A);B=G.x;A=G.y}if(Math.abs(B-z)<=J){if(E===true){z=Math.floor(z)+0.5}else{if(Math.floor(z)!==z){z=Math.round(z)}}if(t){C[L-4]=t.a*z+t.c*w+t.tx;C[L-2]=t.a*z+t.c*A+t.tx}else{C[L-4]=C[L-2]=z}}if(Math.abs(A-w)<=J){if(E===true){w=Math.floor(w)+0.5}else{if(Math.floor(w)!==w){w=Math.round(w)}}if(t){C[L-3]=t.b*z+t.d*w+t.ty;C[L-1]=t.b*B+t.d*w+t.ty}else{C[L-3]=C[L-1]=w}}z=K;w=I;break;case j:L+=2;z=C[L++];w=C[L++];break;case l:L+=4;z=C[L++];w=C[L++];break;default:break}}},cubicify:function(){var w=this.dataTypes,u=this.dataValues,t,p,x=0,y=w.length,v;if(this._hasQuads===true){for(t=0;t<y;t++){switch(w[t]){case h:p=x;x+=2;break;case o:x+=2;break;case j:if(w[t-1]===k){v=b.geom.quadratic2Cubic(u[p],u[p+1],u[x],u[x+1],u[x+2],u[x+3])}else{v=b.geom.quadratic2Cubic(u[x-2],u[x-1],u[x],u[x+1],u[x+2],u[x+3])}w[t]=l;u.splice(x,2,v[0],v[1],v[2],v[3]);x+=6;break;case l:x+=6;break}}this._hasQuads=false}},closePath:function(){this.dataTypes.push(k);this.curX=this.lastMoveToX;this.curY=this.lastMoveToY;return this},_safeMoveTo:function(p,u,t){if(t===true){p+=this.curX;u+=this.curY}this.dataTypes.push(h);this.dataValues.push(p,u);this.curX=p;this.curY=u;this.lastMoveToX=p;this.lastMoveToY=u;this.lastQuadCtrlX=p;this.lastQuadCtrlY=u;this.lastCubicCtrlX=p;this.lastCubicCtrlY=u;return this},_safeLineTo:function(p,u,t){if(t===true){p+=this.curX;u+=this.curY}this.dataTypes.push(o);this.dataValues.push(p,u);this.curX=p;this.curY=u;this.lastQuadCtrlX=p;this.lastQuadCtrlY=u;this.lastCubicCtrlX=p;this.lastCubicCtrlY=u;return this},_safeHorizontalLineTo:function(p,t){if(t===true){p+=this.curX}return this._safeLineTo(p,this.curY,false)},_safeVerticalLineTo:function(t,p){if(p===true){t+=this.curY}return this._safeLineTo(this.curX,t,false)},_safeQuadTo:function(t,v,p,u,w){if(w===true){t+=this.curX;v+=this.curY;p+=this.curX;u+=this.curY}this.dataTypes.push(j);this.dataValues.push(t,v,p,u);this.curX=p;this.curY=u;this.lastQuadCtrlX=t;this.lastQuadCtrlY=v;this.lastCubicCtrlX=p;this.lastCubicCtrlY=u;this._hasQuads=true;return this},_safeSmoothQuadTo:function(p,u,w){var t,v;if(w===true){p+=this.curX;u+=this.curY}t=2*this.curX-this.lastQuadCtrlX;v=2*this.curY-this.lastQuadCtrlY;return this._safeQuadTo(t,v,p,u,false)},_safeCurveTo:function(v,x,t,w,p,u,y){if(y===true){v+=this.curX;x+=this.curY;t+=this.curX;w+=this.curY;p+=this.curX;u+=this.curY}this.dataTypes.push(l);this.dataValues.push(v,x,t,w,p,u);this.curX=p;this.curY=u;this.lastQuadCtrlX=p;this.lastQuadCtrlY=u;this.lastCubicCtrlX=t;this.lastCubicCtrlY=w;this._hasCubics=true;return this},_safeSmoothCurveTo:function(t,w,p,v,y){var u,x;if(y===true){t+=this.curX;w+=this.curY;p+=this.curX;v+=this.curY}u=2*this.curX-this.lastCubicCtrlX;x=2*this.curY-this.lastCubicCtrlY;return this._safeCurveTo(u,x,t,w,p,v,false)},_safeArc:function(t,y,u,p,x,w,v){if(v===true){t+=this.curX;y+=this.curY}u=u*q;p=p*q;this._arcImpl(t,y,u,p,x,w);return this},_arcImpl:function(x,w,v,t,u,p){var A,z=0.523598775598,y=0.506145483078356;if(t>v){while(t-v>z){A=v+y;this._smallArcACW(x,w,v,A,u,p);v=A}this._smallArcACW(x,w,v,t,u,p)}else{if(v>t){while(v-t>z){A=v-y;this._smallArcCW(x,w,v,A,u,p);v=A}this._smallArcCW(x,w,v,t,u,p)}}},_smallArcACW:function(z,y,x,u,w,t){var B=w*Math.cos(u),A=t*Math.sin(u),C=Math.tan((u-x)/2),D=u-m,v=B+w*C*Math.cos(D),p=A+t*C*Math.sin(D);this._safeQuadTo(v+z,p+y,B+z,A+y)},_smallArcCW:function(B,A,z,w,y,v){var D=y*Math.cos(w),C=v*Math.sin(w),u=y*Math.cos(z),p=v*Math.sin(z),E=Math.tan((z-w)/2),F=(z-m),x=u+y*E*Math.cos(F),t=p+v*E*Math.sin(F);this._safeQuadTo(x+B,t+A,D+B,C+A)},_safeArcMoveTo:function(p,y,x,w,v,u){var t=x*q;return this._safeMoveTo(p+w*Math.cos(t),y+v*Math.sin(t),u)},_safeArcLineTo:function(p,y,x,w,v,u){var t=x*q;return this._safeLineTo(p+w*Math.cos(t),y+v*Math.sin(t),u)},_countPathCrossings:function(G,F){var E=b.geom,v=this.dataTypes,t=this.dataValues,w=v.length,z,A=0,u=0,p=0,I=0,H=0,D=0,C=false,B;for(B=0;B<w;B++){z=v[B];switch(z){case h:D+=E.crossCloseSegment(u,p,I,H,G,F);I=u=t[A++];H=p=t[A++];break;case o:D+=E.crossLineSegment(u,p,t[A++],t[A++],G,F);u=t[A-2];p=t[A-1];break;case j:D+=E.crossQuadSegment(u,p,t[A++],t[A++],t[A++],t[A++],G,F);u=t[A-2];p=t[A-1];break;case l:D+=E.crossCubicSegment(u,p,t[A++],t[A++],t[A++],t[A++],t[A++],t[A++],G,F);u=t[A-2];p=t[A-1];break;case k:D+=E.crossCloseSegment(u,p,I,H,G,F);u=I;p=H;break}if(u===G&&p===F){D=0;C=true;break}}if(!C){D+=E.crossCloseSegment(u,p,I,H,G,F)}return D},_parseString:function(A,t){var w=0,x,v,y,u,p,z=Number;x=A.trim();x=x.replace(/([mlhvcsqtz])/gi,",$1,");x=x.replace(/\s+/g,",");x=x.replace(/,{2,}/g,",");x=x.replace(/^,|,$/g,"");v=x.split(",");y=v.length;if(t===true){z=function(C){var B=Number(C);if(isNaN(B)===true){c.error("ERR__PATH__MALFORMED_DATA",v.slice(0,w).join(" "))}return B}}while(w<y){u=v[w++];p=false;switch(u){case"m":p=true;case"M":this._safeMoveTo(z(v[w++]),z(v[w++]),p);while(!isNaN(Number(v[w]))&&w<y){this._safeLineTo(z(v[w++]),z(v[w++]),p)}break;case"l":p=true;case"L":do{this._safeLineTo(z(v[w++]),z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"h":p=true;case"H":do{this._safeHorizontalLineTo(z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"v":p=true;case"V":do{this._safeVerticalLineTo(z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"q":p=true;case"Q":do{this._safeQuadTo(z(v[w++]),z(v[w++]),z(v[w++]),z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"t":p=true;case"T":do{this._safeSmoothQuadTo(z(v[w++]),z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"c":p=true;case"C":do{this._safeCurveTo(z(v[w++]),z(v[w++]),z(v[w++]),z(v[w++]),z(v[w++]),z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"s":p=true;case"S":do{this._safeSmoothCurveTo(z(v[w++]),z(v[w++]),z(v[w++]),z(v[w++]),p)}while(!isNaN(Number(v[w]))&&w<y);break;case"a":p=true;case"A":if(t===true){c.error("ERR__PATH__NO_ARCTO")}break;case"z":case"Z":this.closePath();break;default:if(t===true){c.error("ERR__PATH__UNKNOWN_CMD",[u,w])}}}}}});function f(t){var p=t.length-1;return function(){var v=p-1,u=true;do{u=b.isFiniteNumber(arguments[v])}while(v--&&u);if(u){t.apply(this,arguments)}return this}}var n=b.graphics.PathCommands.prototype,i={},e,g;for(g in n){if(g.indexOf("_safe")===0){i[g.charAt(5).toLowerCase()+g.substr(6)]=f(n[g])}}b.mixin(b.graphics.PathCommands,i);function r(t,p){return function(){var u=[];u.push.apply(u,arguments);u[t.length-1]=p;return t.apply(this,u)}}for(g in s){i=s[g];e=n[i];n[g]=r(e,false);n[g.toLowerCase()]=r(e,true);g="_"+g;i="_safe"+i.charAt(0).toUpperCase()+i.substr(1);e=n[i]||e;n[g]=r(e,false);n[g.toLowerCase()]=r(e,true)}})();(function(){var e=b.graphics.AbstractShape.prototype;b.declare({name:"oui.graphics.AbstractPath",isAbstract:true,extend:b.graphics.AbstractShape,membersDef:{onStyleChanged:function(f){if(f===b.TAGS.GEOM){this._flattenedPathCache=undefined}e.onStyleChanged.call(this,f)},_computeCtrlPts:function(h){var g=this.getFlattenedPathCommands(),f=[];if(g!==undefined){f=b.geom.computeConvexHull(h?g._getStrokeCtrlPts(this._style.strokeThickness/2):g.dataValues)}return f},hitTestOnFill:function(h,g){var f=false,i=this.getFlattenedPathCommands();if(i!==undefined&&this._isWithinBounds(h,g)===true){f=i.isPointInPath(h,g,this.getWindingRule())}return f},hitTestOnStroke:function(i,h,g){var f=false,k=this._style.strokeThickness/2,j=this.getFlattenedPathCommands();if(j!==undefined&&this._isWithinBounds(i,h,k)===true){f=j._isPointOnStrokedPath(i,h,k)}return f},getPathCommands:function(){c.warn("WARN__PATH__NO_OVERRIDE")},getFlattenedPathCommands:function(){var f;if(this._flattenedPathCache===undefined){f=this.getPathCommands();if(f!==undefined){this._flattenedPathCache=f.flatten(10)}}return this._flattenedPathCache},getWindingRule:function(){return b.WindingRuleEnum.EVEN_ODD}}})})();(function(){var g=b.graphics.PathTypeEnum,f=g.MOVE_TO,e=g.LINE_TO,h=g.QUAD_TO,i=g.CURVE_TO,j=g.CLOSE;b.mixin(b.graphics.AbstractPath,{_paintSelfToCanvas:function(t,r){var s=this.getPathCommands(),m=s.dataTypes,l=s.dataValues,o=m.length,p=0,q,k;t.beginPath();for(q=0;q<o;q++){switch(m[q]){case f:t.moveTo(l[p++],l[p++]);break;case e:t.lineTo(l[p++],l[p++]);break;case h:t.quadraticCurveTo(l[p++],l[p++],l[p++],l[p++]);break;case i:t.bezierCurveTo(l[p++],l[p++],l[p++],l[p++],l[p++],l[p++]);break;case j:t.closePath();break;default:c.error("ERR__CNV__INV_PATHDATA");break}}k=this._style;if(k.fill!==b.NO_PAINT){this._setCanvasFill(t);t.fill()}if(k.stroke!==b.NO_PAINT){this._setCanvasStroke(t);t.stroke()}}})})();(function(){b.declare({name:"oui.graphics.Path",extend:b.graphics.AbstractPath,jsonDef:{type:"path"},membersDef:{},styleDef:{pathCommands:{type:b.graphics.PathCommands,defaultValue:new b.graphics.PathCommands(),convertor:function(g,f){if(b.isA(g,String)){try{f.value=new b.graphics.PathCommands(g,true);f.validValue=true}catch(h){f.value=h.message;f.validValue=false}}},tag:b.TAGS.GEOM},windingRule:b.defs.Enum(b.WindingRuleEnum,b.WindingRuleEnum.EVEN_ODD,b.TAGS.GEOM)}})})();(function(){var f=b.graphics.AbstractPath.prototype,g=b.TAGS.GEOM,e;e=function(i,h){if(i>h){i=h}return i};b.declare({name:"oui.graphics.HalfRoundedRectangle",extend:b.graphics.AbstractPath,jsonDef:{type:"hrrect"},membersDef:{init:function(h,i){this._d=new b.graphics.PathCommands();f.init.call(this,h,i)},onStyleChanged:function(h){if(h===g){this._updatePath()}f.onStyleChanged.call(this,h)},getPathCommands:function(){return this._d},_onLayoutDirChanged:function(){this._updatePath();f._onLayoutDirChanged.call(this)},_updatePath:function(){var p=this._style,s=p.x,q=p.y,t=p.width,B=p.height,o=p.rx,m=p.ry,z=p.rounded,D=this._d,C=(b.layoutDir===b.LayoutDirEnum.LTR),n=!C,l=(C&&z.topLineBegin)||(n&&z.topLineEnd),i=(C&&z.topLineEnd)||(n&&z.topLineBegin),j=(C&&z.bottomLineBegin)||(n&&z.bottomLineEnd),E=(C&&z.bottomLineEnd)||(n&&z.bottomLineBegin),k=e(o,(l&&i)?t/2:t),A=e(m,(l&&j)?B/2:B),v=e(o,(j&&E)?t/2:t),u=e(m,(i&&E)?B/2:B);D.resetPath();if(l){D._M(s,q+A)._Q(s,q,s+k,q)}else{D._M(s,q)}if(i){D._L(s+t-k,q)._Q(s+t,q,s+t,q+u)}else{D._L(s+t,q)}if(E){D._L(s+t,q+B-u)._Q(s+t,q+B,s+t-v,q+B)}else{D._L(s+t,q+B)}if(j){D._L(s+v,q+B)._Q(s,q+B,s,q+B-A)}else{D._L(s,q+B)}D._Z()},hitTestOnFill:function(i,M){var I=this._style,z=i,v=M,B=I.width,H=I.height,t=I.rx,q=I.ry,p=I.x,E=I.y,u=E+H,K=p+B,A=false,F,J,s,o,k,j,L,m,G,D,C,n,l;if(z>=p&&z<=K&&v>=E&&v<=u){F=I.rounded;J=(b.layoutDir===b.LayoutDirEnum.LTR);s=!J;o=(J&&F.topLineBegin)||(s&&F.topLineEnd);k=(J&&F.topLineEnd)||(s&&F.topLineBegin);j=(J&&F.bottomLineBegin)||(s&&F.bottomLineEnd);L=(J&&F.bottomLineEnd)||(s&&F.bottomLineBegin);m=e(t,(o&&k)?B/2:B);G=e(q,(o&&j)?H/2:H);D=e(t,(j&&L)?B/2:B);C=e(q,(k&&L)?H/2:H);if(o&&(z<p+m)&&(v<E+G)){n=p+m;l=E+G;t=m;q=G}else{if(k&&(z>K-m)&&(v<E+C)){n=K-m;l=E+C;t=m;q=C}else{if(L&&(z>K-D)&&(v>u-C)){n=K-D;l=u-C;t=D;q=C}else{if(j&&(z<p+D)&&(v>u-G)){n=p+D;l=u-G;t=D;q=G}}}}if(n!==undefined&&l!==undefined){z=(i-n)/t;v=(M-l)/q;A=((z*z+v*v)<=1)}else{A=true}}return A}},styleDef:{x:b.defs.FiniteNumber(0,g),y:b.defs.FiniteNumber(0,g),width:b.defs.PositiveNumber(0,g),height:b.defs.PositiveNumber(0,g),rx:b.defs.PositiveNumber(10,g),ry:b.defs.PositiveNumber(10,g),rounded:{topLineBegin:b.defs.Boolean(true,g),topLineEnd:b.defs.Boolean(true,g),bottomLineBegin:b.defs.Boolean(false,g),bottomLineEnd:b.defs.Boolean(false,g)}}})})();(function(){var g=b.graphics.AbstractPath.prototype,h=b.TAGS.GEOM,e=b.geom.DEG_TO_RAD,f;f=function(i){if(i<0){i=360+i}return i};b.declare({name:"oui.graphics.DiskSector",extend:b.graphics.AbstractPath,jsonDef:{type:"diskSector"},membersDef:{init:function(i,j){this._d=new b.graphics.PathCommands();g.init.call(this,i,j)},onStyleChanged:function(i){if(i===h){this._updatePath()}g.onStyleChanged.call(this,i)},getPathCommands:function(){return this._d},_updatePath:function(){var j=this._style,n=this._d,i=j.cx,p=j.cy,m=j.minAngle,o=j.maxAngle,l=j.minRadius,k=j.maxRadius;n.resetPath();n._aM(i,p,m,k,k);n._A(i,p,m,o,k,k);if((o-m)<360){n._aL(i,p,o,l,l);if(l>0){n._A(i,p,o,m,l,l)}}else{if(l>0){n._Z();n._aM(i,p,o,l,l);n._A(i,p,o,m,l,l)}}n._Z()},hitTestOnFill:function(n,m){var j=this._style,r=false,q=n-j.cx,p=m-j.cy,o=Math.sqrt(q*q+p*p),k,i;if(o>=j.minRadius&&o<=j.maxRadius){k=j.minAngle;i=j.maxAngle;if(Math.abs(i-k)===360){r=true}else{var l=Math.atan2(p,q)*180/Math.PI;l=(l+360)%360;if(k>i){k=i;i=j.minAngle}if(k<0&&i>=0){k=(k+360)%360;r=(l<=360&&l>=k)||l<=i}else{if(k<0&&i<0){k=(k+360)%360;i=(i+360)%360;r=l>=k&&l<=i}else{k=(k+360)%360;i=(i+360)%360;r=l>=k&&l<=i}}}}return r},getInsideGeomPath:function(M){var N=this._style,W=new b.graphics.PathCommands(),H=M/2,I=N.minAngle,P=N.maxAngle,n=N.minRadius,C=N.maxRadius,q,aa,l,w,u,v,B,U,k,K,R,Q,A,r,J,D,O,j,i,m,z,E,X,V,T,S,p,o,Z,Y,G,F,L,y,x;if(n>C){n=C;C=N.minRadius}if(I>P){I=N.maxAngle;P=N.minAngle}q=e*(P-I);aa=Math.cos(q/2);l=Math.sin(q);w=N.cx;u=N.cy;v=Math.sin(e*I);B=Math.cos(e*I);U=Math.sin(e*P);k=Math.cos(e*P);K=0;if(l!==0){K=M*aa/l}R=e*(I+(P-I)/2);Q=w+K*Math.cos(R);A=u+K*Math.sin(R);r=n-K*aa+H;J=r+C-n-M;D=(J+r)/2;C-=H;n+=H;if(r<J){S={x:Q+r*B,y:A+r*v};T={x:Q+J*B,y:A+J*v};V={x:Q+J*k,y:A+J*U};X={x:Q+r*k,y:A+r*U};i=f(Math.atan2(S.y-u,S.x-w)/e);m=f(Math.atan2(X.y-u,X.x-w)/e);z=f(Math.atan2(T.y-u,T.x-w)/e);E=f(Math.atan2(V.y-u,V.x-w)/e);if(i>m){m+=360}if(z>E){E+=360}if((E-i)<q/e){if((m-i)>q/e){p=(V.x-X.x);o=(V.y-X.y);Z=(S.x-T.x);Y=(S.y-T.y);G=(X.x-T.x);F=(X.y-T.y);L=(p*F-o*G)/(p*Y-o*Z);y=T.x+L*Z;x=T.y+L*Y;W._M(T.x,T.y)._L(y,x)._L(V.x,V.y);W._A(w,u,E,z,C,C);W._Z()}else{if(P-I<360){W._aM(Q,A,P,D,D);W._aL(Q,A,P,J,J);W._A(w,u,E,z,C,C);W._aL(Q,A,I,r,r);if(n>H){W._A(w,u,i,m,n,n)}W._aL(Q,A,P,D,D);W._Z()}else{W._aM(w,u,0,C,C);W._A(w,u,0,360,C,C);if(n>H){W._aM(w,u,360,n,n);W._A(w,u,360,0,n,n)}}}}}return W}},styleDef:{minAngle:b.defs.FiniteNumber(0,h),maxAngle:b.defs.FiniteNumber(360,h),minRadius:b.defs.FinitePositiveNumber(0,h),maxRadius:b.defs.FinitePositiveNumber(100,h),cx:b.defs.Number(0,h),cy:b.defs.Number(0,h)}})})();(function(){var e=b.graphics.AbstractGraphicNode.prototype;b.declare({name:"oui.graphics.Group",extend:b.graphics.AbstractGraphicNode,jsonDef:{type:"group",factory:function(h,j,g,i){var f=new b.graphics.Group(h,h.name);b.load(h.children,f,j,g,i);return f}},membersDef:{onStyleChanged:function(f){if(f===b.TAGS.OPACITY){this.notifyNodeEvent(f)}else{e.onStyleChanged.call(this,f)}},_computeCtrlPts:function(h){var f,i,g;if(h===b._BoundsType.LAYOUT){f=this._computeLayoutCtrlPts(h)}else{f=[];i=this.firstChild;while(i!==null){g=i._transformCtrlPts(i._transformMatrix,h);f.push.apply(f,g);i=i.nextSibling}f=b.geom.computeConvexHull(f);return f}return f},_computeLayoutCtrlPts:function(h){var f=[],i=this.firstChild,g;while(i!==null){if(i._style.layout.isLayoutChild===true){g=i._transformCtrlPts(i._transformMatrix,h);f.push.apply(f,g)}i=i.nextSibling}return b.geom.computeConvexHull(f)},_safeLayout:function(){var f=this.firstChild;while(f!==null){f.layout();f=f.nextSibling}this._positionInLayoutBox()},_hitTest:function(g,j){var f=null,h=this.globalToLocal(g,j),i;if(this._isWithinBounds(h.x,h.y)===true){i=this.lastChild;while(i!==null&&f===null){f=i.hitTest(g,j);i=i.previousSibling}}return f}},styleDef:{opacity:b.defs.NumberInRange([0,1],1,b.TAGS.OPACITY)}})})();(function(){var e=b.graphics.AbstractGraphicNode.prototype;b.mixin(b.graphics.Group,{_isViewableInCanvas:function(){return e._isViewableInCanvas.call(this)&&this.firstChild!==null},_cacheAsOffscreenCanvas:function(){return e._cacheAsOffscreenCanvas.call(this)||this._style.opacity<1},_paintSelfToCanvas:function(f,g){var h=this.firstChild;while(h!==null){h.paintToCanvas(f,g);h=h.nextSibling}},_paintOffscreenToCanvas:function(g,h,f,i){if(this._style.opacity<1){g.globalAlpha=this._style.opacity}e._paintOffscreenToCanvas.call(this,g,h,f,i)}})})();(function(){var e=b.graphics.AbstractGraphicNode.prototype,f=b.TAGS;b.declare({name:"oui.graphics.Image",extend:b.graphics.AbstractGraphicNode,jsonDef:{type:"image"},membersDef:{init:function(g,h){this._srcWidth=0;this._srcHeight=0;this._actualWidth=0;this._actualHeight=0;e.init.call(this,g,h)},onStyleChanged:function(g){if(g===f.SRC){var i=this._style.src,h=false;if(i.startsWith("@cache;")===true){i=i.substr(7);h=true}if(this.prevRequest!==undefined){b.resourcesManager.removeObserver(this.prevRequest,this);delete this.prevRequest}else{if(this.imageLoader!==undefined){this.imageLoader.offComplete(this);delete this.imageLoader}}if(h||b.resourcesManager.hasResource(i)===true){b.resourcesManager.requestResource(i,this);this.prevRequest=i}else{this.imageLoader=new b.utils.ImageLoader();this.imageLoader.onComplete(this);this.imageLoader.load(i)}}else{if(g===f.GEOM){this._updateActualDimensions();this._clearCtrlPts();this.invalidateLayout();this.notifyNodeEvent(g)}else{if(g===f.OPACITY){this.notifyNodeEvent(g)}else{e.onStyleChanged.call(this,g)}}}},resourceUpdate:function(g){this._srcWidth=g.width;this._srcHeight=g.height;this._updateActualDimensions();this._resourceUpdateImpl(g)},handleEvent:function(g){this.resourceUpdate(g)},_resourceUpdateImpl:function(g){},_fixBoundsType:function(){return b._BoundsType.DEFAULT},_computeCtrlPts:function(){var g=this._style;return b.geom.getBoxCtrlPts(g.x,g.y,this._actualWidth,this._actualHeight)},_safeLayout:function(){this._positionInLayoutBox()},toDataURL:function(){var h,g=this._style.src;if(g.startsWith("@cache;")===true){g=g.substr(7)}if(b.resourcesManager.hasResource(g)){h=b.resourcesManager.attemptBase64Encoding(g)}if(h===undefined){h=this._toDataURLImpl()}if(h===undefined){h=g}return h},_toDataURLImpl:function(){},_isValidAppendChild:function(){return false},_updateActualDimensions:function(){var g=this._style,i=g.preserveAspectRatio,m=this._srcWidth,p=this._srcHeight,k=g.width,j=g.height,h=(k===b.AUTO)?m:k,o=(j===b.AUTO)?p:j,n,l;n=m>0?h/m:1;l=p>0?o/p:1;if(i===b.PreserveAspectRatioEnum.MIN){if(n<l){if(m>0){o=p*n}}else{if(p>0){h=m*l}}}else{if(i===b.PreserveAspectRatioEnum.MAX){if(n<l){if(p>0){h=m*l}}else{if(m>0){o=p*n}}}}if(this._actualWidth!==h||this._actualHeight!==o){this._actualWidth=h;this._actualHeight=o;this._clearCtrlPts();this.invalidateLayout()}}},styleDef:{src:{type:String,constraint:b.isStringNotEmpty,defaultValue:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAEklEQVR4nGNgGAWjYBSMAggAAAQQAAFVN1rQAAAAAElFTkSuQmCC",tag:f.SRC},x:b.defs.FiniteNumber(0,f.GEOM),y:b.defs.FiniteNumber(0,f.GEOM),width:b.defs.Size(b.AUTO,f.GEOM),height:b.defs.Size(b.AUTO,f.GEOM),opacity:b.defs.NumberInRange([0,1],1,f.OPACITY),preserveAspectRatio:b.defs.Enum(b.PreserveAspectRatioEnum,b.PreserveAspectRatioEnum.NONE,f.GEOM)}})})();(function(){b.mixin(b.graphics.Image,{_resourceUpdateImpl:function(e){this.canvasImage=e.data;this._clearOffscreenCanvasCache(true);b.tree.markCanvasAsDirty()},_toDataURLImpl:function(){var i,g,f;if(this.canvasImage!==undefined){g=b.tree.createOffscreenCanvas(this._srcWidth,this._srcHeight);f=g.getContext("2d");f.drawImage(this.canvasImage,0,0);try{i=g.toDataURL()}catch(h){c.warn(h);i=undefined}b.tree.disposeOffscreenCanvas(g)}return i},_paintSelfToCanvas:function(e,f){var g;if(this.canvasImage!==undefined){g=this._style;if(g.opacity<1){e.globalAlpha=g.opacity}e.drawImage(this.canvasImage,g.x,g.y,this._actualWidth,this._actualHeight)}}})})();(function(){var e=b.TAGS.GEOM;b.declare({name:"oui.graphics.Line",extend:b.graphics.AbstractShape,jsonDef:{type:"line"},membersDef:{_computeCtrlPts:function(j){var h=[],i=this._style,g=i.x1,f=i.x2,m=i.y1,k=i.y2,p=i.strokeThickness,r=i.strokeLineCap,q,o,n,l;if(j){n=p/2;if(r===b.LineCapEnum.SQUARE){l=Math.atan2(k-m,f-g);q=n*Math.cos(l);o=n*Math.sin(l);g-=q;f+=q;m-=o;k+=o}q=f-g;o=k-m;if(r!==b.LineCapEnum.ROUND){if(q!==0||o!==0){n=n/Math.sqrt(q*q+o*o);q=q*n;o=o*n;h.push(g-o,m+q,f-o,k+q,f+o,k-q,g+o,m-q)}else{if(r===b.LineCapEnum.SQUARE){h.push(g-n,m-n,g+n,m-n,g+n,m+n,g-n,m+n)}else{if(r===b.LineCapEnum.BUTT){h.push(g,m)}}}}else{h.push(g-n,m-n,g+n,m+n,g+n,m+n,g+n,m-n,f-n,k-n,f+n,k+n,f+n,k+n,f+n,k-n)}}else{h.push(g,m);if(g!==f||m!==k){h.push(f,k)}}return h},hitTestOnStroke:function(j,i,p){var q=j,m=i,g=this._style,s=g.strokeLineCap,k=g.strokeThickness/2,r=k*k,h=g.x1,o=g.y1,f=g.x2,l=g.y2,v=false,n,u,t;if(s===b.LineCapEnum.SQUARE){n=Math.atan2(l-o,f-h);u=k*Math.cos(n);t=k*Math.sin(n);h-=u;f+=u;o-=t;l+=t}v=b.geom.ptSegDistSq(h,o,f,l,q,m)<=r;if(s!==b.LineCapEnum.ROUND){v=v&&b.geom.dotprod(f-h,l-o,q-h,m-o)>=0&&b.geom.dotprod(f-h,l-o,f-q,l-m)>=0}return v}},styleDef:{x1:b.defs.FiniteNumber(0,e),y1:b.defs.FiniteNumber(0,e),x2:b.defs.FiniteNumber(0,e),y2:b.defs.FiniteNumber(0,e)}})})();(function(){b.mixin(b.graphics.Line,{_paintSelfToCanvas:function(e,f){var g=this._style;if(g.stroke!==b.NO_PAINT){this._setCanvasStroke(e);e.beginPath();e.moveTo(g.x1,g.y1);e.lineTo(g.x2,g.y2);e.stroke()}}})})();(function(){var e=b.geom.isPointInEllipse,f=(Math.sqrt(2)-1)/2,g=b.TAGS.GEOM;b.declare({name:"oui.graphics.Ellipse",extend:b.graphics.AbstractShape,jsonDef:{type:"ellipse"},membersDef:{_computeCtrlPts:function(o){var k=[],l=this._style,n=l.cx,m=l.cy,i=l.width,r=l.height,p,h,j,q,t,s;if(o){i+=l.strokeThickness;r+=l.strokeThickness}p=m-r/2;h=m+r/2;j=n-i/2;q=n+i/2;if(i===0&&r===0){k.push(n,m)}else{if(i===0){k.push(n,p);k.push(n,h)}else{if(r===0){k.push(j,m);k.push(q,m)}else{t=i*f;s=r*f;k.push(j,m-s,n-t,p,n+t,p,q,m-s,q,m+s,n+t,h,n-t,h,j,m+s)}}}return k},hitTestOnFill:function(i,h){var j=this._style;return e(i,h,j.cx,j.cy,j.width/2,j.height/2)},hitTestOnStroke:function(m,l,p){var i=this._style,q=m,o=l,n=i.cx,k=i.cy,j=i.width/2,h=i.height/2,r=i.strokeThickness/2;p=(p===false)?false:true;return e(q,o,n,k,j+r,h+r)&&!(p&&e(q,o,n,k,j-r,h-r))}},styleDef:{cx:b.defs.FiniteNumber(0,g),cy:b.defs.FiniteNumber(0,g),width:b.defs.FinitePositiveNumber(0,g),height:b.defs.FinitePositiveNumber(0,g)}})})();(function(){var f=new b.graphics.PathCommands();var g=new b.graphics.Path({pathCommands:f});var e=2*Math.PI;b.mixin(b.graphics.Ellipse,{_paintSelfToCanvas:function(n,i){var j=this._style,h=j.cx,m=j.cy,l=j.width/2,k=j.height/2;if(l===k){n.beginPath();n.arc(h,m,l,0,e,false);n.closePath();if(j.fill!==b.NO_PAINT){this._setCanvasFill(n);n.fill()}if(j.stroke!==b.NO_PAINT){this._setCanvasStroke(n);n.stroke()}}else{f.resetPath();f._safeMoveTo(h+l,m)._safeArc(h,m,0,360,l,k).closePath();g.onStyleChanged(b.TAGS.GEOM);g.applyStyle(j);g._paintSelfToCanvas(n,i)}}})})();(function(){var f=b.geom.isPointInEllipse,e=b.geom.isPointInTriangle,g=b.TAGS.GEOM;b.declare({name:"oui.graphics.Rectangle",extend:b.graphics.AbstractShape,jsonDef:{type:"rect"},membersDef:{_computeCtrlPts:function(m){var k=this._style,j=k.strokeThickness,i=k.x,n=k.y,l=k.width,h=k.height;if(m){i-=j/2;n-=j/2;l+=j;h+=j}return b.geom.getBoxCtrlPts(i,n,l,h)},hitTestOnFill:function(q,n){var j=this._style,v=q,s=n,o=j.x,w=j.y,u=w+j.height,h=o+j.width,k=j.rx,i=j.ry,p,m,z;z=(v>=o&&v<=h&&s>=w&&s<=u);if(z===true&&k!==0&&i!==0){if(v<o+k){p=o+k}else{if(v>h-k){p=h-k}}if(s<w+i){m=w+i}else{if(s>u-i){m=u-i}}if(p!==undefined&&m!==undefined){z=f(v,s,p,m,k,i)}}return z},hitTestOnStroke:function(h,J,I){var u=false,q=h,o=J,D=this._style,H=D.strokeThickness/2,B=D.x,v=D.y,G=v+D.height,w=B+D.width,m=D.rx,k=D.ry,F=(m!==0&&k!==0),n=D.strokeLineJoin,j,i,A=(F&&m>H)?m:H,z=(F&&k>H)?k:H;I=(I===false)?false:true;u=(q>=B-H&&q<=w+H&&o>=v-H&&o<=G+H);u=u&&!(I&&((q>=B+A&&q<=w-A&&o>=v+H&&o<=G-H)||(F&&q>=B+H&&q<=w-H&&o>=v+z&&o<=G-z)));if(u){if(F||n===b.LineJoinEnum.ROUND){if(q<B+m){j=B+m}else{if(q>w-m){j=w-m}}if(o<v+k){i=v+k}else{if(o>G-k){i=G-k}}if(j!==undefined&&i!==undefined){u=f(q,o,j,i,m+H,k+H);if(u&&I&&F&&m>H&&k>H){u=!f(q,o,j,i,m-H,k-H)}}}else{if(n===b.LineJoinEnum.BEVEL){var s,p,E,C;if(q<B){s=B-H;E=B;j=B}else{if(q>w){s=w+H;E=w;j=w}}if(o<v){p=v;C=v-H;i=v}else{if(o>G){p=G;C=G+H;i=G}}if(j!==undefined&&i!==undefined){u=e(q,o,s,p,E,C,j,i)}}}}return u}},styleDef:{x:b.defs.FiniteNumber(0,g),y:b.defs.FiniteNumber(0,g),width:b.defs.FinitePositiveNumber(0,g),height:b.defs.FinitePositiveNumber(0,g),rx:b.defs.FinitePositiveNumber(0,g),ry:b.defs.FinitePositiveNumber(0,g)}})})();(function(){var e=new b.graphics.HalfRoundedRectangle({rounded:{topLineBegin:true,topLineEnd:true,bottomLineBegin:true,bottomLineEnd:true}});b.mixin(b.graphics.Rectangle,{_paintSelfToCanvas:function(f,g){var h=this._style;if(h.rx===0&&h.ry===0){if(h.fill!==b.NO_PAINT){this._setCanvasFill(f);f.fillRect(h.x,h.y,h.width,h.height)}if(h.stroke!==b.NO_PAINT){this._setCanvasStroke(f);f.strokeRect(h.x,h.y,h.width,h.height)}}else{e.applyStyle(h);e._paintSelfToCanvas(f)}}})})();(function(){var e=b.TAGS.GEOM;b.declare({name:"oui.graphics.Text",extend:b.graphics.AbstractShape,jsonDef:{type:"text"},membersDef:{_computeCtrlPts:function(){var h=this._style,i,l,k,j,g,f;if(h.textValue.length>0){f=this.getVisualBoundsImpl();if(f===null||f===undefined){j=h.fontSize*h.textValue.length/2;g=h.fontSize;l=h.x;if(h.textAlign===b.TextAlignEnum.CENTER){l-=j/2}else{if((b.layoutDir===b.LayoutDirEnum.LTR&&h.textAlign===b.TextAlignEnum.LINE_END)||(b.layoutDir===b.LayoutDirEnum.RTL&&h.textAlign===b.TextAlignEnum.LINE_BEGIN)){l-=j}}k=h.y-g}else{j=f.width;g=f.height;l=f.x;k=f.y}i=b.geom.getBoxCtrlPts(l,k,j,g)}else{i=[h.x,h.y]}return i},hitTestOnFill:function(g,f){return this._isWithinBounds(g,f)},getBaselineYAnchor:function(){var g=this._style,f=g.layout.yAnchor,h=this.getVisualBoundsImpl();if(h!==undefined&&h!==null){f=(g.y-h.y)/h.height}return f},_getXAlignOffset:function(h){var g=0,f=(b.layoutDir===b.LayoutDirEnum.LTR);switch(this._style.textAlign){case b.TextAlignEnum.LINE_BEGIN:g=f?0:-h;break;case b.TextAlignEnum.CENTER:g=-h/2;break;case b.TextAlignEnum.LINE_END:g=f?-h:0;break;case b.TextAlignEnum.JUSTIFY:c.warn("WARN__TEXT__NO_JUSTIFY");break;default:break}return g},_fontNameNeedsQuotes:function(f){f=f.toLowerCase();return f.indexOf(" ")>=0&&f[0]!=="'"&&f!==b.GENERIC_FONTS.SERIF&&f!==b.GENERIC_FONTS.SANS_SERIF&&f!==b.GENERIC_FONTS.CURSIVE&&f!==b.GENERIC_FONTS.MONOSPACE},_getCSSFontFamily:function(h){var f=this._style.fontFamily,j,l,g,k;f=f.replace(/\s+/g," ").replace(/\s*,\s*/g,",").replace(/"/g,"'").trim();if(f.indexOf(",")>0){if(h===true){l=f.split(",");for(g=0,k=l.length;g<k;g++){if(this._fontNameNeedsQuotes(l[g])===true){l[g]="'"+l[g]+"'"}}f=l.join(",")}}else{j=f.replace(/'/g,"").toLowerCase();if(b.cssFonts.hasOwnProperty(j)){f=b.cssFonts[j]}else{if(h===true&&this._fontNameNeedsQuotes(f)===true){f="'"+f+"'"}}}if(h!==true){f=f.replace(/'/g,"")}return f},getVisualBoundsImpl:function(){return null}},styleDef:{textValue:b.defs.String("",e),x:b.defs.FiniteNumber(0,e),y:b.defs.FiniteNumber(0,e),fontFamily:b.defs.String("Verdana",e),fontSize:b.defs.FinitePositiveNumber(12,e),fontWeight:b.defs.Enum(b.FontWeightEnum,b.FontWeightEnum.NORMAL,e),fontStyle:b.defs.Enum(b.FontStyleEnum,b.FontStyleEnum.NORMAL,e),underline:b.defs.Boolean(false,e),textAlign:b.defs.Enum(b.TextAlignEnum,b.TextAlignEnum.LINE_BEGIN,e)}})})();(function(){var e=b.graphics.AbstractShape.prototype;b.mixin(b.graphics.Text,{_paintSelfToCanvas:function(f,g){var h=this._style,i;if(h.fill!==b.NO_PAINT){this._setCanvasFill(f);f.font=this.getCanvasFont();i=this._canvasVisualBounds;f.fillText(h.textValue,i.x,h.y)}},getCanvasVisualBounds:function(){var g=this._style,f=b.tree.context2d,h,j,i;f.font=this.getCanvasFont();h=f.measureText(g.textValue);j=h.width;i=g.fontSize;return{x:g.x+this._getXAlignOffset(j),y:g.y-i,width:j,height:i}},notifyNodeEventImpl:function(f,g){if(f===b.TAGS.GEOM){this._cacheCanvasFont();this._canvasVisualBounds=this.getCanvasVisualBounds()}else{if(f===b.TAGS.LAYOUT_DIR){this._canvasVisualBounds=this.getCanvasVisualBounds()}}e.notifyNodeEventImpl.call(this,f,g)},getCanvasFont:function(){if(this._canvasFont===undefined){this._cacheCanvasFont()}return this._canvasFont},_cacheCanvasFont:function(){var g=this._style,f="";if(g.fontStyle===b.FontStyleEnum.ITALIC){f+="italic "}if(g.fontWeight===b.FontWeightEnum.BOLD){f+="bold "}f+=g.fontSize+"px "+this._getCSSFontFamily(true);this._canvasFont=f}})})();(function(){b.declare({name:"oui.graphics.TextBlock",extend:b.graphics.Text,jsonDef:{type:"textBlock"},membersDef:{convertToText:function(){var m=[],f=new b.text.LineBreakMeasurer(this),l=this._breakText(f),o=l.length,n,e,h=this._style,g=h.y,k=h.x,j;for(j=0;j<o;j++){e=l[j];if(j!==0){g+=e.leading+e.ascent}n=new b.graphics.Text(h);n.applyStyle({textValue:e.textValue,x:k+this._getXAlignOffset(e.lineWidth),y:g});m.push(n);g+=e.descent}return m},_breakText:function(e){var f=this._style,g=f.textValue,n=f.maxWidth,k=f.maxLines,h=f.autoTooltip,j=f.useEllipsis,l=f.ellipsis,m=false,p=[],o=e.getTextLength(),i;e.replaceText(0,o,g);if(j===true){o=e.getTextLength();i=this._fitText(e,p,n,k,true);while(i>=1&&i<o){e.replaceText(i-1,o,l);o=e.getTextLength();i=this._fitText(e,p,n,k,true)}m=(i!==g.length)}else{this._fitText(e,p,n,k,false)}if(h===true&&m===true){this.setTooltip(g)}else{this.setTooltip(null)}return p},_fitText:function(j,g,i,h,k){var f=0,e=0,l=j.nextLine(i);g.length=0;while(l!==null){g.push(l);f++;e=l.textBlockEndIndex;if(f===h||(k&&l.lastWordTruncated)){break}l=j.nextLine(i)}return e}},styleDef:{maxWidth:b.defs.PositiveNumber(Number.POSITIVE_INFINITY,b.TAGS.GEOM),maxLines:b.defs.NumberInRange([1,Number.POSITIVE_INFINITY],Number.POSITIVE_INFINITY,b.TAGS.GEOM),useEllipsis:b.defs.Boolean(false),ellipsis:b.defs.Char("\u2026"),autoTooltip:b.defs.Boolean(false)}})})();(function(){b.mixin(b.graphics.TextBlock,{_paintSelfToCanvas:function(k,l){var g=this._style,m,o,j,f,h,e;if(g.fill!==b.NO_PAINT){this._setCanvasFill(k);k.font=this.getCanvasFont();m=this._canvasTextLines;j=g.x;f=g.y;for(h=0,e=m.length;h<e;h++){o=m[h];j=g.x+this._getXAlignOffset(o.lineWidth);if(h!==0){f+=m[h-1].descent+o.leading+o.ascent}k.fillText(o.textValue,j,f)}}},getCanvasVisualBounds:function(){var g=this._style,f=new b.text.LineBreakMeasurer(this),m=this._breakText(f),e=m.length,k=0,l=0,j=0,n,h;for(h=0;h<e;h++){n=m[h];k=Math.max(k,n.lineWidth);l+=n.lineHeight+n.leading}if(e>0){j=m[0].lineHeight}return{x:g.x+this._getXAlignOffset(k),y:g.y-j,width:k,height:l}},notifyNodeEventImpl:function(e,g){var f;if(e===b.TAGS.GEOM||e===b.TAGS.LAYOUT_DIR){this._cacheCanvasFont();f=new b.text.LineBreakMeasurer(this);this._canvasTextLines=this._breakText(f)}b.graphics.AbstractShape.prototype.notifyNodeEventImpl.call(this,e,g)}})})();(function(){var e=b.graphics.Group.prototype;var f="background";b.declare({name:"oui.layout.AbstractLayoutBox",isAbstract:true,extend:b.graphics.Group,membersDef:{_computeLayoutCtrlPts:function(){var g=this._box;return b.geom.getBoxCtrlPts(g.x,g.y,g.width,g.height)},invalidateLayout:function(){var g;if(this._layingOut!==true&&this._layoutDirty!==true){g=(this._background===undefined)?this.firstChild:this._background.nextSibling;this.invalidateLayout=function(){};while(g!==null){if((g.getLayoutHWeight()!==0)||(g.getLayoutVWeight()!==0)){g.invalidateLayout()}g=g.nextSibling}this.invalidateLayout=arguments.callee;e.invalidateLayout.call(this)}},_getLayoutInformation:function(){var j,g,h,o,l,i,m,p,k,n;j={maxChildWidth:0,maxChildHeight:0,maxLayoutWidth:Number.MAX_VALUE,maxLayoutHeight:Number.MAX_VALUE,totalChildWidth:0,totalChildHeight:0,totalChildHWeight:0,totalChildVWeight:0,children:[],spacingsCount:0};h=(this._background===undefined)?this.firstChild:this._background.nextSibling;while(h!==null){o=h._style;l=h.getPreferredLayoutBox();i=o.layout.hWeight;m=o.layout.vWeight;n=o.display;j.totalChildWidth+=l.width;j.totalChildHWeight+=i;j.totalChildHeight+=l.height;j.totalChildVWeight+=m;if(l.height>j.maxChildHeight){j.maxChildHeight=l.height}if(l.width>j.maxChildWidth){j.maxChildWidth=l.width}j.children.push({node:h,layoutBox:l,hWeight:i,vWeight:m,needSpace:n});if(n){j.spacingsCount++}h=h.nextSibling}if(j.spacingsCount>0){j.spacingsCount--}g=this._layoutBox;if(g!==undefined){if(j.maxChildHeight>g.height){j.maxChildHeight=g.height}if(j.maxChildWidth>g.width){j.maxChildWidth=g.width}j.maxLayoutWidth=g.width;j.maxLayoutHeight=g.height}p=this._style.layout.preferredWidth;k=this._style.layout.preferredHeight;if(p>=0&&j.maxLayoutWidth>p){j.maxLayoutWidth=p}if(k>=0&&j.maxLayoutHeight>k){j.maxLayoutHeight=k}return j},onStyleChanged:function(g){if(g===f){this._updateBackground()}else{e.onStyleChanged.call(this,g)}},_updateBackground:function(){var g=this._style,h={fill:g.background};if(this._background===undefined){this._background=new b.graphics.Rectangle(h);this.insertBefore(this._background,this.firstChild)}else{this._background.applyStyle(h)}},getFirstContentChild:function(){var g;if(this._background===undefined){g=this.firstChild}else{g=this._background.nextSibling}return g},hasBackground:function(){return(this._background!==undefined)}},styleDef:{background:b.defs.Paint(b.NO_PAINT,f)}})})();(function(){var m=b.LayoutDirEnum.LTR,g=b.LayoutDirEnum.RTL,h=b.OrientationEnum.VERTICAL,f=b.OrientationEnum.HORIZONTAL,o=b.DirectionEnum.UP,n=b.DirectionEnum.DOWN,e=b.DirectionEnum.LEFT,l=b.DirectionEnum.RIGHT,j=b.DirectionEnum.TO_LINE_BEGIN,k=b.DirectionEnum.TO_LINE_END,i=b.TAGS.LAYOUT;b.declare({name:"oui.layout.FlowBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"flowbox",factory:function(r,t,q,s){var p=new b.layout.FlowBox(r,r.name);b.load(r.children,p,t,q,s);return p}},membersDef:{_safeLayout:function(){var p=this._style.orientation;if(p===f){this._hFlowLayout()}else{this._vFlowLayout()}if(this._background!==undefined){this._background.applyStyle(this._box)}this._positionInLayoutBox()},_vFlowLayout:function(){var p=this._style,r=0,q=0,y=[],B=0,D=p.wrapLength,x=p.hSpacing,E=p.vSpacing,A,s=this.firstChild,v=0,u=0,C=1,t=0,z=0,w=1;if(this._isRTLLayout()===true){t=1;C=-1}if(p.vDirection===o){z=1;w=-1}while(s!==null){A=s.getPreferredLayoutBox();if(w*q+A.height>D){this._layoutColumn(y,B,t*C*B);if(v>0){v+=x}v+=B;q=0;r+=C*(B+x);y=[];B=0}y.push({node:s,x:r,y:q+z*w*A.height,width:A.width,height:A.height});if(B<A.width){B=A.width}if(w*q+A.height>u){u=w*q+A.height}q+=w*(A.height+(s._style.display?E:0));s=s.nextSibling}if(y.length>0){this._layoutColumn(y,B,t*C*B);if(v>0){v+=x}v+=B}this._box={x:t*C*v,y:z*w*u,width:v,height:u}},_layoutColumn:function(p,s,r){var q,u,t;for(q=0,u=p.length;q<u;q++){t=p[q];t.node.setLayoutBox(t.x+r,t.y,s,t.height)}},_hFlowLayout:function(){var p=this._style,r=0,q=0,u=[],A=0,D=p.wrapLength,w=p.hSpacing,E=p.vSpacing,z,s=this.firstChild,x=0,C=0,B=1,t=0,y=0,v=1;if(this._isRTLLayout()===true){t=1;B=-1}if(p.vDirection===o){y=1;v=-1}while(s!==null){z=s.getPreferredLayoutBox();if(B*r+z.width>D){this._layoutRow(u,A,y*v*A);if(x>0){x+=E}x+=A;r=0;q+=v*(A+E);u=[];A=0}u.push({node:s,x:r+t*B*z.width,y:q,width:z.width,height:z.height});if(A<z.height){A=z.height}if(B*r+z.width>C){C=B*r+z.width}r+=B*(z.width+(s._style.display?w:0));s=s.nextSibling}if(u.length>0){this._layoutRow(u,A,y*v*A);if(x>0){x+=E}x+=A}this._box={x:t*B*C,y:y*v*x,width:C,height:x}},_layoutRow:function(s,q,r){var p,u,t=s.length;for(p=0;p<t;p++){u=s[p];u.node.setLayoutBox(u.x,u.y+r,u.width,q)}},_isRTLLayout:function(){var p=this._style.hDirection;return p===e||(p===j&&b.layoutDir===m)||(p===k&&b.layoutDir===g)}},styleDef:{orientation:b.defs.Enum(b.OrientationEnum,h,i),wrapLength:b.defs.PositiveNumber(100,i),hDirection:{type:[e,l,j,k],defaultValue:k,tag:i},vDirection:{type:[o,n],defaultValue:n,tag:i},hSpacing:b.defs.FinitePositiveNumber(5,i),vSpacing:b.defs.FinitePositiveNumber(5,i)}})})();(function(){var f=b.LayoutDirEnum.LTR,j=b.LayoutDirEnum.RTL,g=b.DirectionEnum.LEFT,h=b.DirectionEnum.RIGHT,k=b.DirectionEnum.TO_LINE_BEGIN,e=b.DirectionEnum.TO_LINE_END,i=b.TAGS.LAYOUT;b.declare({name:"oui.layout.HBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"hbox",factory:function(m,p,l,o){var n=new b.layout.HBox(m,m.name);b.load(m.children,n,p,l,o);return n}},membersDef:{_safeLayout:function(){var x,z,r,l,D,n,t,A,o,v,B,u=this._style,p=0,C=0,y,s=1,m=0,w=u.direction,q=u.spacing;z=this._getLayoutInformation();l=z.maxChildHeight;if(z.maxLayoutHeight!==Number.MAX_VALUE&&((z.totalChildVWeight!==0)||(z.maxLayoutHeight<z.maxChildHeight))){l=z.maxLayoutHeight}o=z.maxLayoutWidth;r=z.children;v=0;D=o;n=r.length;C=z.maxLayoutWidth-z.totalChildWidth-z.spacingsCount*q;if(C<0||z.maxLayoutWidth===Number.MAX_VALUE){C=0}y=z.totalChildHWeight;if(y===0){y=1}if(w===g||(w===k&&b.layoutDir===f)||(w===e&&b.layoutDir===j)){m=1;s=-1}for(B=0;B<n;B++){t=r[B];A=t.node;x=t.layoutBox.width+C*t.hWeight/y;if(x>o){x=o}A.setLayoutBox(v+m*s*x,0,x,l);p=s*v+x;v+=s*(x+(t.needSpace?q:0));if(s*v>D){v=s*D}o=z.maxLayoutWidth-s*v;if(o<0){o=0}}this._box={x:m*s*p,y:0,width:p,height:l};if(this._background!==undefined){this._background.applyStyle(this._box)}this._positionInLayoutBox()}},styleDef:{spacing:b.defs.FinitePositiveNumber(5,i),direction:{type:[g,h,k,e],defaultValue:e,tag:i}}})})();(function(){var e=b.DirectionEnum.UP,f=b.DirectionEnum.DOWN,g=b.TAGS.LAYOUT;b.declare({name:"oui.layout.VBox",extend:b.layout.AbstractLayoutBox,jsonDef:{type:"vbox",factory:function(i,l,h,k){var j=new b.layout.VBox(i,i.name);b.load(i.children,j,l,h,k);return j}},membersDef:{_safeLayout:function(){var o,t,l,m,y,h,n,u,x,q,v,p=this._style,z=0,s=0,j,w=0,r=1,k=p.spacing;t=this._getLayoutInformation();m=t.maxChildWidth;if(t.maxLayoutWidth!==Number.MAX_VALUE&&((t.totalChildHWeight!==0)||(t.maxLayoutWidth<t.maxChildWidth))){m=t.maxLayoutWidth}x=t.maxLayoutHeight;l=t.children;q=0;y=x;h=l.length;s=t.maxLayoutHeight-t.totalChildHeight-t.spacingsCount*k;if(s<0||t.maxLayoutHeight===Number.MAX_VALUE){s=0}j=t.totalChildVWeight;if(j===0){j=1}if(p.direction===e){w=1;r=-1}for(v=0;v<h;v++){n=l[v];u=n.node;o=n.layoutBox.height+s*n.vWeight/j;if(o>x){o=x}u.setLayoutBox(0,q+w*r*o,m,o);z=r*q+o;q+=r*(o+(n.needSpace?k:0));if(r*q>y){q=r*y}x=t.maxLayoutHeight-r*q;if(x<0){x=0}}this._box={x:0,y:w*r*z,width:m,height:z};if(this._background!==undefined){this._background.applyStyle(this._box)}this._positionInLayoutBox()}},styleDef:{spacing:b.defs.FinitePositiveNumber(5,g),direction:{type:[e,f],defaultValue:f,tag:g}}})})();(function(){var e=b.graphics.Group.prototype;b.declare({name:"oui.layout.Box",extend:b.graphics.Group,jsonDef:{type:"box",factory:function(g,j,f,i){var h=new b.layout.Box(g,g.name);b.load(g.children,h,j,f,i);return h}},membersDef:{init:function(f,g){e.init.call(this,f,g);this._updateBackground()},onPropertyChanged:function(){this._updateBackground()},_updateBackground:function(){var i=this._style,h=i.border,g=h.rounded,f,j;if((g.topLineBegin===g.topLineEnd&&g.topLineEnd===g.bottomLineBegin&&g.bottomLineBegin===g.bottomLineEnd)){j={stroke:h.stroke,strokeThickness:h.strokeThickness,rx:g.topLineBegin?h.rx:0,ry:g.topLineBegin?h.ry:0,fill:i.background,filter:i.backgroundFilter};if(this._rect===undefined){this._rect=new b.graphics.Rectangle(j)}else{this._rect.applyStyle(j)}f=this._rect}else{j={stroke:h.stroke,strokeThickness:h.strokeThickness,rx:h.rx,ry:h.ry,rounded:h.rounded,fill:i.background,filter:i.backgroundFilter};if(this._hrrect===undefined){this._hrrect=new b.graphics.HalfRoundedRectangle(j)}else{this._hrrect.applyStyle(j)}f=this._hrrect}if(f!==this._background){if(this._background!==undefined){this.removeChild(this._background)}this.insertBefore(f,this.firstChild);this._background=f}},_safeLayout:function(){var k,g=null,j,f,h,i;if(this._layoutBox===undefined){k=this.getPreferredLayoutBox();this.setLayoutBox(0,0,k.width,k.height)}j=this._layoutBox.width;f=this._layoutBox.height;h=this._style.layout.preferredWidth;i=this._style.layout.preferredHeight;if(h>=0&&h<j){j=h}if(i>=0&&i<f){f=i}if(this._background!==undefined){g=this._background.nextSibling;this._background.applyStyle({width:j,height:f})}else{g=this.firstChild}while(g!==null){g.setLayoutBox(0,0,j,f);g=g.nextSibling}this._positionInLayoutBox()},_getContentPreferredLayoutBox:function(){var f=null,h,g={width:0,height:0};if(this._background!==undefined){f=this._background.nextSibling}while(f!==null){h=f.getPreferredLayoutBox();g.width=Math.max(g.width,h.width);g.height=Math.max(g.height,h.height);f=f.nextSibling}return g}},styleDef:{border:{strokeThickness:b.defs.FinitePositiveNumber(1),stroke:b.defs.Paint(b.NO_PAINT),rx:b.defs.PositiveNumber(3),ry:b.defs.PositiveNumber(3),rounded:{topLineBegin:b.defs.Boolean(true),topLineEnd:b.defs.Boolean(true),bottomLineBegin:b.defs.Boolean(false),bottomLineEnd:b.defs.Boolean(false)}},background:b.defs.Paint(b.NO_PAINT),backgroundFilter:b.defs.FilterEffect(b.FiltersEnum.NONE)}})})();(function(){var e=b.graphics.Group.prototype;var f={name:"content",type:"box",children:[{name:"shadow",type:"box",background:b.black,border:{stroke:b.black},styleBinding:{display:function(g){return g.shadow!==null},filter:"@shadow",border:{strokeThickness:"@border.strokeThickness",rx:"@border.rx",ry:"@border.ry",rounded:"@border.rounded"}}},{name:"background",type:"box",styleBinding:{border:"@border",background:"@background"}},{name:"data",type:"box",background:b.NO_PAINT,border:{stroke:b.NO_PAINT},styleBinding:{layout:{padding:"@padding"}},children:[{name:"text",type:"textBlock",useEllipsis:true,autoTooltip:false,styleBinding:{fontFamily:"@text.fontFamily",fontSize:"@text.fontSize",fontWeight:"@text.fontWeight",fill:"@text.fill",maxLines:"@text.maxLines",maxWidth:"#_computeMaxWidth"}},{name:"graphics",type:"group"}]}]};b.declare({name:"oui.tooltip.Tooltip",extend:b.graphics.Group,membersDef:{init:function(g,h){e.init.call(this,g,h);this.isShown=false;this._isTextBased=false;this.content=b.load(f);this.appendChild(this.content);this.onPropertyChanged();this.setPointerSensitivity(false);this._viewportResizeHandler=this.handler("_computeMaxWidth")},setContent:function(g){this.content.data.text.setDisplay(false);this.content.data.graphics.setDisplay(false);if(b.isA(g,String)){this._setTextContent(g)}else{if(b.isA(g,b.graphics.AbstractGraphicNode)){this._setGraphicContent(g)}else{if(b.isA(g,Number)){this._setTextContent(g.toString(10))}else{if(b.isA(g,Date)){this._setTextContent(g.toLocaleString())}}}}},show:function(){this.appendChild(this.content);this.isShown=true},hide:function(){this.isShown=false;if(this.firstChild!==null){this.removeChild(this.content)}},onPropertyChanged:function(){if(this.content!==undefined){this.content.applyStyleBinding(this._style,this)}},_setTextContent:function(g){this.content.data.text.applyStyle({display:true,textValue:g,maxWidth:this._computeMaxWidth()});if(this._isTextBased===false){b.rootNode.addEventListener(b.ViewEvents.VIEWPORT_RESIZE,this._viewportResizeHandler);this._isTextBased=true}},_setGraphicContent:function(h){var g=this.content.data.graphics;g.removeChildren();g.appendChild(h);g.setDisplay(true);if(this._isTextBased===true){b.rootNode.removeEventListener(b.ViewEvents.VIEWPORT_RESIZE,this._viewportResizeHandler);this._isTextBased=false}},_computeMaxWidth:function(){var g,h;g=this._style.padding;h=b.viewportWidth-(g.lineBegin+g.lineEnd);return Math.min(this._style.text.maxWidth,h)}},styleDef:{border:{strokeThickness:b.defs.FinitePositiveNumber(1),stroke:b.defs.Paint(new b.style.Color(204,204,204,255)),rx:b.defs.PositiveNumber(4),ry:b.defs.PositiveNumber(4),rounded:{topLineBegin:b.defs.Boolean(true),topLineEnd:b.defs.Boolean(true),bottomLineBegin:b.defs.Boolean(true),bottomLineEnd:b.defs.Boolean(true)}},background:b.defs.Paint(new b.style.Color(0,0,0,191)),text:{fontFamily:b.defs.String("Trebuchet MS"),fontSize:b.defs.FinitePositiveNumber(11),fontWeight:b.defs.Enum(b.FontWeightEnum,b.FontWeightEnum.NORMAL),fill:b.defs.Paint(b.white),maxLines:b.defs.NumberInRange([1,Number.POSITIVE_INFINITY],Number.POSITIVE_INFINITY),maxWidth:b.defs.PositiveNumber(Number.POSITIVE_INFINITY,b.TAGS.GEOM)},padding:b.defs.Padding(5,5,5,5),shadow:b.defs.ObjectOfType(b.filters.DropShadow,b.filters.DEFAULT_LTR_KNOCKOUT_SHADOW,true)}})})();(function(){b.declare({name:"oui.tooltip.TooltipManager",mixins:[b.lang.PropertiesSupport],membersDef:{events:{SHOW_TOOLTIP:"showTooltip",HIDE_TOOLTIP:"hideTooltip"},init:function(){var f=this,e=b.tree;this._initProperties();this._initCallbacks();this._initMouseListeners();this._style=new this.Style();this._tooltip=new b.tooltip.Tooltip(this._style);this._currentTarget=null;this._currentX=0;this._currentY=0;this._tooltipTarget=null;this._tooltipX=0;this._tooltipY=0;if(e.isPlatformAvailable()){this.enableAutoTooltips()}else{e.addEventListener(e.events.PLATFORM_AVAILABLE,function(){e._initShadowTree(f._tooltip);f.enableAutoTooltips()})}},enableAutoTooltips:function(){b.tree.tooltipLayer.appendChild(this._tooltip);this._tooltip.hide();b.rootNode.onMouseOver(this._mouseOverListener)},disableAutoTooltips:function(){b.tree.tooltipLayer.removeChild(this._tooltip);b.rootNode.offMouseOver(this._mouseOverListener)},applyStyle:function(e){this._tooltip.applyStyle(e)},showTooltip:function(g,f,e,h){this.cancelDismissTooltip();this.cancelHideTooltip();if(f!==this._tooltipContent){this._tooltip.setContent(f)}this._tooltip.show();this._positionTooltipTo(e,h);this.scheduleDismissTooltip();this._tooltipContent=f},hideTooltip:function(){this._tooltip.hide()},_initMouseListeners:function(){var i=this;var g,e,h,f;g=function(j){var k=null;while(j!==null){k=j.getTooltip();if(k===null||k===""){j=j.parentNode}else{break}}return j};e=function(k){var j=g(k.relatedTarget),l=g(k.target);if(l!==null&&l!==j){l.onMouseMove(f);l.onMouseOut(h)}};h=function(j){var k=j.currentTarget,l=g(j.relatedTarget);if(l!==k){i.cancelShowTooltip();i.cancelDismissTooltip();i.scheduleHideTooltip();k.offMouseMove(f);k.offMouseOut(h)}};f=function(j){i._currentTarget=j.currentTarget;i._currentX=j.clientX;i._currentY=j.clientY;i.cancelShowTooltip();i.scheduleShowTooltip()};this._mouseOverListener=e},_initCallbacks:function(){var e=this;this._showTooltipDefaultAction=function(f){var g=f.target.getTooltip();e.showTooltip(f.target,g,f.tooltipX,f.tooltipY)};this._dispatchShowTooltip=function(){e._currentTarget.dispatchEvent({type:e.events.SHOW_TOOLTIP,tooltipX:e._currentX,tooltipY:e._currentY,cancelable:true,defaultAction:e._showTooltipDefaultAction})};this._hideTooltipDefaultAction=function(){e.hideTooltip()};this._dispatchHideTooltip=function(){if(e._currentTarget!==null){e._currentTarget.dispatchEvent({type:e.events.HIDE_TOOLTIP,defaultAction:e._hideTooltipDefaultAction})}}},scheduleShowTooltip:function(){var e=this._properties.showDelay;if(e===0){this._dispatchShowTooltip()}else{this._showTooltipTimeoutID=setTimeout(this._dispatchShowTooltip,e)}},cancelShowTooltip:function(){if(this._showTooltipTimeoutID!==undefined){clearTimeout(this._showTooltipTimeoutID);this._showTooltipTimeoutID=undefined}},scheduleHideTooltip:function(){var e=this._properties.hideDelay;if(e===0){this._dispatchHideTooltip()}else{this._hideTooltipTimeoutID=setTimeout(this._dispatchHideTooltip,e)}},cancelHideTooltip:function(){if(this._hideTooltipTimeoutID!==undefined){clearTimeout(this._hideTooltipTimeoutID);this._hideTooltipTimeoutID=undefined}},scheduleDismissTooltip:function(){var e=this._properties.dismissDelay;if(e===0){this._dispatchHideTooltip()}else{if(isFinite(e)){this._dismissTooltipTimeoutID=setTimeout(this._dispatchHideTooltip,e)}}},cancelDismissTooltip:function(){if(this._dismissTooltipTimeoutID!==undefined){clearTimeout(this._dismissTooltipTimeoutID);this._dismissTooltipTimeoutID=undefined}},_positionTooltipTo:function(e,i){var h=this._properties,f={x:e,y:i},g=undefined;this._tooltip.setTranslation(e+h.cursorOffset,i+h.cursorOffset);g=this._tooltip.getLayoutBounds();f=b.geom.computeBoundedPosition(g,b.viewportBounds,undefined,f);if(f.x!==g.x||f.y!==g.y){this._tooltip.setTranslation(f.x,f.y)}}},propertiesDef:{showDelay:b.defs.FinitePositiveNumber(200),hideDelay:b.defs.FinitePositiveNumber(250),dismissDelay:b.defs.PositiveNumber(5000),cursorOffset:b.defs.Number(12),followCursor:b.defs.Boolean(false)},styleDef:b.tooltip.Tooltip.StyleDefinition})})();(function(){b.declare({name:"oui.io.JSONExporter",membersDef:{init:function(){this._resources={};this._root={type:"group"};this._containerHierarchy=[this._root];this._curContainer=this._root},snapshotNodes:function(p,s,m,o){var r,q,t;if(b.isA(p,Array)===true){for(q=0,t=p.length;q<t;q++){this.captureNode(p[q])}r={type:"snapshot",width:m,height:o,viewBox:b.geom.isValidRect(s)===true?[s.x,s.y,s.width,s.height]:undefined,resources:this._captureResources(),content:this._root}}return r},captureNode:function(m){if(m.jsonNodeExporter!==undefined){m.jsonNodeExporter.captureNode(m,this)}},startNodeExport:function(m){if(this._curContainer.children===undefined){this._curContainer.children=[m]}else{this._curContainer.children.push(m)}this._containerHierarchy.push(m);this._curContainer=m},endNodeExport:function(){var m;this._containerHierarchy.pop();m=this._containerHierarchy.length;this._curContainer=this._containerHierarchy[m-1]},_DEFAULT_RESOURCE_COMPARE:function(n,m){return n===m},getResourceId:function(p,o,t,s){var r=0,m=0,q;if(t===undefined){t=this._DEFAULT_RESOURCE_COMPARE}if(this._resources[o]===undefined){q=[];this._resources[o]=q}else{q=this._resources[o];for(m=0,r=q.length;m<r;m++){if(t(q[m],p)===true){break}}}if(m===r){if(typeof s==="function"){s(p)}q.push(p)}return o.concat(m)},_captureResources:function(){var r=this._resources,m={},o,s,q;for(q in r){if(r.hasOwnProperty(q)===true){m[q]={};for(o=0,s=r[q].length;o<s;o++){m[q][q+o]=this._resourceToJSON(r[q][o])}}}return m},_resourceToJSON:function(n){var m=n;if(b.isA(n.exportValueToJSON,Function)===true){m=n.exportValueToJSON()}return m}}});b.graphics.AbstractGraphicNode.prototype.jsonNodeExporter={exportNode:function(u,o,q){var m,p=u._style,r=u.StyleDefinition.prototype,s=u.jsonExportConfig.styleExporter,t=u.jsonExportConfig.propertiesExporter;for(m in p){if(s.hasOwnProperty(m)){s[m](m,p[m],r[m].defaultValue,o,u,q)}}if(t!==undefined){t(o,u,q)}},captureNode:function(p,o){var m;if(p.shouldCapture()===true){m={type:p.jsonExportConfig.type,__node:p};this.exportNode(p,m,o);o.startNodeExport(m);this.exportChildren(p,o);o.endNodeExport(m)}},exportChildren:function(m,n){var o=m.firstChild;while(o!==null){n.captureNode(o);o=o.nextSibling}}};var f,l,j,h,e,k,g,i;f=function(n,m){n.prototype.exportToJSON=m};l=function(n,m){n.prototype.exportValueToJSON=m};j=function(n,m){var o=n.prototype.jsonExportConfig;n.prototype.jsonExportConfig=m;if(o!==undefined){b.mixin(m.styleExporter,o.styleExporter)}};b.graphics.AbstractGraphicNode.prototype.shouldCapture=function(){return this._style.display===true&&this._style.visibility===true};b.graphics.AbstractPath.prototype.shouldCapture=function(){return this._style.display===true&&this._style.visibility===true&&this.getPathCommands().dataTypes.length>0};h=function(o,r,m,p,s,q){if(r!==m){p[o]=r}};e=function(o,r,m,p,s,q){if(r!==m){p[o]=r.concat()}};k=function(o,r,m,p,s,q){if(r!==m){p[o]=r.exportToJSON(q)}};g=function(r){var o=[],m,q,p,s=r.length;for(p=0;p<s;p++){q=r[p];m=q.getColor();o.push({type:"stop",offset:q.getOffset(),color:m.exportToJSON(),opacity:m.getOpacity()})}return o};i=function(n,m){return n===m||(n._style.color===m._style.color&&n._style.opacity===m._style.opacity&&n._style.radius===m._style.radius&&n._style.angle===m._style.angle&&n._style.offset===m._style.offset&&n._style.knockout===m._style.knockout)};j(b.graphics.AbstractGraphicNode,{styleExporter:{clip:e,transform:function(o,r,m,p,s,q){if(r.isIdentity()===false){p[o]=r.exportToJSON(q)}},filter:function(o,r,m,p,s,q){if(r!==m){s._updateFilterEffect();k(o,s._filterEffect,m,p,s,q)}}}});j(b.graphics.Group,{type:"group",styleExporter:{opacity:h}});j(b.graphics.AbstractShape,{styleExporter:{fill:k,fillOpacity:h,stroke:k,strokeOpacity:h,strokeThickness:h,strokeLineJoin:h,strokeLineCap:h,strokeMiterLimit:h}});j(b.graphics.Ellipse,{type:"ellipse",styleExporter:{cx:h,cy:h,width:h,height:h}});j(b.graphics.Image,{type:"image",styleExporter:{src:function(o,r,m,p,t,q){var s=q.getResourceId({type:"imageResource",src:r},"image_",function(u,n){return u.src===n.src},function(n){n.href=t.toDataURL()});p[o]="#"+s},x:h,y:h,width:h,height:h}});j(b.graphics.Line,{type:"line",styleExporter:{x1:h,y1:h,x2:h,y2:h}});j(b.graphics.AbstractPath,{type:"path",propertiesExporter:function(m,o,n){m.pathCommands=o.getPathCommands().exportToJSON(n)},styleExporter:{}});j(b.graphics.Rectangle,{type:"rect",styleExporter:{x:h,y:h,width:h,height:h,rx:h,ry:h}});j(b.graphics.Text,{type:"text",styleExporter:{x:h,y:h,fontSize:h,fontWeight:h,fontFamily:h,underline:h,textAlign:h,textValue:h}});j(b.graphics.TextBlock,{type:"textBlock",styleExporter:{}});f(b.style.Color,function(){return"#".concat(this.getHexRGBA())});f(b.style.GradientPaint,function(m){return"url(#"+m.getResourceId(this,"gradient_")+")"});f(b.style.NoPaint,function(){return"none"});f(b.filters.AbstractFilter,function(m){return"url(#"+m.getResourceId(this,"filter_")+")"});f(b.filters.DropShadow,function(m){return"url(#"+m.getResourceId(this,"filter_",i)+")"});l(b.style.LinearGradient,function(){var m=this._properties;return{type:"linearGradient",x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,useObjectBoundingBox:m.useObjectBoundingBox,stops:g(m.stops)}});l(b.style.RadialGradient,function(){var m=this._properties;return{type:"radialGradient",cx:m.cx,cy:m.cy,r:m.radius,useObjectBoundingBox:m.useObjectBoundingBox,stops:g(m.stops)}});l(b.filters.DropShadow,function(){var m=this._style;return{type:"dropShadow",color:m.color.getHexRGBA(),opacity:m.opacity,radius:m.radius,angle:m.angle,offset:m.offset,knockout:m.knockout}});l(b.filters.Blur,function(){return{type:"blur",radius:this._style.radius}});f(b.geom.Matrix,function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]});f(b.graphics.PathCommands,function(){return{dataTypes:this.dataTypes.concat(),dataValues:this.dataValues.concat()}})})();(function(){b.ns("oui.io");b.io.XMLConverter={convert:function(e,k){var f,h,g,j;if(typeof e==="string"){k=k.concat(b.xmlSpecialChars(e))}else{k=k.concat("<",e.__type);f=[];for(h in e){if(h!=="children"&&h!=="__type"&&e.hasOwnProperty(h)===true){f.push(" ".concat(h,"='",e[h],"'"))}}if(f.length>0){f.sort();k=String.prototype.concat.apply(k,f)}if(e.children!==undefined){k=k.concat(">");j=e.children.length;for(g=0;g<j;g++){k=arguments.callee.call(null,e.children[g],k)}k=k.concat("</"+e.__type+">")}else{k=k.concat(" />")}}return k}}})();(function(){var t,e=3*Math.sqrt(2*Math.PI),u={LTR:{LINE_BEGIN:"start",LINE_END:"end",CENTER:"middle",JUSTIFY:"start"},RTL:{LINE_BEGIN:"end",LINE_END:"start",CENTER:"middle",JUSTIFY:"start"}},r={};function g(x){if(r[x]===undefined){r[x]=0}else{r[x]++}return x+r[x]}function p(x){return x.substring(0,7)}function v(y){var x=y;if(y!==undefined&&y.charAt(0)==="#"){x=p(y)}return x}function o(y){var x=y.substr(7),z=1;if(x!=="FF"){z=parseInt(x,16)/255}return z}function l(y){var x=1;if(y!==undefined&&y.charAt(0)==="#"){x=o(y)}return x}function q(x){return[parseInt(x.substr(0,2),16),parseInt(x.substr(2,2),16),parseInt(x.substr(4,2),16),parseInt(x.substr(6,2),16)]}function j(y,x){if(y!==undefined){if(x.children===undefined){x.children=[]}x.children.push(y)}}function w(x){return(x*4-2)/e}function n(y,x,z){return{__type:"feFunc"+y,type:"linear",slope:x,intercept:z}}function k(y){var z={},x;for(x in y){if(y.hasOwnProperty(x)===true&&x!=="children"&&x!=="type"&&x!=="__node"){z[x]=y[x]}}if(y.hasOwnProperty("type")===true){z.__type=y.type}return z}function s(y){var z=k(y),x=z.color;z["stop-color"]=p(x);delete z.color;z["stop-opacity"]=o(x);return z}function m(y){var A=k(y),z=A.stops,x,B;A.gradientUnits=A.useObjectBoundingBox?"objectBoundingBox":"userSpaceOnUse";delete A.useObjectBoundingBox;delete A.stops;if(z!==undefined){for(x=0,B=z.length;x<B;x++){j(s(z[x]),A)}}return A}function i(x){return{__type:"filter",id:x.id,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[]}}function h(z){var C=k(z),y=C.transform,B=C.clip,A,x;delete C.clip;if(B!==undefined&&B[2]!==-1){x=g("clipPath_");A={__type:"clipPath",id:x,children:[{__type:"rect",x:B[0],y:B[1],width:B[2],height:B[3]}]};C["clip-path"]="url(#"+x+")";j(A,C)}if(y!==undefined){C.transform="matrix("+y.join(",")+")"}return C}function f(z){var A=h(z),D=v(A.fill),E=l(A.fill),x=A.fillOpacity,C=v(A.stroke),y=A.strokeOpacity,B=l(A.stroke);if(x===undefined){x=1}x*=E;if(y===undefined){y=1}y*=B;if(D!==undefined){A.fill=D}if(x!==1){A["fill-opacity"]=x}if(C!==undefined){A.stroke=C}if(y!==1){A["stroke-opacity"]=y}if(A.strokeThickness!==undefined){A["stroke-width"]=A.strokeThickness}if(A.strokeLineJoin!==undefined){A["stroke-linejoin"]=A.strokeLineJoin.toLowerCase()}if(A.strokeLineCap!==undefined){A["stroke-linecap"]=A.strokeLineCap.toLowerCase()}if(A.strokeMiterLimit!==undefined){A["stroke-miter-limit"]=A.strokeMiterLimit}delete A.strokeOpacity;delete A.fillOpacity;delete A.strokeThickness;delete A.strokeLineJoin;delete A.strokeLineCap;delete A.strokeMiterLimit;return A}t={radialGradient:m,linearGradient:m,blur:function(x){var y=i(x);j({__type:"feGaussianBlur","in":"SourceGraphic",stdDeviation:w(x.radius)},y);return y},dropShadow:function(E){var x=i(E),A,y,C,F,D,z,B;y={__type:"feComponentTransfer","in":"SourceAlpha",result:"compTransfer"};j(y,x);A=q(E.color);j(n("R",0,A[0]/255),y);j(n("G",0,A[1]/255),y);j(n("B",0,A[2]/255),y);j(n("A",E.opacity*A[3]/255,0),y);C={__type:"feGaussianBlur","in":"compTransfer",result:"blur",stdDeviation:w(E.radius)};j(C,x);z=E.angle*Math.PI/180;B=E.offset;F={__type:"feOffset","in":"blur",result:"castShadow",dx:B*Math.cos(z),dy:B*Math.sin(z)};j(F,x);D={__type:"feComposite"};if(E.knockout===true){D["in"]="castShadow";D.in2="SourceGraphic";D.operator="out"}else{D["in"]="SourceGraphic";D.in2="castShadow";D.operator="over"}j(D,x);return x},group:function(z){var A=h(z),y=z.children,x,B;A.__type="g";if(y!==undefined){for(x=0,B=y.length;x<B;x++){j(t[y[x].type](y[x]),A)}}else{A=undefined}return A},ellipse:function(y){var A=f(y),z=A.width,x=A.height;A.rx=z/2;A.ry=x/2;delete A.width;delete A.height;return A},image:function(y){var A=h(y),x,z;x={__type:"use","xlink:href":A.src};A.__type="g";z=y.__node.getLocalBounds();if(A.x!==undefined){x.x=A.x}if(A.y!==undefined){x.y=A.y}if(z!==undefined){x.width=z.width;x.height=z.height}A.children=[x];delete A.src;delete A.x;delete A.y;delete A.width;delete A.height;return A},imageResource:function(x){return{__type:"symbol",id:x.id,children:[{__type:"image",width:"100%",height:"100%",preserveAspectRatio:"none","xlink:href":x.href}]}},line:f,path:function(y){var z=f(y),x=z.pathCommands;delete z.pathCommands;if(x!==undefined){z.d=b.graphics.PathCommands.prototype.toString.call(x)}return z},rect:f,text:function(y){var z=f(y),x=b.layoutDir;if(z.fontSize!==undefined){z["font-size"]=z.fontSize}if(z.fontWeight===b.FontWeightEnum.BOLD){z["font-weight"]="bold"}if(z.underline===true){z["text-decoration"]="underline"}delete z.underline;if(z.textAlign!==undefined){z["text-anchor"]=u[x][z.textAlign]}if(z.textValue!==undefined){j(z.textValue,z);delete z.textValue}if(z.fontFamily!==undefined){z["font-family"]=z.fontFamily}z.direction=(x===b.LayoutDirEnum.RTL)?"rtl":"ltr";z["unicode-bidi"]="embed";delete z.fontSize;delete z.fontWeight;delete z.textAlign;delete z.fontFamily;return z},textBlock:function(B){var y=(B.x!==undefined)?B.x:0,D,A,F,C,E,z;delete B.textValue;delete B.x;delete B.y;D=t.text(B);D.__type="text";C=B.__node.convertToText();for(A=0,F=C.length;A<F;A++){E=C[A];z={__type:"tspan",x:y,y:E._style.y};j(E._style.textValue,z);j(z,D)}return D}};b.declare({name:"oui.io.svg.SVGExporter",membersDef:{init:function(){},snapshotNodes:function(z,B,x,y){var A=new b.io.JSONExporter().snapshotNodes(z,B,x,y);r={};return this._toSVG(A)},_getSVGBoilerPlate:function(){return{__type:"svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",stroke:"none",fill:"black","fill-rule":"evenodd","font-size":12,"font-family":"Verdana","text-anchor":u[b.layoutDir].LINE_BEGIN,children:[{__type:"style",type:"text/css",children:["text {stroke: none;}"]}]}},_toSVG:function(H){var G=H.viewBox,B,F,A=H.resources,y=H.content.children,C,z=y.length,x,E,D;D=this._getSVGBoilerPlate();D.width=H.width;D.height=H.height;D.viewBox=G.join(" ");B={__type:"defs"};D.children.push(B);for(F in A){if(A.hasOwnProperty(F)===true){E=A[F];for(x in E){if(E.hasOwnProperty(x)){E[x].id=x;this._toSVGNode(E[x],B)}}}}for(C=0;C<z;C++){this._toSVGNode(y[C],D)}return D},_toSVGNode:function(y,x){var z=t[y.type];if(z!==undefined){j(z(y),x)}}}})})();(function(){b.ns("oui.i18n");b.i18n.I18nSupport={addI18nSupport:function(f,e){f.Resources=e;f.prototype.Resources=e;f.updateResources=b.i18n.I18nSupport.updateResources},updateResources:function(e){var f=this.Resources;if(this.prototype!==undefined&&this.prototype.Resources!==undefined){f=this.prototype.Resources}b.i18n.I18nSupport._updateObject(f,e)},_updateObject:function(g,f,i){if(g!==undefined){if(f===undefined){c.info(i?"INFO__I18N__MISS_PROP":"INFO__I18N__INV_PROP",i)}else{var h,e;for(h in f){if(f.hasOwnProperty(h)&&f[h]!==undefined){e=i!==undefined?i+"."+h:h;if(g[h]===undefined){c.info("INFO__I18N__UNSUPP_PROP",e)}else{if(b.isA(g[h],String)){g[h]=f[h]}else{b.i18n.I18nSupport._updateObject(g[h],f[h],e)}}}}for(h in g){if(g.hasOwnProperty(h)&&(f.hasOwnProperty(h)===false||f[h]===undefined)){e=i!==undefined?i+"."+h:h;c.info("INFO__I18N__MISS_PROP",e)}}}}}};b.addI18nSupport=b.i18n.I18nSupport.addI18nSupport})();(function(){b.ns("oui.net");b.mixin(b.net,{goToURL:function(e,f){c.warn("WARN__NET__UNSUPP")}})})();return b}ouilib={createLiveGraphics:function(b,d){var c={};c.aboutInfo="FortKnox1.0#7812/Canvas (c)2008-2012, Oracle Corp.";if(d!==undefined&&d!==null){c.config=d}a(c);c.setUp(b);return c}}})();var OM=OM||{version:"11.1.1.7.0",build:"_21-DEC-2012_"};OM.$=OM.$||jQuery;OM.layer=OM.layer||{};OM.filter=OM.filter||{};
OM.style=OM.style||{};OM.util=OM.util||{};OM.event=OM.event||{};OM.geometry=OM.geometry||{};OM.universe=OM.universe||{};
OM.visualfilter=OM.visualfilter||{};OM.infowindow=OM.infowindow||{};OM.tool=OM.tool||{};OM.control=OM.control||{};
OM.template=OM.template||{};OM.Class=OM.Class||function(){};(function(){if(OM.Class.extend){return;}var d=false;
var e=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;OM.Class.extend=function(l){var o=this.prototype;
d=true;var n=new this();d=false;if(l.mixin){OM.util.MiscUtil.mixin(n,l.mixin);delete l.mixin;}for(var g in l){n[g]=(typeof l[g]==="function"&&typeof o[g]==="function"&&e.test(l[g]))?(function(q,r){return function(){var t=this._super;
this._super=o[q];var s=r.apply(this,arguments);this._super=t;return s;};})(g,l[g]):l[g];}function m(){if(!d&&this.initialize){this.initialize.apply(this,arguments);
}}m.prototype=n;m.prototype.constructor=m;m.extend=arguments.callee;return m;};}());OM.setJQuery=function(d){OM.$=d;
};(function(){var d=navigator.userAgent.toLowerCase(),q=/webkit/.test(d),e=typeof orientation!=="undefined"?true:false,g=/android/.test(d),m=/chrome/.test(d),n=/firefox/.test(d),r=/(mozilla)(?:.*? rv:([\w.]+))?/.test(d),l=/(opera)(?:.*version)?[ \/]([\w.]+)/.test(d),o=/(msie) ([\w.]+)/.test(d);
OM.browser={msie:o,msie6:o&&!window.XMLHttpRequest,mozilla:r,webkit:q,safari:q,firefox:n,webkit3d:q&&("WebKitCSSMatrix" in window)&&("m11" in new window.WebKitCSSMatrix()),chrome:m,gecko:d.indexOf("gecko")!==-1,opera:l,android:g,mobileWebkit:e&&q,mobileOpera:e&&l,mobile:e,touchSupported:(function(){try{if("ontouchstart" in document.documentElement){return true;
}else{return false;}}catch(s){return false;}}())};}());OM.MapContext=function(g){var e=g.getMapContextToken();
var d={getUniverse:function(){return e.universe;},getPreviousZoomLevel:function(){return e.previousZoomLevel;
},getZoomLevel:function(){return e.zoomLevel;},getPreviousCenterPoint:function(){return e.previousCenterPoint;
},getCenterPoint:function(){return e.centerPoint;},getTransform:function(){if(!e.transform){var s=e.universe.bound;
var r=s.getWidth();var l=s.getHeight();var o={x:s.getMinX(),y:s.getMinY(),w:r,h:l};var t=e.universe.getZoomLevels()[e.zoomLevel];
var n=r/t.resolution;var m=l/t.resolution/t.stretchRatio;var q={x:0,y:0,w:n,h:m};e.transform=new OM.util.ScreenTransform(o,q);
}return e.transform;},getDeviceWindow:function(){return e.deviceWindow;},getDeviceWidth:function(){return e.deviceWindow.w;
},getDeviceHeight:function(){return e.deviceWindow.h;},getQueryWindow:function(){var m=e.universe.getZoomLevels()[e.zoomLevel];
var r=e.centerPoint.getX();var o=e.centerPoint.getY();var l=r-e.deviceWindow.w*m.resolution/2;var q=r+e.deviceWindow.w*m.resolution/2;
var s=o-e.deviceWindow.h*m.resolution*m.stretchRatio/2;var n=o+e.deviceWindow.h*m.resolution*m.stretchRatio/2;
return new OM.geometry.Rectangle(l,s,q,n,e.universe.getSRID());},getLabelGrid:function(){var r=this.getUniverse().getZoomLevels();
var q=this.getZoomLevel();var o=r[q];var n=this.getUniverse().bound;var m=n.getWidth()/o.resolution;var l=n.getHeight()/o.resolution/o.stretchRatio;
return{minX:0,minY:0,maxX:m,maxY:l};}};return d;};OM.Messages={};OM.Messages["MAPVIEWER-05500"]="Oracle Maps client internal error.";
OM.Messages["MAPVIEWER-05501"]="Map tile layer not found. Check map tile layer name and/or data source name.";
OM.Messages["MAPVIEWER-05502"]="Cannot get map tile layer config information.";OM.Messages["MAPVIEWER-05503"]="FOI ID cannot be null.";
OM.Messages["MAPVIEWER-05504"]="MapViewer server base URL is not defined.";OM.Messages["MAPVIEWER-05505"]="Wrong map center point type specified. It should be an MVSdoGeometry point.";
OM.Messages["MAPVIEWER-05506"]="Invalid zoom level.";OM.Messages["MAPVIEWER-05507"]="Map tile layer name cannot be null. ";
OM.Messages["MAPVIEWER-05508"]="FOI Id is already used, please pick a new Id.";OM.Messages["MAPVIEWER-05509"]="Layer name is used, please pick a new name.";
OM.Messages["MAPVIEWER-05510"]="Cannot find theme-based FOI layer.";OM.Messages["MAPVIEWER-05511"]="Error occurred when sending request to MapViewer server.";
OM.Messages["MAPVIEWER-05512"]="Not enough points have been drawn.";OM.Messages["MAPVIEWER-05513"]="Not a valid line or polygon type. It should be an MVSdoGeometry.";
OM.Messages["MAPVIEWER-05514"]="Must have a filtering geometry when in high-light only mode.";OM.Messages["MAPVIEWER-05515"]="Oracle Maps client notification.";
OM.Messages["MAPVIEWER-05516"]="Synchronized remote call is not supported when using Oracle Maps' non-AJAX remoting.";
OM.Messages["MAPVIEWER-05517"]="Request string is too long for Oracle Maps' non-AJAX remoting.";OM.Messages["MAPVIEWER-05518"]="Map tile layer hasn't been successfully added.";
OM.Messages["MAPVIEWER-05519"]="One or more parameter is missing or invalid.";OM.Messages["MAPVIEWER-05520"]="Geometry SRID is null.";
OM.Messages["MAPVIEWER-05521"]="Call back function cannot be null when browser's builtin XMLHttp/XMLHttpRequest is disabled.";
OM.Messages["MAPVIEWER-05522"]="Client side coordinate system conversion not supported.";OM.Messages["MAPVIEWER-05523"]="Cannot process response from MapViewer server.";
OM.Messages["MAPVIEWER-05524"]="Theme feature highlighting is disabled for this theme.";OM.Messages["MAPVIEWER-05525"]="Theme has not been added to a MVMapView instance.";
OM.Messages["MAPVIEWER-05526"]="Map has not been initialized. Please try again later.";OM.Messages["MAPVIEWER-05527"]="Wrong parameter data type. ";
OM.Messages["MAPVIEWER-05528"]="Map tile layers have different zoom level definitions. Only the map tile layer added later will be added to the map.";
OM.Messages.marqueeZoomHint="Click on the rectangle to zoom in!";OM.Messages.panNWInfoTip="Pan NorthWest";
OM.Messages.panNInfoTip="Pan North";OM.Messages.panNEInfoTip="Pan NorthEast";OM.Messages.panWInfoTip="Pan West";
OM.Messages.panEInfoTip="Pan East";OM.Messages.panSWInfoTip="Pan SouthWest";OM.Messages.panSInfoTip="Pan South";
OM.Messages.panSEInfoTip="Pan SouthEast";OM.Messages.panCenterInfoTip="Home";OM.Messages.sliderBarInfoTip="Click to change zoom level";
OM.Messages.sliderInfoTip="Drag to change zoom level";OM.Messages.zoomInInfoTip="Zoom in";OM.Messages.zoomOutInfoTip="Zoom out";
OM.Messages.scaleBarInfoTip="Scale at the center of the map";OM.Messages.kilometers="km";OM.Messages.miles="mi";
OM.Messages.meters="m";OM.Messages.feet="ft";OM.Messages["delete"]="Delete";OM.Messages.addPoint="Add Point";
OM.Messages.finish="Finish";OM.Messages.clear="Clear";OM.Messages.totalDistance="Total Distance:";OM.Messages.km="km";
OM.Messages.m="m";OM.Messages.cm="cm";OM.Messages.mi="mi";OM.Messages.yd="yd";OM.Messages.ft="ft";OM.Messages.clearButton="Clear Button";
OM.Messages.redlineTool="Redline Tool";OM.Messages.distanceTool="Distance Tool";OM.Messages.circleTool="Circle Tool";
OM.Messages.retangleTool="Retangle Tool";OM.Messages.marqueeZoomTool="Marquee Zoom Tool";OM.Messages.number_format="1,000.1";
OM.Messages.getErrorMessage=function(e){var g=OM.Messages;var d=g[e];if(d){return e+": "+d;}else{return e;
}};OM.Messages.getString=function(g){var e=OM.Messages;var d=e[g];if(d){return d;}else{return g;}};OM.Messages.fetchMessages=function(){var msg=OM.Messages;
if(msg.URL==null){return;}var request={request:"getinfomsgs"};if(msg.language){request.language=msg.language;
}if(msg.country){request.country=msg.country;}msg.timeoutCount++;OM.util.HttpRequest.send(OM.Messages.URL,request,function(result){var MVMessages=new Array();
eval(result);var each;for(each in MVMessages){OM.Messages[each]=MVMessages[each];}MVMessages=null;msg.fetched=true;
},"text");};OM.Messages.isFetched=function(){var d=OM.Messages;if(d.fetched){return true;}if(d.timeoutCount>10){d.fetched=true;
}return d.fetched;};OM.Messages.setURL=function(d){if(d==null||d==""){alert("Parameter should not be null or empty. Error occurs in MVi18n.setURL(...)");
return;}OM.Messages.URL=d;};OM.Messages.fetched=false;OM.Messages.timeoutCount=0;OM.CursorTypes={AUTO:"AUTO",MOVE:"MOVE",POINTER:"POINTER",DEFAULT:"DEFAULT",TEXT:"TEXT",WAIT:"WAIT",NONE:"NONE",CUSTOM:"CUSTOM"};
OM.LayerTypes={TILE:0,VECTOR:1,EXTERNAL:2};OM.VectorLayerTypes={PREDEFINED:0,JDBC:1,DATAPACK:2,LOCAL:3,GEORSS:4,WFS:5};
OM.LineCaps={BUTT:"BUTT",ROUND:"ROUND",SQUARE:"SQUARE"};OM.LineJoins={MITER:"MITER",ROUND:"ROUND",BEVEL:"BEVEL"};
OM.GeomTypes={POINT:"Point",MULTIPOINT:"MultiPoint",ORIENTEDPOINT:"OrientedPoint",ORIENTEDMULTIPOINT:"OrientedMultiPoint",LINESTRING:"LineString",MULTILINESTRING:"MultiLineString",POLYGON:"Polygon",MULTIPOLYGON:"MultiPolygon",CIRCLE:"Circle",RECTANGLE:"Rectangle",GEOMETRYCOLLECTION:"GeometryCollection"};
OM.Text={FONTSTYLE_NORMAL:"NORMAL",FONTSTYLE_ITALIC:"ITALIC",FONTWEIGHT_NORMAL:"NORMAL",FONTWEIGHT_BOLD:"BOLD",HORIZONTALALIGN_LEFT:"LEFT",HORIZONTALALIGN_CENTER:"CENTER",HORIZONTALALIGN_RIGHT:"RIGHT",VERTICALALIGN_TOP:"TOP",VERTICALALIGN_CENTER:"CENTERV",VERTICALALIGN_BOTTOM:"BOTTOM"};
OM.PaintTypes={NO_PAINT:0};OM.gv=OM.gv||{};OM.gv.proxyPath="/mapviewer/proxy";OM.gv.proxyEnabled=true;
OM.gv._baseURL=document.location.protocol+"//"+document.location.host+"/mapviewer";OM.gv.localbaseURL=function(){return OM.gv._baseURL;
};OM.gv.setBaseMapViewerURL=function(d){if(d&&d.indexOf("/mapviewer")&&d.indexOf("http")==0){OM.gv._baseURL=d;
}else{}};OM.gv.defaultDataSource=null;OM.gv._resPath="/mapviewer/jslib/v2/images/";OM.gv.resourcePath=function(){return OM.gv._resPath;
};OM.gv.setResourcePath=function(d){if(!d){return;}OM.gv._resPath=d;if(d.indexOf("/",d.length-1)<0){OM.gv._resPath+="/";
}OM.gv.transparentImg=OM.gv._resPath+"transparent."+(OM.browser.msie?"gif":"png");OM.gv.loadTransImg();
OM.control.MapDecoration.setIconsPath();if(OM.tool.WhiteBoardTool){OM.tool.WhiteBoardTool.setIconsPath();
}};OM.gv.loadTransImg=function(){var d=new Image();d.onload=function(){if(d.src.indexOf(OM.gv._resPath)>=0){OM.gv.transparentImg=d.src;
}};d.src=OM.gv.transparentImg;};OM.gv.transparentImg=OM.gv._resPath+"transparent."+(OM.browser.msie?"gif":"png");
OM.gv.loadTransImg();OM.gv.CacheConfig=new Array(30);OM.gv.infoWindowWidth=180;OM.gv.infoWindowHeight=100;
OM.gv.infoWindowTabsWidth=240;OM.gv.infoWindowTabsHeight=130;OM.gv.unitFactors={};OM.gv.unitFactors.SQ_MM=0.000001;
OM.gv.unitFactors.SQ_KILOMETER=1000000;OM.gv.unitFactors.SQ_CENTIMETER=0.0001;OM.gv.unitFactors.SQ_MILLIMETER=0.000001;
OM.gv.unitFactors.SQ_CH=404.6856;OM.gv.unitFactors.SQ_FT=0.09290304;OM.gv.unitFactors.SQ_IN=0.00064516;
OM.gv.unitFactors.SQ_LI=0.04046856;OM.gv.unitFactors.SQ_CHAIN=404.6856;OM.gv.unitFactors.SQ_FOOT=0.09290304;
OM.gv.unitFactors.SQ_INCH=0.00064516;OM.gv.unitFactors.SQ_LINK=0.04046856;OM.gv.unitFactors.SQ_MILE=2589988;
OM.gv.unitFactors.SQ_ROD=25.29285;OM.gv.unitFactors.SQ_SURVEY_FOOT=0.09290341;OM.gv.unitFactors.SQ_YARD=0.8361274;
OM.gv.unitFactors.ACRE=4046.856;OM.gv.unitFactors.HECTARE=10000;OM.gv.unitFactors.PERCH=25.29285;OM.gv.unitFactors.ROOD=1011.714;
OM.gv.unitFactors.M=1;OM.gv.unitFactors.METER=1;OM.gv.unitFactors.KM=1000;OM.gv.unitFactors.KILOMETER=1000;
OM.gv.unitFactors.CM=0.01;OM.gv.unitFactors.CENTIMETER=0.01;OM.gv.unitFactors.MM=0.001;OM.gv.unitFactors.MILLIMETER=0.001;
OM.gv.unitFactors.MILE=1609.344;OM.gv.unitFactors.NAUT_MILE=1852;OM.gv.unitFactors.SURVEY_FOOT=0.3048006096012;
OM.gv.unitFactors.FOOT=0.3048;OM.gv.unitFactors.INCH=0.0254;OM.gv.unitFactors.YARD=0.9144;OM.gv.unitFactors.CHAIN=20.1168;
OM.gv.unitFactors.ROD=5.0292;OM.gv.unitFactors.LINK=0.201166195;OM.gv.unitFactors.MOD_USFT=0.304812253;
OM.gv.unitFactors.CL_FT=0.304797265;OM.gv.unitFactors.IND_FT=0.304799518;OM.gv.unitFactors.LINK_BEN=0.201167651;
OM.gv.unitFactors.LINK_SRS=0.201167651;OM.gv.unitFactors.CHN_BEN=20.1167825;OM.gv.unitFactors.CHN_SRS=20.1167651;
OM.gv.unitFactors.IND_YARD=0.914398554;OM.gv.unitFactors.SRS_YARD=0.914398415;OM.gv.unitFactors.FATHOM=1.8288;
OM.gv.unitFactors.SQ_M=1;OM.gv.unitFactors.SQ_METER=1;OM.gv.unitFactors.SQ_KM=1000000;OM.gv.unitFactors.SQ_CM=0.0001;
OM.gv.toolButtonW=14;OM.gv.toolButtonH=14;OM.gv.DPI=96;OM.gv.getUnitFactor=function(d){if(d){d=d.toUpperCase();
}else{return 0;}if(OM.gv.unitFactors[d]){return OM.gv.unitFactors[d];}else{return 0;}};OM.gv.defaultMarkerStyleWidth=13;
OM.gv.defaultMarkerStyleHeight=13;OM.gv.loadingIcon="o_loading.gif";OM.gv.defaultTextStyleConfig={fontSize:12,fill:"#ff0000"};
OM.gv.labelDisplayOrder=["R","L","B","T"];OM.gv.mapInstanceId=0;OM.gv.enableSelfDestroy=true;OM.gv.mapInstances=[];
OM.gv.mvKeyMap=[];OM.gv.clearMapInstanceByDiv=function(e){var o=OM.gv.mapInstances;var d=o.length;for(var g=0;
g<d;g++){var m=o[g];if(m&&m.$containerDiv){var n=m.$containerDiv[0];if(n==e){m.destroyMap();}else{var l=false;
while(n.parentNode){n=n.parentNode;if(n==document.body){l=true;break;}}if(!l){m.destroyMap();}}}}};OM.gv.addMapInstance=function(e,d){if(OM.gv.enableSelfDestroy){OM.gv.clearMapInstanceByDiv(d);
}OM.gv.mapInstances.push(e);};OM.gv.clearAllMapInstance=function(e){if(OM.gv.mapInstances!=null){var g=OM.gv.mapInstances;
while(g.length>0){var d=g.pop();if(d.overview){d.destroyMap();}}}};OM.$(window).unload(function(d){OM.gv.clearAllMapInstance();
});OM.Graphics=function(e){this.div=e;var d=OM.$(this.div);this.width=d.width();this.height=d.height();
this.oui=ouilib.createLiveGraphics(this.div,{defaultViewportWidth:this.width,defaultViewportHeight:this.height,frameRate:60});
this.oui.tooltipManager._properties.cursorOffset=10;this.oui.tooltipManager._properties.dismissDelay=100000000;
this.oui.tooltipManager.setHideDelay(0);this.oui.tooltipManager.applyStyle({background:"#ffffe1ff",border:{stroke:this.oui.NO_PAINT},text:{fill:this.oui.BLACK},padding:{top:5,lineBegin:5,bottom:5,lineEnd:5}});
};OM.Graphics.EVENT_CLICK="click";OM.Graphics.EVENT_DOUBLE_CLICK="doubleClick";OM.Graphics.EVENT_MOUSE_DOWN="mouseDown";
OM.Graphics.EVENT_MOUSE_UP="mouseUp";OM.Graphics.EVENT_MOUSE_OVER="mouseOver";OM.Graphics.EVENT_MOUSE_OUT="mouseOut";
OM.Graphics.EVENT_MOUSE_MOVE="mouseMove";OM.Graphics.EVENT_MOUSE_DRAG="drag";OM.Graphics.TYPE_GROUP=1;
OM.Graphics.TYPE_IMAGE=2;OM.Graphics.TYPE_IMAGE_MARKER=3;OM.Graphics.TYPE_SIMPLE_VECTOR_MARKER=4;OM.Graphics.TYPE_COMPOUND_VECTOR_MARKER=5;
OM.Graphics.TYPE_PATH=6;OM.Graphics.TYPE_RECTANGLE=7;OM.Graphics.TYPE_ELLIPSE=8;OM.Graphics.prototype.createGroup=function(d){var e=new this.oui.graphics.Group(d);
e.vtype=OM.Graphics.TYPE_GROUP;return e;};OM.Graphics.prototype.addGroup=function(e,d){if(d!=null){d.appendChild(e);
}else{this.oui.rootNode.appendChild(e);}};OM.Graphics.prototype.drawImage=function(e,m,l){if(!e){return null;
}var o=l.group;if(!o){o=this.oui.rootNode;}this.setId(o,l);m.x=e.x;m.y=e.y;if(m.width&&m.height){m.preserveAspectRatio=true;
}if(l&&l.angle){var d=e.x+m.width/2;var q=e.y+m.height/2;var g=(new this.oui.geom.Matrix()).rotate(l.angle,d,q);
m.transform=g;}if(l&&l.enableCache&&OM.browser.mozilla){if(m.src.indexOf("@cache;")<0){m.src="@cache;"+m.src;
}}var n=new this.oui.graphics.Image(m,l.name);o.appendChild(n);n.vtype=OM.Graphics.TYPE_IMAGE;return n;
};OM.Graphics.prototype.drawImageMarker=function(d,l,g){if(g.xOffset){d.x+=g.xOffset;}if(g.yOffset){d.y+=g.yOffset;
}if(l&&l.src){if(l.width){d.x-=l.width/2;}if(l.height){d.y-=l.height/2;}var e=this.drawImage(d,l,g);e.vtype=OM.Graphics.TYPE_IMAGE_MARKER;
return e;}else{return null;}};OM.Graphics.prototype.drawVectorMarker=function(u,d,z){if(z.xOffset){u.x+=z.xOffset;
}if(z.yOffset){u.y+=z.yOffset;}if(z.width){u.x-=z.width/2;}if(z.height){u.y-=z.height/2;}z.transform=(new this.oui.geom.Matrix()).translate(u.x,u.y);
var w=z.xScale?z.xScale:1;var l=z.yScale?z.yScale:1;if(w!=1||l!=1){z.transform=z.transform.scale(w,l);
}if(z.angle){var o=z.width/2/w;var n=z.height/2/l;z.transform.rotate(z.angle,o,n);}if(d&&d.length>0){var r;
var e;var s=z.group;if(d.length>=1){z.group=this.createGroup({transform:z.transform});z.transform=null;
}var m=null;for(var q=0;q<d.length;q++){r=d[q].shape;e=d[q].style;e.transform=z.transform;if(!e.fill){e.fill="#ffffff";
e.fillOpacity=0;}var t=r.type;if(t=="path"){m=this.drawPath(r.coords,e,z);}else{if(t=="rectangle"){m=this.drawRectangle(r,e,z);
}else{m=this.drawEllipse(r,e,z);}}}if(s==z.group){m.vtype=OM.Graphics.TYPE_SIMPLE_VECTOR_MARKER;return m;
}else{this.addGroup(z.group,s);z.group.vtype=OM.Graphics.TYPE_COMPOUND_VECTOR_MARKER;var g=z.group;z.group=s;
return g;}}else{return null;}};OM.Graphics.prototype.drawRectangle=function(g,e,d){if(!g||g.x==undefined||g.y==undefined||g.width==undefined&&g.rx==undefined||g.height==undefined&&g.ry==undefined){return null;
}var m=d.group;if(!m){m=this.oui.rootNode;}this.setId(m,d);if(e.fill==undefined){e.fill=this.oui.NO_PAINT;
}e.x=g.x;e.y=g.y;if(g.width!=undefined){e.width=g.width;}if(g.rx!=undefined){e.rx=g.rx;}if(g.height!=undefined){e.height=g.height;
}if(g.ry!=undefined){e.ry=g.ry;}var l=new this.oui.graphics.Rectangle(e);l.vtype=OM.Graphics.TYPE_RECTANGLE;
m.appendChild(l);return l;};OM.Graphics.prototype.drawEllipse=function(g,e,d){if(!g||g.cx==undefined||g.cy==undefined||g.width==undefined||g.height==undefined){return null;
}var m=d.group;if(!m){m=this.oui.rootNode;}this.setId(m,d);if(e.fill==undefined){e.fill=this.oui.NO_PAINT;
}e.cx=g.cx;e.cy=g.cy;e.width=g.width;e.height=g.height;var l=new this.oui.graphics.Ellipse(e);m.appendChild(l);
l.vtype=OM.Graphics.TYPE_ELLIPSE;return l;};OM.Graphics.prototype.drawPath=function(e,m,g){var q=new this.oui.graphics.PathCommands();
for(var l=0,d=e.length;l<d;l++){this.drawSegment(q,e[l],g);}var o=g.group;if(!o){o=this.oui.rootNode;
}this.setId(o,g);if(m.fill==undefined){m.fill=this.oui.NO_PAINT;}m.pathCommands=q;var n=new this.oui.graphics.Path(m);
o.appendChild(n);n.vtype=OM.Graphics.TYPE_PATH;return n;};OM.Graphics.prototype.drawText=function(e,d){var g=d.group;
if(!g){g=this.oui.rootNode;}var l=new this.oui.graphics.Text(e);g.appendChild(l);l.vtype="TEXT";return l;
};OM.Graphics.prototype.attachEventListener=function(d,e,g){if(g==undefined||!g){g=this.oui.rootNode;
}g.addEventListener(d,e);};OM.Graphics.prototype.detachEventListener=function(d,e,g){if(g==undefined||!g){g=this.oui.rootNode;
}g.removeEventListener(d,e);};OM.Graphics.prototype.getLeftTop=function(d){return d.getTranslation();
};OM.Graphics.prototype.setLeftTop=function(g,e,d){return g.setTranslation(e,d);};OM.Graphics.prototype.setImageMarker=function(m,e,l){if(l){if(e){var d=m.getWidth();
var g=m.getHeight();if(l.width){d=l.width;}if(l.height){g=l.height;}l.x=e.x-d/2;l.y=e.y-g/2;}else{if(l.width){l.x=m.getX()-(l.width-m.getWidth())/2;
}if(l.height){l.y=m.getY()-(l.height-m.getHeight())/2;}}m.applyStyle(l);}else{if(e){e.x=e.x-m.getWidth()/2;
e.y=e.y-m.getHeight()/2;m.applyStyle(e);}}};OM.Graphics.prototype.setImage=function(g,d,e){if(e){if(d){e.x=d.x;
e.y=d.y;}if(e.width&&e.height){e.preserveAspectRatio=true;}g.applyStyle(e);}else{if(d){g.applyStyle(d);
}}};OM.Graphics.prototype.setRectangle=function(g,d,e){if(g.vtype==OM.Graphics.TYPE_RECTANGLE){if(e){if(d){e.x=d.x;
e.y=d.y;if(d.width!=undefined){e.width=d.width;}else{e.rx=d.rx;}if(d.height!=undefined){e.height=d.height;
}else{e.ry=d.ry;}}g.applyStyle(e);}else{g.applyStyle(d);}}};OM.Graphics.prototype.setEllipse=function(g,d,e){if(g.vtype==OM.Graphics.TYPE_ELLIPSE){if(e){if(d){if(d.cx!=undefined){e.cx=d.cx;
}if(d.cy!=undefined){e.cy=d.cy;}if(d.width!=undefined){e.width=d.width;}if(d.height!=undefined){e.height=d.height;
}}g.applyStyle(e);}else{if(d){g.applyStyle(d);}}}};OM.Graphics.prototype.setPath=function(m,e,l){if(m.vtype==OM.Graphics.TYPE_PATH){var n=null;
if(e){n=new this.oui.graphics.PathCommands();for(var g=0,d=e.length;g<d;g++){this.drawSegment(n,e[g]);
}}if(l){l.pathCommands=n;m.applyStyle(l);}else{if(n){m.applyStyle({pathCommands:n});}}}};OM.Graphics.prototype.remove=function(d){if(d&&d.parentNode){d.parentNode.removeChild(d);
}};OM.Graphics.prototype.removeAll=function(){this.oui.rootNode.removeChildren();};OM.Graphics.prototype.bringForward=function(d){d.bringForward();
};OM.Graphics.prototype.bringToTop=function(d){d.bringToFront();};OM.Graphics.prototype.sendBackward=function(d){d.sendBackward();
};OM.Graphics.prototype.sendToBottom=function(d){d.sendToBack();};OM.Graphics.prototype.getDisplayIndex=function(d){if(d.parentNode){return d.parentNode.getChildIndex(d);
}else{return -1;}};OM.Graphics.prototype.setDisplayIndex=function(e,d){if(e.parentNode){e.parentNode.setChildIndex(e,d);
}};OM.Graphics.prototype.applyStyle=function(e,d){e.applyStyle(d);};OM.Graphics.prototype.drawSegment=function(m,l,e){if(!l||!l.length||l.length<2){return;
}if(e&&e.scTransform){if(!e.genThreshold){e.genThreshold=1;}this.drawSegmentWithTransform(l,e);return;
}m.moveTo(Math.round(l[0]),Math.round(l[1]));for(var g=2,d=l.length;g<d;g+=2){m.lineTo(Math.round(l[g]),Math.round(l[g+1]));
}if(l[0]==l[d-2]&&l[1]==l[d-1]){m.closePath();}};OM.Graphics.prototype.drawSegmentWithTransform=function(w,o,z){var l=z.scTransform;
var d=l.transformPoint(o[0],o[1]);var g=d.x,e=d.y;w.moveTo(Math.round(d.x),Math.round(d.y));var n=z.genThreshold;
for(var m=2,q=o.length-2;m<q;m+=2){d=l.transformPoint(o[m],o[m+1]);var u=Math.round(d.x),s=Math.round(d.y);
var t=u-g,r=s-e;if(t>n||t<-n||r>n||r<-n){continue;}else{w.lineTo(u,s);}}d=l.transformPoint(o[q-2],o[q-1]);
w.lineTo(Math.round(d.x),Math.round(d.y));};OM.Graphics.prototype.setId=function(e,d){if(d.id==undefined){d.id=e.length;
}if(d.id){d.name="path_"+d.id;}else{d.name="path_"+e.length;}};OM.Graphics.prototype.setImageStyleLocation=function(e,d){e.x=d.x;
e.y=d.y;if(e.width&&e.height){e.preserveAspectRatio=true;}};OM.Graphics.prototype.setImageStyle=function(d){if(d.width&&d.height){d.preserveAspectRatio=true;
}};OM.Graphics.prototype.zoom=function(g,d){g.curScaleX=d.beginValue;g.curScaleY=d.beginValue;g.zoomPointXOffset=d.zoomPointXOffset;
g.zoomPointYOffset=d.zoomPointYOffset;var e=new this.oui.anim.AnimateStyle({targetNode:g,beginValue:d.beginValue,endValue:d.endValue,dur:d.duration,interpolator:function(t,s,o){var r=(s-t)*o+t;
var q=sY=1;var l=y=0;if(d.zoomPointXOffset!=undefined){var n=g.zoomPointXOffset/r*g.curScaleX;l=-n+g.zoomPointXOffset;
q=r/g.curScaleX;}if(d.zoomPointYOffset!=undefined){var m=g.zoomPointYOffset/r*g.curScaleY;y=-m+g.zoomPointYOffset;
sY=r/g.curScaleX;}g.scale(q,sY);g.translate(-l,-y);g.curScaleX=r;g.curScaleY=r;}});if(d.endListener){e.addEventListener(this.oui.EventTypes.END,function(l){d.endListener(l);
});}e.beginAt(0);};OM.Graphics.prototype.setVisible=function(d,e){d.setVisibility(e);};OM.Graphics.prototype.isVisible=function(d){return d.getVisibility();
};OM.Graphics.prototype.clearGroup=function(d){if(d){d.removeChildren();}};OM.Graphics.prototype.getGraphicFilter=function(d){if(d&&d.type=="DROPSHADOW"){return new this.oui.filters.DropShadow({opacity:d.opacity,color:d.color,offset:d.offset,radius:d.radius,knockout:d.knockout,angle:d.angle});
}else{if(d&&d.type=="BLUR"){return new this.oui.filters.Blur();}else{if(d&&d.type=="GLOW"){return new this.oui.filters.Glow({color:"#ffff00",strength:10});
}}}};OM.Graphics.prototype.setRotationTransform=function(l,g){if(l&&g){if(l.width==undefined){l.width=0;
}if(l.height==undefined){l.height=0;}var d=l.x+l.width/2;var m=l.y+l.height/2;var e=(new this.oui.geom.Matrix()).rotate(g,d,m);
l.transform=e;}return l;};OM.Graphics.prototype.getWidthHeight=function(e){if(e==null||e==undefined){return null;
}var d=e.getLocalBounds();return{w:d.width,h:d.height};};OM.Graphics.prototype.setOpacity=function(e,d){if(e){e.setOpacity(d);
}};OM.Graphics.prototype.getTextSize=function(l,g){var d=this.createTextNode(l,g,0,0);this.oui.rootNode.appendChild(d);
d.setDisplay(false);var e=this.getWidthHeight(d);this.remove(d);return e;};OM.Graphics.prototype.createTextNode=function(g,e,d,l){if(e){return this.oui.load({type:"text",textValue:g,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,fill:e.fill,x:d,y:l,textAlign:e.textAlign});
}else{return this.oui.load({type:"text",textValue:g,x:d,y:l});}};OM.Graphics.prototype.drawPieChart=function(u,A,q,B){if(!u||u.cx==undefined||u.cy==undefined||u.width==undefined||u.height==undefined||A==undefined||A.length==0||q==undefined||q.length!=A.length){return null;
}var w=B.offsetAngle?B.offsetAngle:0;var C=new Array();C.push(0);var m=0;var l=u.width/2;var e=u.height/2;
var z=B.group;if(!z){z=this.oui.rootNode;}this.setId(z,B);var o=this.createGroup({opacity:1});this.addGroup(o,z);
for(var r=0;r<A.length;r++){m=m+A[r];C.push(m);}for(var r=0;r<A.length;r++){var g=B.orientation&&B.orientation==2?((C[r]/m)*360+w):-((C[r]/m)*360+w);
var d=B.orientation&&B.orientation==2?((C[r+1]/m)*360+w):-((C[r+1]/m)*360+w);var t=Math.round((A[r]/m)*10000)/100+"%";
var s=B.description&&B.description[r]?B.description[r]+" \n value:"+A[r]+" \n percent:"+t:null;var n=this.drawSector(u.cx,u.cy,g,d,l,e,{fill:q[r],stroke:B.stroke,strokeThickness:B.strokeThickness},B.plugable,s);
o.appendChild(n);n.vtype=OM.Graphics.TYPE_PATH;}o.applyStyle({filter:B.filter});return o;};OM.Graphics.prototype.drawSector=function(t,s,B,q,n,l,m,A,z){var e=new this.oui.graphics.PathCommands();
e.moveTo(Math.round(t),Math.round(s));var g=n*Math.cos(B*Math.PI/180);var d=l*Math.sin(B*Math.PI/180);
e.lineTo(Math.round(t)+g,Math.round(s)+d);e.arc(Math.round(t),Math.round(s),B,q,n,l,false);e.lineTo(t,s,false);
e.closePath();if(m.fill==undefined){m.fill=this.oui.NO_PAINT;}m.pathCommands=e;var r=new this.oui.graphics.Path(m);
if(!A||(A&&A==true)){var o=((B+q)*Math.PI)/360;var w=n*0.2<5?Math.cos(o)*5:Math.cos(o)*n*0.2;var u=l*0.2<5?Math.sin(o)*5:Math.sin(o)*l*0.2;
w=n*0.2>15?Math.cos(o)*15:w;u=l*0.2>15?Math.sin(o)*15:u;this.attachEventListener(OM.Graphics.EVENT_MOUSE_OVER,function(C){C.target.parentNode.bringToFront();
C.target.bringToFront();C.target.setTranslation(w,u);},r);this.attachEventListener(OM.Graphics.EVENT_MOUSE_OUT,function(C){C.target.setTranslation(0,0);
},r);r.applyStyle({tooltip:z});}return r;};OM.Graphics.prototype.drawBarChart=function(t,A,g,B){if(!t||t.cx==undefined||t.cy==undefined||t.width==undefined||t.height==undefined||A==undefined||A.length==0||g==undefined||g.length!=A.length){return null;
}var z=B.group;if(!z){z=this.oui.rootNode;}this.setId(z,B);var q=this.createGroup({opacity:1});this.addGroup(q,z);
var u=0;var d=0;for(var o=0;o<A.length;o++){d=d+A[o];if(u<A[o]){u=A[o];}}var n=t.width;var w=t.height;
var e=n/A.length;for(var o=0;o<A.length;o++){tempHeight=w*(A[o]/u);var m=this.drawRectangle({x:0,y:tempHeight<0?0:-tempHeight,width:e,height:Math.abs(tempHeight)},{fill:g[o],stroke:B.stroke,strokeThickness:B.strokeThickness},{group:q});
m.translate(e*o,0);if(!B.plugable||(B&&B.plugable==true)){this.attachEventListener(OM.Graphics.EVENT_MOUSE_OVER,function(C){C.target.parentNode.bringToFront();
C.target.bringToFront();C.target.scale(1.1,1.1);var E=C.target.parentNode.childrenCount;for(var D=0;D<E;
D++){if(C.target.parentNode.getChildAt(D)!=C.target){C.target.parentNode.getChildAt(D).applyStyle({fillOpacity:0.4});
}}},m);this.attachEventListener(OM.Graphics.EVENT_MOUSE_OUT,function(C){C.target.scale(1/1.1,1/1.1);var E=C.target.parentNode.childrenCount;
for(var D=0;D<E;D++){C.target.parentNode.getChildAt(D).applyStyle({fillOpacity:1});}},m);}var s=Math.round((A[o]/d)*10000)/100+"%";
var r=B.description&&B.description[o]?B.description[o]+" \n value:"+A[o]+" \n percent:"+s:null;m.applyStyle({tooltip:r});
}var l=this.getWidthHeight(q);this.setLeftTop(q,t.cx-l.w/2,t.cy+(2*w-l.h)/2);q.applyStyle({filter:B.filter});
return q;};OM.Graphics.prototype.getScaleValue=function(g){if(g==null||g==undefined){return null;}var d=g.getTransformMatrix();
if(d==null){return;}var e=d.exportToJSON();return{scaleX:e[0],scaleY:e[3]};};OM.Graphics.prototype.clearToolTips=function(){this.oui.tooltipManager.hideTooltip();
};OM.util.Logger=OM.util.Logger||{};OM.util.Logger.DEBUG=(typeof console!="undefined"&&typeof(console.time)!="undefined");
OM.util.Logger.NO_ALERT_BOX=false;OM.util.Logger._log=function(d){if(typeof console=="object"){console.log(d);
}else{if(typeof opera=="object"){opera.postError(d);}else{if(typeof java=="object"&&typeof java.lang=="object"){java.lang.System.out.println(d);
}}}};OM.util.Logger.finest=function(g,d,e){OM.util.Logger._log("[FINEST]  "+OM.util.Logger._mix(g,d,e));
};OM.util.Logger.finer=function(g,d,e){OM.util.Logger._log("[FINER]  "+OM.util.Logger._mix(g,d,e));};
OM.util.Logger.fine=function(g,d,e){OM.util.Logger._log("[FINE]  "+OM.util.Logger._mix(g,d,e));};OM.util.Logger.info=function(g,d,e){OM.util.Logger._log("[INFO]  "+OM.util.Logger._mix(g,d,e));
};OM.util.Logger.config=function(g,d,e){OM.util.Logger._log("[CONFIG]  "+OM.util.Logger._mix(g,d,e));
};OM.util.Logger.warning=function(g,d,e){OM.util.Logger._log("[WARNING]  "+OM.util.Logger._mix(g,d,e));
};OM.util.Logger.severe=function(g,d,e){OM.util.Logger._log("[SEVERE]  "+OM.util.Logger._mix(g,d,e));
};OM.util.Logger.alert=function(l,e,g){var d=OM.util.Logger._mix(l,e,g);OM.util.Logger._log("[ALERT]  "+d);
if(OM.util.Logger.errorHandler){OM.util.Logger.errorHandler(d);}else{if(!OM.util.Logger.NO_ALERT_BOX){alert(d);
}}};OM.util.Logger._mix=function(l,e,g){var d=null;if(l){d=OM.Messages.getErrorMessage(l);}if(e){if(d){d+="\n    "+OM.Messages.getString("Source")+": "+e;
}else{d=OM.Messages.getString("Source")+": "+e;}}if(g){if(d){d+="\n    "+g;}else{d=g;}}return d;};OM.util.Logger.serverLog=function(e){var d=new Image();
d.src="/mapviewer/logger?msg="+e;};OM.util.ScreenTransform=function(e,d){this.dw=e;this.sw=d;this.sx=d.w/e.w;
this.sy=-d.h/e.h;this.tx=-e.x*this.sx+d.x;this.ty=-e.y*this.sy+d.y+d.h;this.xtr=e.w/d.w;this.ytr=e.h/d.h;
this.rsx=1/this.sx;this.rsy=1/this.sy;this.rtx=-d.x*this.rsx+e.x;this.rty=-d.y*this.rsy+e.y+e.h;};OM.util.ScreenTransform.prototype.toScreenPoint=function(d,g){var e=new Object();
e.x=Math.round(d*this.sx+this.tx);e.y=Math.round(g*this.sy+this.ty);return e;};OM.util.ScreenTransform.prototype.toMapDataPoint=function(d,g){var e=new Object();
e.x=d*this.rsx+this.rtx;e.y=g*this.rsy+this.rty;return e;};OM.util.ScreenTransform.prototype.toScreenXLength=function(d){return d*this.sx;
};OM.util.ScreenTransform.prototype.toScreenYLength=function(d){return -d*this.sy;};OM.util.ScreenTransform.prototype.transformSegment=function(r,n,g){if(g==null){g=2;
}if(!r.length||r.length<=2){return null;}var t=n*this.xtr;var l=n*this.ytr;var u=new Array();var s=r[0],q=r[1];
var e=s,d=q;s=Math.round(s*this.sx+this.tx);q=Math.round(q*this.sy+this.ty);u.push(s);u.push(q);for(var m=g,o=r.length;
m<o;m+=g){s=r[m];q=r[m+1];if(Math.abs(s-e)>t||Math.abs(q-d)>l){e=s;d=q;s=Math.round(s*this.sx+this.tx);
q=Math.round(q*this.sy+this.ty);u.push(s,q);}}if(u.length<=2){return null;}else{if(r[0]==r[o-2]&&r[1]==r[o-1]&&(u[0]!=u[u.length-2]||u[1]!=u[u.length-1])){u.push(u[0],u[1]);
}return u;}};OM.util.ScreenTransform.getScreenCoordinates=function(n,o,m,g,e,l,u,s,q){var t=(s-o)*l/(g-o)-n.divLeft;
var r=(e-q)*u/(e-m)-n.divTop;var d={x:t,y:r};return d;};OM.util.ScreenTransform.prototype.toHeatMapPoint=function(e,n,d,m,l){var g=new Object();
g.x=Math.round((e*this.sx+this.tx-d)/l);g.y=Math.round((n*this.sy+this.ty-m)/l);return g;};OM.util.ScreenTransform.prototype.transformHeatMapSegment=function(w,r,n,m,g,l){if(n==null){n=2;
}if(!w.length||w.length<=2){return null;}var z=r*this.xtr;var o=r*this.ytr;var A=new Array();var u=w[0],t=w[1];
var e=u,d=t;u=Math.round((u*this.sx+this.tx-m)/l);t=Math.round((t*this.sy+this.ty-g)/l);A.push(u);A.push(t);
for(var q=n,s=w.length;q<s;q+=n){u=w[q];t=w[q+1];if(Math.abs(u-e)>z||Math.abs(t-d)>o){e=u;d=t;u=Math.round(u*this.sx+this.tx);
t=Math.round(t*this.sy+this.ty);A.push((u-m)/l,(t-g)/l);}}if(A.length<=2){return null;}else{if(w[0]==w[s-2]&&w[1]==w[s-1]&&(A[0]!=A[A.length-2]||A[1]!=A[A.length-1])){A.push(A[0],A[1]);
}return A;}};OM.util.GeomUtil=OM.util.GeomUtil||{};OM.util.GeomUtil.earthRadius=6372795;OM.util.GeomUtil.pointInRect=function(e,n,g,d,m,l){return(e<=m)&&(e>=g)&&(n<=l)&&(n>=d);
};OM.util.GeomUtil.pointInPolygon=function(d,q,e,n,m){var l,g,o=0;for(l=0,g=e-1;l<e;g=l++){if(((m[l]>q)!=(m[g]>q))&&(d<(n[g]-n[l])*(q-m[l])/(m[g]-m[l])+n[l])){o=!o;
}}return o;};OM.util.GeomUtil.getPointAtBearing=function(r,q,o,t){var s=OM.util.GeomUtil.getRadiansFromLatLon(r,q);
var m=s.x;var g=s.y;var n=o/OM.util.GeomUtil.earthRadius;var e=Math.asin(Math.sin(g)*Math.cos(n)+Math.cos(g)*Math.sin(n)*Math.cos(t));
var l=m+Math.atan2(Math.sin(t)*Math.sin(n)*Math.cos(g),Math.cos(n)-Math.sin(g)*Math.sin(e));return OM.util.GeomUtil.getLatLonFromRadians(l,e);
};OM.util.GeomUtil.getRadiansFromLatLon=function(d,e){while(d<-180){d+=360;}while(d>180){d-=360;}d=d*Math.PI/180;
e=e*Math.PI/180;return{x:d,y:e};};OM.util.GeomUtil.getLatLonFromRadians=function(d,e){d=d*180/Math.PI;
e=e*180/Math.PI;return{x:d,y:e};};OM.util.GeomUtil.densifyOrdinates=function(l,q){if(!l||l.length<4){return l;
}var d=new Array();for(var r=0;r<l.length-2;r+=2){var m=l[r];var t=l[r+1];var e=l[r+2];var s=l[r+3];var z=e-m;
var w=s-t;d.push(m);d.push(t);var o=Math.ceil(Math.abs(z)/q);var n=Math.ceil(Math.abs(w)/q);var g=Math.max(o,n);
if(g>0){z=z*1/g;w=w*1/g;for(var u=0;u<g-1;u++){m+=z;t+=w;d.push(m);d.push(t);}}}d.push(l[l.length-2]);
d.push(l[l.length-1]);return d;};OM.util.GeomUtil.SimplifyCoordinates=function(l){var e=l.length;var d=l[0];
var n=l[1];var m=new Array(d,n);for(var g=2;g<e;g+=2){if(Math.abs(d-l[g])>=1||(Math.abs(n-l[g+1]))>=1){d=l[g];
n=l[g+1];m.push(d);m.push(n);}}return m;};OM.util.GeomUtil.getLength=function(o,t,g){var w=o?o.type:"";
var E=o.srid;var q=null;if(w!="LineString"&&w!="MultiLineString"&&w!="Polygon"&&w!="MultiPolygon"&&w!="Rectangle"){OM.util.Logger.alert("MAPVIEWER-05513","OM.util.GeomUtil.getLength","");
q=-1;return q;}var G=function(N){var J=0,L=2,K=N.length;if(N&&K>3){for(;L<K;L+=2){var M=N[L]-N[L-2];var O=N[L+1]-N[L-1];
J+=Math.sqrt(M*M+O*O);}return J;}else{return 0;}};if(!E){q=G(o.coordinates);if(t){t(q);}return q;}if(g){var u=g.unit?g.unit:"METER";
var D=g.transformToGeodetic;var H=g.foiURL;var F=g.dataSource?g.dataSource:"mvdemo";}var I={type:"GEODETIC",distConvFactor:0,maxX:180,maxY:90,minX:-180,minY:-90};
var d=null;if(D){d=OM.util.CSTransformUtil.getCSTransformFunction(E,8307);}if(!D||E==8307||E==8265||D&&d){var B=0;
if(!u||u==""){B=1;}else{B=OM.gv.getUnitFactor(u);if(I.distConvFactor&&!D){B=B/I.distConvFactor;}}var A=o.coordinates.slice(0);
if(d){A=OM.util.GeomUtil.transformOrdinates(d,A);}if(B){var C=0;if(I&&I.type!="GEODETIC"&&!D){q=G(A)/B;
}else{q=OM.util.GeomUtil.getGreatCircleLength(A)/B;}if(t){t(q);}return q;}}var z=o.toString();var r=OM.gv.localbaseURL()+"/foi";
var s={request:"getlength",version:1,figord:z};if(u){s.unit=u;}if(D){var l=(D==true)?"yes":"no";s.togeodetic=l;
}if(F){s.datasource=F;}var e=function(J){J=1*J;if(t){t(J);}q=J;};try{OM.util.HttpRequest.send(r,s,e,"text");
}catch(n){var m=(n.stack)?n.message+"\nStack: "+n.stack:n.message;OM.util.Logger.alert("MAPVIEWER-05511","OM.util.GeomUtil.getLength",m);
q=-1;}return q;};OM.util.GeomUtil.moveCoordinates=function(t,s,r,g){var e=function(z,u,A){if(!z){return;
}var m=z.length;if(g){m=2;}for(var w=0;w<m;w+=2){z[w]+=u;z[w+1]+=A;}};var q=OM.util.ValidationUtil.isNumberArray;
if(q(t)){e(t,s,r);}else{var o=t.length;for(var n=0;n<o;n++){if(q(t[n])){e(t[n],s,r);}else{var l=t[n].length;
for(var d=0;d<l;d++){e(t[n][d],s,r);}}}}};OM.util.GeomUtil.transformOrdinates=function(g,n,l){var o=[];
for(var m=0,e=n.length;m<e;m+=2){var d=g(n[m],n[m+1],l);o.push(d.x);o.push(d.y);}return o;};OM.util.GeomUtil.getGreatCircleLength=function(g){var d=0;
var e=OM.util.GeomUtil;for(i=0;i<g.length-2;i+=2){d+=e.getGreatCircleDistance({x:g[i],y:g[i+1]},{x:g[i+2],y:g[i+3]});
}return d;};OM.util.GeomUtil.getGreatCircleDistance=function(q,n){var g=OM.util.GeomUtil;q=g.getRadiansFromLatLon(q.x,q.y);
n=g.getRadiansFromLatLon(n.x,n.y);var l=n.x-q.x;var e=n.y-q.y;var o=Math.sin(e/2);var d=Math.sin(l/2);
var r=o*o+Math.cos(q.y)*Math.cos(n.y)*d*d;var m=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return m*g.earthRadius;
};OM.util.GeomUtil.getOGCOrdinateString=function(g){var e=0;var d="";for(;e<g.length;e+=2){if(e>0){d+=" ";
}d+=g[e+0]+","+g[e+1];}return d;};OM.util.GeomUtil.getCurrentDistancePerPixel=function(e){var n=e.getMapContext();
var o=n.getUniverse();var d=n.getZoomLevel();var r=o.getZoomLevels();var g=r[d];if(g.distancePerPixel!=null){return g.distancePerPixel;
}var q=o.getSRID();if(q==8307||q==8265){var l=111195;var m=l*g.resolution;g.distancePerPixel=m;return m;
}else{var m=g.resolution;g.distancePerPixel=m;return m;}};OM.util.GeomUtil.calculateGreatCircle=function(z,w,A,r){var d=z.clone();
var B=w.clone();var q=d.getY()*Math.PI/180;var t=d.getX()*Math.PI/180;var n=B.getY()*Math.PI/180;var s=B.getX()*Math.PI/180;
var u=[];var l=0;var m=Math.abs(r-A);var g=Math.PI/180;e=Math.min(t,s);if(Math.abs(t-s)<=0.00005){s=e+Math.PI;
}if(Math.abs(s-t)==Math.PI){if(q+n==0){n+=Math.PI/180000000;}}var e=A*Math.PI/180;r*=Math.PI/180;while(e<=r){lat=Math.atan((Math.sin(q)*Math.cos(n)*Math.sin(e-s)-Math.sin(n)*Math.cos(q)*Math.sin(e-t))/(Math.cos(q)*Math.cos(n)*Math.sin(t-s)));
u[2*l]=e*180/Math.PI;u[2*l+1]=lat*180/Math.PI;l++;if(e<r&&(e+g)>=r){e=r;}else{e=e+g;}}var o=new OM.geometry.LineString(u,8307);
return o;};OM.util.GeomUtil.createGreatCircle=function(m,e){if(m.srid!=8307&&m.srid!=8265||e.srid!=8307&&e.srid!=8265){OM.util.Logger.alert("","OM.util.GeomUtil.getGreatCircle","Invalid point or srid!");
return;}var l=m.getX();var g=e.getX();var d=[];if(l<g&&(g-l)<180){d[0]=OM.util.GeomUtil.calculateGreatCircle(m,e,l,g);
return(d[0]);}if(Math.abs(l-g)<180){d[0]=OM.util.GeomUtil.calculateGreatCircle(m,e,g,l);return(d[0]);
}if(l>g){d[0]=OM.util.GeomUtil.calculateGreatCircle(m,e,l,180);d[1]=OM.util.GeomUtil.calculateGreatCircle(m,e,-180,g);
return(new OM.geometry.MultiLineString([d[0].coordinates,d[1].coordinates],8307));}else{d[0]=OM.util.GeomUtil.calculateGreatCircle(m,e,g,180);
d[1]=OM.util.GeomUtil.calculateGreatCircle(m,e,-180,l);return(new OM.geometry.MultiLineString([d[0].coordinates,d[1].coordinates],8307));
}};OM.util.GeomUtil.flatten=function(m,g,d){var e=[];if(!m){return null;}var o=m.length;var r=0;for(var n=0;
n<o;n++){var q=m[n];if(!q instanceof OM.geometry.Geometry||q.getType().indexOf(g)<0){return null;}var l=q.getSRID();
if(!r){r=l;}if(r!==l){return null;}if(d){e.push(q.coordinates);}else{e.push(q.getX());e.push(q.getY());
}}return{ordinates:e,srid:r};};OM.util.GeomUtil.getOutCode=function(e,d,g){if(e.minX>d){if(e.minY>g){return 3;
}else{if(e.maxY<g){return 9;}else{return 1;}}}else{if(e.maxX<d){if(e.minY>g){return 6;}else{if(e.maxY<g){return 12;
}else{return 4;}}}else{if(e.minY>g){return 2;}else{if(e.maxY<g){return 8;}else{return 0;}}}}};OM.util.GeomUtil.clipLineSegment=function(n,e,l,d,g){var m=OM.util.GeomUtil.getOutCode;
c0=m(n,e,l);c1=m(n,d,g);while(true){if((c0|c1)==0){return{x0:e,y0:l,x1:d,y1:g};}if((c0&c1)!=0){return null;
}c=(c0!=0)?c0:c1;if((c&8)!=0){x=e+(d-e)*(n.maxY-l)/(g-l);y=n.maxY;}else{if((c&2)!=0){x=e+(d-e)*(n.minY-l)/(g-l);
y=n.minY;}else{if((c&4)!=0){x=n.maxX;y=l+(g-l)*(n.maxX-e)/(d-e);}else{x=n.minX;y=l+(g-l)*(n.minX-e)/(d-e);
}}}if(c==c0){e=x;l=y;c0=m(n,e,l);}else{d=x;g=y;c1=m(n,d,g);}}};OM.util.GeomUtil.clipLine=function(r,u){var w=[];
for(var e=0,o=u.length;e<o;e++){if(!u[e]||!u[e][0]){continue;}var d=u[e][0];for(var q=3,s=d.length;q<s;
q+=2){var n=OM.util.GeomUtil.clipLineSegment(r,d[q-3],d[q-2],d[q-1],d[q]);if(n){var t=w.length-1;if(t>=0){var g=w[t].length;
if(g>1&&n.x0==w[t][g-2]&&n.y0==w[t][g-1]){w[t].push(n.x1,n.y1);continue;}}w.push([n.x0,n.y0,n.x1,n.y1]);
}}}return w;};OM.util.GeomUtil.getSegmentLength=function(e,l,d,g){return Math.sqrt((e-d)*(e-d)+(l-g)*(l-g));
};OM.util.GeomUtil.getScreenLength=function(l){var e=0;for(var g=0,d=l.length-3;g<d;g+=2){e+=OM.util.GeomUtil.getSegmentLength(l[g],l[g+1],l[g+2],l[g+3]);
}return e;};OM.util.GeomUtil.getPointByPercent=function(z,s,q){var A=[];for(var o=0,n=z.length;o<n;o++){var e=z[o];
var u=OM.util.GeomUtil.getScreenLength(e);if(u<q/2){continue;}u*=s;for(var m=0,l=e.length-3;m<l;m+=2){var g=OM.util.GeomUtil.getSegmentLength(e[m],e[m+1],e[m+2],e[m+3]);
if(g>=u){var d=u/g;var w=(e[m]+(e[m+2]-e[m])*d);var t=(e[m+1]+(e[m+3]-e[m+1])*d);A.push({x:w,y:t});break;
}u-=g;}}return A;};OM.util.DomUtil=function(){};OM.util.DomUtil.setImageSrc=function(l,m,d,e){var g=OM.$(l);
if(m){g.css("opacity",d);g.attr("src",m);}else{g.attr("src",OM.gv.transparentImg);}};OM.util.DomUtil.changeOpacity=function(l,d,e){var g=OM.$(l);
g.css("opacity",d);};OM.util.DomUtil.pixel=function(d){return Math.round(d)+"px";};OM.util.DomUtil.createImageNode=function(l,g,e){var d=null;
d=document.createElement("img");d.src=l;if(OM.browser.msie&&!g){d.galleryImg="no";}if(OM.browser.mozilla){d.style.MozUserSelect="none";
}else{if(OM.browser.safari){d.style.KhtmlUserSelect="none";}else{if(OM.browser.msie){d.unselectable="on";
}}}return d;};OM.util.DomUtil.FigLayer=function(m,g,l,s,q,e,r){var d=null;var o=OM.util.DomUtil;d=document.createElement("img");
d.src=m;if(g&&l){d.style.width=o.pixel(g);d.style.height=o.pixel(l);d.width=g;d.height=l;}if(q||(s||(q==0||s==0))){d.style.position="absolute";
d.style.left=o.pixel(s);d.style.top=o.pixel(q);}if(e||e==0){d.style.zIndex=e;}d.style.MozUserSelect="none";
d.style.border="0";d.style.padding="0";d.style.margin="0";d.oncontextmenu=o.falseFunc;return d;};OM.util.DomUtil.setCursor=function(d,e){try{if(e.indexOf(".")>-1){e='url("'+e+'"),auto';
}d.style.cursor=e;}catch(g){if(e=="pointer"){OM.util.DomUtil.setCursor(d,"hand");}}};OM.util.DomUtil.falseFunc=function(){return false;
};OM.util.DomUtil.strEndWith=function(e,d){return e.substring(e.length-d.length,e.length)==d;};OM.util.DomUtil.getTouchCount=function(d){if(d.originalEvent){d=d.originalEvent;
}if(d.type.toUpperCase()=="TOUCHSTART"){return d.touches.length;}else{if(d.type.toUpperCase()=="TOUCHEND"){return d.changedTouches.length;
}}};OM.util.DomUtil.getTouchesPosition=function(m){if(m.originalEvent){m=m.originalEvent;}if(m.touches){var g=m.touches.length;
var e=[];for(var l=0;l<g;l++){var d=m.touches[l].pageX;var n=m.touches[l].pageY;e.push({x:d,y:n});}if(e.length==1){return e[0];
}else{return e;}}return[];};OM.util.DomUtil.getTouchesClientPosition=function(m){if(m.originalEvent){m=m.originalEvent;
}if(m.touches){var g=m.touches.length;var e=[];for(var l=0;l<g;l++){var d=m.touches[l].clientX;var n=m.touches[l].clientY;
e.push({x:d,y:n});}if(e.length==1){return e[0];}else{return e;}}return[];};OM.util.DomUtil.getChangedTouchesPosition=function(m){if(m.originalEvent){m=m.originalEvent;
}if(m.changedTouches){var g=m.changedTouches.length;var e=[];for(var l=0;l<g;l++){var d=m.changedTouches[l].pageX;
var n=m.changedTouches[l].pageY;e.push({x:d,y:n});}return e;}else{return[];}};OM.util.DomUtil.getTouchesScale=function(d){if(d.originalEvent){d=d.originalEvent;
}return d.scale;};OM.util.DomUtil.getElementPos=function(g){if(!g){return;}if(OM.browser.msie){var d=parseInt(g[0].style.left),e=parseInt(g[0].style.top);
return{top:isNaN(e)?0:e,left:isNaN(d)?0:d};}else{return g.position();}};OM.util.XMLUtil={};OM.util.XMLUtil.parse=window.DOMParser!=undefined?function(d){parser=new DOMParser();
return parser.parseFromString(d,"text/xml");}:function(e){var d=new ActiveXObject("Microsoft.XMLDOM");
d.async="false";d.loadXML(e);return d;};OM.util.XMLUtil.xmlToString=typeof XMLSerializer!="undefined"?function(d){var e=new XMLSerializer();
return e.serializeToString(d);}:function(d){return d.xml;};OM.util.ValidationUtil=OM.util.ValidationUtil||{};
OM.util.ValidationUtil.isNumber=function(d){return d!=null&&!isNaN(d);};OM.util.ValidationUtil.isNumber2=function(d){return d!=null&&typeof d=="number";
};OM.util.ValidationUtil.isObject=function(d){return d!=null&&typeof d=="object";};OM.util.ValidationUtil.isNumberArray=function(l){if(!l||typeof l!="object"){return false;
}var d=l.length;if(d==0){return false;}var e=OM.util.ValidationUtil.isNumber;for(var g=0;g<d;g++){if(!e(l[g])){return false;
}}return true;};OM.util.ValidationUtil.getColor=function(g){if(g==null){return null;}var d=typeof g;if(d==="string"){if(/#[0-9a-fA-F]{6}/.test(g)){return g;
}else{if(/[0-9a-fA-F]{6}/.test(g)){return"#"+g;}else{return null;}}}else{if(d==="number"){if(g==0){return"#000000";
}else{var e=Math.round(g).toString(16);while(e.length<6){e="0"+e;}return"#"+e;}}else{return null;}}};
OM.util.CSTransformUtil=OM.util.CSTransformUtil||{};OM.util.CSTransformUtil.csTransformFunctions=[];OM.util.CSTransformUtil.getCSTransformFunction=function(e,d){var g=OM.util.CSTransformUtil.csTransformFunctions[e];
if(g){return g[d];}else{return null;}};OM.util.CSTransformUtil.addCSTransformFunction=function(e,d,g){var l=OM.util.CSTransformUtil.csTransformFunctions[e];
if(!l){l=OM.util.CSTransformUtil.csTransformFunctions[e]=new Array();}l[d]=g;};OM.util.CSTransformUtil.transformOrdinates=function(l,d){var r=OM.util.ValidationUtil;
var e=null;var g=function(z){var t=z.length;var w=new Array(t);for(var u=0;u<t;u+=2){var s=l(z[u],z[u+1]);
w[u]=s.x;w[u+1]=s.y;}return w;};if(r.isNumberArray(d)){e=g(d);}else{var q=d.length;e=new Array(q);for(var o=0;
o<q;o++){if(r.isNumberArray(d[o])){e[o]=g(d[o]);}else{var n=d[o].length;e[o]=new Array(n);for(var m=0;
m<n;m++){e[o][m]=g(d[o][m]);}}}}return e;};OM.util.CSTransformUtil.loadCSTransformFunction=function(){var d=OM.util.CSTransformUtil;
var e=d.addCSTransformFunction;e(54004,8307,function(g,l){return d.mercatorToGeodetic(g,l,54004,8307);
});e(8307,54004,function(g,l){return d.geodeticToMercator(g,l,8307,54004);});e(3785,8307,function(g,l){return d.SphereMercatorToGeodetic(g,l,6378137);
});e(8307,3785,function(g,l){return d.geodeticToSphereMercator(g,l,6378137);});e(3857,8307,function(g,l){return d.SphereMercatorToGeodetic(g,l,6378137);
});e(8307,3857,function(g,l){return d.geodeticToSphereMercator(g,l,6378137);});e(53004,8307,function(g,l){return d.SphereMercatorToGeodetic(g,l,6371000);
});e(8307,53004,function(g,l){return d.geodeticToSphereMercator(g,l,6371000);});e(53004,54004,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6371000);
return d.geodeticToMercator(l.x,l.y,8307,54004);});e(54004,53004,function(g,m){var l=d.mercatorToGeodetic(g,m,54004,8307);
return d.geodeticToSphereMercator(l.x,l.y,6371000);});e(3785,54004,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6378137);
return d.geodeticToMercator(l.x,l.y,8307,54004);});e(54004,3785,function(g,m){var l=d.mercatorToGeodetic(g,m,54004,8307);
return d.geodeticToSphereMercator(l.x,l.y,6378137);});e(3857,54004,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6378137);
return d.geodeticToMercator(l.x,l.y,8307,54004);});e(54004,3857,function(g,m){var l=d.mercatorToGeodetic(g,m,54004,8307);
return d.geodeticToSphereMercator(l.x,l.y,6378137);});e(3785,53004,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6378137);
return d.geodeticToSphereMercator(l.x,l.y,6371000);});e(53004,3785,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6371000);
return d.geodeticToSphereMercator(l.x,l.y,6378137);});e(3857,53004,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6378137);
return d.geodeticToSphereMercator(l.x,l.y,6371000);});e(53004,3857,function(g,m){var l=d.SphereMercatorToGeodetic(g,m,6371000);
return d.geodeticToSphereMercator(l.x,l.y,6378137);});e(3857,3785,function(g,l){return{x:g,y:l};});e(3785,3857,function(g,l){return{x:g,y:l};
});};OM.util.CSTransformUtil.csParameters=[{srid:54004,params:[0,0,1,0,0]},{srid:8307,params:[6378137,298.257223563]}];
OM.util.CSTransformUtil.geodeticToMercator=function(l,q,s,u){var g=OM.util.CSTransformUtil.getCSParameters(u);
var H=OM.util.CSTransformUtil.getCSParameters(s);if(!g||!H){return null;}var G=OM.util.GeomUtil.getRadiansFromLatLon(l,q);
l=G.x;q=G.y;var D=g[3];var t=g[4];var r=g[2];var E=g[1];var F=H[0];var A=1/H[1];var C=Math.sqrt(2*A-A*A);
var o=D+F*r*(l-E);var d=Math.sin(q);var B=Math.tan(Math.PI/4+q/2);var z=(1-C*d)/(1+C*d);var w=C/2;var m=Math.pow(z,w);
var n=t+F*r*Math.log(B*m);return{x:o,y:n};};OM.util.CSTransformUtil.mercatorToGeodetic=function(L,K,o,d){var r=OM.util.CSTransformUtil.getCSParameters(o);
var T=OM.util.CSTransformUtil.getCSParameters(d);if(!r||!T){return null;}var G=r[3];var w=r[4];var F=r[2];
var g=r[1];var ab=T[0];var X=1/T[1];var Z=Math.sqrt(2*X-X*X);var m=K;var n=L;var q=Math.E;var O=Math.pow(q,((w-m)/(ab*F)));
var s=Math.PI/2-2*Math.atan2(O,1);var M=Math.pow(Z,4);var J=Math.pow(Z,6);var I=Math.pow(Z,8);var aa=Z*Z/2;
var Y=5*M/24;var W=J/12;var V=13*I/360;var U=Math.sin(2*s);var S=7*M/48;var R=29*J/240;var Q=811*I/11520;
var P=Math.sin(2*s);var D=7*J/120;var C=81*I/1120;var A=Math.sin(6*s);var z=4279*I/161280;var u=Math.sin(8*s);
var H=s+(aa+Y+W+V)*U+(S+R+Q)*P+(D+C)*A+z*u;var l=((n-G)/(ab*F))+g;return OM.util.GeomUtil.getLatLonFromRadians(l,H);
};OM.util.CSTransformUtil.getCSParameters=function(e){var l=OM.util.CSTransformUtil.csParameters;var d=l.length;
for(var g=0;g<d;g++){if(l[g].srid==e){return l[g].params;}}return null;};OM.util.CSTransformUtil.geodeticToSphereMercator=function(q,o,e){var n=OM.util.GeomUtil.getRadiansFromLatLon(q,o);
q=n.x;o=n.y;var d=Math.sin(o);var g=Math.log((1+d)/(1-d));var m=e*q;var l=g*e/2;return{x:m,y:l};};OM.util.CSTransformUtil.SphereMercatorToGeodetic=function(d,q,g){var o=d/g;
var l=q*2/g;var n=Math.pow(Math.E,l);var e=(n-1)/(n+1);var m=Math.asin(e);return OM.util.GeomUtil.getLatLonFromRadians(o,m);
};OM.util.CSTransformUtil.loadCSTransformFunction();OM.util.HttpRequest={};OM.util.HttpRequest.localDomain=document.location.protocol+"//"+document.location.host;
OM.util.HttpRequest.instanceId=Math.round(Math.random()*10000);OM.util.HttpRequest.reqCount=0;OM.util.HttpRequest.scriptTagCount=0;
OM.util.HttpRequest.requests=new Array();OM.util.HttpRequest.urlMaxLength=4000;OM.util.HttpRequest.instanceIdTable={};
if(OM.$.browser.msie){var idx=OM.$.browser.version.indexOf(".");var v=0;if(idx>0){v=parseInt(OM.$.browser.version.substring(0,idx));
}else{v=parseInt(OM.$.browser.version);}if(v<8){OM.util.HttpRequest.urlMaxLength=2048;}}OM.util.HttpRequest.send=function(d,m,g,r,n,e,q){if(!d){return;
}if(typeof q==="undefined"){q=OM.gv.proxyEnabled;}var s=OM.util.HttpRequest;var l=function(u,z,w){if(w=="abort"){return;
}if(n){n(u,z,w);return;}var t="URL: "+d;if(w){t+="\nError: "+w;}if(u&&u.responseText){t+="\nResponse : "+u.responseText;
}OM.util.Logger.alert("MAPVIEWER-05511","OM.util.HttpRequest.send",t);};if(s.isLocalDomain(d)){if(r=="json"){return new s.XHR(OM.$.post(d,m,function(z){try{var u=null;
u=OM.$.parseJSON(z);g(u);}catch(t){var w=t.message;if(t.stack){w+="\nStack: "+t.stack;}OM.util.Logger.warning(0,"OM.util.HttpRequest.send",w);
}},"text")).setErrorHandler(l);}else{return new s.XHR(OM.$.post(d,m,g,r));}}else{if(q){var o=OM.util.HttpRequest.localDomain+OM.gv.proxyPath;
m.rtarget=d;return new s.XHR(OM.$.post(o,m,function(t){g(t);},r)).setErrorHandler(l);}else{return s.sendAsScripts(d,m,g,r,e);
}}};OM.util.HttpRequest.sendAsScripts=function(d,l,g,s,e){if(!d){return null;}var t=OM.util.HttpRequest;
var o=t.instanceIdTable[d];if(typeof o==="undefined"){var n="v2"+t.reqCount++;var u=d;if(u.indexOf("?")>0){u+="&";
}else{u+="?";}u+="callback_id="+n+"&";var m="text";var q=r;if(e){t.instanceIdTable[d]="-1";m=s;q=g;}else{u+="getinstid=true";
}return t.sendAsScript(u,q,m,n);}else{return t.sendAsScriptsWithId(d,l,g,s,o);}function r(w){o=w;t.instanceIdTable[d]=w;
t.sendAsScriptsWithId(d,l,g,s,o);}};OM.util.HttpRequest.sendAsScriptsWithId=function(l,r,o,A,u){var B=OM.util.HttpRequest;
var C=new B.XHR();var t="v2"+u+"_"+B.reqCount++;if(l.indexOf("?")>0){l+="&";}else{l+="?";}l+="callback_id="+t+"&";
var n=l+OM.$.param(r);var z=l.length;if(n.length>B.urlMaxLength){var g={};for(param in r){g[param]=r[param]+"";
}var s=1;var w=new Date();l+="ref="+(Math.floor(Math.random()*10000))+"&";while(true){var m=l+"pn="+s;
var e=B.getParameters(g,B.urlMaxLength-m.length);if(B.getParametersCount(g)>0){var q=B.sendAsScript(m+e,o,A,t,s);
C.addScriptId(q.getScriptIds()[0]);}else{var q=B.sendAsScript(l+"pn=e"+s+e,o,A,t,s);C.addScriptId(q.getScriptIds()[0]);
break;}s++;}return C;}else{return B.sendAsScript(n,o,A,t);}};OM.util.HttpRequest.sendAsScript=function(d,m,o,l,n){if(!d){return null;
}var g=OM.util.HttpRequest;var e=document.createElement("script");e.id="OMV_XHR_"+g.scriptTagCount++;
e.src=d;e.type="text/javascript";e.charset="utf-8";g.requests.push({jsNode:e,callBack:m,reqId:l,format:o,parts:n});
document.body.appendChild(e);var q=new g.XHR();q.addScriptId(e.id);return q;};OM.util.HttpRequest.callBack=function(q,n,m){var o=OM.util.HttpRequest.requests;
while(o.length>0){var g=o[0];if(!g.callBack&&!g.parts){if(g.jsNode){try{document.body.removeChild(g.jsNode);
}catch(e){}g.jsNode=null;}o.shift();}else{break;}}var d=0;for(;d<o.length;d++){var g=o[d];if(g.reqId==q&&g.parts==m){var l=false;
var g=o[d];try{document.body.removeChild(g.jsNode);}catch(e){l=true;}g.jsNode=null;if(d==0){o.shift();
}if(!l&&n!=null&&g.callBack){if(g.format=="json"){if(typeof n==="string"){g.callBack(OM.$.parseJSON(n));
}else{g.callBack(n);}}else{if(g.format=="xml"){g.callBack(OM.util.XMLUtil.parse(n));}else{g.callBack(n);
}}}g.callBack=null;return;}}};OM.util.HttpRequest.isLocalDomain=function(d){var e=OM.util.HttpRequest;
d=OM.$.trim(d);if(d.toLowerCase().indexOf("http://")==0||d.toLowerCase().indexOf("https://")==0){return(e.getDomain(d)==e.localDomain);
}else{return true;}};OM.util.HttpRequest.getDomain=function(d){if(!d){return null;}var g=d.indexOf("://");
if(g>0){g+=3;var e=d.indexOf("/",g);if(e>0){return d.substring(0,e);}else{return d.substring(0);}}else{return null;
}};OM.util.HttpRequest.getParameters=function(m,d){var u="";for(var e in m){var q=("&"+e+"=");if(u.length+q.length>=d){return u;
}u+=q;d=d-u.length;var s=m[e];var o=encodeURIComponent(s);var g=o.length;if(g<=d){u+=o;delete m[e];}else{var l=s.length;
var r=Math.floor(d*(l*1/g));for(var n=r;n>=0;n--){var t=s.substring(0,n);var o=encodeURIComponent(t);
if(o.length<=d){m[e]=s.substring(n);return u+=o;}}}}return u;};OM.util.HttpRequest.getParametersCount=function(g){var e=0;
for(var d in g){++e;}return e;};OM.util.HttpRequest.XHR=function(d){this.scriptTags=new Array();this.jQXHR=null;
this.error=null;if(d){this.jQXHR=d;}};OM.util.HttpRequest.XHR.prototype.addScriptId=function(d){this.scriptTags.push(d);
};OM.util.HttpRequest.XHR.prototype.getScriptIds=function(){return this.scriptTags;};OM.util.HttpRequest.XHR.prototype.abort=function(){if(this.jQXHR){this.jQXHR.abort();
}else{for(var e=0;e<this.scriptTags.length;e++){var d=document.getElementById(this.scriptTags[e]);if(d&&d.parentNode){try{d.parentNode.removeChild(d);
}catch(g){}}}}};OM.util.HttpRequest.XHR.prototype.setErrorHandler=function(d){if(this.jQXHR){this.jQXHR.error(d);
}else{this.error=d;}return this;};OM.util.CoverageGrid=function(d){this.xResolution=null;this.yResolution=null;
this.grid=new Object();this.gridWidth=128;this.gridHeight=128;this.gridDeviceSize=128;this.setBox(d);
};OM.util.CoverageGrid.prototype.setBox=function(d){this.minX=d.minX;this.minY=d.minY;this.maxX=d.maxX;
this.maxY=d.maxY;if(typeof d.gridSize!="undefined"){this.gridDeviceSize=d.gridSize;}};OM.util.CoverageGrid.prototype.init=function(d,e){this.clear();
};OM.util.CoverageGrid.prototype.clear=function(){var d=this.grid;for(idx in d){delete d[idx];}};OM.util.CoverageGrid.prototype.conflicts=function(m){var o=Math.floor((m[0]-this.minX)/this.gridWidth);
var n=Math.floor((m[1]-this.minY)/this.gridHeight);var l=Math.floor((m[2]-this.minX)/this.gridWidth);
var g=Math.floor((m[3]-this.minY)/this.gridHeight);for(var e=o;e<=l;e++){for(var d=n;d<=g;d++){if(this.conflictsWithCell(e,d,m)){return true;
}}}return false;};OM.util.CoverageGrid.prototype.insert=function(m){var o=Math.floor((m[0]-this.minX)/this.gridWidth);
var n=Math.floor((m[1]-this.minY)/this.gridHeight);var l=Math.floor((m[2]-this.minX)/this.gridWidth);
var g=Math.floor((m[3]-this.minY)/this.gridHeight);for(var e=o;e<=l;e++){for(var d=n;d<=g;d++){this.insertToCell(e,d,m);
}}};OM.util.CoverageGrid.prototype.remove=function(m){var o=Math.floor((m[0]-this.minX)/this.gridWidth);
var n=Math.floor((m[1]-this.minY)/this.gridHeight);var l=Math.floor((m[2]-this.minX)/this.gridWidth);
var g=Math.floor((m[3]-this.minY)/this.gridHeight);for(var e=o;e<=l;e++){for(var d=n;d<=g;d++){this.removeFromCell(e,d,m);
}}};OM.util.CoverageGrid.prototype.insertToCell=function(g,e,d){if(!this.grid[g]){this.grid[g]=new Object();
}if(!this.grid[g][e]){this.grid[g][e]=new Array();}this.grid[g][e].push(d);};OM.util.CoverageGrid.prototype.conflictsWithCell=function(n,m,g){if(!this.grid[n]){return false;
}if(!this.grid[n][m]){return false;}var d=this.grid[n][m];for(var e=0;e<d.length;e++){var l=d[e];if(l[2]<=g[0]||l[0]>=g[2]||l[3]<g[1]||l[1]>g[3]){continue;
}else{return true;}}return false;};OM.util.CoverageGrid.prototype.removeFromCell=function(m,l,g){if(!this.grid[m]){return;
}if(!this.grid[m][l]){return;}var d=this.grid[m][l];for(var e=0;e<d.length;e++){if(d[e]==g){this.grid[m].splice(e,1);
return;}}};OM.util.MiscUtil={arraysAreEqual:function(g,e){if(g==e||g==null&&e==null||g==null&&e.length==0||g.length==0&&e==null){return true;
}else{if(g==null||e==null||g.length!=e.length){return false;}else{for(var l=0,d=g.length;l<d;l++){if(g[l]!=e[l]){return false;
}}}}return true;},mixin:function(m){var d=Array.prototype.slice.call(arguments,1),g=d.length,n;for(var e=0;
e<g;e++){n=d[e];if(n){for(var l in n){if(n.hasOwnProperty(l)){m[l]=n[l];}}}}return m;},mark:(function(){var e=0,d="_omapsid_";
return function(g){g[d]=g[d]||++e;return g[d];};}()),transparentImgURL:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};
OM.util.MiscUtil.cleanObj=function(e){for(var d in e){if(e[d]&&typeof e[d]=="object"){OM.util.MiscUtil.cleanObj(e[d]);
e[d]=null;}else{e[d]=null;}}};OM.util.GeoDataCache=function(e,d){this.url=null;this.name=e;this._data={};
this._count=0;this._mbr=null;this._restrictedArea=null;this._srid=d?d:8307;};OM.util.GeoDataCache.prototype.destroy=function(){this._data=null;
this._restrictedArea=null;};OM.util.GeoDataCache.prototype.setRestrictedArea=function(d){this._restrictedArea=d;
};OM.util.GeoDataCache.prototype.getRestrictedArea=function(){return this._restrictedArea;};OM.util.GeoDataCache.prototype.size=function(){return this._count;
};OM.util.GeoDataCache.prototype.get=function(d){if(this._data[d]){return this._data[d];}else{return null;
}};OM.util.GeoDataCache.prototype.put=function(d,e,l){if(!d||!e){return null;}if(!this.isAllowed(e,l)){return null;
}var g=this.get(d);this._data[d]=e;if(!g){this._count++;}if(!this._mbr){this._mbr=new OM.geometry.Rectangle(l.minX,l.minY,l.maxX,l.maxY,l.srid);
}else{this._mbr.expand(l);}return g;};OM.util.GeoDataCache.remove=function(d){if(!d){return;}if(this._data[d]){delete this._data[d];
this._count--;}};OM.util.GeoDataCache.isAllowed=function(d,e){if(!this._restrictedArea){return true;}else{}};
OM.geometry.Geometry=OM.Class.extend({initialize:function(d){this.type=null;this.srid=null;if(typeof d==="undefined"||d===null){this.srid=8307;
}else{if(!OM.util.ValidationUtil.isNumber(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Geometry","srid:"+d);
return null;}else{this.srid=(typeof d==="number")?d:parseInt(d);}}this.coordinates=null;this.geometries=null;
this.mbr=null;},getMBR:function(){if(!this.mbr){var d=OM.geometry.Geometry.calculateMBR(this.coordinates,this.type);
this.mbr=new OM.geometry.Rectangle(d.minX,d.minY,d.maxX,d.maxY,this.srid);}return this.mbr;},transform:function(g,l,n,d){if(!this.srid||!g){OM.util.Logger.alert("MAPVIEWER-05520","OM.geometry.Geometry.transform","");
return null;}if(this.srid==g){if(l){l(this);return;}else{return this;}}var q=OM.util.CSTransformUtil.getCSTransformFunction(this.srid,g);
if(q){var r=null;if(this instanceof OM.geometry.GeometryCollection){r=this.clientTransform(g);}else{var m=OM.util.CSTransformUtil.transformOrdinates(q,this.coordinates);
r=OM.geometry.Geometry.createGeometry({type:this.type,coordinates:m},g);}if(l){l(r);return;}else{return r;
}}var e=OM.gv.localbaseURL();if(!n&&e){n=e+"/mcserver";}else{if(!n){OM.util.Logger.alert("MAPVIEWER-05511","OM.geometry.Geometry.transform","invalid server URL");
return;}}paras={request:"cstransform",gformat:"geojson",dstsrid:g,datasource:d,geometry:this.toString()};
var s=this;var o=function(t,w,u){if(t){OM.util.Logger.alert("MAPVIEWER-05511","OM.geometry.Geometry.transform",t.responseText);
}else{OM.util.Logger.alert("MAPVIEWER-05511","OM.geometry.Geometry.transform","");}return;};OM.util.HttpRequest.send(n,paras,function(t){if(t){var u=OM.geometry.Geometry.createGeometry(t,g);
l(u);}else{OM.util.Logger.alert("MAPVIEWER-05511","OM.geometry.Geometry.transform","");}},"json",o);},clone:function(){var d={};
OM.$.extend(true,d,this);return d;},toString:function(){var e="{";e+='type:"'+this.type+'",';e+="srid:"+this.srid+",";
e+="coordinates:";if(this.type==OM.GeomTypes.MULTIPOINT||this.type==OM.GeomTypes.MULTILINESTRING||this.type==OM.GeomTypes.MULTIPOLYGON||this.type==OM.GeomTypes.POLYGON||this.type==OM.GeomTypes.ORIENTEDMULTIPOINT){e+="[";
var d=this.coordinates.length;for(var m=0;m<d;m++){e+="[";if(this.type==OM.GeomTypes.MULTIPOLYGON){var l=this.coordinates[m].length;
for(var g=0;g<l;g++){e+="["+this.coordinates[m][g]+"],";}l=e.length;e=e.substring(0,l-1);}else{e+=this.coordinates[m];
}e+="],";}d=e.length;e=e.substring(0,d-1);e+="]";}else{e+="["+this.coordinates+"]";}e+="}";return e;},densify:function(){if(this.type==OM.GeomTypes.POINT||this.type==OM.GeomTypes.MULTIPOINT||this.type==OM.GeomTypes.ORIENTEDPOINT||this.type==OM.GeomTypes.ORIENTEDMULTIPOINT){return this;
}var d={type:"GEODETIC",distConvFactor:1};if(this.srid!=8307&&this.srid!=8265&&this.srid!=4326&&this.srid!=4269&&(!d||d.type!="GEODETIC"&&d.type!="PROJECTED")){return this;
}var g=1;if(d&&d.type=="PROJECTED"){g=100000*d.distConvFactor;}var e=null;var q=null;if(this.type==OM.GeomTypes.LINESTRING){e=OM.util.GeomUtil.densifyOrdinates(this.coordinates,g);
q=this.type;}else{if(this.type==OM.GeomTypes.RECTANGLE){var r=[this.getMinX(),this.getMinY(),this.getMinX(),this.getMaxY(),this.getMaxX(),this.getMaxY(),this.getMaxX(),this.getMinY(),this.getMinX(),this.getMinY()];
e=OM.util.GeomUtil.densifyOrdinates(r,g);q="Polygon";}else{if(this.type==OM.GeomTypes.GEOMETRYCOLLECTION){var o=this.geometries.length;
var s=new Array(o);for(var n=0;n<o;n++){s[n]=this.geometries[n].densify();}return new OM.geometry.GeometryCollection(s,this.srid);
}else{var o=this.coordinates.length;e=new Array(o);for(var n=0;n<o;n++){if(this.type==OM.GeomTypes.MULTIPOLYGON){var m=this.coordinates[n].length;
e[n]=new Array(m);for(var l=0;l<m;l++){e[n][l]=OM.util.GeomUtil.densifyOrdinates(this.coordinates[n][l],g);
}}else{e[n]=OM.util.GeomUtil.densifyOrdinates(this.coordinates[n],g);}}q=this.type;}}}return new OM.geometry.Geometry.createGeometry({type:q,coordinates:e},this.srid);
},move:function(g,e){var d=this.type=="OrientedPoint"||this.type=="OrientedMultiPoint"?true:false;OM.util.GeomUtil.moveCoordinates(this.coordinates,g,e,d);
if(this.mbr){this.mbr.move(g,e);}},getSRID:function(){return this.srid;},getOrdinates:function(){return this.coordinates;
},getType:function(){return this.type;}});OM.geometry.Geometry.createGeometry=function(m,z){var o,n;var e=m.type;
var d=m.coordinates;var t=null;var g=OM.geometry.Geometry;if(e==OM.GeomTypes.POINT){o=d[0];n=d[1];t=new OM.geometry.Point(o,n,z);
}else{if(e==OM.GeomTypes.ORIENTEDPOINT){o=d[0];n=d[1];var s=d[2];var r=d[3];t=new OM.geometry.Point(o,n,z,s,r);
}else{if(e==OM.GeomTypes.LINESTRING){t=new OM.geometry.LineString(d,z);}else{if(e==OM.GeomTypes.RECTANGLE){var D=d[0];
var B=d[1];var C=d[2];var A=d[3];t=new OM.geometry.Rectangle(D,B,C,A,z);}else{if(e==OM.GeomTypes.POLYGON){t=new OM.geometry.Polygon(d,z);
}else{if(e==OM.GeomTypes.MULTIPOINT||e==OM.GeomTypes.ORIENTEDMULTIPOINT){t=new OM.geometry.MultiPoint(d,z);
}else{if(e==OM.GeomTypes.MULTILINESTRING){t=new OM.geometry.MultiLineString(d,z);}else{if(e==OM.GeomTypes.MULTIPOLYGON){t=new OM.geometry.MultiPolygon(d,z);
}else{if(e==OM.GeomTypes.GEOMETRYCOLLECTION){var q=m.geometries;var w=q.length;var l=g.createGeometry;
for(var u=0;u<w;u++){q[u]=l(q[u],z);}t=new OM.geometry.GeometryCollection(q,z);}}}}}}}}}if(m.mbr&&!(m.mbr instanceof g)){t.mbr=new OM.geometry.Rectangle(m.mbr.minX,m.mbr.minY,m.mbr.maxX,m.mbr.maxY,z);
}return t;};OM.geometry.Geometry.calculateMBR=function(t,r){var n=OM.util.ValidationUtil;var d=t.length;
if(d>=1){var s=new Array();if(!n.isNumberArray(t)){for(var l=0;l<d;l+=1){if(!n.isNumberArray(t[l])){var m=t[l].length;
for(var g=0;g<m;g+=1){s=s.concat(t[l][g]);}}else{if(r==OM.GeomTypes.ORIENTEDMULTIPOINT){s=s.concat(t[l][0],t[l][1]);
}else{s=s.concat(t[l]);}}}}else{if(r==OM.GeomTypes.ORIENTEDPOINT){s.push(t[0],t[1]);}else{s=t;}}var e=s.length;
if(e>1){var w=s[0];var q=w;var u=s[1];var o=u;for(var l=0;l<e;l+=2){if(s[l]<w){w=s[l];}else{if(s[l]>q){q=s[l];
}}if(s[l+1]<u){u=s[l+1];}else{if(s[l+1]>o){o=s[l+1];}}}return{minX:w,minY:u,maxX:q,maxY:o};}}return null;
};OM.geometry.Geometry.calculateGeomCollectionMBR=function(g,l){if(!g||g.length==0||l!==OM.GeomTypes.GEOMETRYCOLLECTION){return null;
}var m;var n=null,d=null;for(var e=0;e<g.length;e++){m=g[e].coordinates;if(!m){continue;}d=OM.geometry.Geometry.calculateMBR(m,g[e].type);
if(!n){n={};n.minX=d.minX;n.minY=d.minY;n.maxX=d.maxX;n.maxY=d.maxY;}else{if(n.minX>d.minX){n.minX=d.minX;
}if(n.minY>d.minY){n.minY=d.minY;}if(n.maxX<d.maxX){n.maxX=d.maxX;}if(n.maxY<d.maxY){n.maxY=d.maxY;}}}return n;
};OM.geometry.Rectangle=OM.geometry.Geometry.extend({initialize:function(d,m,l,g,e){this._super(e);this.setRectangle(d,m,l,g);
},getCenter:function(){return new OM.geometry.Point((this.getMaxX()-this.getMinX())/2+this.getMinX(),(this.getMaxY()-this.getMinY())/2+this.getMinY(),this.srid);
},getMinX:function(){return this.coordinates[0];},getMinY:function(){return this.coordinates[1];},getMaxX:function(){return this.coordinates[2];
},getMaxY:function(){return this.coordinates[3];},getWidth:function(){return this.coordinates[2]-this.coordinates[0];
},getHeight:function(){return this.coordinates[3]-this.coordinates[1];},setRectangle:function(d,n,m,l){var g=OM.util.ValidationUtil.isNumber;
if(!g(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Rectangle.setRectangle","minX:"+d);return null;
}if(!g(m)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Rectangle.setRectangle","maxX:"+m);return null;
}if(!g(n)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Rectangle.setRectangle","minY:"+n);return null;
}if(!g(l)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Rectangle.setRectangles","maxY:"+l);return null;
}var e;if(d>m){e=m;m=d;d=e;}if(n>l){e=l;l=n;n=e;}this.type="Rectangle";this.coordinates=[d,n,m,l];},move:function(e,d){this.coordinates[0]+=e;
this.coordinates[1]+=d;this.coordinates[2]+=e;this.coordinates[3]+=d;},expand:function(d){if(!d||d.type!==this.type){return;
}if(this.coordinates[0]>d.minX){this.coordinates[0]=d.minX;}if(this.coordinates[1]>d.minY){this.coordinates[1]=d.minY;
}if(this.coordinates[2]<d.maxX){this.coordinates[2]=d.maxX;}if(this.coordinates[3]<d.maxY){this.coordinates[3]=d.maxY;
}},toGML:function(){var d='<Polygon srsName="SDO:'+this.srid+'" >';d+="<outerBoundaryIs><LinearRing><coordinates>";
d+=this.getMinX()+","+this.getMinY()+" "+this.getMaxX()+","+this.getMinY()+" ";d+=this.getMaxX()+","+this.getMaxY()+" "+this.getMinX()+","+this.getMaxY()+" ";
d+=this.getMinX()+","+this.getMinY()+"</coordinates></LinearRing></outerBoundaryIs>";d+="</Polygon>";
return d;}});OM.geometry.Point=OM.geometry.Geometry.extend({initialize:function(d,n,g,l,e){this._super(g);
var m=OM.util.ValidationUtil.isNumber;if(!m(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","x:"+d);
return null;}if(!m(n)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","y:"+n);return null;
}if(typeof l!=="undefined"&&typeof e!=="undefined"){if(!m(l)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","orientationX:"+l);
return null;}if(!m(e)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","orientationY:"+e);
return null;}this.type="OrientedPoint";this.coordinates=[d,n,l,e];}else{this.type="Point";this.coordinates=[d,n];
}},equals:function(d){if(d===null||typeof d==="undefined"){return false;}if(d.type!==this.type){return false;
}if(d.srid!==this.srid){return false;}if(this.coordinates[0]!==d.coordinates[0]||this.coordinates[1]!==d.coordinates[1]){return false;
}if(this.type==="OrientedPoint"){if(this.coordinates[2]!==d.coordinates[2]||this.coordinates[3]!==d.coordinates[3]){return false;
}}return true;},getX:function(){return this.coordinates[0];},getY:function(){return this.coordinates[1];
},getOrientationX:function(){return this.coordinates[2];},getOrientationY:function(){return this.coordinates[3];
},isOriented:function(){if(this.coordinates.length>2){return true;}else{return false;}},setPoint:function(d,g){var e=OM.util.ValidationUtil.isNumber;
if(!e(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","x:"+d);return;}if(!e(g)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Point","y:"+g);
return;}this.x=d;this.y=g;this.coordinates[0]=d;this.coordinates[1]=g;},move:function(e,d){this.x+=e;
this.y+=d;this._super(e,d);},toGML:function(){var e=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates);
var d='<Point srsName="SDO:'+this.srid+'" ><coordinates>';d=d+e+"</coordinates></Point>";return d;},getOrientationPoint:function(d,l,m){if(m==null){if(this.isOriented()){m=Math.atan2(this.coordinates[3],this.coordinates[2]);
}else{return null;}}var e=d*Math.cos(m)*l.resolution;var g=d*Math.sin(m)*l.resolution*l.stretchRatio;
return new OM.geometry.Point(this.coordinates[0]+e,this.coordinates[1]+g,this.srid);}});OM.geometry.LineString=OM.geometry.Geometry.extend({initialize:function(e,d){this._super(d);
if(e==undefined||e==null||!OM.util.ValidationUtil.isNumberArray(e)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.LineString","ordinates:"+e);
throw new Error("LineString.initialize(): no ordinates found.");}if(e.length<4){throw new Error("LineString.initialize(): ordinates must have at least 4 elements.");
}this.type="LineString";this.coordinates=e;},toGML:function(){var e=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates);
var d='<LineString srsName="SDO:'+this.srid+'" ><coordinates>';d=d+e+"</coordinates></LineString>";return d;
},getFirstPoint:function(){var d=this.coordinates;if(d.length<2){return null;}return new OM.geometry.Point(d[0],d[1],this.srid);
},getLastPoint:function(){var e=this.coordinates;if(e.length<2){return null;}var d=e.length;return new OM.geometry.Point(e[d-2],e[d-1],this.srid);
}});OM.geometry.LineString.create=function(e){if(e==null||e.length<2){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.LineString.create","pointArray:"+e);
return null;}var d=OM.util.GeomUtil.flatten(e,"Point");if(!d){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.LineString.create","pointArray:"+e);
return null;}return new OM.geometry.LineString(d.ordinates,d.srid);};OM.geometry.Polygon=OM.geometry.Geometry.extend({initialize:function(g,d){this._super(d);
var e=OM.util.ValidationUtil;if(g==undefined||g==null||g.length==0){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon","ordinates:"+g);
return null;}if(e.isNumberArray(g)){g=[g];}if(!e.isNumberArray(g[0])){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon","ordinates:"+g);
return null;}this.type="Polygon";this.coordinates=g;},toGML:function(){var g=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[0]);
var d='<Polygon srsName="SDO:'+this.srid+'" >';d+="<outerBoundaryIs><LinearRing><coordinates>";d+=g+"</coordinates></LinearRing></outerBoundaryIs>";
if(this.coordinates.length>1){var e=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[1]);d+="<innerBoundaryIs><LinearRing><coordinates>";
d+=e+"</coordinates></LinearRing></innerBoundaryIs>";}d+="</Polygon>";return d;}});OM.geometry.Polygon.createCirclePolygon=function(m,l,d,e){if(!e){e=8307;
}var g=new Array();for(i=0;i<36;i++){var n=i*Math.PI/18;g[i*2]=m+d*Math.cos(n);g[i*2+1]=l+d*Math.sin(n);
}g[72]=g[0];g[73]=g[1];return new OM.geometry.Polygon(g,e);};OM.geometry.Polygon.createGeodeticCirclePolygon=function(n,m,e,g){if(!g){g=8307;
}var l=new Array();for(i=0;i<36;i++){var d=OM.util.GeomUtil.getPointAtBearing(n,m,e,i*Math.PI/18);l[i*2]=d.getX();
l[i*2+1]=d.getY();}l[72]=l[0];l[73]=l[1];return new OM.geometry.Polygon(l,g);};OM.geometry.Polygon.create=function(d,l){if(d==null||d.length<3){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon.create","pointArray:"+d);
return null;}var g=OM.util.GeomUtil.flatten(d,"Point");if(!g){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon.create","pointArray:"+d);
return null;}if(l&&l.length>2){var e=OM.util.GeomUtil.flatten(l,"Point");if(!e){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon.create","outerPointArray:"+l);
return null;}else{if(g.srid!==e.srid){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Polygon.create","SRID is different");
return null;}}return new OM.geometry.Polygon([g.ordinates,e.ordinates],g.srid);}return new OM.geometry.Polygon([g.ordinates],g.srid);
};OM.geometry.Circle=OM.geometry.Geometry.extend({initialize:function(m,l,d,e){this._super(e);var g=OM.util.ValidationUtil.isNumber;
if(!g(m)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle","centerX:"+m);return null;}if(!g(l)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle","centerY:"+l);
return null;}if(!g(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle","radius:"+d);return null;
}if(!e||!g(e)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle","srid:"+e);return null;}this.centerX=m;
this.centerY=l;this.radius=d;this.toCirclePolygon();this.type="Polygon";},getRadius:function(){return this.radius;
},getCenterX:function(){return this.centerX;},getCenterY:function(){return this.centerY;},setCircle:function(e,l,d){var g=OM.util.ValidationUtil.isNumber;
if(!g(centerX)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle.setCircle","centerX:"+centerX);
return null;}if(!g(centerY)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle.setCircle","centerY:"+centerY);
return null;}if(!g(d)){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.Circle.setCircle","radius:"+d);
return null;}this.centerX=e;this.centerY=l;this.radius=d;this.toCirclePolygon();},toCirclePolygon:function(){if(this.circlePolygon){return;
}this.circlePolygon=OM.geometry.Polygon.createCirclePolygon(this.centerX,this.centerY,this.radius,this.srid);
this.coordinates=this.circlePolygon.coordinates;},move:function(e,d){this.centerX+=e;this.centerY+=d;
this._super(e,d);},toGML:function(){if(!this.circlePolygon){this.toCirclePolygon();}return this.circlePolygon.toGML();
}});OM.geometry.MultiPoint=OM.geometry.Geometry.extend({initialize:function(n,e){this._super(e);var l=OM.util.ValidationUtil;
if(n==null||n.length<1){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPoint","ordinates:"+n);
return null;}if(!l.isNumberArray(n[0])){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPoint","ordinates:"+n);
return null;}var d=n.length;var g=true;for(var m=0;m<d;m++){if(n[m].length<4){g=false;}}if(g){this.type="OrientedMultiPoint";
}else{this.type="MultiPoint";}this.coordinates=n;},toGML:function(){var d=this.coordinates.length;var g='<MULTIPOINT srsName="SDO:'+this.srid+'">';
for(var e=0;e<d;e++){var l=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[e]);g+="<pointMember>";
g+='<Point srsName="SDO:'+this.srid+'"><coordinates>';g+=l+"</coordinates></Point>";g+="<pointMember>";
}g+="</MULTIPOINT>";return g;}});OM.geometry.MultiPoint.create=function(e){if(e==null||e.length<2){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPoint.create","pointArray:"+e);
return null;}var d=OM.util.GeomUtil.flatten(e,"Point",true);if(!d){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPoint.create","pointArray:"+e);
return null;}return new OM.geometry.MultiPoint(d.ordinates,d.srid);};OM.geometry.MultiLineString=OM.geometry.Geometry.extend({initialize:function(m,e){this._super(e);
var g=OM.util.ValidationUtil;var d=m==null?0:m.length;if(d<1){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiLineString","ordinates:"+m);
return null;}for(var l=0;l<d;l++){if(m[l]!=undefined&&m[l]!=null&&!g.isNumberArray(m[l])){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiLineString","ordinates:"+m);
return null;}}this.type="MultiLineString";this.coordinates=m;},toGML:function(){var g=this.coordinates.length;
var d='<MultiLineString srsName="SDO:'+this.srid+'" >';for(var e=0;e<g;e++){d=d+"<lineStringMember>";
var l=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[e]);d+='<LineString srsName="SDO:'+this.srid+'" ><coordinates>';
d+=l+"</coordinates></LineString>";d=d+"</lineStringMember>";}d=d+"</MultiLineString>";return d;}});OM.geometry.MultiLineString.create=function(e){if(e==null||e.length<2){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiLineString.create","lineArray:"+e);
return null;}var d=OM.util.GeomUtil.flatten(e,"LineString",true);if(!d){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiLineString.create","lineArray:"+e);
return null;}return new OM.geometry.MultiLineString(d.ordinates,d.srid);};OM.geometry.MultiPolygon=OM.geometry.Geometry.extend({initialize:function(m,e){this._super(e);
var g=OM.util.ValidationUtil;var d=m==null?0:m.length;if(d<1){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPolygon","ordinates:"+m);
return null;}for(var l=0;l<d;l++){if(m[l]==undefined||m[l]==null||m[l].length==0){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPolygon","ordinates:"+m);
return null;}if(g.isNumberArray(m[l])){m[l]=[m[l]];}if(!g.isNumberArray(m[l][0])){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPolygon","ordinates:"+m);
return null;}}this.type="MultiPolygon";this.coordinates=m;},toGML:function(){var d=this.coordinates.length;
var m='<MULTIPOLYGON srsName="SDO:'+this.srid+'" >';for(var l=0;l<d;l++){m+="<polygonMember>";var g=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[l][0]);
m+='<Polygon srsName="SDO:'+this.srid+'" >';m+="<outerBoundaryIs><LinearRing><coordinates>";m+=g+"</coordinates></LinearRing></outerBoundaryIs>";
if(this.coordinates[l].length>1){var e=OM.util.GeomUtil.getOGCOrdinateString(this.coordinates[l][1]);
m+="<innerBoundaryIs><LinearRing><coordinates>";m+=e+"</coordinates></LinearRing></innerBoundaryIs>";
}m+="</Polygon>";m+="</polygonMember>";}m+="</MULTIPOLYGON>";return m;}});OM.geometry.MultiPolygon.create=function(e){if(e==null||e.length<2){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPolygon.create","polygonArray:"+e);
return null;}var d=OM.util.GeomUtil.createOrdinatesFromGeometries(e,"Polygon",true);if(!d){OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.MultiPolygon.create","polygonArray:"+e);
return null;}return new OM.geometry.MultiPolygon(d.ordinates,d.srid);};OM.geometry.GeometryCollection=OM.geometry.Geometry.extend({initialize:function(g,e){this._super(e);
var d=g.length;for(var l=0;l<d;l++){if(g[l] instanceof OM.geometry.Geometry){if(e==null){g[l].srid=e;
}else{if(g[l].srid!=e){g[l].transform(e);}}}else{OM.util.Logger.alert("MAPVIEWER-05519","OM.geometry.GeometryCollection","geometryArray:"+g);
return null;}}this.geometries=g;this.type="GeometryCollection";},getMBR:function(){if(!this.mbr){var d=OM.geometry.Geometry.calculateGeomCollectionMBR(this.geometries,this.type);
this.mbr=new OM.geometry.Rectangle(d.minX,d.minY,d.maxX,d.maxY,this.srid);}return this.mbr;},toString:function(){var e="{";
e+='type:"'+this.type+'",';e+="srid:"+this.srid+",";e+="geometries:[";var d=this.geometries.length;for(var g=0;
g<d;g++){e+=this.geometries[g].toString()+",";}d=e.length;e=e.substring(0,d-1);e+="]}";return e;},clientTransform:function(l,g){var e=this.geometries.length;
var d=new Array(e);for(var m=0;m<e;m++){d[m]=this.geometries[m].transform(l);}return new OM.geometry.GeometryCollection(d,l);
},move:function(l,g){var d=this.geometries.length;for(var e=0;e<d;e++){this.geometries[e].move(l,g);}if(this.mbr){this.mbr.move(l,g);
}},toGML:function(){var d=this.geometries.length;var g='<GeometryCollection srsName="SDO:'+this.srid+'" >';
for(var e=0;e<d;e++){g+="<geometryMember>";g+=this.geometries[e].toGML();g+="</geometryMember>";}g+="</GeometryCollection>";
return g;}});OM.event.EventSource={addListener:function(e,l,d){this._omListeners=this._omListeners||{};
var g=this._omListeners;g[e]=g[e]||[];g[e].push({listener:l,context:d||this});return this;},hasListener:function(e){var d="_omListeners";
return(d in this)&&(e in this[d])&&(this[d][e].length>0);},getListeners:function(d){if(this.hasListener(d)){return this._omListeners[d];
}else{return[];}},deleteListener:function(l,n,g){if(!this.hasListener(l)){return this;}for(var e=0,m=this._omListeners,d=m[l].length;
e<d;e++){if((m[l][e].listener===n)&&(!g||(m[l][e].context===g))){m[l].splice(e,1);return this;}}return this;
},deleteListeners:function(d){if(!this.hasListener(d)){return this;}this._omListeners[d]=null;return this;
},deleteAllListeners:function(){this._omListeners={};return this;},fire:function(d){if(!this.hasListener(d)){return this;
}var q=this._omListeners[d].slice(),o=[].slice.apply(arguments),m,r;if(o.length>=2){o.splice(0,1);}for(var l=0,n=q.length;
l<n;l++){m=q[l].listener;if(!m){continue;}r=q[l].context||this;try{if(o.length>0){m.apply(r,o);}else{m.call(r);
}}catch(g){var e=g.message;if(g.stack){e+="\nStack: "+g.stack;}OM.util.Logger.warning(0,"EventSource.fire",e);
}}return this;}};OM.event.EventSource.on=OM.event.EventSource.addListener;OM.event.Event=OM.Class.extend({initialize:function(d,e){if(d==undefined||d==null||e==undefined||e==null){return null;
}this.type=d;this.target=e;}});OM.event.MapEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);
this.beforeZoomLevel=null;this.affectedLayer=null;this.preMapCenter=null;}});OM.event.MapEvent.I_MAP_CENTER_ZOOM="i_mapCenterZoom";
OM.event.MapEvent.I_MAP_DRAGGING="i_mapDragging";OM.event.MapEvent.MAP_BEFORE_ZOOM="mapBeforeZoom";OM.event.MapEvent.MAP_AFTER_ZOOM="mapAfterZoom";
OM.event.MapEvent.MAP_RECENTERED="mapRecentered";OM.event.MapEvent.MAP_INITIALIZED="mapInitialized";OM.event.MapEvent.MAP_RESET_UNIVERSE="mapResetUniverse";
OM.event.MapEvent.MAP_RESIZED="mapResized";OM.event.MapEvent.MAP_BEFORE_REFRESH="mapBeforeRefresh";OM.event.MapEvent.MAP_REDRAW="mapRedraw";
OM.event.MapEvent.MAP_AFTER_REFRESH="mapAfterRefresh";OM.event.MapEvent.LAYER_ADDED="layerAdded";OM.event.MapEvent.LAYER_DELETED="layerDeleted";
OM.event.MapEvent.LAYER_REORDERED="layerReordered";OM.event.MapEvent.MAP_DESTROY="mapDestroy";OM.event.MapEvent.MAP_RESTRICT_CENTER="mapRestrictCenter";
OM.event.MapEvent.MAP_STYLE_CHANGED="mapStyleChanged";OM.event.MapEvent.MAP_CLEAN="mapClean";OM.event.MapEvent.I_MAP_NSDP_MAPPED="mapNSDPMapped";
OM.event.KeyboardEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);this.event=null;
}});OM.event.KeyboardEvent.KEY_DOWN="keyDown";OM.event.KeyboardEvent.KEY_UP="keyUp";OM.event.LayerEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);
this.affectedFeature=null;}});OM.event.LayerEvent.BEFORE_REFRESH="beforeFresh";OM.event.LayerEvent.AFTER_REFRESH="afterFresh";
OM.event.LayerEvent.FEATURE_SELECTED="featureSelected";OM.event.LayerEvent.FEATURE_DESELECTED="featureDeselected";
OM.event.LayerEvent.RENDERING_STYLE_CHANGED="renderingStyleChanged";OM.event.LayerEvent.LABELING_STYLE_CHANGED="labelingStyleChanged";
OM.event.LayerEvent.SELECTION_STYLE_CHANGED="selectionStyleChanged";OM.event.LayerEvent.HOVER_STYLE_CHANGED="hoverStyleChanged";
OM.event.LayerEvent.RESULT_STYLE_CHANGED="resultStyleChanged";OM.event.LayerEvent.LABEL_VISIBILITY_CHANGED="labelVisibilityChanged";
OM.event.LayerEvent.LAYER_VISIBILITY_CHANGED="layerVisibilityChanged";OM.event.LayerEvent.LAYER_REMOVED="layerRemoved";
OM.event.LayerEvent.LAYER_INITIALIZED="layerInitialized";OM.event.LayerEvent.FEATURE_MOVING="featureMoving";
OM.event.LayerEvent.FEATURE_MOVED="featureMoved";OM.event.LayerEvent.FEATURE_EDITED="featureEdited";OM.event.LayerEvent.FEATURE_ORIENTATION_CHANGING="featureOrientationChanging";
OM.event.LayerEvent.LAYER_Z_INDEX_CHANGED="layerZIndexChanged";OM.event.LayerEvent.LAYER_INIT="layerInit";
OM.event.LayerEvent.FINISH_GOT_CONFIG="layerFinishGotConfig";OM.event.LayerEvent.FINISH_LOAD="layerFinishLoad";
OM.event.LayerEvent.FEATURES_LOADED="featuresLoad";OM.event.LayerEvent.FEATURES_DISPLAYED="featuresDisplay";
OM.event.LayerEvent.INIT_ERROR="initError";OM.event.LayerEvent.NSDP_MAPPED="nsdpMapped";OM.event.MapDecorationEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);
}});OM.event.MapDecorationEvent.BEFORE_COLLAPSE="beforeCollapse";OM.event.MapDecorationEvent.AFTER_COLLAPSE="afterCollapse";
OM.event.MapDecorationEvent.BEFORE_RESTORE="beforeRestore";OM.event.MapDecorationEvent.AFTER_RESTORE="afterRestore";
OM.event.MapDecorationEvent.DRAG_START="dragStart";OM.event.MapDecorationEvent.DRAG="drag";OM.event.MapDecorationEvent.DRAG_END="dragEnd";
OM.event.MouseEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);this.event=null;
this.location=null;this.feature=null;}});OM.event.MouseEvent.MOUSE_DOWN="mouseDown";OM.event.MouseEvent.MOUSE_UP="mouseUp";
OM.event.MouseEvent.MOUSE_MOVE="mouseMove";OM.event.MouseEvent.MOUSE_OVER="mouseOver";OM.event.MouseEvent.MOUSE_OUT="mouseOut";
OM.event.MouseEvent.MOUSE_CLICK="click";OM.event.MouseEvent.MOUSE_RIGHT_CLICK="rightClick";OM.event.MouseEvent.MOUSE_DOUBLE_CLICK="doubleClick";
OM.event.MouseEvent.WHEEL_SCROLL="wheelScroll";OM.event.MouseEvent.TOUCH_TAP="tap";OM.event.MouseEvent.TOUCH_LONG_PRESS="touchlongpress";
OM.event.MouseEvent.TOUCH_END="touchend";OM.event.MouseEvent.TOUCH_START="touchstart";OM.event.ToolEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);
this.location=null;}});OM.event.ToolEvent.TOOL_START="toolStart";OM.event.ToolEvent.TOOL_END="toolEnd";
OM.event.ToolEvent.TOOL_CLEAR="toolClear";OM.event.ToolEvent.RECTANGLE_DRAG="rectangleDrag";OM.event.ToolEvent.CIRCLE_DRAG="circleDrag";
OM.event.ToolEvent.REDLINE_POINT_CREATE="redlinePointCreate";OM.event.ToolEvent.REDLINE_DRAW="redlineDraw";
OM.event.ToolEvent.REDLINE_EDITED="redlineEdited";OM.event.ToolEvent.DISTANCE_UPDATE="distanceUpdate";
OM.event.ToolbarEvent=OM.event.Event.extend({initialize:function(d,e){this._super(d,e);}});OM.event.ToolbarEvent.BUTTON_STATE_CHANGE="buttonStateChange";
OM.event.ToolbarEvent.BUTTON_DOWN="buttonDown";OM.event.ToolbarEvent.BUTTON_UP="buttonUp";OM.universe.ZoomLevel=OM.Class.extend({initialize:function(e,d){if(e==undefined||e==null||!OM.util.ValidationUtil.isNumber(e)){return;
}this.resolution=e;this.stretchRatio=1;if(d&&d.stretchRatio){this.stretchRatio=d.stretchRatio;}this.infotip=null;
if(d&&d.infotip){this.infotip=d.infotip;}}});OM.universe.Universe=OM.Class.extend({initialize:function(e){if(e==undefined||!OM.util.ValidationUtil.isObject(e)||!e.srid||!e.bounds){return null;
}this.srid=e.srid;this.bound=e.bounds;if(!e.zoomLevels&&e.numberOfZoomLevels){this.zoomLevels=[];var l=e.bounds;
var m=Math.abs(l.getMaxX()-l.getMinX())/256;var d=Math.abs(l.getMaxY()-l.getMinY())/256;if(d>m){m=d;}for(var g=0;
g<e.numberOfZoomLevels;g++){this.zoomLevels[g]=new OM.universe.ZoomLevel(m);m=m/2;}}else{this.zoomLevels=e.zoomLevels;
}this.homeCenter=null;this.homeZoomlevel=null;},getSRID:function(){return this.srid;},getMapBounds:function(){return this.bound;
},getZoomLevelNumber:function(){return this.zoomLevels.length;},getZoomLevels:function(){return this.zoomLevels;
},equals:function(g){if(this.srid!=g.srid){return false;}if(this.zoomLevels&&g.zoomLevels&&this.zoomLevels.length!=g.zoomLevels.length){return false;
}var d=this.zoomLevels.length;for(var e=0;e<d;e++){if(this.zoomLevels[e].resolution!=g.zoomLevels[e].resolution||this.zoomLevels[e].stretchRatio!=g.zoomLevels[e].stretchRatio){return false;
}}return true;},clone:function(){var d={};OM.$.extend(d,this);return d;},copy:function(d){this.homeCenter=d.homeCenter;
this.homeZoomlevel=d.homeZoomlevel;return this;}});OM.universe.WorldMercatorUniverse=OM.universe.Universe.extend({initialize:function(){var e=OM.universe.ZoomLevel;
var d={srid:3857,bounds:new OM.geometry.Rectangle(-20037508,-20037508,20037508,20037508,3857),zoomLevels:[new e(78271.515625),new e(39135.7578125),new e(19567.87890625),new e(9783.939453125),new e(4891.9697265625),new e(2445.98486328125),new e(1222.992431640625),new e(611.4962158203125),new e(305.74810791015625),new e(152.87405395507812),new e(76.43702697753906),new e(38.21851348876953),new e(19.109256744384766),new e(9.554628372192383),new e(4.777314186096191),new e(2.3886570930480957),new e(1.1943285465240479),new e(0.5971642732620239),new e(0.29858213663101196)]};
this._super(d);}});OM.universe.ElocationUniverse=OM.universe.Universe.extend({initialize:function(){var e=OM.universe.ZoomLevel;
var d={srid:54004,bounds:new OM.geometry.Rectangle(-20037508,-20037508,20037508,20037508,54004),zoomLevels:[new e(78271.515625),new e(39135.7578125),new e(19567.87890625),new e(9783.939453125),new e(4891.9697265625),new e(2445.98486328125),new e(1222.992431640625),new e(611.4962158203125),new e(305.74810791015625),new e(152.87405395507812),new e(76.43702697753906),new e(38.21851348876953),new e(19.109256744384766),new e(9.554628372192383),new e(4.777314186096191),new e(2.3886570930480957),new e(1.1943285465240479),new e(0.5971642732620239),new e(4.285026888325811)]};
this._super(d);}});OM.universe.LatLonUniverse=OM.universe.Universe.extend({initialize:function(){var e=OM.universe.ZoomLevel;
var d={srid:8307,bounds:new OM.geometry.Rectangle(-180,-90,180,90,8307),zoomLevels:[new e(180/256),new e(90/256),new e(45/256),new e(22.5/256),new e(11.25/256),new e(5.625/256),new e(2.8125/256),new e(1.40625/256),new e(0.703125/256),new e(0.3515625/256),new e(0.17578125/256),new e(0.087890625/256),new e(0.0439453125/256),new e(0.02197265625/256),new e(0.010986328125/256),new e(0.0054931640625/256),new e(0.00274658203125/256),new e(0.001373291015625/256),new e(0.0006866455078125/256)]};
this._super(d);}});OM.universe.OSMUniverse=OM.universe.Universe.extend({initialize:function(){var e=OM.universe.ZoomLevel;
var d={srid:3857,bounds:new OM.geometry.Rectangle(-20037508,-20037508,20037508,20037508,3857),zoomLevels:[new e(156543.03125),new e(78271.515625),new e(39135.7578125),new e(19567.87890625),new e(9783.939453125),new e(4891.9697265625),new e(2445.98486328125),new e(1222.992431640625),new e(611.4962158203125),new e(305.74810791015625),new e(152.87405395507812),new e(76.43702697753906),new e(38.21851348876953),new e(19.109256744384766),new e(9.554628372192383),new e(4.777314186096191),new e(2.3886570930480957),new e(1.1943285465240479),new e(0.5971642732620239)]};
this._super(d);}});OM.style.Style=OM.Class.extend({initialize:function(d){this.origConfig=d;this.styleName=(d&&d.styleName)?d.styleName:this.generateName();
this.styleType=(d&&d.styleType)?d.styleType:"Style";this.effects=(d&&d.effects)?d.effects:[];},clone:function(){return OM.$.extend(true,{},this);
},generateName:(function(){var d=0;return function(){return"_om_style"+(++d);};}())});OM.style.Style.calculateStyleSize=function(n,q){if(!n||n.realWidth!=null&&n.realHeight!=null){return;
}var g=n.lengthUnit?n.lengthUnit:"pixel";var o=OM.util.GeomUtil.getCurrentDistancePerPixel(q);if(g=="kilometer"){o/=1000;
}else{if(g=="mile"){o/=1609.344;}else{if(g=="feet"){o/=0.3048;}else{if(g!="meter"){g="pixel";}}}}if(g=="pixel"){n.realWidth=n.width;
n.realHeight=n.height;}else{if(n.unitFontSize){n.fontSize=parseFloat(n.unitFontSize/o);}else{if(n.unitFillWidth||n.unitCenterLineWidth||n.unitStrokeThickness){n.fillWidth=parseFloat(n.unitFillWidth/o);
n.centerLineWidth=parseFloat(n.unitCenterLineWidth/o);n.strokeThickness=parseFloat(n.unitStrokeThickness/o);
n.calculateRealSize();}else{if(n.unitSpotlightRadius){n.spotlightRadius=parseFloat(n.unitSpotlightRadius/o);
}else{var m=n.width;var d=n.height;var l=parseFloat(m/o);var e=parseFloat(d/o);l=l<parseFloat(n.minlength)?parseFloat(n.minlength):l;
e=e<parseFloat(n.minlength)?parseFloat(n.minlength):e;n.realWidth=l>parseFloat(n.maxlength)?parseFloat(n.maxlength):l;
n.realHeight=e>parseFloat(n.maxlength)?parseFloat(n.maxlength):e;}}}}};OM.style.Style.rgbToHsv=function(g){var r,l,e;
var m=g.r/255;var s=g.g/255;var d=g.b/255;var n=Math.min(m,s,d);var q=Math.max(m,s,d);var o=q-n;if(o==0){r=0;
}else{if(q==s){r=60*(d-m)/o+120;}else{if(q==d){r=60*(m-s)/o+240;}else{if(q==m){if(s>=d){r=60*(s-d)/o+0;
}else{r=60*(s-d)/o+360;}}}}}if(q==0){l=0;}else{l=o/q;}e=q;return{h:Math.round(r),s:Math.round(l*100),v:Math.round(e*100)};
};OM.style.Style.hsvToRgb=function(n){var m=n.h,e=n.s,d=n.v;var l,g,o;if(e==0){m=e=d=Math.round(255*d/100);
l=m;g=e;o=d;}else{e=e/100;d=d/100;p=Math.floor(m/60)%6;f=m/60-p;a=d*(1-e);b=d*(1-e*f);c=d*(1-e*(1-f));
switch(p){case 0:l=d;g=c;o=a;break;case 1:l=b;g=d;o=a;break;case 2:l=a;g=d;o=c;break;case 3:l=a;g=b;o=d;
break;case 4:l=c;g=a;o=d;break;case 5:l=d;g=a;o=b;break;}l=Math.round(255*l);g=Math.round(255*g);o=Math.round(255*o);
}return{r:l,g:g,b:o};};OM.style.Text=OM.style.Style.extend({initialize:function(d){d=d||{};d.styleType="Text";
this._super(d);this.fontFamily=d.fontFamily!==undefined?d.fontFamily:null;this.fontStyle=d.fontStyle!==undefined?d.fontStyle:OM.Text.FONTSTYLE_NORMAL;
this.fontWeight=d.fontWeight!==undefined?d.fontWeight:OM.Text.FONTWEIGHT_NORMAL;this.fill=d.fill!=undefined?d.fill:null;
this.lengthUnit=d.sizeUnit?d.sizeUnit:"pixel";if(this.lengthUnit=="pixel"){this.fontSize=d.fontSize!==undefined?parseInt(d.fontSize):12;
}else{this.unitFontSize=d.fontSize!==undefined?parseInt(d.fontSize):10;}this.hAlign=d.hAlign!=undefined?d.hAlign:OM.Text.HORIZONTALALIGN_CENTER;
this.vAlign=d.vAlign!=undefined?d.vAlign:OM.Text.VERTICALALIGN_CENTER;},getXML:function(){return"";}});
OM.style.Gradient=OM.style.Style.extend({initialize:function(d){d=d||{};d.styleType=(d&&d.styleType)?d.styleType:"AbstractGradient";
this._super(d);this.stops1=d&&d.stops!=undefined?d.stops:null;this.useFeatureBoundingBox=d&&d.useFeatureBoundingBox!=undefined?d.useFeatureBoundingBox:true;
this.stroke=d&&d.stroke!=undefined?d.stroke:null;this.strokeThickness=d&&d.strokeThickness!=undefined?parseFloat(d.strokeThickness):1;
this.strokeOpacity=d&&d.strokeOpacity!=undefined?d.strokeOpacity:1;this.fillOpacity=d&&d.fillOpacity!=undefined?d.fillOpacity:1;
},createGradientStop:function(g){var e=g.oui.style.GradientStop;if(this.stops1){var d=this.stops1.length;
this.stops=[];for(var l=0;l<d;l++){if(this.stops1[l] instanceof e){continue;}this.stops[l]=new e({offset:this.stops1[l].offset,color:this.stops1[l].color});
}}}});OM.style.LinearGradient=OM.style.Gradient.extend({initialize:function(d){d.styleType="LinearGradient";
this._super(d);this.x1=d.x1||0;this.y1=d.y1||0;this.x2=d.x2||0;this.y2=d.y2||0;},createStyle:function(d){this.createGradientStop(d);
this.fill=new d.oui.style.LinearGradient({x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,stops:this.stops});
}});OM.style.Color=OM.style.Style.extend({initialize:function(d){d=d||{};d.styleType="Color";this._super(d);
var e=OM.util.ValidationUtil.getColor;this.stroke=d.stroke&&(e(d.stroke))?e(d.stroke):OM.PaintTypes.NO_PAINT;
this.strokeOpacity=d.strokeOpacity!=undefined?d.strokeOpacity:1;this.strokeThickness=d.strokeThickness!=undefined?parseFloat(d.strokeThickness):1;
this.fill=d.fill!=undefined&&(e(d.fill))?e(d.fill):OM.PaintTypes.NO_PAINT;this.fillOpacity=d.fillOpacity!=undefined?d.fillOpacity:1;
if(d.stroke!=undefined){d.stroke=e(d.stroke);}if(d.fill!=undefined){d.fill=e(d.fill);}},getXML:function(){var l=(this.stroke==null)?"":"stroke:"+this.stroke+";";
var m=(this.fill==null)?"":"fill:"+this.fill+";";var e=this.strokeOpacity<1?"stroke-opacity:"+parseInt(this.strokeOpacity*255)+";":"";
var n=this.fillOpacity<1?"fill-opacity:"+parseInt(this.fillOpacity*255)+";":"";var d=this.strokeThickness!=1?"stroke-width:"+this.strokeThickness:"";
var g='<style name="'+this.styleName+'"><svg width="1in" height="1in"><g class="color" style="'+l+e+m+n+d+'"></g></svg></style>';
return g;}});OM.style.Bucket=OM.Class.extend({initialize:function(d){this.seq=d.seq||0;if(d.label){this.label=d.label;
}if(d.labelStyle){this.labelStyle=d.labelStyle;}},evaluate:function(d){return false;}});OM.style.RangedBucket=OM.style.Bucket.extend({initialize:function(d){this._super(d);
this.low=d.low!=undefined?d.low:Number.NEGATIVE_INFINITY;this.high=d.high!=undefined?d.high:Number.POSITIVE_INFINITY;
},evaluate:function(d){if(typeof d==="undefined"||d==null){return false;}return d>=this.low&&d<this.high;
},getXML:function(){var d=this.low==Number.NEGATIVE_INFINITY||this.low==null?"-Infinity":this.low;var m=this.high==Number.POSITIVE_INFINITY||this.high==null?"Infinity":this.high;
var e=this.seq!=null?' seq="'+this.seq+'"':"";var g=this.label?' label="'+this.label+'"':"";var l=this.style?' style="'+this.style.styleName+'"':"";
xml="<RangedBucket"+e+g+l+' low="'+d+'" high="'+m+'"/>';return xml;}});OM.style.CollectionBucket=OM.style.Bucket.extend({initialize:function(d){this._super(d);
this.keepWhiteSpace=d.keepWhiteSpace||false;this.dataType=d.dataType||"string";this.values=d.values||[];
},evaluate:function(g){var d=this.values.length;if(typeof g==="undefined"||g==null||d==0){return false;
}for(var e=0;e<d;e++){if(this.values[e]==g){return true;}}return false;},getXML:function(){var r=this.keepWhiteSpace?' keep_white_space="'+this.keepWhiteSpace+'"':"";
var d=this.style?' style="'+this.style.styleName+'"':"";var s=this.seq!=null?' seq="'+this.seq+'"':"";
var o=this.label?' label="'+this.label+'"':"";var n=this.labelStyle?' label_style="'+this.labelStyle.styleName+'"':"";
var e=' delimiter=","';var l="<CollectionBucket"+s+e+r+d+o+n+">";var m=this.values?this.values.length:0;
var q="";for(var g=0;g<m;g++){q+=g==m-1?this.values[g]:this.values[g]+",";}l+=q+"</CollectionBucket>";
return l;}});OM.style.BucketStyle=OM.style.Style.extend({initialize:function(d){d=d||{};d.styleType=d.styleType||"BucketStyle";
this._super(d);if(d.style&&d.buckets&&d.style!==d.buckets){OM.util.Logger.warning(null,"OM.style.BucketStyle","Styles and buckets must be arrays of the same length.");
}this.numClasses=d.numClasses||5;this.defaultStyle=d.defaultStyle||null;this.styles=d.styles||[];if(this.styles.length==0&&d.styleType!="ColorScheme"&&d.styleType!="VariableMarker"){OM.util.Logger.warning(null,"OM.style.BucketStyle","No styles found in the options. ");
}this.buckets=d.buckets||[];if(!d.classification&&d.low!==undefined&&d.high!==undefined){this.buckets=this.createEqualBuckets(d.high,d.low);
}this.classification=d.classification||"equal";if(this.buckets.length>0){if(this.classification!=="custom"){OM.util.Logger.info(null,"OM.style.BucketStyle","Buckets exist, but classification is not 'custom'. ");
this.classification="custom";}}this.algorithm=d.algorithm||null;this.effects=d.effects||null;this.isNumeric=(typeof d.isNumeric==="undefined")?true:d.isNumeric;
this.gradient=d.gradient||"off";if(this.gradient!=="off"&&this.styles[0] instanceof OM.style.Color){this.createGradients();
}},generateBuckets:function(g,e,l){if(this.buckets&&this.buckets.length>0&&(!l||this.buckets[0] instanceof OM.style.CollectionBucket)){return;
}if(!g||g.length==0){return;}e=e||g[0].columns;if(!e){return;}var d=(e instanceof Array)?e[0]:e;d=d.toUpperCase();
OM.util.Logger.fine(null,"OM.style.BucketStyle","generating buckets.");if(this.classification==="equal"){this.buckets=this.equalRangeMethod(g,d);
}else{if(this.classification==="quantile"||this.classification==="quantiles"){this.buckets=this.quantilesMethod(g,d);
}else{if(this.classification==="logarithmic"){this.buckets=this.logarithmicMethod(g,d);}else{if(this.algorithm){this.buckets=this.algorithm.call(this,g,d);
}else{OM.util.Logger.warning(null,"OM.style.BucketStyle","Invalid classification sepcified.");this.buckets=[];
}}}}},getDefaultStyle:function(){return this.defaultStyle;},setDefaultStyle:function(d){this.defaultStyle=d;
},getRealStyle:function(l){if(typeof l===undefined||l==null){return this.defaultStyle;}var g=this.buckets,d=this.buckets.length;
if(g&&d>0){for(var e=0;e<d;e++){if(g[e].evaluate(l)){return this.styles[e];}}}return this.defaultStyle;
},logarithmicMethod:function(g,e){var d=this.getMinMaxValues(g,e);return this.createLogarithmicBuckets(d.max,d.min);
},getMinMaxValues:function(d,e){var g=null,o=null,n=d.length,q,m,r=OM.util.ValidationUtil.isNumber2;for(var l=0;
l<n;l++){m=d[l];if(m&&m.attributes&&typeof m.attributes[e]!=="undefined"){q=m.attributes[e];if(typeof q!=="undefined"&&q!=null){if(this.isNumeric&&!r(q)){q=Number(q);
}if(g==null||g>q){g=q;}if(o==null||q>o){o=q;}}}}return{min:g,max:o};},equalRangeMethod:function(g,e){var d=this.getMinMaxValues(g,e);
return this.createEqualBuckets(d.max,d.min);},createEqualBuckets:function(e,g){var l=[],d=(e-g)/this.numClasses,m=g;
for(i=1;i<=this.numClasses;i++){l[i-1]=new OM.style.RangedBucket({low:m,high:m+d});m+=d;}l[this.numClasses-1].high++;
return l;},createLogarithmicBuckets:function(q,m){var e=[],r=m;var d=Math.log(m),l=Math.log(q);var g=(l-d)/this.numClasses;
for(var n=1;n<=this.numClasses;n++){var o=Math.exp(d+g*n);e[n-1]=new OM.style.RangedBucket({low:r,high:o});
r=o;}e[this.numClasses-1].high++;return e;},quantilesMethod:function(e,d){return[];},createGradients:function(){var l=this.styles,g;
var d=[];for(var e=0;e<l.length;e++){g=l[e];d.push(new OM.style.LinearGradient({stops:[{offset:0,color:"#eeffffff"},{offset:1,color:g.fill}],x1:0,y1:0,x2:1,y2:1,stroke:g.stroke,fillOpacity:g.fillOpacity,strokeOpacity:g.strokeOpacity}));
}this.styles=d;},clearBuckets:function(){if(this.classification==="equal"||this.classification==="quantile"||this.classification==="quantiles"||this.classification==="logarithmic"||is.algorithm){this.buckets=[];
}}});OM.style.ColorScheme=OM.style.BucketStyle.extend({initialize:function(d){d.styleType="ColorScheme";
this._super(d);this.baseColor=d.baseColor!=undefined?d.baseColor:null;this.fromColor=typeof d.fromColor!=="undefined"?d.fromColor:null;
this.toColor=typeof d.toColor!=="undefined"?d.toColor:null;this.fillOpacity=d.fillOpacity!=undefined?d.fillOpacity:1;
this.stroke=d.stroke!=undefined?d.stroke:null;this.strokeOpacity=d.strokeOpacity!=undefined?d.strokeOpacity:1;
this.strokeThickness=d.strokeThickness!=undefined?parseFloat(d.strokeThickness):1;this.calculateColorStops();
},calculateColorStops:function(){if(this.styles&&this.styles.length>0){return;}if(this.fromColor&&this.toColor){this.calculateMultiHueStops();
}else{if(this.baseColor){this.calculateSingleHueStops();}else{OM.util.Logger.warning(null,"OM.style.ColorScheme.calculateColorStops","Must specify either a baseColor or a pair of fromColor and toColor.");
}}},calculateSingleHueStops:function(){var m=OM.style.ColorScheme.rgbStringParse(this.baseColor);var d=OM.style.Style.rgbToHsv(m);
var o=d.v/this.numClasses;for(var n=0;n<this.numClasses;n++){var e=OM.style.Style.hsvToRgb({h:d.h,s:d.s,v:(d.v-n*o)});
var r=e.r.toString(16);if(r.length!=2){r="0"+r;}var q=e.g.toString(16);if(q.length!=2){q="0"+q;}var s=e.b.toString(16);
if(s.length!=2){s="0"+s;}var l="#"+r+q+s;var g=new OM.style.Color({fill:l,fillOpacity:this.fillOpacity,stroke:this.stroke,strokeThickness:this.strokeThickness,strokeOpacity:this.strokeOpacity});
this.styles.push(g);}},calculateMultiHueStops:function(){var q=OM.style.ColorScheme;var l=q.rgbStringParse(this.fromColor);
var t=OM.style.Style.rgbToHsv(l);l=q.rgbStringParse(this.toColor);var o=OM.style.Style.rgbToHsv(l);var r=(o.h-t.h)/this.numClasses;
var z=(o.s-t.s)/this.numClasses;var w=(o.v-t.v)/this.numClasses;for(var m=0;m<this.numClasses;m++){var d=OM.style.Style.hsvToRgb({h:t.h+r*m,s:t.s+z*m,v:t.v+w*m});
var s=d.r.toString(16);if(s.length!=2){s="0"+s;}var n=d.g.toString(16);if(n.length!=2){n="0"+n;}var u=d.b.toString(16);
if(u.length!=2){u="0"+u;}var g="#"+s+n+u;var e=new OM.style.Color({fill:g,fillOpacity:this.fillOpacity,stroke:this.stroke,strokeThickness:this.strokeThickness,strokeOpacity:this.strokeOpacity});
this.styles.push(e);}}});OM.style.ColorScheme.rgbStringParse=function(g){var d={};var e=OM.$.trim(g);
d.r=parseInt(e[1]+e[2],16);d.g=parseInt(e[3]+e[4],16);d.b=parseInt(e[5]+e[6],16);return d;};OM.style.HeatMap=OM.style.Style.extend({initialize:function(d){d=d||{};
d.styleType="HeatMap";this._super(d);this.colorStops=d.colorStops!=undefined?d.colorStops:null;this.opacity=d.opacity!=undefined?d.opacity:1;
this.containerVectorLayer=d.containerVectorLayer!=undefined?d.containerVectorLayer:null;this.lengthUnit=d.lengthUnit?d.lengthUnit:"pixel";
if(this.lengthUnit=="pixel"){this.spotlightRadius=d.spotlightRadius!=undefined?d.spotlightRadius:5;}else{this.unitSpotlightRadius=d.spotlightRadius!=undefined?d.spotlightRadius:5;
}this.maxValue=d.maxValue!=undefined?d.maxValue:null;this.minValue=d.minValue!=undefined?d.minValue:null;
}});OM.style.RadialGradient=OM.style.Gradient.extend({initialize:function(d){d=d||{};d.styleType="RadialGradient";
this._super(d);this.cx=d.cx||0;this.cy=d.cy||0;this.radius=d.radius||0;},createStyle:function(d){this.createGradientStop(d);
this.fill=new d.oui.style.RadialGradient({cx:this.cx,cy:this.cy,radius:this.radius,stops:this.stops});
}});OM.style.PieSlice=function(e,d){this.name=e;this.color=d;};OM.style.PieChart=OM.style.Style.extend({initialize:function(e){e.styleType="PieChart";
if(!e||!e.pieSlices||e.pieSlices.length<1){return;}this._super(e);var d=e.pieSlices.length;this.colors=[];
this.names=[];for(var g=0;g<d;g++){var l=e.pieSlices[g];this.colors.push(l.color);this.names.push(l.name);
}this.stroke=e.stroke!=undefined?e.stroke:"#000000";this.strokeThickness=e.strokeThickness!=undefined?parseFloat(e.strokeThickness):1;
this.startingAngle=e.startingAngle!=undefined?parseFloat(e.startingAngle):0;this.direction=e.direction!=undefined?e.direction:"CCW";
this.radius=e.radius!=undefined?e.radius:50;this.width=this.radius*2;this.height=this.radius*2;this.lengthUnit=e.lengthUnit?e.lengthUnit:"pixel";
this.enableHighlight=e.enableHighlight?e.enableHighlight:false;this.maxlength=e.radiusPixelRange&&e.radiusPixelRange.max?e.radiusPixelRange.max*2:5000;
this.minlength=e.radiusPixelRange&&e.radiusPixelRange.min?e.radiusPixelRange.min*2:0;},getXML:function(){var e='<style name="'+this.styleName+'"><AdvancedStyle>';
e+='<PieChartStyle pieradius="'+this.radius+'">';var d=this.colors.length;for(var g=0;g<d;g++){e+='<PieSlice name="'+this.names[g]+'" color="'+this.colors[g]+'"/>';
}e+="</PieChartStyle></AdvancedStyle></style>";return e;}});OM.style.VariableMarker=OM.style.BucketStyle.extend({initialize:function(d){d.styleType="VariableMarker";
this._super(d);this.marker=d.marker!=undefined?d.marker:null;this.startSize=d.startSize!=undefined?d.startSize:7;
this.increament=d.increment!=undefined?d.increment:3;this.createAllMarkerStyles();},createAllMarkerStyles:function(){if(this.styles&&this.styles.length>0){return;
}else{if(this.marker instanceof OM.style.Marker){this.styles=[];for(var e=0;e<this.numClasses;e++){var d=this.marker.clone();
d.width=this.startSize+this.increament*e;d.height=d.width;d.calculateVectorMarkerScale();this.styles.push(d);
}}else{OM.util.Logger.warning(null,null,"Either a base marker or a set of marker styles must be specified.");
}}}});OM.style.Bar=function(e,d){this.name=e;this.color=d;};OM.style.BarChart=OM.style.Style.extend({initialize:function(e){e.styleType="BarChart";
if(!e||!e.bars||e.bars.length<1){return;}this._super(e);var d=e.bars.length;this.colors=[];this.names=[];
for(var g=0;g<d;g++){var l=e.bars[g];this.colors.push(l.color);this.names.push(l.name);}this.stroke=e.stroke!=undefined?e.stroke:"#000000";
this.strokeThickness=e.strokeThickness!=undefined?parseFloat(e.strokeThickness):1;this.showXAxis=e.showXAxis!=undefined?e.showXAxis:false;
this.showYAxis=e.showYAxis!=undefined?e.showYAxis:false;this.backGround=e.background!=undefined?e.background:null;
this.width=e.width!=undefined?e.width:100;this.height=e.width!=undefined?e.height:100;this.lengthUnit=e.lengthUnit?e.lengthUnit:"pixel";
this.enableHighlight=e.enableHighlight?e.enableHighlight:false;this.maxlength=e.lengthPixelRange&&e.lengthPixelRange.max?e.lengthPixelRange.max:5000;
this.minlength=e.lengthPixelRange&&e.lengthPixelRange.min?e.lengthPixelRange.min:0;},getXML:function(){var e='<style name="'+this.styleName+'"><AdvancedStyle>';
e+='<BarChartStyle width="'+this.width+'" height="'+this.height+'">';var d=this.colors.length;for(var g=0;
g<d;g++){e+='<Bar name="'+this.names[g]+'" color="'+this.colors[g]+'"/>';}e+="</BarChartStyle></AdvancedStyle></style>";
return e;}});OM.style.Line=OM.style.Style.extend({initialize:function(e){e=e||{};e.styleType="Line";this._super(e);
var g=OM.util.ValidationUtil.getColor;var d=OM.PaintTypes.NO_PAINT;this.stroke=e.stroke&&g(e.stroke)?g(e.stroke):OM.PaintTypes.NO_PAINT;
this.strokeOpacity=(e.strokeOpacity!=undefined)?parseFloat(e.strokeOpacity):1;this.strokeDashPattern=e.strokeDashPattern||[];
this.strokeLineCap=e.strokeLineCap||OM.LineCaps.ROUND;this.strokeLineJoin=e.strokeLineJoin||OM.LineJoins.ROUND;
this.fill=(e.fill!=undefined&&g(e.fill))?g(e.fill):d;this.fillOpacity=(e.fillOpacity!=undefined)?parseFloat(e.fillOpacity):1;
this.centerLine=e&&e.centerLine!=undefined&&(g(e.centerLine))?g(e.centerLine):d;this.startMarker=e?e.startMarker:null;
this.endMarker=e?e.endMarker:null;this.oriented=e?e.orientedMarker:false;this.centerLineDashPattern=e.centerLineDashPattern||[];
this.cased=e&&e.cased!=undefined?e.cased:false;this.lengthUnit=e.lengthUnit?e.lengthUnit:"pixel";if(this.lengthUnit=="pixel"){this.fillWidth=e&&e.fillWidth!=undefined&&this.fill!=d?parseFloat(e.fillWidth):0;
this.centerLineWidth=e&&e.centerLineWidth!=undefined&&this.centerLine!=d?parseFloat(e.centerLineWidth):0;
this.strokeThickness=e&&e.strokeThickness!=undefined&&this.stroke!=d?parseFloat(e.strokeThickness):1;
}else{this.unitFillWidth=e&&e.fillWidth!=undefined&&this.fill!=d?parseFloat(e.fillWidth):0;this.unitCenterLineWidth=e&&e.centerLineWidth!=undefined&&this.centerLine!=d?parseFloat(e.centerLineWidth):0;
this.unitStrokeThickness=e&&e.strokeThickness&&this.stroke!=d?parseFloat(e.strokeThickness):1;}this.calculateRealSize();
},calculateRealSize:function(){var e=null;this.stylelist=[];var d=OM.PaintTypes.NO_PAINT;if(this.stroke!=d&&this.strokeThickness>0){e={stroke:this.stroke,strokeThickness:this.fillWidth>0?this.strokeThickness*2+this.fillWidth:this.strokeThickness,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashPattern,strokeOpacity:this.strokeOpacity};
this.stylelist.push(e);}if(this.fill!=d&&this.fillWidth>0){e={stroke:this.fill,strokeThickness:this.fillWidth,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashPattern,strokeOpacity:this.fillOpacity};
this.stylelist.push(e);}if(this.centerLine!=d&&this.centerLineWidth>0&&this.fill!=this.centerLine){e={stroke:this.centerLine,strokeThickness:this.centerLineWidth,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.centerLineDashPattern};
this.stylelist.push(e);}if(this.startMarker||this.endMarker){this.stylelist.push({});}},getXML:function(){var d='<g class="line"';
if(this.fill!=null&&this.fillWidth>0){var g="fill:"+this.fill+";stroke-width:"+this.fillWidth+";";g+=this.strokeLineCap?"stroke-linecap:"+this.strokeLineCap+";":"";
g+=this.strokeLineJoin?"stroke-linejoin:"+this.strokeLineJoin+";":"";var m=this.cased?' cased="true"':"";
d+=m+' style="'+g+'"';}d+=">";if(this.stroke!=null&&this.strokeThickness>0){var g="fill:"+this.stroke+";stroke-width:"+this.strokeThickness+";";
var l=this.strokeDashPattern?' dash="'+this.strokeDashPattern+'"':"";d+='<line class="parallel" style="'+g+'"'+l+"/>";
}if(this.centerLine!=null&&this.centerLineWidth>0&&this.fill!=this.centerLine){var g="fill:"+this.centerLine+";stroke-width:"+this.centerLineWidth+";";
var l=this.centerLineDashPattern?' dash="'+this.centerLineDashPattern+'"':"";d+='<line class="base" style="'+g+'"'+l+"/>";
}var e='<style name="'+this.styleName+'"><svg width="1in" height="1in">'+d+"</g></svg></style>";return e;
}});OM.style.Marker=OM.style.Style.extend({initialize:function(d){d=d||{};d.styleType="Marker";this._super(d);
this.width=d.width?d.width:null;this.height=d.height?d.height:null;this.xOffset=d.xOffset?d.xOffset:0;
this.yOffset=d.yOffset?d.yOffset:0;this.lengthUnit=d.lengthUnit?d.lengthUnit:"pixel";this.src=d.src?d.src:null;
this.textStyle=d.textStyle?d.textStyle:null;if(this.src&&(this.width==null||this.height==null)){var e=this;
var g=new Image();g.src=this.src;g.onload=function(){if(e.width==null){e.width=g.width;}if(e.height==null){e.height=g.height;
}if(e.origConfig){e.origConfig.width=g.width;e.origConfig.height=g.height;}};}this.vectorDef=d.vectorDef?d.vectorDef:null;
if(this.vectorDef){this.calculateVectorMarkerScale();}},calculateVectorMarkerScale:function(){if(this.vectorDef&&this.vectorDef[0].shape&&this.width&&this.height){var r=this.vectorDef[0].shape;
r.width=r.width?r.width:this.width;r.height=r.height?r.height:this.height;if(r.type=="circle"){if(r.cx==0&&r.cy==0){r.cx=r.width/2;
r.cy=r.height/2;}r.scaleX=this.width/r.width;r.scaleY=this.height/r.height;}else{if(r.type=="rectangle"){if(r.x==undefined){r.x=0;
}if(r.y==undefined){r.y=0;}r.scaleX=this.width/r.width;r.scaleY=this.height/r.height;}else{var e=this.vectorDef[0].shape.coords[0];
var m=Number.POSITIVE_INFINITY;var g=Number.NEGATIVE_INFINITY;var l=Number.POSITIVE_INFINITY;var d=Number.NEGATIVE_INFINITY;
for(var n=0,q=e.length;n<q;n+=2){e[n]=1*e[n];e[n+1]=1*e[n+1];if(e[n]<m){m=e[n];}if(e[n]>g){g=e[n];}if(e[n+1]<l){l=e[n+1];
}if(e[n+1]>d){d=e[n+1];}}var s=g-m;var o=d-l;r.scaleX=this.width/s;r.scaleY=this.height/o;}}if(this.vectorDef[0].style&&this.vectorDef[0].style.strokeThickness){this.vectorDef[0].style.strokeThickness=parseFloat(this.vectorDef[0].style.strokeThickness);
}}},getXML:function(){var e="";var t="width:"+this.width+";height:"+this.height+";";if(this.src){var e='<g class="marker" style="'+t+'">';
e+='<image_marker url="'+this.src+'"/>';}else{if(this.vectorDef){var d=this.vectorDef[0].style;var r=(d.stroke==null)?"":"stroke:"+d.stroke+";";
var m=(d.fill==null)?"":"fill:"+d.fill+";";var l=d.strokeOpacity<1?"stroke-opacity:"+d.strokeOpacity*255+";":"";
var o=d.fillOpacity<1?"fill-opacity:"+d.fillOpacity*255+";":"";var q=d.strokeThickness&&d.strokeThickness!=1?"stroke-width:"+d.strokeThickness:"";
var n=this.vectorDef[0].shape;var e='<g class="marker" style="'+t+r+l+m+o+q+'">';if(n.type=="circle"){e+='<circle cx="0" cy="0" r="1"/>';
}else{if(n.type=="rectangle"){e+='<rect points="'+n.x+","+n.y+","+n.width+","+n.height+'"/>';}else{if(n.type=="path"){e+='<polyline points="'+n.coords+'"/>';
}}}}}var g='<style name="'+this.styleName+'"><svg width="1in" height="1in">'+e+"</g></svg></style>";return g;
}});OM.style.StyleStore=function(){};OM.style.StyleStore.styleCache=[];OM.style.StyleStore.getServerSideStyle=function(d,m,o){if(!d||!m){OM.util.Logger.alert("MAPVIEWER-05527","OM.style.StyleStore.getServerSideStyle","");
return null;}var s=OM.style;var n=OM.style.StyleStore.styleCache;var u=OM.style.StyleStore;var g=s.StyleStore.getCachedStyle(d,m);
if(g==null){if(!o||!o.callback){OM.util.Logger.alert("MAPVIEWER-05527","OM.style.StyleStore.getServerSideStyle","");
return null;}var q=function(A){var w=OM.$(A);var z;if(w.find("oms_error")[0]!=undefined){z=new OM.style.Style({styleName:"Invalid"});
}else{z=u.createStyle(w,d,e);}if(z!=null){n[d][m]=z;}if(o&&o.callback){o.callback(z);}return z;};var t=OM.util.HttpRequest;
var r="/omserver";var l={xml_request:'<non_map_request><get_style_definition data_source="'+d+'" style="'+m+'"/></non_map_request>'};
var e;if(o&&o.url){e=o.url+r;}else{e=OM.gv.localbaseURL()+r;}t.send(e,l,q,"xml");}else{if(o&&o.callback){o.callback(g);
}}return g;};OM.style.StyleStore.createStyle=function(g,n,e){var m=OM.style.StyleStore;var d=g.find("AdvancedStyle")[0];
if(d==undefined){g=OM.$(g.find("style"));var l={dataSource:n,data:g,url:e};style=m.createSimpleStyle(l);
}else{style=m.createAdvancedStyle(g,n,e);}return style;};OM.style.StyleStore.createAdvancedStyle=function(g,o,e){var n=g.find("AdvancedStyle")[0];
var m=OM.style.StyleStore;var d=OM.$(n).children()[0];var l=d.tagName;switch(l){case"PieChartStyle":return m.createPieChartStyle(g);
case"BarChartStyle":return m.createBarChartStyle(g);case"ColorSchemeStyle":return m.createColorSchemeStyle(g);
case"HeatMapStyle":return m.createHeatMapStyle(g);case"BucketStyle":return m.createBucketStyle(g,o,e);
case"VariableMarkerStyle":return m.createVariableMarkerStyle(g,o,e);default:return;}};OM.style.StyleStore.getCachedStyle=function(d,g){var e=OM.style.StyleStore.styleCache;
if(e[d]){if(e[d][g]){return e[d][g];}}else{e[d]=[];}return null;};OM.style.StyleStore._styleStringToArray=function(o){var e=o.attr("style");
var n=e.split(";");var m=[];for(var g=0,d=n.length;g<d;g++){var l=n[g].split(":");if(l&&l[0]){m[l[0]]=l[1];
}}return m;};OM.style.StyleStore.createSimpleStyle=function(g){var e=g.data;var o=g.dataSource;var d=g.url;
var n=e.find("g");var m=OM.style.StyleStore;if(n[0]!=undefined){var l=n.attr("class");switch(l){case"color":return m.createColorStyle(e);
case"line":return m.createLineStyle(e);case"area":return m.createAreaStyle(e);case"marker":return m.createMarkerStyle(o,d,e);
case"text":return m.createTextStyle(e);default:return null;}}else{return null;}};OM.style.StyleStore.getAdvacnedStyle=function(d){};
OM.style.StyleStore.createColorStyle=function(d){var g={};var e=OM.style.StyleStore;g.styleName=d.attr("name");
d.find("g").each(function(m,n){var q=OM.$(n);var o=e._styleStringToArray(q);g.fill=o.fill;g.fillOpacity=o["fill-opacity"]?parseInt(o["fill-opacity"])/255:1;
g.stroke=o.stroke;g.strokeThickness=o["stroke-width"];g.strokeOpacity=o["stroke-opacity"]?parseInt(o["stroke-opacity"])/255:1;
});var l=new OM.style.Color(g);return l;};OM.style.StyleStore.createLineStyle=function(d){var g={};var e=OM.style.StyleStore;
g.styleName=d.attr("name");d.find("g").each(function(m,n){var q=OM.$(n);var o=e._styleStringToArray(q);
g.fill=o.fill;g.fillWidth=o["stroke-width"];g.strokeLineCap=o["stroke-linecap"];g.strokeLineJoin=o["stroke-linejoin"];
g.cased=q.attr("cased")=="true"?true:false;q.find("line").each(function(u,t){var r=OM.$(t);if(r.attr("class")=="parallel"){var s=e._styleStringToArray(r);
g.stroke=s.fill;g.strokeThickness=s["stroke-width"];g.strokeDashPattern=e.splitDashArray(r.attr("dash"));
}else{if(r.attr("class")=="base"){var s=e._styleStringToArray(r);g.centerLine=s.fill;g.centerLineWidth=s["stroke-width"];
g.centerLineDashPattern=e.splitDashArray(r.attr("dash"));}}});});g.dashPattern=d.find("line.base").attr("dash");
var l=new OM.style.Line(g);return l;};OM.style.StyleStore.createAreaStyle=function(d){var g={};var e=OM.style.StyleStore;
g.styleName=d.attr("name");d.find("g").each(function(m,n){var q=OM.$(n);var o=e._styleStringToArray(q);
g.fill=o.fill;g.stroke=o.stroke;g.strokeThickness=o["stroke-width"];g.strokeOpacity=o["stroke-opacity"]?parseInt(o["stroke-opacity"])/255:1;
});var l=new OM.style.AreaStyle(g);return l;};OM.style.StyleStore.createMarkerStyle=function(n,g,r){var o={};
var u=OM.style.StyleStore;var l={};var m={};var w={};o.styleName=r.attr("name");r.find("g").each(function(){var A=OM.$(this);
var z=u._styleStringToArray(A);o.width=1*z.width;o.height=1*z.height;if(z.fill){m.fill=z.fill;}if(z["fill-opacity"]){m.fillOpacity=z["fill-opacity"]?parseInt(z["fill-opacity"])/255:1;
}if(z.stroke){m.stroke=z.stroke;}if(z["stroke-width"]){m.strokeThickness=z["stroke-width"];}if(z["stroke-opacity"]){m.strokeOpacity=z["stroke-opacity"]?parseInt(z["stroke-opacity"])/255:1;
}});if(r.find("image").length!=0){if(r.find("image").attr("href")=="dummy.gif"){o.src=g+"?w="+o.width+"&h="+o.height+"&sty="+o.styleName+"&ds="+n;
}else{o.src=r.find("image").attr("href");}}else{if(r.find("circle").length!=0){w.type="circle";w.cx=1*r.find("circle").attr("cx");
w.cy=1*r.find("circle").attr("cy");w.width=o.width;w.height=o.height;l.shape=w;}else{if(r.find("rect").length!=0){w.type="rectangle";
var e=r.find("rect").attr("points").split(",");for(var q=0,t=e.length;q<t;q++){e[q]=1*e[q];}w.width=o.width;
w.height=o.height;w.x=e[0];w.y=e[1];l.shape=w;}else{var s=r.find("polygon").attr("points")||r.find("polyline").attr("points");
w.type="path";var e=s.split(",");w.coords=[e];l.shape=w;}}}for(var q in m){l.style=m;break;}if(l.shape||l.style){o.vectorDef=[l];
}var d=new OM.style.Marker(o);d.calculateVectorMarkerScale();return d;};OM.style.StyleStore.createTextStyle=function(d){var e={};
e.styleName=d.attr("name");d.find("g").each(function(l,n){var r=OM.$(n);var q=OM.Text;var o=OM.style.StyleStore._styleStringToArray(r);
e.fill=o.fill;e.fontStyle=o["font-style"]=="italic"?q.FONTSTYLE_ITALIC:q.FONTSTYLE_NORMAL;e.fontFamily=o["font-family"];
var m=o["font-size"];if(m){e.fontSize=parseInt(m);var g=m.length;if(g>2&&m.substring(g-2)=="pt"){e.fontSize=parseInt(e.fontSize*96/72);
}}e.fontWeight=o["font-weight"]=="bold"?q.FONTWEIGHT_BOLD:q.FONTWEIGHT_NORMAL;});return new OM.style.Text(e);
};OM.style.StyleStore.createPieChartStyle=function(d){var g={};var e=OM.style.StyleStore;g.pieSlices=[];
g.styleName=d.find("style").attr("name");g.radius=d.find("PieChartStyle").attr("pieradius");d.find("PieSlice").each(function(o,q){var r=OM.$(q);
var m=r.attr("color");var n=r.attr("name");g.pieSlices.push(new OM.style.PieSlice(n,m));});var l=new OM.style.PieChart(g);
return l;};OM.style.StyleStore.createBarChartStyle=function(d){var g={};var e=OM.style.StyleStore;g.bars=[];
g.styleName=d.find("style").attr("name");var l=d.find("BarChartStyle");g.width=l.attr("width");g.height=l.attr("height");
g.showXAxis=l.attr("show_x_axis");g.maxSize=l.attr("max_value");d.find("Bar").each(function(q,r){var s=OM.$(r);
var n=s.attr("color");var o=s.attr("name");g.bars.push(new OM.style.Bar(o,n));});var m=new OM.style.BarChart(g);
return m;};OM.style.StyleStore.createColorSchemeStyle=function(d){var l=OM.style.StyleStore.createBucketConfig(d);
var e=d.find("ColorSchemeStyle");l.baseColor=e.attr("basecolor");var g=e.attr("basecolor_opacity");l.baseColorOpacity=g?parseInt(g)/255:1;
l.stroke=e.attr("strokecolor");if(e.attr("strokewidth")){l.strokeThickness=1*e.attr("strokewidth");}g=e.attr("strokecolor_opacity");
l.strokeOpacity=g?parseInt(g)/255:1;var m=new OM.style.ColorScheme(l);return m;};OM.style.StyleStore.createHeatMapStyle=function(d){var g={};
var l=d.find("spot_light_radius").text();g.styleName=d.find("style").attr("name");g.containerThemeName=d.find("container_theme").text();
g.spotlightRadius=1*l.match(/\d+\.?\d+/g);var e=OM.$.trim(d.find("color_stops").text());g.colorStops=e.split(",");
g.isRadiusInMeter=l.match("meter")?true:false;var m=new OM.style.HeatMap(g);return m;};OM.style.StyleStore.createBucketStyle=function(d,m,g){var e=OM.style.StyleStore.createBucketConfig(d,m,g);
var l=new OM.style.BucketStyle(e);return l;};OM.style.StyleStore.createBucketConfig=function(s,e,l){var n={};
n.styleName=s.find("style:has('AdvancedStyle')").attr("name");var r=s.find("Buckets");var B=OM.style.StyleStore;
var C=r.attr("default_style");if(C){n.defaultStyle=B.getSubStyleByName(s,C,e,l);}n.buckets=[];n.styles=[];
var A=r.find("RangedBucket");if(A.length>0){var m=OM.style.RangedBucket;A.each(function(){n.classification="custom";
var J=OM.$(this);var E={};E.seq=1*J.attr("seq");E.label=J.attr("label");var D=1*J.attr("low");var H=1*J.attr("high");
E.low=isNaN(D)?Number.NEGATIVE_INFINITY:D;E.high=isNaN(H)?Number.POSITIVE_INFINITY:H;var G=J.attr("style");
var F=B.getSubStyleByName(s,G,e,l);var I=new m(E);n.buckets.push(I);if(F){n.styles.push(F);}});n.numClasses=n.buckets.length;
return n;}var d=r.find("CollectionBucket");if(d.length>0){m=OM.style.CollectionBucket;d.each(function(){n.classification="custom";
var I=OM.$(this);var G={};G.seq=1*I.attr("seq");G.label=I.attr("label");var K=I.attr("style");var D=B.getSubStyleByName(s,K,e,l);
var O=I.attr("label_style");G.labelStyle=B.getSubStyleByName(s,O,e,l);G.keepWhiteSpace=I.attr("keep_white_space");
var L=I.attr("type");G.dataType=L;var E=I.attr("delimiter");if(E==null||E==""){E=",";}var M=I.text();
var N=M.split(E);var J=N.length;for(var H=0;H<J;H++){if(L=="integer"||L=="short"){N[H]=parseInt(N[H]);
}else{if(L=="double"||L=="long"){N[H]=parseFloat(N[H]);}}}G.values=N;var F=new m(G);n.buckets.push(F);
if(D){n.styles.push(D);}});n.numClasses=n.buckets.length;return n;}var z=r.attr("styles");if(z){z=z.split(",");
for(var q=0,t=z.length;q<t;q++){var g=B.getSubStyleByName(s,z[q],e,l);n.styles.push(g);}}var w=r.attr("low");
var o=r.attr("high");if(w){n.low=1*w;}if(o){n.high=1*o;}var u=r.attr("nbuckets");n.numClasses=u?1*u:null;
return n;};OM.style.StyleStore.createVariableMarkerStyle=function(n,e,g){var l=OM.style.StyleStore.createBucketConfig(n,e,g);
var o=n.find("VariableMarkerStyle");var r=OM.style.StyleStore;var q=o.attr("basemarker");l.markerStyle=r.getSubStyleByName(n,q,e,g);
var s=o.attr("startsize");var m=o.attr("increment");if(s){l.startSize=1*s;}if(m){l.increament=1*m;}var d=new OM.style.VariableMarker(l);
return d;};OM.style.StyleStore.getSubStyleByName=function(e,m,o,l){var d=e.find('style[name="'+m+'"]')[0];
var g=OM.$(d);var n={dataSource:o,url:l,data:g};return OM.style.StyleStore.createSimpleStyle(n);};OM.style.StyleStore.splitDashArray=function(g){if(g){var d=g.split(",");
len=d.length;for(var e=0;e<len;e++){d[e]=parseInt(d[e]);}return d;}return null;};OM.style.BasicAnimation=OM.style.Style.extend({initialize:function(d){this._super(d);
this.duration=d.duration!=undefined?d.duration:5;this.repeatCount=d.repeatCount?d.repeatCount:Number.MAX_VALUE;
},isRepeat:function(){return this.repeatCount>0;},getDuration:function(){return this.duration;}});OM.style.AnimationColor=OM.style.BasicAnimation.extend({initialize:function(d){d=d||{};
d.styleType="AnimationColor";this._super(d);this.beginColor=d.beginColor!=undefined?d.beginColor:new OM.style.Color({strokeThickness:1,stroke:"#000000",fill:"#ffffff"});
this.endColor=d.endColor!=undefined?d.endColor:new OM.style.Color({strokeThickness:1,stroke:"#ffffff",fill:"#000000"});
this.movingDashLine=d.enableMovingDashLine!=undefined?d.enableMovingDashLine:false;if(this.movingDashLine){this.beginColor.strokeDashArray=[10,10];
}},createAnimation:function(n,l,g){this.target=n;if(this.beginColor&&this.endColor){var o=[];var e=function(r){var q=r.target;
q.beginAt(0);};var m={};if(this.beginColor.stroke!==this.endColor.stroke){m.stroke={beginValue:this.covertColor(this.beginColor.stroke,l),endValue:this.covertColor(this.endColor.stroke,l),interpolator:l.oui.anim.interpolateColor};
}if(this.beginColor.strokeThickness!==this.endColor.strokeThickness){m.strokeThickness={beginValue:this.beginColor.strokeThickness,endValue:this.endColor.strokeThickness};
}if(!g){if(this.beginColor.fill!==this.endColor.fill){m.fill={beginValue:this.covertColor(this.beginColor.fill,l),endValue:this.covertColor(this.endColor.fill,l),interpolator:l.oui.anim.interpolateColor};
}if(this.beginColor.fillOpacity!==this.endColor.fillOpacity){m.fillOpacity={beginValue:this.beginColor.fillOpacity,endValue:this.endColor.fillOpacity};
}if(this.beginColor.strokeOpacity!==this.endColor.strokeOpacity){m.strokeOpacity={beginValue:this.beginColor.strokeOpacity,endValue:this.endColor.strokeOpacity};
}}if(this.movingDashLine){m.strokeDashArray={beginValue:[10,10],endValue:[10,10],interpolator:function(u,t,A){var z=5;
var w=parseInt(A*20*z);var s=w%20;var q=[10,10];if(s>10){q=[s-10,10,20-s,0.1];}else{if(s>0){var r=10-s;
q=[0.1,s,10,r==0?0.1:r];}}return q;}};}var d=new l.oui.anim.AnimateStyle({targetNode:n,dur:this.duration,animValues:m,repeatCount:this.repeatCount});
o.push(d);return o;}},covertColor:function(e,g){var m=parseInt(e.substring(1,3),16);var l=parseInt(e.substring(3,5),16);
var d=parseInt(e.substring(5),16);return new g.oui.style.Color(m,l,d);}});OM.style.PulseAnimation=OM.style.BasicAnimation.extend({initialize:function(d){d=d||{};
d.styleType="PulseAnimation";this._super(d);this.beginSize=d.beginSize!=undefined?d.beginSize:10;this.endSize=d.endSize!=undefined?d.endSize:20;
this.stroke=d.stroke!=undefined?d.stroke:"#000000";},createAnimation:function(l,g,e){this.target=l;var m=[];
var d=new g.oui.anim.AnimateStyle({targetNode:l,dur:this.duration,repeatCount:this.repeatCount,animValues:{width:{beginValue:this.beginSize,endValue:this.endSize},height:{beginValue:this.beginSize,endValue:this.endSize},strokeOpacity:{beginValue:1,endValue:0}}});
d.addEventListener(g.oui.SyncEvents.END,this.endListener);m.push(d);return m;},endListener:function(e){var d=e.target;
var l=d.getTargetNode();var g=d.getAnimValues();l.applyStyle({width:g.width.beginValue,height:g.height.beginValue,strokeOpacity:1});
}});OM.Feature=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(m,g,d){this.id=m;this.geo=g?g:null;
this.graphics=null;this.group=null;this.shape=null;this.attributes=d&&d.attributes!=undefined?d.attributes:null;
this.renderingStyle=d&&d.renderingStyle!=undefined?d.renderingStyle:null;this.label=d&&d.label!=undefined?d.label:null;
this.labelStyle=d&&d.labelStyle!=undefined?d.labelStyle:null;this.customContent=d&&d.customContent!=undefined?d.customContent:null;
this.displayed=false;this.visible=true;this.editable=false;this.screenTransformObj=null;this.labelOffsetX=2;
this.labelOffsetY=2;this.selected=false;this.hover=false;this.scaleX=1;this.scaleY=1;if(this.attributes){for(var e in this.attributes){var l=e.toUpperCase();
if(l!=e){this.attributes[l]=this.attributes[e];this.attributes[e]=null;delete this.attributes[e];}}}},setGeometry:function(u){if(u==null||u==undefined){return false;
}if(!this.displayed){this.geo=u;this.screenPoints=null;return true;}var o=OM.geometry;var A=u.type;var e=this.geo.type;
if(A!=e){return false;}var n=u.srid;var B=this.geo.srid;if(n!==B){var C=this;u.transform(B,function(D){C.setGeometry(D);
});return true;}this.clearInfoWindow();var s=A;this.geo=u;var t=this.graphics;var d={};var g=this.renderingStyle;
switch(s){case"Point":var w=this.screenTransformObj.toScreenPoint(u.getX(),u.getY());d={x:w.x,y:w.y,width:g.width,height:g.height};
if(d.width){d.x-=d.width/2;}if(d.height){d.y-=d.height/2;}this.screenPoints=w;if(g.styleType=="Marker"&&g.src){t.setLeftTop(this.shape,0,0);
}else{t.setLeftTop(this.shape,d.x,d.y);}this.shape.applyStyle(d);this.parentLayer.parentMap.refreshVectorLayerLabels();
break;case"OrientedPoint":var z=this.shape.parentNode;this.graphics.remove(this.shape);this.screenPoints=null;
this.drawPoint(this.graphics,z,this.geo,g);break;case"LineString":var m=u.coordinates.slice(0);m=this.screenTransformObj.transformSegment(m,2,u.dim);
if(m==null){return null;}this.screenPoints=[m];if(this.shapeGroup){var q=this.shapeGroup.length;for(var l=0;
l<q;l++){t.setLeftTop(this.shapeGroup[l],0,0);t.setPath(this.shapeGroup[l],this.screenPoints);}}else{t.setLeftTop(this.shape,0,0);
t.setPath(this.shape,this.screenPoints);}break;case"MultiPoint":case"OrientedMultiPoint":while(this.shape.firstChild){this.shape.removeChild(this.shape.firstChild);
}this.screenPoints=null;this.drawMultiPoint(t,this.shape,u,g);break;case"MultiLineString":while(this.shape.firstChild){this.shape.removeChild(this.shape.firstChild);
}this.screenPoints=null;this.drawMultiLineString(t,this.shape,u,g);break;case"MultiPolygon":this.remove();
var z=this.renderingStyle.cased?this.lineGroup:this.group;this.screenPoints=null;this.drawMultiPolygon(t,z,u,g);
break;case"Rectangle":var w=this.screenTransformObj.toScreenPoint(u.getMinX(),u.getMaxY());d.x=w.x;d.y=w.y;
d.width=this.screenTransformObj.toScreenXLength(u.width);d.height=this.screenTransformObj.toScreenYLength(u.height);
this.screenPoints={x:w.x,y:w.y,width:d.width,height:d.height};t.setLeftTop(this.shape,0,0);this.shape.applyStyle(d);
break;case"Circle":case"Polygon":var m=u.coordinates.slice(0);var q=m.length;this.screenPoints=new Array();
for(var l=0;l<q;l++){var r=m[l].slice(0);r=this.screenTransformObj.transformSegment(r,1,u.dim);if(r!=null){this.screenPoints.push(r);
}}t.setLeftTop(this.shape,0,0);t.setPath(this.shape,this.screenPoints);this.parentLayer.parentMap.refreshVectorLayerLabels();
break;case"GeometryCollection":while(this.shape.firstChild){this.shape.removeChild(this.shape.firstChild);
}this.drawGeometryCollection(t,this.shape,u,g);break;default:return false;}return true;},getGeometry:function(){var d=OM.geometry.Geometry;
if(!(this.geo instanceof d)){this.geo=d.createGeometry(this.geo,this.geo.srid);}return this.geo;},getAttributes:function(){return this.attributes;
},getAttributeValue:function(e){if(typeof e!=="string"){return null;}var d=this.attributes;var g=e.toUpperCase();
if(d&&typeof d[g]!=="undefined"){return d[g];}else{return null;}},hasAttributes:function(){return(this.attributes);
},setRenderingStyle:function(d){if(d==null&&(this.parentLayer==null||this.parentLayer.otherStyles==null||this.parentLayer.otherStyles.length==0)){return;
}else{if(!(d instanceof OM.style.Style)&&d&&d.dataSource&&d.name){var z=this;OM.style.StyleStore.getServerSideStyle(d.dataSource,d.name,{url:d.url,callback:function(A){z.setRenderingStyle(A);
}});return;}}if(this.renderingStyle==d){return;}var g=this.renderingStyle;this.renderingStyle=d;if(!this.displayed){return;
}if(d!=null){d=this.parentLayer.resolveStyle(this,d);}if(this.parentLayer.otherStyles&&this.parentLayer.otherStyles.length>0){this.remove();
if(d!=null){d=[d];}else{d=[];}d=d.concat(this.parentLayer.otherStyles);this.displayFeature(d);return;
}var u=this.graphics;var s=function(B){var C=this.firstChild;if(C){s.call(C,B);var A=C.nextSibling;while(A){s.call(A,B);
A=A.nextSibling;}}else{u.applyStyle(this,B);}};var m=new Object();OM.$.extend(true,m,d);this.scaleX=1;
this.scaleY=1;if(this.shape){if(g.styleType=="Marker"&&m.styleType=="Marker"){if(g.src&&m.src&&g.width==m.width&&g.height==m.height){s.call(this.shape,m);
}else{this.graphics.remove(this.shape);this.displayFeature([d]);}return;}else{if(this.geo.type=="MultiLineString"||this.geo.type=="LineString"){var w=m.stylelist;
if(m.styleType=="Color"){if(!m.stroke){m.stroke=m.fill?m.fill:"#000000";}m.fill=null;w=[m];}else{if(m.styleType=="Line"){OM.style.Style.calculateStyleSize(m,this.parentLayer.parentMap);
}}var t=w?w.length:1;var e=g.stylelist?g.stylelist.length:1;if(e==t&&g.cased==m.cased&&this.geo.type!="MultiLineString"){if(this.shapeGroup){for(var n=0;
n<t;n++){s.call(this.shapeGroup[n],w[n]);}}else{s.call(this.shape,w?w[0]:m);}}else{if(this.geo.type=="MultiLineString"&&e==t&&g.cased&&m.cased){if(this.shapeGroup){for(var n=0;
n<t;n++){var r=this.shapeGroup[n].childrenCount;for(var l=0;l<r;l++){s.call(this.shapeGroup[n].getChildAt(l),w[n]);
}}}else{var r=this.shape.childrenCount;for(var l=0;l<r;l++){s.call(this.shape.getChildAt(l),w[0]);}}}else{if(this.geo.type=="MultiLineString"&&e==1&&t==1){var r=this.shape.childrenCount;
for(var l=0;l<r;l++){s.call(this.shape.getChildAt(l),w?w[0]:m);}}else{this.remove();this.displayFeature([d]);
}}}}else{if(d instanceof OM.style.Gradient){if(d.fill==null){d.createStyle(this.graphics);}if(!d.useFeatureBoundingBox){var q=this.parentLayer;
var o=q.calculateLayerGradientBound();d.fill.applyProperties(o);}this.remove();this.displayFeature([d]);
}else{if(g.styleType=="PieChart"||g.styleType=="BarChart"||d.styleType=="PieChart"||d.styleType=="BarChart"){this.remove();
this.displayFeature([d]);}else{if((this.geo.type=="Polygon"||this.geo.type=="MultiPolygon"||this.geo.type=="Rectangle")&&m.styleType=="Color"&&g.styleType=="Color"){if(m.fill==OM.PaintTypes.NO_PAINT){m.fill="#000000";
m.fillOpacity=0;}s.call(this.shape,m);}else{this.remove();this.displayFeature([m]);}}}}}}},getRenderingStyle:function(){return this.renderingStyle;
},setLabel:function(d){if(d==null){return;}this.label=d;this.applyToolTip();},setLabelingStyle:function(d){if(d==null){return;
}this.labelStyle=d;},getLabelingStyle:function(){return this.labelStyle;},isVisible:function(){return this.visible;
},setVisible:function(e){if(e==null||e==undefined){return;}this.visible=e;if(this.displayed){var d=this.graphics;
d.setVisible(this.shape,e);}else{if(e){this.displayFeature(this.renderingStyle);}}},bringForward:function(){if(this.parentLayer){this.parentLayer.bringFeatureForward(this);
}},sendBackward:function(){if(this.parentLayer){this.parentLayer.sendFeatureBackward(this);}},bringToTop:function(){if(this.parentLayer){this.parentLayer.bringFeatureToTop(this);
}},sendToBottom:function(){if(this.parentLayer){this.parentLayer.sendFeatureToBottom(this);}},displayFeature:function(u){if(!u){return;
}var z=this.graphics;var B=this.renderingStyle&&this.renderingStyle.cased?this.parentLayer.getLineGroup():this.group;
var r=this.geo;var n=this.screenTransformObj;if(z==null||B==null||r==null||n==null){return;}var w=this.typeIs(r);
if(u.length>1){var e=z.createGroup();B.appendChild(e);B=e;}var g=u.length;var m=[];for(var q=0;q<g;q++){var d=u[q];
if(d&&d instanceof OM.style.Gradient){d.createStyle(z);if(!d.useFeatureBoundingBox){var s=this.parentLayer.calculateLayerGradientBound();
d.fill.applyProperties(s);}}var A=d.styleType;var l={};if(A=="AnimationColor"){OM.$.extend(true,l,d.beginColor);
}else{if(A=="PulseAnimation"){l.stroke=d.stroke;l.width=d.beginSize;l.height=d.beginSize;}else{OM.$.extend(true,l,d);
}}if(A=="PieChart"||A=="BarChart"){if(w=="Point"){this.drawChart(this.geo,B,l);}else{if((w=="Polygon"||w=="MultiPolygon")&&this.labelBox){m.push(l);
}}}else{var o,t;switch(w){case"Point":case"OrientedPoint":this.drawPoint(z,B,r,l);break;case"LineString":this.drawLineString(z,B,r,l);
break;case"MultiPoint":case"OrientedMultiPoint":o={opacity:1,visibility:"visible"};t=z.createGroup(o);
B.appendChild(t);this.drawMultiPoint(z,t,r,l);break;case"MultiLineString":o={opacity:1,visibility:"visible"};
this.drawMultiLineString(z,B,r,l);break;case"MultiPolygon":this.drawMultiPolygon(z,B,r,l);break;case"Rectangle":this.drawRectangle(z,B,r,l);
break;case"Circle":this.drawPolygon(z,B,r,l);break;case"Polygon":this.drawPolygon(z,B,r,l);break;case"GeometryCollection":o={opacity:1,visibility:"visible"};
t=z.createGroup(o);B.appendChild(t);this.drawGeometryCollection(z,t,r,l);break;default:return;}}if((A=="AnimationColor"||A=="PulseAnimation")&&this.shape!=null){this.createAnimation(d,w=="MultiLineString"||w=="LineString");
}}if(m.length>0){srid=this.parentLayer.parentMap.getMapContext().getUniverse().getSRID();this.displayChartStyle(m,this.labelBox,B,srid);
}if(g>1){this.shape=B;}this.displayed=true;this.applyToolTip();if(this.shapeGroup&&!this.visible){for(q=1;
q<this.shapeGroup.length;q++){this.graphics.setVisible(this.shapeGroup[q],false);}}else{if(this.shape&&!this.visible){this.graphics.setVisible(this.shape,false);
}}this.resumeMoveAnimation();},drawSinglePoint:function(l,r,o,d){var t={group:r,id:"pot"};if(o.angle){t.angle=o.angle;
}t.xOffset=d.xOffset;t.yOffset=d.yOffset;var g;if(d.src){t.enableCache=true;g=l.drawImageMarker({x:o.x,y:o.y},d,t);
}else{if(!d.vectorDef||!d.vectorDef[0]||!d.vectorDef[0].shape){var s=OM.gv;var n=s.defaultMarkerStyleWidth;
var e=s.defaultMarkerStyleHeight;d.width=n;d.height=e;d.realWidth=n;d.realHeight=e;d.vectorDef=[{shape:{type:"circle",cx:n/2,cy:e/2,width:d.width,height:d.height,scaleX:1,scaleY:1},style:d}];
}OM.style.Style.calculateStyleSize(d,this.parentLayer.parentMap);t.width=d.realWidth;t.height=d.realHeight;
this.markerSize={w:d.realWidth,h:d.realHeight};var q=d.realWidth/d.width*d.vectorDef[0].shape.scaleX;
var m=d.realHeight/d.height*d.vectorDef[0].shape.scaleY;if(d.vectorDef[0].style.strokeThickness){d.vectorDef[0].style.strokeThickness=d.vectorDef[0].style.strokeThickness/q;
}else{d.vectorDef[0].style.strokeThickness=1/q;}this.scaleX=q;this.scaleY=m;if(q&&m){t.xScale=q;t.yScale=m;
}g=l.drawVectorMarker({x:o.x,y:o.y},d.vectorDef,t);}return g;},drawPoint:function(t,g,F,s){if(!this.screenPoints){var D=F.coordinates;
var o=this.screenTransformObj.toScreenPoint(D[0],D[1]);var q=F.dimension?F.dimension:2;if(F.type=="OrientedPoint"){var C=D[q];
var A=D[q+1];var z=-Math.atan2(A,C);o.angle=z;}this.screenPoints=o;}this.shape=this.drawSinglePoint(t,g,this.screenPoints,s);
if(this.markerText){var G=this.graphics.createTextNode(this.markerText,s.textStyle,0,0);var B=0;var u=0;
if(s.src){var d=t.createGroup();d.appendChild(this.shape);d.appendChild(G);this.shape=d;g.appendChild(d);
B=this.screenPoints.x-s.width/2;u=this.screenPoints.y-s.height/2;}else{this.shape.appendChild(G);}var E=this.graphics.getScaleValue(this.shape);
var n=this.graphics.getWidthHeight(G);var l=s.realWidth?s.realWidth:s.width;var r=s.realHeight?s.realWidth:s.width;
var e=(l-n.w)/2+B;var m=(r+n.h-4)/2+u;G.scale(1/E.scaleX,1/E.scaleY);G.translate(e,m);}return this.shape;
},drawMultiPoint:function(s,r,n,d){var z=n.coordinates;var q=z.length;var l=n.type=="OrientedMultiPoint"?true:false;
var e=true;if(this.screenPoints){e=false;}else{this.screenPoints=new Array();}var o=n.dimension?n.dimension:2;
for(var m=0;m<q;m++){if(e){z=n.coordinates[m];var w=this.screenTransformObj.toScreenPoint(z[0],z[1]);
if(l){var u=z[o];var t=z[o+1];var g=-Math.atan2(t,u);w.angle=g;}this.screenPoints.push(w);}this.drawSinglePoint(s,r,this.screenPoints[m],d);
}this.shape=r;return r;},drawRectangle:function(n,r,l,d){if(!this.screenPoints){var o=l.coordinates;var q=this.screenTransformObj.toScreenPoint(o[0],o[3]);
var t=q.x;var s=q.y;var e=this.screenTransformObj.toScreenXLength(o[2]-o[0]);var g=this.screenTransformObj.toScreenYLength(o[3]-o[1]);
this.screenPoints={x:t,y:s,width:e,height:g};}var m=n.drawRectangle(this.screenPoints,d,{group:r,id:"rec"});
this.shape=m;return m;},drawCircle:function(q,s,l){var r=this.screenTransformObj.toScreenPoint(l.centerX,l.centerY);
var o=r.x;var n=r.y;var e=this.screenTransformObj.toScreenXLength(l.radius*2);var t=this.screenTransformObj.toScreenYLength(l.radius*2);
var g={cx:o,cy:n,width:e,height:t};var d=this.renderingStyle;var u={group:s,id:"cir"};var m=q.drawEllipse(g,d,u);
if(this.shape==null){this.shape=m;}return m;},drawLineString:function(d,l,g,e){if(!this.screenPoints){var n=g.coordinates.slice(0);
n=this.screenTransformObj.transformSegment(n,2,g.dim);if(n==null){return null;}this.screenPoints=[n];
}var m=this.drawLine(l,this.screenPoints,e);if(m.length>1){this.shape=m[0];this.shapeGroup=m;}else{this.shape=m[0];
}return this.shape;},drawLine:function(u,n,d){var e=new Array();if(d&&d.styleType=="Line"){OM.style.Style.calculateStyleSize(d,this.parentLayer.parentMap);
var s=d.stylelist;var r=s.length;var z={group:u,id:"lstr"};for(var l=0;l<r;l++){var m=s[l];if(u.length&&d.cased){z.group=u[l];
}if(!m.stroke){continue;}e.push(this.graphics.drawPath(n,m,z));}if(d.startMarker){var t={x:n[0][0],y:n[0][1]};
if(d.oriented){var q=n[0][0]-n[0][2];var o=n[0][3]-n[0][1];t.angle=-Math.atan2(o,q);}var g={};g=OM.$.extend(true,g,d.startMarker);
e.push(this.drawSinglePoint(this.graphics,z.group,t,g));}if(d.endMarker){var w=n[0].length;var t={x:n[0][w-2],y:n[0][w-1]};
if(d.oriented){var q=n[0][w-4]-n[0][w-2];var o=n[0][w-1]-n[0][w-3];t.angle=-Math.atan2(o,q);}var g={};
g=OM.$.extend(true,g,d.endMarker);e.push(this.drawSinglePoint(this.graphics,z.group,t,g));}}else{var z={group:u,id:"lstr"};
if(!d.stroke){d.stroke=d.fill?d.fill:"#000000";}d.fill=null;e.push(this.graphics.drawPath(n,d,z));}return e;
},drawMultiLineString:function(s,l,o,d){var r=l.length;var t=null;if(r!=undefined){t=new Array();for(k=0;
k<r;k++){t[k]=s.createGroup();l[k].appendChild(t[k]);}}else{t=s.createGroup();l.appendChild(t);}var g=true;
var q=null;if(this.screenPoints){g=false;}else{this.screenPoints=[];}q=g?o.coordinates.slice(0):o.coordinates;
var e=q.length;for(var n=0;n<e;n++){if(g){var m=this.screenTransformObj.transformSegment(q[n],2,o.dim);
this.screenPoints.push([m]);if(m==null){continue;}}if(this.screenPoints[n].length>0){this.drawLine(t,this.screenPoints[n],d);
}}if(t.length>1){this.shape=t[0];this.shapeGroup=t;}else{this.shape=t;}return this.shape;},drawPolygon:function(s,t,l,e){if(!this.screenPoints){var n=l.coordinates.slice(0);
var o=n.length;var g=[];for(var m=0;m<o;m++){var r=n[m].slice(0);r=this.screenTransformObj.transformSegment(r,1,l.dim);
if(r!=null){g.push(r);}}if(g.length>0){this.screenPoints=g;}}if(!this.screenPoints||this.screenPoints.length==0){return;
}var w={group:t,id:"pol"};var q;if(e.styleType=="Line"){q=this.drawLine(t,this.screenPoints,e);if(q.length>1){this.shape=q[0];
this.shapeGroup=q;}else{this.shape=q[0];}}else{if(e.styleType=="Marker"){var u=null;if(this.labelBox){u=new OM.geometry.Point((this.labelBox[0]+this.labelBox[2])/2,(this.labelBox[1]+this.labelBox[3])/2,l.srid);
}else{if(l.mbr){u=new OM.geometry.Point((l.mbr.getMixX()+l.mbr.getMaxX())/2,(l.mbr.getMinY()+l.mbr.getMaxY())/2,l.srid);
}}var d=this.screenTransformObj.toScreenPoint(u.x,u.y);q=this.drawSinglePoint(s,t,d,e);this.shape=q;}else{if(e.fill==OM.PaintTypes.NO_PAINT){e.fill="#ffffff";
e.fillOpacity=0;}q=s.drawPath(this.screenPoints,e,w);this.shape=q;}}return q;},drawMultiPolygon:function(w,A,l,d){if(d.styleType==="Marker"){return this.drawPolygon(w,A,l,d);
}var o=l.coordinates.slice(0);var u=o.length;if(!this.screenPoints){this.screenPoints=new Array();for(var m=0;
m<u;m++){var q=o[m].length;var z=new Array(q);for(var g=0;g<q;g++){var t=this.screenTransformObj.transformSegment(o[m][g],1,l.dim);
z[g]=t;}if(q>0&&z[0]){this.screenPoints.push(z);}}}if(this.screenPoints.length==0){return;}var e={opacity:1,visibility:"visible"};
var s=null;var B={id:"mplg"};if(A.length==undefined){s=w.createGroup(e);A.appendChild(s);this.shape=s;
B={group:s};}else{s=new Array();for(var m=0;m<A.length;m++){s.push(w.createGroup(e));A[m].appendChild(s[m]);
}this.shape=s[0];this.shapeGroup=s;}var q=this.screenPoints.length;var r;for(var m=0;m<q;m++){var n=this.screenPoints[m];
if(d.styleType=="Line"){r=this.drawLine(s,n,d);}else{if(d.fill==OM.PaintTypes.NO_PAINT){d.fill="#ffffff";
d.fillOpacity=0;}w.drawPath(n,d,B);}}return s;},drawGeometryCollection:function(q,o,l,d){var n=OM.geometry;
var e=l.geometries.length;for(var m=0;m<e;m++){var r=l.geometries[m];var g=this.typeIs(r);switch(g){case"Point":case"OrientedPoint":this.drawPoint(q,o,r,d);
break;case"LineString":this.drawLineString(q,o,r,d);break;case"MultiPoint":case"OrientedMultiPoint":this.drawMultiPoint(q,o,r,d);
break;case"MultiLineString":this.drawMultiLineString(q,o,r,d);break;case"MultiPolygon":this.drawMultiPolygon(q,o,r,d);
break;case"Rectangle":this.drawRectangle(q,o,r,d);break;case"Circle":this.drawPolygon(q,o,r,d);break;
case"Polygon":this.drawPolygon(q,o,r,d);break;case"GeometryCollection":this.drawGeometryCollection(q,o,r,d);
break;default:return null;}}this.shape=o;},remove:function(){var e=this.shape;if(!e){return;}this.graphics.remove(e);
this.shape=null;if(this.shapeGroup){var d=this.shapeGroup.length;for(var g=0;g<d;g++){if(this.shapeGroup[g]){this.graphics.remove(this.shapeGroup[g]);
}}}this.shapeGroup=null;},typeIs:function(d){var e=OM.geometry;if(d instanceof e.Circle){return"Circle";
}if(d instanceof e.Rectangle){return"Rectangle";}return d.type;},move:function(l,g,d){l=-l;if(this.displayed){var r=this.geo.type;
var q=function(z,A){if(A=="Point"||A=="OrientedPoint"||A=="Rectangle"){z.x+=l;z.y-=g;}else{if(A=="MultiPoint"||A=="OrientedMultiPoint"){var u=z.length;
for(var w=0;w<u;w++){z[w].x+=l;z[w].y-=g;}}else{OM.util.GeomUtil.moveCoordinates(z,l,-g);}}};if(r=="GeometryCollection"){var o=this.screenPoints.length;
for(var n=0;n<o;n++){var r=this.geo.geometries[n].type;q(this.screenPoints[n],r);}}else{q(this.screenPoints,r);
}var t=l*d.resolution;var s=g*d.resolution*d.stretchRatio;if(!(this.geo instanceof OM.geometry.Geometry)){if(r!="GeometryCollection"){var m=(r=="OrientedPoint"||r=="OrientedMultiPoint")?true:false;
OM.util.GeomUtil.moveCoordinates(this.geo.coordinates,t,s,m);}else{var e=this.geo.geometries;var o=e.length;
for(var n=0;n<o;n++){var r=e[n].type;var m=(r=="OrientedPoint"||r=="OrientedMultiPoint")?true:false;OM.util.GeomUtil.moveCoordinates(e[n].coordinates,t,s,m);
}}}else{this.geo.move(t,s);}if(this.labelBox){this.labelBox=[this.labelBox[0]+t,this.labelBox[1]+s,this.labelBox[2]+t,this.labelBox[3]+s];
}return this.geo;}},addLabel:function(d){if(!this.displayed){return;}if(!this.label){if(!this.attributes){return;
}if(this.parentLayer.labelColumn){this.label=this.attributes[this.parentLayer.labelColumn.toUpperCase()];
}else{this.label=this.attributes._LABEL_;}}if(!this.label){return;}var e=this.geo.type;OM.style.Style.calculateStyleSize(this.labelStyle,this.parentLayer.parentMap);
if(e=="Point"||e=="OrientedPoint"){this.addPointLabel(d);}else{if(e=="Polygon"||e=="MultiPolygon"){this.addPolygonLabel(d);
}else{if(e=="LineString"||e=="MultiLineString"){this.addLineLabel(d);}}}},addPointLabel:function(e){var t=this.graphics;
var B=t.getTextSize(this.label,this.labelStyle);B.w=parseInt(B.w)-2;B.h=parseInt(B.h)-4;var u=this.screenPoints.x;
var s=this.screenPoints.y;var z=this.markerSize?this.markerSize.w:this.renderingStyle.width;var q=this.markerSize?this.markerSize.h:this.renderingStyle.height;
var A=new Object();var l=u-z/2-this.labelOffsetX;var n=l-B.w;var m=s-B.h/2;var d=s+B.h/2;A.L=[n,m,l,d];
n=u+z/2+this.labelOffsetX;l=n+B.w;A.R=[n,m,l,d];n=u-B.w/2;l=n+B.w;d=s-q/2-this.labelOffsetY;m=d-B.h;A.T=[n,m,l,d];
n=u-B.w/2;l=n+B.w;m=s+q/2+this.labelOffsetY;d=m+B.h;A.B=[n,m,l,d];var g=OM.gv.labelDisplayOrder;for(var o=0;
o<g.length;o++){var r=A[g[o]];if(this.addLabelNode(e,r,r[0],r[3]-1)){return;}}},addPolygonLabel:function(e){if(this.labelBox){var s=this.graphics;
var A=s.getTextSize(this.label,this.labelStyle);A.w=parseInt(A.w)-2;A.h=parseInt(A.h)-4;var q=(this.labelBox[0]+this.labelBox[2])/2;
var n=(this.labelBox[1]+this.labelBox[3])/2;var u=this.screenTransformObj.toScreenPoint(q,n);var t=u.x;
var r=u.y;var m=t-A.w/2;var g=t+A.w/2;var l=r-A.h/2;var d=r+A.h/2;var z=this.screenTransformObj.toScreenPoint(this.labelBox[0],this.labelBox[1]);
var w=this.screenTransformObj.toScreenPoint(this.labelBox[2],this.labelBox[3]);if(m<z.x||g>w.x||l<w.y||d>z.y){return;
}var o=[m,l,g,d];this.addLabelNode(e,o,m,d-1);if(this.labelShape){this.labelShape.feature=this;}}},addLineLabel:function(o){if(this.labelStyle.styleType!="Marker"){return;
}var l=this.labelStyle.width/2;var q=this.labelStyle.height/2;var g=Math.max(l,q)*4;var n=this.getLabelMarkerPos(g);
for(var e=0,d=n?n.length:0;e<d;e++){var r=[n[e].x-l,n[e].y-q,n[e].x+l,n[e].y+q];this.addMarkerLabelNode(o,r,n[e]);
}},addLabelNode:function(g,l,e,m){if(!g.conflicts(l)){g.insert(l);var d=this.graphics.createTextNode(this.label,this.labelStyle,e,m);
this.parentLayer.labelGroup.appendChild(d);this.labelShape=d;return true;}return false;},addMarkerLabelNode:function(e,l,g){if(e.conflicts(l)){return false;
}this.labelShape=this.graphics.createGroup();this.parentLayer.labelGroup.appendChild(this.labelShape);
this.drawSinglePoint(this.graphics,this.labelShape,g,this.labelStyle);var d=this.graphics.getTextSize(this.label,{});
var m=this.graphics.createTextNode(this.label,this.labelStyle.textStyle,g.x-d.w/2,g.y+d.h/2-2);this.labelShape.appendChild(m);
e.insert(l);return true;},drawChart:function(s,u,g){if(!this.attributes){return false;}var l=this.screenTransformObj.toScreenPoint(s.getX(),s.getY());
var d=g.colors;var r=g.names;if(!r||r.length<1){return false;}var o=r.length;var w=new Array(o);for(var n=0;
n<o;n++){var e=r[n].toUpperCase();var t=parseFloat(this.attributes[e]);if(t==null){return false;}w[n]=t;
}var m=g.realWidth;var z=g.realHeight;var q={cx:l.x,cy:l.y,width:m,height:z};var A={group:u};A.stroke=g.stroke;
A.strokeThickness=g.strokeThickness;if(g.enableHighlight){A.plugable=true;A.description=r;}if(g.styleType=="PieChart"){A.offsetAngle=g.startingAngle;
A.orientation=g.direction=="CW"?2:1;this.shape=this.graphics.drawPieChart(q,w,d,A);}else{this.shape=this.graphics.drawBarChart(q,w,d,A);
}this.displayed=true;if(this.shape){if(this.attributes&&this.attributes._LABEL_!=undefined&&!this.renderingStyle.enableHighlight){this.shape.applyStyle({tooltip:this.attributes._LABEL_+""});
}this.shape.feature=this;}},applyToolTip:function(){if(!this.displayed){return;}var e;if(this.parentLayer.showToolTip){if(this.parentLayer.toolTipCustomizer){e=this.parentLayer.toolTipCustomizer(this)+"";
}else{if(this.label){e=this.label+"";}else{if(this.parentLayer.labelColumn&&this.attributes[this.parentLayer.labelColumn.toUpperCase()]!=undefined){e=this.attributes[this.parentLayer.labelColumn.toUpperCase()]+"";
}else{if(this.attributes&&this.attributes._LABEL_!=undefined){e=this.attributes._LABEL_+"";}}}}}if(this.shapeGroup){for(var d=1;
d<this.shapeGroup.length;d++){if(e&&(!this.renderingStyle||!this.renderingStyle.enableHighlight)){this.shapeGroup[d].applyStyle({tooltip:e});
}this.shapeGroup[d].feature=this;}}else{if(this.shape){if(e&&(!this.renderingStyle||!this.renderingStyle.enableHighlight)){this.shape.applyStyle({tooltip:e});
}this.shape.feature=this;}}},createAnimation:function(g,e){if(!this.shape.hasChildNodes()){this.animations=g.createAnimation(this.shape,this.graphics,e);
}else{var l=this.shape.firstChild;this.animations=new Array();while(l){var d=g.createAnimation(l,this.graphics,e);
this.animations=this.animations.concat(d);l=l.nextSibling;}}},startAnimation:function(){if(this.animations){var d=this.animations.length;
for(var e=0;e<d;e++){this.animations[e].beginAt(0);}}},stopAnimation:function(){if(this.animations){var d=this.animations.length;
for(var e=0;e<d;e++){this.animations[e].endAt(0);}}},clearAnimation:function(){if(this.animations){var d=this.animations.length;
for(var e=0;e<d;e++){this.animations[e].unplug();this.animations[e].endAt(0);}}},animateToNewLocation:function(n,e){var m=n.coordinates;
if(n.type=="Point"||n.type=="OrientedPoint"){this.movePoints=[m[0],m[1]];}else{if(n.type=="MultiPoint"||n.type=="OrientedMultiPoint"){var d=m.length;
var l=[];for(var g=0;g<d;g++){l=l.concat(m[g][0],m[g][1]);}this.movePoints=l;}else{if(n.type=="LineString"||n.type=="MultiLineString"){d=m.length;
l=[];for(var g=0;g<d;g++){l=l.concat(m[g]);}this.movePoints=l;}}}if(this.movePoints&&this.movePoints.length>=2){this.moveTime=e&&e.time!==undefined?e.time:300;
this.moveLoop=e&&e.loop;this.moveBound=e&&e.bounce;this.moveOriented=this.geo.type=="OrientedPoint"?true:false;
this.moveStep=e&&e.step?e.step:5;this.animateToNewPoint(0);}},animateToNewPoint:function(E){var t={x:this.movePoints[E],y:this.movePoints[E+1]};
this.currentTarget=E;if(this.displayed&&this.shape){var C=this.screenPoints;var u=this.screenTransformObj.toScreenPoint(t.x,t.y);
var s=u.x-C.x;var r=u.y-C.y;if(Math.abs(s)<=this.moveStep&&Math.abs(r)<=this.moveStep){if(this.movePoints&&!this.reverse&&this.movePoints.length>=this.currentTarget+4){this.animateToNewPoint(this.currentTarget+2);
}else{if(this.movePoints&&this.reverse&&this.currentTarget>0){this.animateToNewPoint(this.currentTarget-2);
}else{this.finishAnimation();}}return;}if(this.moveOriented){var D=new OM.geometry.Point(this.geo.getX(),this.geo.getY(),this.geo.srid,s,-r);
this.setGeometry(D);}var o=this.graphics.getLeftTop(this.shape);var w=this.shape._style;var A=C.x;if(w.width||w.x){A-=w.width/2+w.x;
}var z=C.y;if(w.height||w.y){z-=w.height/2+w.y;}var g=A+s;var e=z+r;this.moveAnimationDef={startX:A,startY:z,endX:g,endY:e,moveX:s,moveY:r};
var d=Math.sqrt(s*s+r*r)/10*this.moveTime/1000;var B;var n;B=this.shape.getTransformMatrix();n=B.clone();
if(this.moveOriented){this.moveAnimationDef.angleInRadius=Math.atan2(r,s);if(this.scaleX!=1&&this.scaleY!=1){var m=this.renderingStyle.realWidth/2;
var l=this.renderingStyle.realHeight/2;n.rotate(-this.moveAnimationDef.angleInRadius,m,l);n.translate(s/this.scaleX,r/this.scaleY);
n.rotate(this.moveAnimationDef.angleInRadius,m,l);}else{this.dis=Math.sqrt(s*s+r*r);n.translate(this.dis,0);
}}else{n.translate(s/this.scaleX,r/this.scaleY);}this.moveAnimation=new this.graphics.oui.anim.AnimateStyle({targetNode:this.shape,dur:d,animValues:{transform:{beginValue:B,endValue:n,interpolator:function(L,K,F){var H=L.tx;
var G=K.tx;var J=(G-H)*F+H;var O=L.ty;var M=K.ty;var I=(M-O)*F+O;var N=L.clone();N.tx=J;N.ty=I;N.b=K.b;
N.c=K.c;N.a=K.a;N.b=K.b;return N;}}}});this.moveAnimation.beginAt(0);var q=this;this.moveAnimation.addEventListener(this.graphics.oui.SyncEvents.END,function(T){var I=q.moveAnimationDef;
var L=0;var K=0;if(q.progress!=null){L=parseInt(I.moveX*q.progress);K=parseInt(I.moveY*q.progress);if(L==0&&K==0){q.progress=null;
return;}var S=I.startX+L;var Q=I.startY+K;if(q.shape){if(q.moveOriented){var R=new q.graphics.oui.geom.Matrix();
R.translate(S,Q);var G=q.shape._style;q.shape.applyStyle({transform:R});}else{q.graphics.setLeftTop(q.shape,S,Q);
}}if(q.parentLayer){var M=q.parentLayer.parentMap.getMapContext();var O=M.getUniverse();var N=O.getZoomLevels(0);
var H=N[M.getZoomLevel()];var P=q.getGeometry();var F=P.getX()+L*H.resolution;var V=P.getY()-K*H.resolution*H.stretchRatio;
if(q.moveOriented){var J=q.moveAnimationDef.angleInRadius;var U=q.getOrientation(J);q.geo=new OM.geometry.Point(F,V,q.geo.srid,U.x,U.y);
}else{q.geo=new OM.geometry.Point(F,V,q.geo.srid);}q.screenPoints=q.screenTransformObj.toScreenPoint(q.geo.x,q.geo.y);
}q.progress=null;}else{if(q.screenTransformObj){q.screenPoints=q.screenTransformObj.toScreenPoint(t.x,t.y);
}if(q.moveOriented){var J=q.moveAnimationDef.angleInRadius;q.screenPoints.angle=J;var U=q.getOrientation(J);
q.geo=new OM.geometry.Point(t.x,t.y,q.geo.srid,U.x,U.y);}else{q.geo=new OM.geometry.Point(t.x,t.y,q.geo.srid);
}q.moveAnimation=null;if(q.movePoints&&!q.reverse&&q.movePoints.length>=q.currentTarget+4){q.animateToNewPoint(q.currentTarget+2);
}else{if(q.movePoints&&q.reverse&&q.currentTarget>0){q.animateToNewPoint(q.currentTarget-2);}else{q.finishAnimation();
}}}});}},finishAnimation:function(){if((this.moveLoop||this.moveBound)&&this.movePoints.length>=4){if(this.moveBound){this.reverse=!this.reverse;
if(this.reverse){this.animateToNewPoint(this.movePoints.length-2);}else{this.animateToNewPoint(2);}}else{var e={x:this.movePoints[0],y:this.movePoints[1]};
var g=this.screenTransformObj.toScreenPoint(e.x,e.y);var d=g.x-this.screenPoints.x;var l=g.y-this.screenPoints.y;
if(this.screenPoints.angle){this.shape.rotate(-this.screenPoints.angle*180/Math.PI,12.5,5);}this.shape.translate(d/this.scaleX,l/this.scaleY);
this.screenPoints=g;this.screenPoints.angle=0;this.geo=new OM.geometry.Point(this.movePoints[0],this.movePoints[1],this.geo.srid);
this.animateToNewPoint(2);}}else{this.movePoints=null;this.moveTime=null;this.currentTarget=null;}},pauseMoveAnimation:function(){if(this.displayed&&this.shape&&this.moveAnimation){var d=this.moveAnimation._progress();
var e=this.graphics.getLeftTop(this.shape);this.shape.stopPos=e;this.moveAnimation.endAt(0,false);this.progress=d;
}},resumeMoveAnimation:function(){if(this.movePoints&&this.currentTarget!=null){this.animateToNewPoint(this.currentTarget);
}},stopMoveAnimation:function(){this.pauseMoveAnimation();this.movePoints=null;this.moveTime=null;this.currentTarget=null;
this.moveAnimation=null;},getOrientation:function(e){var d=0;var l=0;var g=Math.PI/2;if(e>-g&&e<g){d=1;
l=d*Math.tan(e);}else{if(e>g||e<-g){d=1;l=d*Math.tan(e);}else{l=e==g?1:-1;}}return{x:d,y:l};},displayChartStyle:function(K,A,e,F){var d=this;
var u;if(K.length<2){var n=(A[0]+A[2])/2;var m=(A[1]+A[3])/2;u=new OM.geometry.Point(n,m,F);OM.style.Style.calculateStyleSize(K[0],this.parentLayer.parentMap);
d.drawChart(u,e,K[0]);return;}var s=0;var z=0;var g=0;var t=0;var E=K.length;for(var B=0;B<E;B++){OM.style.Style.calculateStyleSize(K[B],this.parentLayer.parentMap);
s+=K[B].realWidth;z+=K[B].realHeight;var G=K[B].realWidth*K[B].realHeight;if(G>g){g=G;t=B;}}var J=d.parentLayer.parentMap.getMapContext();
var r=J.getUniverse();var D=r.getZoomLevels()[J.getZoomLevel()];var q=(A[2]-A[0])/D.resolution;var l=(A[3]-A[1])/D.resolution/D.stretchRatio;
var H=0;var I;if(s<=q){I="H";H=(q-s)/(E+1);}else{if(z<=l){I="V";H=(l-z)/(E+1);}else{if(s-q>z-l){I="V";
}else{I="H";}}}var n,m;var L=[];OM.$.extend(true,L,A);if(I=="H"){var o=K[t].realWidth/2*D.resolution;
if(q>K[t].realWidth){n=A[0]+o+H*D.resolution;}else{n=(A[0]+A[2])/2-o;}m=(A[1]+A[3])/2;L[0]=n+o;}else{if(I=="V"){var C=K[t].realHeight/2*D.resolution*D.stretchRatio;
if(l>K[t].realHeight){m=A[1]+C+H*D.resolution;}else{m=(A[1]+A[3])/2-C;}n=(A[0]+A[2])/2;L[1]=m+C;}}u=new OM.geometry.Point(n,m,F);
d.drawChart(u,e,K[t]);K.splice(t,1);d.displayChartStyle(K,L,e,F);},enableFeatureEditing:function(e){if(this.editable==e){return;
}if(this.geo instanceof OM.geometry.Circle||this.geo instanceof OM.geometry.Rectangle){return;}this.editable=e;
if(this.editable){if(!this.startDrag){var d=new OM.layer.EditableFeature();this.init=d.init;this.startDrag=d.startDrag;
this.featureDragging=d.featureDragging;this.endDrag=d.endDrag;this.addEditProperties=d.addEditProperties;
this.startEditing=d.startEditing;this.endEditing=d.endEditing;this.deleteEditingProperties=d.deleteEditingProperties;
this.shapePointMoved=d.shapePointMoved;this.possiblePointMoved=d.possiblePointMoved;this.deleteShapePoint=d.deleteShapePoint;
this.featurePointMoved=d.featurePointMoved;this.showContextMenu=d.showContextMenu;this.shapePointMoving=d.shapePointMoving;
this.possiblePointMoving=d.possiblePointMoving;this.featurePointMoving=d.featurePointMoving;this.calRelatedFeature=d.calRelatedFeature;
this.setParentThat=d.setParentThat;this.calDistance=d.calDistance;var g=this;this.init();this.setParentThat(this);
}this.startEditing();}else{this.setParentThat(this);this.endEditing();this.edit=null;this.relatedFeature=null;
this.parentLayer.parentMap.enableMapAction.drag=true;}},isEditable:function(){return this.editable;},clone:function(){var e={};
OM.$.extend(true,e,this.geo);var d={};OM.$.extend(true,d,this.attributes);var g=new OM.Feature(this.id,e,{attributes:d,renderingStyle:this.renderingStyle,label:this.label,labelStyle:this.labelStyle});
if(this.columns){g.columns={};OM.$.extend(true,g.columns,this.columns);}if(!this.renderingStyle&&this.styleName){g.styleName=this.styleName;
}if(this.mapping){g.mapping=true;}return g;},clearInfoWindow:function(){var d=this.parentLayer.parentMap;
if(d.infoLayer){d.infoLayer.deleteInfoWindows();}},getLabelMarkerPos:function(e){if(!this.parentLayer.mask){var g=this.parentLayer.parentMap.getMapContext();
var d=g.getCenterPoint();var m=g.getDeviceWindow();var l=this.screenTransformObj.toScreenPoint(d.getX(),d.getY());
this.parentLayer.mask={minX:l.x-m.w,minY:l.y-m.h,maxX:l.x+m.w,maxY:l.y+m.h};}if(this.screenPoints){if(this.geo.type=="LineString"){coords=OM.util.GeomUtil.clipLine(this.parentLayer.mask,[this.screenPoints]);
}else{coords=OM.util.GeomUtil.clipLine(this.parentLayer.mask,this.screenPoints);}if(coords.length>0){return OM.util.GeomUtil.getPointByPercent(coords,0.5,e);
}}},isCluster:function(){if(this.id&&this.id.indexOf("-CL")==0&&this.cluster){return true;}else{return false;
}},getFeaturesInCluster:function(){if(this.isCluster()){return this.cluster.featureArray;}else{return null;
}}});OM.TextFeature=OM.Feature.extend({initialize:function(l,d,g,e){this.id=l;this.geo=d;this.text=g;
this.renderingStyle=e?e:new OM.style.Text(OM.gv.defaultTextStyleConfig);},setText:function(d){if(d!=null&&d!=""){this.text=d;
if(this.displayed){this.remove();this.displayFeature();}}},getText:function(d){return this.text;},setGeometry:function(d){if(d&&(d.type=="Point"||d.type=="OrientedPoint")){this.geo=d;
if(this.displayed){this.remove();this.screenPoints=null;this.displayFeature();}}},setRenderingStyle:function(e){if(e==null){return;
}else{if(!(e instanceof OM.style.Style)&&e&&e.dataSource&&e.name){var d=this;OM.style.StyleStore.getServerSideStyle(e.dataSource,e.name,{url:e.url,callback:function(g){d.setRenderingStyle(g);
}});return;}}this.renderingStyle=e;if(this.displayed){this.remove();this.displayFeature();}},displayFeature:function(){if(!this.screenPoints){var l=false;
var r=this.geo.coordinates;var t=this.screenTransformObj.toScreenPoint(r[0],r[1]);var m=this.geo.dimension?geo.dimension:2;
if(this.geo.type=="OrientedPoint"){var s=r[m];var q=r[m+1];var g=-Math.atan2(q,s);t.angle=g;}this.screenPoints=t;
}OM.style.Style.calculateStyleSize(this.renderingStyle,this.parentLayer.parentMap);this.shape=this.graphics.createTextNode(this.text,this.renderingStyle,this.screenPoints.x,this.screenPoints.y);
if(this.shape){this.group.appendChild(this.shape);this.size=this.graphics.getWidthHeight(this.shape);
var e=0;var o=0;var n=OM.Text;if(this.renderingStyle.hAlign==n.HORIZONTALALIGN_CENTER){e=(0-this.size.w)/2;
}else{if(this.renderingStyle.hAlign==n.HORIZONTALALIGN_RIGHT){e=-this.size.w;}}if(this.renderingStyle.vAlign==n.VERTICALALIGN_CENTER){o=(this.size.h-4)/2;
}else{if(this.renderingStyle.vAlign==n.VERTICALALIGN_TOP){o=this.size.h;}}var d=new this.graphics.oui.geom.Matrix();
d.translate(e,o);if(this.screenPoints.angle){d.rotate(this.screenPoints.angle,this.screenPoints.x-e,this.screenPoints.y-o);
}this.shape.applyStyle({transform:d});}this.shape.feature=this;this.displayed=true;},remove:function(){if(this.shape){this.graphics.remove(this.shape);
this.size=null;}}});OM.Map=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(d,e){var l=this;
OM.gv.addMapInstance(this,d);this.$containerDiv=OM.$(d);this.$containerDiv.empty();if(document.compatMode=="CSS1Compat"){if(this.$containerDiv.width()==0){OM.$("html").css("width","100%");
OM.$("body").css("width","100%");}if(this.$containerDiv.height()==0){OM.$("html").css("height","100%");
OM.$("body").css("height","100%");}}this.$containerDiv.css("-webkit-user-select","none");this.$containerDiv.css({"-moz-user-select":"none"});
if(OM.browser.touchSupported){this.$containerDiv.css({"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0)"});
}if(this.$containerDiv.css("position")!="absolute"){this.$containerDiv.css("position","relative");}this.mapInstanceId=this.generateMapInstanceId();
this.$oracleMapDiv=OM.$("<div id='oracleMapDiv"+this.mapInstanceId+"'  style='position:absolute; width:100%; height:100%; left:0px; top:0px; -moz-user-select: none;-webkit-user-select:none; overflow: hidden;'></div>");
this.$containerDiv.append(this.$oracleMapDiv);this.$fixedLayerDIV=OM.$("<div id ='fixedLayerDIV"+this.mapInstanceId+"'></div>");
this.$infoWinLayerDIV=OM.$("<div id ='infoWinLayerDIV"+this.mapInstanceId+"'></div>");this.$fkGraphicLayersDiv=OM.$("<div id ='fkGraphicLayersDiv"+this.mapInstanceId+"'></div>");
this.$tileLayersDiv=OM.$("<div id ='tileLayersDiv"+this.mapInstanceId+"'></div>");this.$oracleMapDiv.append(this.$fixedLayerDIV);
this.$oracleMapDiv.append(this.$infoWinLayerDIV);this.$oracleMapDiv.append(this.$fkGraphicLayersDiv);
this.$oracleMapDiv.append(this.$tileLayersDiv);this.$fixedLayerDIV.css({"z-index":"200",position:"absolute",left:"0px",top:"0px"});
this.$infoWinLayerDIV.css({"z-index":"110",position:"absolute",left:"0px",top:"0px"});this.$fkGraphicLayersDiv.css({"z-index":"99",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",overflow:"hidden"});
this.$tileLayersDiv.css({"z-index":"0",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",overflow:"hidden"});
this.$heatMapDiv=OM.$("<div id ='heatMapDiv"+this.mapInstanceId+"'></div>");this.$oracleMapDiv.append(this.$heatMapDiv);
this.$heatMapDiv.css({"z-index":"90",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",overflow:"hidden"});
this.graphics=new OM.Graphics(this.$fkGraphicLayersDiv[0]);this.draggableGroup=this.graphics.createGroup({opacity:1,visibility:"visible"});
this.fixedGroup=this.graphics.createGroup({opacity:1,visibility:"visible"});this.graphics.addGroup(this.draggableGroup);
this.graphics.addGroup(this.fixedGroup);this.divLeft=0;this.divTop=0;this.mapviewerURL=OM.gv.localbaseURL();
if(e&&e.mapviewerURL){this.mapviewerURL=e.mapviewerURL;}this.getMapContextToken=(function(){var o={};
return function(){return o;};}());var g=this.getMapContextToken();g.universe={};if(e&&e.universe){g.universe=e.universe;
}g.deviceWindow={x:0,y:0,w:this.$containerDiv.width(),h:this.$containerDiv.height()};this.typeArray=new Array();
this.nameArray=new Array();this.divLayers=[];this.svgLayers=[];this.layerQueue=[];this.touchStartLocs=[];
this.mLocX=null;this.mLocY=null;this.decorationArray=[];this.defaultFeatureLayer=null;this.toolFeatureLayer=null;
this.enableMapAction={mouse:true,click:true,drag:true,dbclick:true,mousewheel:true};this.universeLayerIndex=-1;
this.boundingLayerName=null;this.inited=false;this.displayed=false;this.initialized=false;this.boundingThemeLoading=false;
this.boundingThemeLoaded=false;this.moveflag=false;this.resetTag=false;this.hasExternal=false;this.tileLayerZoomAnimation=true;
this.infoWindowEventPropogation=false;this.resizeFun=function(){if(l.overview){if(g.deviceWindow.w!=l.$containerDiv.width()||g.deviceWindow.h!=l.$containerDiv.height()){g.deviceWindow.w=l.$containerDiv.width();
g.deviceWindow.h=l.$containerDiv.height();l.redrawMap();var o=new OM.event.MapEvent(OM.event.MapEvent.MAP_RESIZED,l);
l.fire(o.type,o);}}};this.resizeTimer=setInterval(this.resizeFun,300);if(!e.magnifier){this.$oracleMapDiv.dblclick(function(o){if(l.displayed&&l.enableMapAction.dbclick){l.setMapCenterAndZoomLevel(l.getCursorLocation(),g.zoomLevel+1,true);
}var q=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_DOUBLE_CLICK,l);l.fire(q.type,q);return false;
});this.$oracleMapDiv[0].oncontextmenu=function(o){o.preventDefault();};this.$oracleMapDiv.mousewheel(function(r,t){if(!l.enableMapAction.mousewheel){return;
}r.preventDefault();r.stopPropagation();var o=t>0?"zoomIn":"zoomOut",q=Math.abs(t);l[o]();var s=new OM.event.MapEvent(OM.event.MouseEvent.WHEEL_SCROLL,l);
s.delta=t;l.fire(s.type,s);});if(!OM.browser.touchSupported){this.$oracleMapDiv.mousedown(function(o){if(o.which==1&&l.enableMapAction.drag){l.moveflag=true;
}l.mLocX=o.pageX-l.$oracleMapDiv.offset().left;l.mLocY=o.pageY-l.$oracleMapDiv.offset().top;l.mouseDownLocX=l.mLocX;
l.mouseDownLocY=l.mLocY;var q=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_DOWN,l);q.evt=o;l.fire(q.type,q);
return false;});this.$oracleMapDiv.mousemove(function(r){var q=(r.pageX-l.$oracleMapDiv.offset().left)-l.mLocX;
var o=(r.pageY-l.$oracleMapDiv.offset().top)-l.mLocY;l.mLocX=r.pageX-l.$oracleMapDiv.offset().left;l.mLocY=r.pageY-l.$oracleMapDiv.offset().top;
if(l.moveflag&&l.enableMapAction.drag){l.$oracleMapDiv.css("cursor","move");l.pan(q,o,false);}var s=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_MOVE,l);
s.evt=r;l.fire(s.type,s);});this.$oracleMapDiv.mouseup(function(s){var t=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_UP,l);
t.evt=s;l.fire(t.type,t);l.mouseUpLocX=l.mLocX;l.mouseUpLocY=l.mLocY;if(l.mouseDownLocX&&l.mouseDownLocY&&(Math.abs(l.mouseUpLocX-l.mouseDownLocX)>1||Math.abs(l.mouseUpLocY-l.mouseDownLocY)>1)){var t=new OM.event.MapEvent(OM.event.MapEvent.MAP_RECENTERED,l);
l.fire(t.type,t);}else{if(l.mouseDownLocX&&l.mouseDownLocY&&Math.abs(l.mouseUpLocX-l.mouseDownLocX)<=1&&Math.abs(l.mouseUpLocY-l.mouseDownLocY)<=1){if(s.which==3){var t=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_RIGHT_CLICK,l);
l.fire(t.type,t);return;}var t=new OM.event.MapEvent(OM.event.MouseEvent.MOUSE_CLICK,l);l.fire(t.type,t);
for(var r=0;r<l.divLayers.length;r++){var q=l.divLayers[r];if(q.layerType==OM.LayerTypes.TILE&&q instanceof OM.layer.InteractiveTileLayer&&q.isVisible()){var o=l.getCursorLocation();
q.identifyFeatures(o);}}}}l.mouseDownLocX=null;l.mouseDownLocY=null;});OM.$(document).mouseup(function(o){if(l.moveflag&&l.enableMapAction.drag){l.moveflag=false;
l.$oracleMapDiv.css("cursor","default");l.mouseDownLocX=null;l.mouseDownLocY=null;}}).mouseout(function(o){if(l.moveflag&&l.enableMapAction.drag){l.moveflag=false;
l.$oracleMapDiv.css("cursor","default");l.mouseDownLocX=null;l.mouseDownLocY=null;}});this.$fkGraphicLayersDiv.mouseout(function(o){o.stopPropagation();
});}else{this.$oracleMapDiv.bind("touchstart",function(o){o.stopPropagation();o.preventDefault();l.touchStart(o);
});this.$oracleMapDiv.bind("touchmove",function(o){o.preventDefault();o.stopPropagation();l.touchMove(o);
});this.$oracleMapDiv.bind("touchend",function(o){o.preventDefault();o.stopPropagation();l.touchEnd(o);
});}}this.newLayerConfigLoaded=function(o){l.initLayers(o);};this.layerFinish=function(r){r.target.loaded=true;
if(r.target.layerType==OM.LayerTypes.TILE||r.target.layerType==OM.LayerTypes.EXTERNAL){if(!l.divLayers){return;
}for(var o=0;o<l.divLayers.length;o++){if(!l.divLayers[o].loaded){return;}}l.graphics.setVisible(l.draggableGroup,true);
l.$heatMapDiv.css({visibility:"visible"});}for(var o=0;o<l.divLayers.length;o++){if(!l.divLayers[o].loaded){return;
}}for(var o=0;o<l.svgLayers.length;o++){if(!(l.svgLayers[o].loaded||l.svgLayers[o].loadError)){return;
}}l.boundingLayerName=null;l.boundingThemeLoaded=false;try{l.refreshVectorLayerLabels();l.getToolFeatureLayer();
}catch(q){var s=(q.stack)?q.message+"\nStack: "+q.stack:q.message;OM.util.Logger.warning(0,"OM.Map.layerFinish",s);
}finally{l.showLoadingIcon(false);var r=new OM.event.MapEvent(OM.event.MapEvent.MAP_AFTER_REFRESH,l);
l.fire(r.type,r);}};this.layerErr=function(o){if(l.overviewLayer==o.target){l.overviewLayerErr=true;}l.removeLayer(o.target);
if(o.target.layerType==OM.LayerTypes.TILE||o.target.layerType==OM.LayerTypes.EXTERNAL){if(l.divLayers.length==0){l.showLoadingIcon(false);
}else{l.divLayers[l.universeLayerIndex].getLayerConfig();}}else{if(o.target.isBoundingTheme()){l.boundingLayerName=null;
if(l.universeLayerIndex>=0){l.divLayers[l.universeLayerIndex].getLayerConfig();}}l.layerFinish(o);if(l.universeLayerIndex<0&&l.overviewLayerErr&&l.overview){if(l.svgLayers.length>0){l.overviewLayer=l.svgLayers[l.svgLayers.length-1];
l.setOverviewMapOptions({overviewLayer:l.overviewLayer});l.overview.errLoadLayer();}}}};this.layerStyleChanged=function(q){var o=new OM.event.MapEvent(OM.event.MapEvent.MAP_STYLE_CHANGED,l);
o.affectLayer=q.target;o.newStyle=q.newStyle;o.attributes=q.attributes;l.fire(o.type,o);};this.nsdpMapped=function(q){var o=new OM.event.MapEvent(OM.event.MapEvent.I_MAP_NSDP_MAPPED,l);
o.affectLayer=q.target;l.fire(o.type,o);};if(e.disableOverviewMap){e.over=true;}if(!e.over&&!e.magnifier){this.overview=new OM.control.OverviewMap({});
this.overview.mainmap=this;this.addMapDecoration(this.overview);var m=this.overview;this.$fixedLayerDIV.append(this.overview.$DecorationDiv);
this.on(OM.event.MapEvent.I_MAP_CENTER_ZOOM,this.overview.setCenterAndZoomlevel,m);this.on(OM.event.MapEvent.I_MAP_DRAGGING,this.overview.setRectangleFeature,m);
this.on(OM.event.MapEvent.MAP_RECENTERED,this.overview.setCenterAndZoomlevel,m);this.on(OM.event.MapEvent.MAP_BEFORE_REFRESH,this.overview.setCenterAndZoomlevel,m);
this.on(OM.event.MapEvent.MAP_RESIZED,this.overview.resize,m);this.on(OM.event.MapEvent.MAP_STYLE_CHANGED,this.overview.styleChange,m);
this.on(OM.event.MapEvent.I_MAP_NSDP_MAPPED,this.overview.nsdpMapped,m);this.on(OM.event.MapEvent.LAYER_DELETED,this.overview.layerDel,m);
this.overviewLayer=null;}OM.Messages.setURL(this.mapviewerURL+"/mcserver");var n=function(){var q=l.getLabelGridBox();
l.grid=new OM.util.CoverageGrid(q);for(var o=0;o<l.svgLayers.length;o++){l.svgLayers[o].loaded=false;
}};this.on(OM.event.MapEvent.MAP_INITIALIZED,n,this);this.getToolFeatureLayer();},generateMapInstanceId:(function(){var d=0;
return function(){return +(++d);};}()),getMapContext:function(){return OM.MapContext(this);},initLayers:function(t){var g=this;
var B=OM.event;var m=t&&t.target.layerType;var u=this.getMapContextToken();var w=function(){for(var e=0;
e<g.layerQueue.length;e++){var C=g.layerQueue[e];if(C[0].layerType==OM.LayerTypes.TILE||C[0].layerType==OM.LayerTypes.EXTERNAL){if(C.length==1&&C[0] instanceof OM.layer.InteractiveTileLayer){C[0].setLayerConfig(u.universe);
}else{if(!C[1].equals(u.universe)){g.resetUniverse(C[1],C[0],C[0].tileLayerConfig);return;}else{if(g.divLayers[g.universeLayerIndex]==C[0]&&!g.boundingLayerName){continue;
}}}}C[0].initLayer();}if(g.overviewLayerErr&&g.overview){if(g.universeLayerIndex!=-1){g.overviewLayer=g.divLayers[g.universeLayerIndex];
}else{if(g.svgLayers.length>0){g.overviewLayer=g.svgLayers[g.svgLayers.length-1];}}g.setOverviewMapOptions({overviewLayer:g.overviewLayer});
g.overview.errLoadLayer();}g.layerQueue=[];};var d=function(C){var D=[C.target];if((C.target.layerType==OM.LayerTypes.TILE||C.target.layerType==OM.LayerTypes.EXTERNAL)&&C.config!=null){D.push(new OM.universe.Universe(C.config));
}g.layerQueue.push(D);};if(g.extentRect){g.boundingLayerName=null;}if(g.extentRect!=null&&g.universeLayerIndex!=-1){if(!g.displayed&&g.divLayers[g.universeLayerIndex]==t.target){u.universe=new OM.universe.Universe(t.config).copy(u.universe);
g.displayed=true;if(u.centerPoint==null){u.centerPoint=new OM.geometry.Point((u.universe.bound.getMinX()+u.universe.bound.getMaxX())/2,(u.universe.bound.getMinY()+u.universe.bound.getMaxY())/2,u.universe.srid);
}if(u.homeCenter==null){u.homeCenter=u.centerPoint;}if(u.zoomLevel==null){u.zoomLevel=0;}if(!u.homeMapCenter){u.homeMapCenter=u.centerPoint;
}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=u.zoomLevel;}u.zoomLevel=g.checkZoomLevel(u.zoomLevel);d(t);
g.zoomToExtent(g.extentRect);}else{if(!t&&g.displayed){g.checkCenter();var l=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);
g.initialized=true;g.inited=false;g.fire(l.type,l);w();}else{if(g.initialized){if(t.target.layerType==OM.LayerTypes.TILE||t.target.layerType==OM.LayerTypes.EXTERNAL){var z=new OM.universe.Universe(t.config);
if(t.config==null&&t.target instanceof OM.layer.InteractiveTileLayer){t.target.setLayerConfig(u.universe);
}else{if(!z.equals(u.universe)){g.resetUniverse(z,t.target,t.config);return;}}}t.target.initLayer();w();
}else{d(t);}}}}else{if(g.extentRect!=null){if(!g.displayed){g.displayed=true;u.zoomLevel=g.checkZoomLevel(u.zoomLevel);
if(u.centerPoint==null){u.centerPoint=new OM.geometry.Point((u.universe.bound.getMinX()+u.universe.bound.getMaxX())/2,(u.universe.bound.getMinY()+u.universe.bound.getMaxY())/2,u.universe.srid);
}if(u.homeCenter==null){u.homeCenter=u.centerPoint;}if(u.zoomLevel==null){u.zoomLevel=0;}if(!u.homeMapCenter){u.homeMapCenter=u.centerPoint;
}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=u.zoomLevel;}d(t);g.zoomToExtent(g.extentRect);}else{if(!t&&g.displayed){var l=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);
if(!g.initialized){g.initialized=true;g.inited=false;g.fire(l.type,l);}w();}else{if(g.initialized){t.target.initLayer();
}else{d(t);}}}}else{if(g.boundingLayerName&&g.universeLayerIndex!=-1){if(g.divLayers[g.universeLayerIndex]==t.target&&!g.displayed){u.universe=new OM.universe.Universe(t.config).copy(u.universe);
g.displayed=true;d(t);for(var q=0;q<g.layerQueue.length;q++){var n=g.layerQueue[q];if(n[0].layerType==OM.LayerTypes.VECTOR&&(n[0].name==g.boundingLayerName)){n[0].loadBoundingTheme();
g.boundingThemeLoading=true;break;}}}else{if(g.boundingLayerName==t.target.name&&g.displayed){if(g.boundingThemeLoading){var o=t.bbox;
var A=t.target.calculateCenterAndZoomLevel(o[0],o[1],o[2],o[3]);if(g.initialized){g.setMapCenterAndZoomLevel(A[1],A[0]);
t.target.initLayer();w();}else{u.centerPoint=A[1];u.homeCenter=u.centerPoint;u.zoomLevel=g.checkZoomLevel(A[0]);
if(!u.homeMapCenter){u.homeMapCenter=u.homeCenter;}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=u.zoomLevel;
}g.checkCenter();g.boundingThemeLoaded=true;var l=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);g.initialized=true;
g.inited=false;g.fire(l.type,l);d(t);w();}g.boundingThemeLoading=false;}else{t.target.loadBoundingTheme();
g.boundingThemeLoading=true;}}else{if(g.initialized&&g.boundingThemeLoaded){if(t.target.layerType==OM.LayerTypes.TILE||t.target.layerType==OM.LayerTypes.EXTERNAL){var z=new OM.universe.Universe(t.config);
if(t.config==null&&t.target instanceof OM.layer.InteractiveTileLayer){t.target.setLayerConfig(u.universe);
}else{if(!z.equals(u.universe)){g.resetUniverse(z,t.target,t.config);return;}}}t.target.initLayer();w();
}else{d(t);}}}}else{if(g.universeLayerIndex!=-1){if(g.divLayers[g.universeLayerIndex]==t.target&&!g.displayed){u.universe=new OM.universe.Universe(t.config).copy(u.universe);
u.zoomLevel=g.checkZoomLevel(u.zoomLevel);g.displayed=true;var s=function(){g.checkCenter();var e=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);
if(!g.initialized){g.initialized=true;g.inited=false;if(g.resetTag){e=new B.MapEvent(B.MapEvent.MAP_RESET_UNIVERSE,g);
}g.fire(e.type,e);}t.target.initLayer();w();};if(u.centerPoint==null){u.centerPoint=new OM.geometry.Point((u.universe.bound.getMinX()+u.universe.bound.getMaxX())/2,(u.universe.bound.getMinY()+u.universe.bound.getMaxY())/2,u.universe.srid);
}if(u.homeCenter==null){u.homeCenter=u.centerPoint;}if(u.zoomLevel==null){u.zoomLevel=0;}if(!u.homeMapCenter){u.homeMapCenter=u.centerPoint;
}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=u.zoomLevel;}if(u.centerPoint.srid==u.universe.srid){u.homeCenter=u.centerPoint.clone();
s();}else{u.centerPoint.transform(u.universe.srid,function(e){u.centerPoint=e;u.homeCenter=u.centerPoint.clone();
s();});}}else{if(g.initialized){if(t.target.layerType==OM.LayerTypes.TILE||t.target.layerType==OM.LayerTypes.EXTERNAL){var z=new OM.universe.Universe(t.config);
if(t.config==null&&t.target instanceof OM.layer.InteractiveTileLayer){t.target.setLayerConfig(u.universe);
}else{if(!z.equals(u.universe)){g.resetUniverse(z,t.target,t.config);return;}}}t.target.initLayer();w();
}else{d(t);}}}else{if(g.boundingLayerName){if((t.target.name==g.boundingLayerName)&&t.bbox){g.displayed=true;
u.homeMapCenter=u.centerPoint;u.homeMapZoomlevel=u.zoomLevel;if(t.bbox[0]!=0&&t.bbox[1]!=0&&t.bbox[2]!=0&&t.bbox[3]!=0){var A=t.target.calculateCenterAndZoomLevel(t.bbox[0],t.bbox[1],t.bbox[2],t.bbox[3]);
u.homeCenter=A[1];if(!u.homeMapCenter){u.homeMapCenter=A[1];}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=A[0];
}g.setMapCenterAndZoomLevel(A[1],A[0]);}else{g.setMapZoomLevel(0);}g.checkCenter();g.boundingThemeLoaded=true;
var l=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);if(!g.initialized){g.initialized=true;g.inited=false;
g.fire(l.type,l);}if(t.bbox[0]!=0&&t.bbox[1]!=0&&t.bbox[2]!=0&&t.bbox[3]!=0){t.target.initLayer();}w();
}else{if(t.target.name==g.boundingLayerName){t.target.loadBoundingTheme();g.boundingThemeLoading=true;
}else{if(g.initialized&&g.boundingThemeLoaded){t.target.initLayer();w();}else{d(t);}}}}else{var r=this.getMapContext().getUniverse();
g.displayed=true;u.zoomLevel=g.checkZoomLevel(u.zoomLevel);if(u.centerPoint==null){u.centerPoint=new OM.geometry.Point((u.universe.bound.getMinX()+u.universe.bound.getMaxX())/2,(u.universe.bound.getMinY()+u.universe.bound.getMaxY())/2,u.universe.srid);
}if(u.homeCenter==null){u.homeCenter=u.centerPoint;}if(u.zoomLevel==null){u.zoomLevel=0;}if(!u.homeMapCenter){u.homeMapCenter=u.centerPoint;
}if(!u.homeMapZoomlevel){u.homeMapZoomlevel=u.zoomLevel;}var s=function(){var e=new B.MapEvent(B.MapEvent.MAP_INITIALIZED,g);
g.checkCenter();if(!g.initialized){g.initialized=true;g.inited=false;g.fire(e.type,e);}t&&t.target.initLayer();
w();};if(u.centerPoint.srid==r.srid){u.homeCenter=u.centerPoint.clone();s();}else{u.centerPoint.transform(r.srid,function(e){u.centerPoint=e;
u.homeCenter=u.centerPoint.clone();s();});}}}}}}},init:function(){this.showLoadingIcon(true);var o=this;
var n=OM.event;var m=this.getMapContextToken();this.layerQueue=[];if(this.initialized){this.cleanMap();
}else{var d=this.getMapContextToken();d.homeMapCenter=d.centerPoint;d.homeMapZoomlevel=d.zoomLevel;}if(this.divLayers.length==0&&this.svgLayers.length==0){this.displayed=true;
m.zoomLevel=o.checkZoomLevel(m.zoomLevel);if(!this.initialized){this.initialized=true;this.inited=false;
var l=new n.MapEvent(n.MapEvent.MAP_INITIALIZED,this);if(this.resetTag){l=new n.MapEvent(n.MapEvent.MAP_RESET_UNIVERSE,this);
}this.fire(l.type,l);}}else{if(this.universeLayerIndex!=-1&&this.divLayers.length>0){var g=this.divLayers[this.universeLayerIndex];
if(g.layerType==OM.LayerTypes.EXTERNAL){g.loaded=true;g.setContainer(this.$tileLayersDiv[0]);}if(this.overviewLayer==null){this.overviewLayer=g;
}this.graphics.setVisible(this.draggableGroup,false);this.$heatMapDiv.css({visibility:"hidden"});g.getLayerConfig();
for(var e=this.universeLayerIndex+1;e<this.divLayers.length;e++){var g=this.divLayers[e];if(g.layerType==OM.LayerTypes.EXTERNAL){g.loaded=true;
g.setContainer(this.$tileLayersDiv[0]);}g.getLayerConfig();}}for(var e=0;e<=this.svgLayers.length-1;e++){this.showLoadingIcon(true);
if(this.overviewLayer==null&&this.svgLayers[e]!=this.toolFeatureLayer&&this.svgLayers[e]!=this.defaultFeatureLayer){this.overviewLayer=this.svgLayers[e];
if(this.overview&&this.overview.submap){this.overview.submap.destroyMap();this.overview.doinit();}}this.svgLayers[e].getLayerConfig();
}this.inited=true;}},refreshMap:function(){if(this.initialized){var d=new OM.event.MapEvent(OM.event.MapEvent.MAP_BEFORE_REFRESH,this);
this.fire(d.type,d);}},redrawMap:function(){if(this.initialized){var d=new OM.event.MapEvent(OM.event.MapEvent.MAP_REDRAW,this);
this.fire(d.type,d);}},destroyMap:function(){var l=new OM.event.MapEvent(OM.event.MapEvent.MAP_DESTROY,this);
this.fire(l.type,l);this.deleteAllListeners();if(this.graphics){this.graphics.clearGroup(this.draggableGroup);
this.graphics.clearGroup(this.fixedGroup);this.graphics.removeAll();}this.draggableGroup=null;this.fixedGroup=null;
this.graphics=null;OM.$(this.loadingIcon).unbind();this.$fixedLayerDIV.unbind();this.$infoWinLayerDIV.unbind();
this.$fkGraphicLayersDiv.unbind();this.$tileLayersDiv.unbind();this.$heatMapDiv.unbind();OM.$(this.loadingIcon).empty();
this.$oracleMapDiv.unbind().remove();this.$containerDiv.unbind().empty();this.loadingIcon=null;this.$fixedLayerDIV=null;
this.$infoWinLayerDIV=null;this.$fkGraphicLayersDiv=null;this.$tileLayersDiv=null;this.$oracleMapDiv=null;
this.$containerDiv=null;this.$heatMapDiv=null;this.divLayers=null;this.svgLayers=null;this.defaultFeatureLayer=null;
this.toolFeatureLayer=null;this.overviewLayer=null;this.overview=null;this.decorationArray=null;var m=OM.gv.mapInstances;
var d=m.length;for(var g=0;g<d;g++){if(m[g]==this){m.splice(g,1);break;}}},getUniverse:function(){return this.getMapContext().getUniverse();
},setMapCenter:function(e,d){if(d!=false){d=true;}this.setMapCenterAndZoomLevel(e,null,d);},getMapCenter:function(){return this.getMapContext().getCenterPoint();
},setMapZoomLevel:function(d){this.setMapCenterAndZoomLevel(null,d,true);},getMapZoomLevel:function(){return this.getMapContext().getZoomLevel();
},setMapScale:function(l,e){var g=this;var d=function(){g.deleteListener(OM.event.MapEvent.MAP_INITIALIZED,d);
var n=this.getMapContext().getUniverse().getSRID();var q=0.0254;var o;if(n==8307||n==8265||n==4326){var m=111195;
o=l*q/m/OM.gv.DPI;}else{o=l*q/OM.gv.DPI;}g.setMapResolution(o,e);};if(this.initialized){d();}else{this.on(OM.event.MapEvent.MAP_INITIALIZED,d);
}},setMapResolution:function(g,d){var e=this.getMapContext().getUniverse().getZoomLevels();if(!d){d=null;
}if(g>e[0].resolution){this.setMapCenterAndZoomLevel(d,0);return;}for(var l=0;l<e.length-1;l++){if(e[l+1].resolution<=g&&e[l].resolution>=g){if(g/e[l].resolution>=e[l+1].resolution/g){this.setMapCenterAndZoomLevel(d,l);
}else{this.setMapCenterAndZoomLevel(d,l+1);}return;}}this.setMapCenterAndZoomLevel(d,l);},zoomToExtent:function(l){var g=this;
var d=this.getMapContextToken();var m=d.universe;var e=function(q){var n=q.getWidth()/d.deviceWindow.w;
var o=q.getHeight()*m.zoomLevels[d.zoomLevel].stretchRatio/d.deviceWindow.h;if(n>o){g.setMapResolution(n,q.getCenter(),q.getCenter());
}else{g.setMapResolution(o,q.getCenter(),q.getCenter());}if(!g.initialized){g.initLayers();}};g.extentRect=l;
if(!this.displayed){return;}if(l.srid==m.srid){e(l);}else{l.transform(m.srid,function(n){e(n);});}},zoomIn:function(){this.setMapZoomLevel(this.getMapContext().getZoomLevel()+1);
},zoomOut:function(){this.setMapZoomLevel(this.getMapContext().getZoomLevel()-1);},pan:function(I,r,m){var E=this.getMapContextToken();
var w=E.universe;var B=E.zoomLevel;var D=w.zoomLevels[B].resolution;var t=w.zoomLevels[B].stretchRatio;
var s=I*D;var u=r*D*t;var q=w.bound.getMinX();var o=w.bound.getMaxX();var n=w.bound.getMinY();var l=w.bound.getMaxY();
var A=E.centerPoint.clone();var z=new OM.geometry.Point(E.centerPoint.getX()-s,E.centerPoint.getY()+u,w.srid);
var C=E.deviceWindow;var g=C.w*D;var d=C.h*D*t;if(z.getX()<(o-g/2)&&z.getY()<(l-d/2)&&z.getX()>(q+g/2)&&z.getY()>(n+d/2)){E.centerPoint=z;
E.homeCenter=z.clone();}else{var H=z.getX();var G=z.getY();if(z.getX()<(o-g/2)&&z.getX()>(q+g/2)){if(z.getY()<(n+d/2)){G=n+d/2;
r=(n+d/2-A.getY())/(D*t);}else{if(z.getY()>(l-d/2)){G=l-d/2;r=(A.getY()-(l-d/2))/(D*t)*-1;}else{r=0;}}E.centerPoint.setPoint(H,G);
E.homeCenter.setPoint(H,G);}else{if(z.getY()<(l-d/2)&&z.getY()>(n+d/2)){if(z.getX()<(q+g/2)){H=q+g/2;
I=(q+g/2-A.getX())/D*-1;}else{if(z.getX()>(o-g/2)){H=o-g/2;I=(A.getX()-(o-g/2))/D;}else{I=0;}}E.centerPoint.setPoint(H,G);
E.homeCenter.setPoint(H,G);}else{return;}}}if((o-q)<g){I=0;}if((l-n)<d){r=0;}if(I==0&&r==0){return;}if(this.initialized){var F=new OM.event.MapEvent(OM.event.MapEvent.I_MAP_DRAGGING,this);
F.xOffset=I;F.yOffset=r;F.preCenter=A;this.doSmoothPan(F,m);}},doSmoothPan:function(r,m){var u=r.xOffset;
var s=r.yOffset;var g=this;var t=this.graphics;var q=null;var l=0;var o=0;var n=0;var z=null;var d=function(){if(Math.abs(u)>w){r.xOffset=w*(Math.abs(u)/u);
u=u-w*(Math.abs(u)/u);}else{r.xOffset=u;u=0;}if(Math.abs(s)>w){r.yOffset=w*(Math.abs(s)/s);s=s-w*(Math.abs(s)/s);
}else{r.yOffset=s;s=0;}q=t.getLeftTop(g.draggableGroup);t.setLeftTop(g.draggableGroup,q.x+r.xOffset,q.y+r.yOffset);
g.fire(r.type,r);n++;if(n<o){z=setTimeout(d,20);}else{if(!g.moveflag){r=new OM.event.MapEvent(OM.event.MapEvent.MAP_RECENTERED,g);
g.fire(r.type,r);}}};var w=Math.floor(OM.MapContext(this).getDeviceWidth()/10);if(!m||(Math.abs(u)<w&&Math.abs(s)<w)){q=t.getLeftTop(g.draggableGroup);
t.setLeftTop(g.draggableGroup,q.x+u,q.y+s);g.fire(r.type,r);if(!g.moveflag){r=new OM.event.MapEvent(OM.event.MapEvent.MAP_RECENTERED,g);
g.fire(r.type,r);}}else{l=Math.abs(u)>Math.abs(s)?u:s;o=Math.abs(l/w);z=setTimeout(d,20);}},checkZoomLevel:function(e){var g=this.getMapContextToken().universe;
if(g&&g.getZoomLevelNumber){if(e!=null){var d=g.getZoomLevelNumber()-1;var l=0;if(e>d){e=d;}if(e<l){e=l;
}}else{e=0;}}return e;},setMapCenterAndZoomLevel:function(m,l,d){var g=this;var e=this.getMapContextToken();
if(!this.initialized||m==null||e.centerPoint.srid==m.srid){this.do_setMapCenterAndZoomLevel(m,l,d);}else{m.transform(e.universe.srid,function(n){g.do_setMapCenterAndZoomLevel(n,l,d);
});}},do_setMapCenterAndZoomLevel:function(g,D,m){var o=null;var B=null;var z=this.getMapContextToken();
if(this.initialized){if(D!=null&&this.checkZoomLevel(D)!=z.zoomLevel){if(this.grid){this.grid.clear();
var t=this.getLabelGridBox(D);this.grid.setBox(t);}this.showLoadingIcon(true);var w=new OM.event.MapEvent(OM.event.MapEvent.I_MAP_CENTER_ZOOM,this);
o=z.zoomLevel;z.transform=null;z.zoomLevel=this.checkZoomLevel(D);w.beforeZoomLevel=o;w.afterZoomLevel=z.zoomLevel;
var r=new OM.event.MapEvent(OM.event.MapEvent.MAP_BEFORE_ZOOM,this);r.beforeZoomLevel=o;r.afterZoomLevel=z.zoomLevel;
this.fire(r.type,r);w.preMapCenter=z.centerPoint.clone();if(g&&g!=z.homeCenter){z.centerPoint=g;z.homeCenter=z.centerPoint.clone();
}this.checkCenter();for(var q=0;q<this.svgLayers.length;q++){this.svgLayers[q].loaded=false;this.svgLayers[q].clearFeatureShapes();
}if(this.divLayers.length>0){this.graphics.setVisible(this.draggableGroup,false);this.$heatMapDiv.css({visibility:"hidden"});
}for(var q=0;q<this.divLayers.length;q++){this.divLayers[q].loaded=false;}var u=this;this.graphics.clearToolTips();
setTimeout(function(){u.fire(w.type,w);var e=new OM.event.MapEvent(OM.event.MapEvent.MAP_AFTER_ZOOM,u);
e.beforeZoomLevel=o;e.afterZoomLevel=z.zoomLevel;u.fire(e.type,e);},0);}else{if(g){B=z.centerPoint.clone();
z.centerPoint=g;z.homeCenter=z.centerPoint.clone();var C=this.checkCenter(z.centerPoint);var d=z.centerPoint;
var n=Math.round((B.getX()-d.getX())/z.universe.zoomLevels[z.zoomLevel].resolution);var l=Math.round((d.getY()-B.getY())/z.universe.zoomLevels[z.zoomLevel].resolution*z.universe.zoomLevels[z.zoomLevel].stretchRatio);
if(n==0&&l==0){var A=new OM.event.MapEvent(OM.event.MapEvent.MAP_RESTRICT_CENTER,this);this.fire(A.type,A);
return;}if(Math.abs(n)>z.deviceWindow.w||Math.abs(l)>z.deviceWindow.h){var s=this.graphics.getLeftTop(this.draggableGroup);
this.graphics.setLeftTop(this.draggableGroup,s.x+n,s.y+l);var w=new OM.event.MapEvent(OM.event.MapEvent.MAP_BEFORE_REFRESH,this);
w.preMapCenter=B;w.restrictCenter=C;this.fire(w.type,w);}else{var w=new OM.event.MapEvent(OM.event.MapEvent.I_MAP_DRAGGING,this);
w.xOffset=Math.round(n);w.yOffset=Math.round(l);w.preCenter=B;w.restrictCenter=C;this.doSmoothPan(w,m);
}}}}else{if(g){z.centerPoint=g;z.homeCenter=z.centerPoint.clone();}if(D!=null){z.zoomLevel=this.checkZoomLevel(D);
}}},addLayer:function(m,n){var q=this;if(q.inited&&!q.initialized){setTimeout(function(){q.addLayer(m,n);
},50);return;}if(n==undefined){n="undefined";}this.typeArray.push(n);m.customType=n;if(this.nameArray[n]==undefined){this.nameArray[n]=[];
}this.nameArray[n].push(m.name);if(this.getLayerByName(m.name)){OM.util.Logger.warning("MAPVIEWER-05509","OM.Map.addLayer");
return;}m.parentMap=this;var o=OM.event;this.on(o.MapEvent.I_MAP_DRAGGING,m.panEvent,m);this.on(o.MapEvent.MAP_RECENTERED,m.recenter,m);
this.on(o.MapEvent.I_MAP_CENTER_ZOOM,m.setCenterAndZoomlevel,m);this.on(o.MapEvent.MAP_BEFORE_REFRESH,m.refreshEvent,m);
this.on(o.MapEvent.MAP_REDRAW,m.redraw,m);this.on(o.MapEvent.MAP_DESTROY,m.destroy,m);m.addListener(o.LayerEvent.FINISH_GOT_CONFIG,q.newLayerConfigLoaded);
m.addListener(o.LayerEvent.FINISH_LOAD,q.layerFinish);m.addListener(o.LayerEvent.INIT_ERROR,q.layerErr);
m.addListener(o.LayerEvent.RENDERING_STYLE_CHANGED,q.layerStyleChanged);m.addListener(o.LayerEvent.NSDP_MAPPED,q.nsdpMapped);
if(m.serverURL==null){m.serverURL=this.mapviewerURL;}if(m.serverURL=="invalid url"){OM.util.Logger.alert("MDS 100001","OM.layer.VectorLayer.getThemeData"," Cannot get root cause.");
return;}if(m.layerType==OM.LayerTypes.TILE||m.layerType==OM.LayerTypes.EXTERNAL){if(m.layerType==OM.LayerTypes.EXTERNAL){this.hasExternal=true;
}if(this.universeLayerIndex==-1){this.universeLayerIndex=this.divLayers.length;}this.divLayers.push(m);
}else{if(m.isBoundingTheme()&&!this.initialized){this.boundingLayerName=m.name;m.setBoundingTheme(false);
}else{if(m.isBoundingTheme()){this.boundingThemeLoaded=false;this.boundingThemeLoading=false;this.boundingLayerName=m.name;
m.setBoundingTheme(false);}}this.svgLayers.push(m);}if(this.initialized){if(!(m.layerType==OM.LayerTypes.TILE)&&!(m.layerType==OM.LayerTypes.EXTERNAL)){q.showLoadingIcon(true);
}else{if(m.layerType==OM.LayerTypes.EXTERNAL){m.loaded=true;}}if(m.layerType==OM.LayerTypes.EXTERNAL){m.setContainer(this.$tileLayersDiv[0]);
}if(q.grid){q.grid.clear();}m.getLayerConfig();if(this.overviewLayer==null&&this.overview){this.overviewLayer=m;
this.overview.layer=this.overviewLayer.clone("over_"+m.name,true);this.overview.submap.addLayer(this.overview.layer);
this.overview.overFeatureLayer.bringToTop();}}var l=null;if(m.layerType==OM.LayerTypes.TILE||m.layerType==OM.LayerTypes.EXTERNAL){l=this.divLayers.length;
}else{l=this.svgLayers.length+this.divLayers.length-2;}var d=new o.MapEvent(o.MapEvent.LAYER_ADDED,q);
d.affectedLayer=m;this.fire(d.type,d);for(var g=0;g<this.decorationArray.length;g++){var e=this.decorationArray[g];
if(e.type=="LayerControl"){this.removeMapDecoration(e);this.addMapDecoration(e);}}return l;},removeAllFeatureLayers:function(){var l=this.svgLayers;
var d=l.length-1;for(var g=d;g>=0;g--){var e=l[g].name;if(e!="oracle_maps_default_layer"&&e!="oracle_maps_default_layer2"){this.removeLayer(l[g]);
}}},removeLayer:function(o){if(o){var g=new OM.event.MapEvent(OM.event.MapEvent.LAYER_DELETED,o.parentMap);
g.affectedLayer=o;for(var n=0,e=this.svgLayers.length;n<e;n++){if(this.svgLayers[n]==o){this.deleteLayerListener(o);
this.nameArray[this.svgLayers[n].customType].remove(this.svgLayers[n].name);this.svgLayers.splice(n,1);
this.fire(g.type,g);this.refreshVectorLayerLabels();o.parentMap=null;for(var d=0;d<this.decorationArray.length;
d++){var l=this.decorationArray[d];if(l.type=="LayerControl"){this.removeMapDecoration(l);this.addMapDecoration(l);
}}return o;}}for(var n=0,e=this.divLayers.length;n<e;n++){if(this.divLayers[n]==o){this.deleteLayerListener(o);
this.divLayers.splice(n,1);this.fire(g.type,g);o.parentMap=null;for(var n=0;n<this.decorationArray.length;
n++){var l=this.decorationArray[n];if(l.type=="LayerControl"){this.removeMapDecoration(l);this.addMapDecoration(l);
}}return o;}}for(var n=0,e=this.divLayers.length;n<e;n++){if(this.divLayers[n].layerType==OM.LayerTypes.EXTERNAL){this.hasExternal=true;
break;}else{this.hasExternal=false;}}for(var n=0;n<this.decorationArray.length;n++){var l=this.decorationArray[n];
if(l.type=="LayerControl"){this.removeMapDecoration(l);this.addMapDecoration(l);}}}},deleteLayerListener:function(e){if(e){var l=this;
this.deleteListener(OM.event.MapEvent.I_MAP_DRAGGING,e.panEvent,e);this.deleteListener(OM.event.MapEvent.MAP_RECENTERED,e.recenter,e);
this.deleteListener(OM.event.MapEvent.I_MAP_CENTER_ZOOM,e.setCenterAndZoomlevel,e);this.deleteListener(OM.event.MapEvent.MAP_BEFORE_REFRESH,e.refreshEvent,e);
this.deleteListener(OM.event.MapEvent.MAP_REDRAW,e.redraw,e);this.deleteListener(OM.event.MapEvent.MAP_DESTROY,e.destroy,e);
var g=OM.event.LayerEvent;e.deleteListener(g.FINISH_GOT_CONFIG,l.newLayerConfigLoaded);e.deleteListener(g.FINISH_LOAD,l.layerFinish);
e.deleteListener(g.INIT_ERROR,l.layerErr);e.deleteListener(g.RENDERING_STYLE_CHANGED,l.layerStyleChanged);
e.deleteListener(g.NSDP_MAPPED,l.nsdpMapped);if(e.clearLayer){e.clearLayer();}if(e.destroy){e.destroy();
}var d=new OM.event.MapEvent(OM.event.MapEvent.LAYER_DELETED,l);d.affectedLayer=e;}},addToolBar:function(d){if(d!=null||d!=undefined){this.addMapDecoration(d.toolBarDecoration);
d.map=this;d.initBuiltInTools();d.initCustomBts();this.on(OM.event.MapEvent.MAP_CLEAN,d.clearTools,this);
}},addMagnifier:function(d){if(d!=null||d!=undefined){this.addMapDecoration(d);d.map=this;}},removeToolbar:function(d){this.removeMapDecoration(d.toolBarDecoration);
d.destroy();d.map=null;},addNavigationPanelBar:function(){var d=new OM.control.NavigationPanelBar();this.addMapDecoration(d);
},addScaleBar:function(){var d=new OM.control.ScaleBar();this.addMapDecoration(d);},addMapDecoration:function(d){if(d!=null||d!=undefined){this.decorationArray=this.decorationArray||[];
for(var e=0;e<this.decorationArray.length;e++){if(d.id==this.decorationArray[e].id){return;}if(d.mapType==this.decorationArray[e].mapType&&d.mapType=="mapTypeControl"){return;
}}this.decorationArray.push(d);var g=this;d.map=this;if(this.initialized||d.type=="ToolBar"){d.display();
}else{if(d.type=="CopyRight"){this.copyRight=d;}this.on(OM.event.MapEvent.MAP_INITIALIZED,d.display,d);
this.on(OM.event.MapEvent.MAP_RESET_UNIVERSE,d.display,d);}this.on(OM.event.MapEvent.MAP_DESTROY,d.remove,d);
this.on(OM.event.MapEvent.MAP_CLEAN,d.clean,d);}},removeMapDecoration:function(d){if(!this.decorationArray||this.decorationArray.length===0||!d){return;
}for(var e=0;e<this.decorationArray.length;e++){if(this.decorationArray[e].id===d.id){this.decorationArray.splice(e,1);
this.deleteListener(OM.event.MapEvent.MAP_CLEAN,d._cleanMapDecoration);this.deleteListener(OM.event.MapEvent.MAP_DESTROY,d._removeMapDecoration);
this.deleteListener(OM.event.MapEvent.MAP_INITIALIZED,d.display);this.deleteListener(OM.event.MapEvent.MAP_RESET_UNIVERSE,d.display);
d.remove();break;}}},showOverviewMap:function(){this.setOverviewMapOptions({display:true});},hideOverviewMap:function(){this.setOverviewMapOptions({display:false});
},setOverviewMapOptions:function(d){if(this.overview){this.overview.setOverviewMapOptions(d);}},getCursorLocation:function(){return this.getScreenPointLocation(this.mLocX,this.mLocY);
},getScreenPointLocation:function(t,s){var n=OM.MapContext(this);var r=n.getUniverse();var q=n.getZoomLevel();
var d=n.getCenterPoint();var o=t-n.getDeviceWidth()/2;var g=s-n.getDeviceHeight()/2;var m=null;var e=null;
var t=null;var s=null;if(r&&r.zoomLevels){q=this.checkZoomLevel(q);var l=r.zoomLevels[q].resolution;e=r.zoomLevels[q].stretchRatio;
t=d.getX()+o*l;s=d.getY()-g*l*e;return new OM.geometry.Point(t,s,r.srid);}else{return null;}},getMapWindowBoundingBox:function(){var d=OM.MapContext(this).getDeviceWindow();
var g=this.getScreenPointLocation(0,0);var e=this.getScreenPointLocation(d.w,d.h);return new OM.geometry.Rectangle(g.getX(),g.getY(),e.getX(),e.getY(),e.srid);
},getMaxResolution:function(){},getMinResolution:function(){},setMaxResolution:function(d){},setMinResolution:function(d){},backToHomeMap:function(){var d=this.getMapContextToken();
if(d.homeMapZoomlevel==null){d.homeMapZoomlevel=d.zoomLevel;}if(!d.homeMapCenter){d.homeMapCenter=d.centerPoint;
}this.setMapCenterAndZoomLevel(d.homeMapCenter,d.homeMapZoomlevel,true);},showLoadingIcon:function(n){var e=OM.MapContext(this).getDeviceWindow();
var q=OM.util.DomUtil;if(!n){if(this.loadingIcon){this.loadingIcon.style.visibility="hidden";}}else{if(!this.loadingIcon){var l=OM.gv;
var m=OM.$("<img src='"+l.resourcePath()+l.loadingIcon+"' style='position:absolute; z-index:2000;'>");
var o=m[0];var d=0,g=0;if(o.width){d=o.width;}if(o.height){g=o.height;}o.style.left=q.pixel((e.w-d)/2);
o.style.top=q.pixel((e.h-g)/2);o.onload=function(){o.style.left=q.pixel((e.w-o.width)/2);o.style.top=q.pixel((e.h-o.height)/2);
o.onload=null;};this.$fixedLayerDIV[0].appendChild(o);this.loadingIcon=o;}else{this.loadingIcon.style.left=q.pixel((e.w-this.loadingIcon.width)/2);
this.loadingIcon.style.top=q.pixel((e.h-this.loadingIcon.height)/2);this.loadingIcon.style.visibility="visible";
}}},setLayerIndex:function(l,e){var q=this.divLayers.length;var n=this.svgLayers.length;var m=this.getLayerCurrentIndex(l);
if(m==e){return e;}if(l.layerType==OM.LayerTypes.TILE||l.layerType==OM.LayerTypes.EXTERNAL){if(e<=1){return this.sendToBottom(l);
}else{if(e>=q){return this.bringToTop(l);}}m--;this.divLayers.splice(m,1);this.divLayers.splice(e-1,0,l);
for(var g=0;g<this.divLayers.length;g++){OM.$("#tilelayer_"+this.divLayers[g].name).css({"z-index":g});
}var o=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);o.affectedLayer=l;this.fire(o.type,o);
return e;}else{if(e<=q+1){return this.sendToBottom(l);}else{if(e>=q+n-2){return this.bringToTop(l);}}m=m-q-1;
var d=e-q-1;this.svgLayers.splice(m,1);this.svgLayers.splice(d,0,l);this.graphics.setDisplayIndex(l.group,d);
var o=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);o.affectedLayer=l;this.fire(o.type,o);
return e;}},getLayerCurrentIndex:function(l,e){if(l.layerType==OM.LayerTypes.TILE||l.layerType==OM.LayerTypes.EXTERNAL){var d=this.divLayers.length;
if(d==0){return -1;}for(var g=0;g<d;g++){if(this.divLayers[g]==l){return g+1;}}}else{var d=this.svgLayers.length;
if(d==0){return -1;}for(var g=0;g<d;g++){if(this.svgLayers[g]==l){return(g+this.divLayers.length+1);}}}return -1;
},bringForward:function(l){var g=this.getLayerCurrentIndex(l);if(g<0){return;}var e=null;var m=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);
m.affectedLayer=l;if(l.layerType==OM.LayerTypes.TILE||l.layerType==OM.LayerTypes.EXTERNAL){if(this.divLayers[this.divLayers.length-1]==l){this.fire(m.type,m);
return this.divLayers.length-1;}e=this.divLayers[g];this.divLayers[g]=l;this.divLayers[g-1]=e;for(var d=0;
d<this.divLayers.length;d++){OM.$("#tilelayer_"+this.divLayers[d].name).css({"z-index":d});}this.fire(m.type,m);
return(g+2);}else{if(this.svgLayers.length<3){return;}if(this.svgLayers[this.svgLayers.length-3]==l){this.fire(m.type,m);
return(this.svgLayers.length-3+this.divLayers.length);}e=this.svgLayers[g-this.divLayers.length];this.svgLayers[g-this.divLayers.length]=l;
this.svgLayers[g-1-this.divLayers.length]=e;this.graphics.bringForward(l.group);this.fire(m.type,m);return(g+2);
}},sendBackward:function(l){var g=this.getLayerCurrentIndex(l);if(g<0){return;}var m=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);
m.affectedLayer=l;var e=null;if(l.layerType==OM.LayerTypes.TILE||l.layerType==OM.LayerTypes.EXTERNAL){if(this.divLayers[0]==l){this.fire(m.type,m);
return 0;}e=this.divLayers[g-2];this.divLayers[g-2]=l;this.divLayers[g-1]=e;for(var d=0;d<this.divLayers.length;
d++){OM.$("#tilelayer_"+this.divLayers[d].name).css({"z-index":d});}this.fire(m.type,m);return(g);}else{if(this.svgLayers[0]==l){this.fire(m.type,m);
return(0+this.divLayers.length);}e=this.svgLayers[g-this.divLayers.length-2];this.svgLayers[g-2-this.divLayers.length]=l;
this.svgLayers[g-1-this.divLayers.length]=e;this.graphics.sendBackward(l.group);this.fire(m.type,m);return(g);
}},bringToTop:function(l,d){var g=this.getLayerCurrentIndex(l,d);if(g<0){return;}var m=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);
m.affectedLayer=l;if(l.layerType==OM.LayerTypes.TILE||l.layerType==OM.LayerTypes.EXTERNAL){if(this.divLayers[this.divLayers.length-1]==l){this.fire(m.type,m);
return this.divLayers.length;}this.divLayers.splice(g-1,1);this.divLayers.push(l);for(var e=0;e<this.divLayers.length;
e++){OM.$("#tilelayer_"+this.divLayers[e].name).css({"z-index":e});}this.fire(m.type,m);return(this.divLayers.length);
}else{var n=this.divLayers.length;if(this.svgLayers[this.svgLayers.length-2]==l){if(!d){this.fire(m.type,m);
}return(this.svgLayers.length+n);}if(d){this.svgLayers.splice(g-n-1,1);this.svgLayers.push(l);}else{this.svgLayers.splice(g-n-1,1);
this.svgLayers.splice(this.svgLayers.length-2,0,l);}if(!l.group){return;}this.graphics.bringToTop(l.group);
if(!d){this.graphics.bringToTop(this.getDefaultFeatureLayer().group);this.graphics.bringToTop(this.getToolFeatureLayer().group);
this.fire(m.type,m);}return(this.svgLayers.length+n);}},sendToBottom:function(g){var e=this.getLayerCurrentIndex(g);
if(e<0){return;}var l=new OM.event.MapEvent(OM.event.MapEvent.LAYER_REORDERED,this);l.affectedLayer=g;
if(g.layerType==OM.LayerTypes.TILE||g.layerType==OM.LayerTypes.EXTERNAL){if(this.divLayers[0]==g){this.fire(l.type,l);
return 1;}this.divLayers.splice(e-1,1);this.divLayers.splice(0,0,g);for(var d=0;d<this.divLayers.length;
d++){OM.$("#tilelayer_"+this.divLayers[d].name).css({"z-index":d});}this.fire(l.type,l);return 1;}else{var m=this.divLayers.length;
if(this.svgLayers.length>2&&this.svgLayers[0]==g){this.fire(l.type,l);return(1+m);}if(this.svgLayers.length<2){return -1;
}this.svgLayers.splice(e-m-1,1);this.svgLayers.splice(0,0,g);this.graphics.sendToBottom(g.group);this.fire(l.type,l);
return(1+m);}},displayInfoWindow:function(e,m,g){if(!e||!m){return null;}if(!this.infoLayer){this.infoLayer=new OM.infowindow.MVInfoLayerControl(this,"1");
}var d=this;var n=this.getMapContext().getUniverse();var l=function(){d.deleteListener(OM.event.MapEvent.MAP_INITIALIZED,l);
var q=g?g:{};q.universe=n;var r=function(s){if(s){e=s;}d.infoLayer.showHtmlWindow(m,e.getX(),e.getY(),g);
};if(n.srid!=e.srid){var o=e.transform(n.srid,r);}else{r();}};if(d.initialized){l();}else{this.on(OM.event.MapEvent.MAP_INITIALIZED,l);
}},displayTabbedInfoWindow:function(e,l,g){if(!e||!l){return null;}if(!this.infoLayer){this.infoLayer=new OM.infowindow.MVInfoLayerControl(this,"1");
}var d=this;var n=this.getMapContext().getUniverse();var m=function(){d.deleteListener(OM.event.MapEvent.MAP_INITIALIZED,m);
var q=g?g:{};q.universe=n;var r=function(s){if(s){e=s;}d.infoLayer.showTabbedHtmlWindow(l,e.getX(),e.getY(),q);
};if(n.srid!=e.srid){var o=e.transform(n.srid,r);}else{r();}};if(d.initialized){m();}else{this.on(OM.event.MapEvent.MAP_INITIALIZED,m,this);
}},printReset:function(){this.$oracleMapDiv[0].className=null;if(this.$printMapDiv){this.$printMapDiv.empty();
}},getLabelGridBox:function(o){var l=this.getMapContext();var q=l.getUniverse();var n=l.getZoomLevel();
var m=q.getZoomLevels();if(!o){o=n;}var d=m[n];var g=q.bound;var e=g.getWidth()/d.resolution;var r=g.getHeight()/d.resolution/d.stretchRatio;
return{minX:0,minY:0,maxX:e,maxY:r};},refreshVectorLayerLabels:function(){var l=false;var d=this.svgLayers.length;
for(var g=0;g<d;g++){if(this.svgLayers[g].labelsVisible()){l=true;break;}}if(!l){return;}this.grid.clear();
for(var g=0;g<d;g++){var e=this.svgLayers[g];if(e.labelsVisible()){e.clearAllLabels();}e.addMarkerBoundToGrid();
}for(var g=d-1;g>-1;g--){var e=this.svgLayers[g];if(e.isVisible()&&e.labelsVisible()){e.addLabels();}}},getLayerByName:function(e){var d=this.svgLayers.length;
while(d--){if(this.svgLayers[d].name==e){return this.svgLayers[d];}}d=this.divLayers.length;while(d--){if(this.divLayers[d].name==e){return this.divLayers[d];
}}},getFeatureLayers:function(){return this.svgLayers;},getDefaultFeatureLayer:function(){if(this.defaultFeatureLayer!=null){this.defaultFeatureLayer.bringToTop(true);
return this.defaultFeatureLayer;}else{this.defaultFeatureLayer=new OM.layer.VectorLayer("ii_oracle_maps_internal_editing",{def:{type:OM.layer.VectorLayer.TYPE_LOCAL}});
this.defaultFeatureLayer.selectionEnable=false;this.defaultFeatureLayer.setBringToTopOnMouseOver(false);
this.addLayer(this.defaultFeatureLayer);return this.defaultFeatureLayer;}},getToolFeatureLayer:function(){if(this.toolFeatureLayer!=null){this.toolFeatureLayer.bringToTop(true);
if(this.defaultFeatureLayer){this.getDefaultFeatureLayer();}return this.toolFeatureLayer;}else{this.toolFeatureLayer=new OM.layer.VectorLayer("ii_oracle_maps_internal_others",{def:{type:OM.layer.VectorLayer.TYPE_LOCAL}});
this.toolFeatureLayer.selectionEnable=false;this.toolFeatureLayer.setBringToTopOnMouseOver(false);this.toolFeatureLayer.enableFeatureEditing(true);
this.addLayer(this.toolFeatureLayer);this.getDefaultFeatureLayer();return this.toolFeatureLayer;}},touchStart:function(n){var d=OM.util.DomUtil;
this.touchCount=d.getTouchCount(n);if(this.touchCount>2){return;}this.pinchZoomScale=1;var m=this.touchStartLocs;
if(this.touchCount==1){var q=d.getTouchesPosition(n);m.length=0;m.push(q);}else{if(this.touchCount==2){var o=d.getChangedTouchesPosition(n);
if(o.length==1){m.push(o[0]);}else{if(o.length==2){m.length=0;m.push(o[0]);m.push(o[1]);}}}}if(m.length==2){var g=m[1].x-m[0].x;
var e=m[1].y-m[0].y;this.pinchZoomStartDist=Math.sqrt(g*g+e*e);}this.moveflag=true;var l=this.$oracleMapDiv.offset();
this.mLocX=m[0].x-l.left;this.mLocY=m[0].y-l.top;return false;},touchMove:function(d){if(this.touchStartLocs.length==0){return;
}var t=OM.util.DomUtil;var e=this.$oracleMapDiv.offset();this.mLocX=this.touchStartLocs[0].x-e.left;this.mLocY=this.touchStartLocs[0].y-e.top;
if(this.touchCount==2){var r=t.getTouchesScale(d);if(r==undefined){var l=t.getTouchesPosition(d);var m=l[0].x-l[1].x;
var g=l[0].y-l[1].y;var u=Math.sqrt(m*m+g*g);r=u/this.pinchZoomStartDist;}this.pinchZoomScale=r;if(r==1||r<=0){return;
}var q=this.zoomLevel;if(r>1&&q>=this.maxZoom){return;}else{if(r<1&&q<=0){return;}}this.pinchZooming=true;
this.graphics.setVisible(this.draggableGroup,false);this.$heatMapDiv.css({visibility:"hidden"});for(var s=0;
s<this.divLayers.length;s++){if(this.divLayers[s].zoomControl){this.divLayers[s].zoomControl.scaleTiles(r);
}}return;}var w=t.getTouchesPosition(d);var o=w.x-this.touchStartLocs[0].x;var n=w.y-this.touchStartLocs[0].y;
this.touchStartLocs[0].x=w.x;this.touchStartLocs[0].y=w.y;if(this.moveflag&&this.enableMapAction.drag){this.pan(o,n,false);
}return false;},touchEnd:function(l){this.touchStartLocs.length=0;this.touchCount-=OM.util.DomUtil.getTouchCount(l);
if(this.touchCount>0){return;}var o=this.pinchZoomScale;if(this.pinchZooming){var g=this.getScaleZoomLevel(o);
this.setMapZoomLevel(g);this.pinchZoomScale=1;this.pinchZooming=false;this.graphics.setVisible(this.draggableGroup,true);
this.$heatMapDiv.css({visibility:"visible"});}else{var m=this.lastTouchTimeStamp;var d=l.timeStamp;this.lastTouchTimeStamp=d;
if(d-m<500&&this.initialized&&this.enableMapAction.dbclick){this.setMapCenterAndZoomLevel(this.getCursorLocation(),OM.MapContext(this).getZoomLevel()+1,true);
}else{if(this.moveflag){this.moveflag=false;var n=new OM.event.MapEvent(OM.event.MapEvent.MAP_RECENTERED,this);
this.fire(n.type,n);}}}},getScaleZoomLevel:function(l){var o=this.getMapContext();var m=o.getZoomLevel();
if(l>0&&(l<1&&l>0.9||l>1&&l<1.1)){return m;}var r=o.getUniverse().getZoomLevels();var u=r.length-1;var d=r[m];
var t=d.resolution;var s=t/l;var q;if(l<1){for(q=m-1;q>=0;q--){var g=r[q].resolution;if(s<=g){var n=s/r[q+1].resolution;
var e=g/s;if(n>e){return q;}break;}}return q+1;}else{for(q=m+1;q<=u;q++){var g=r[q].resolution;if(s>=g){var n=r[q-1].resolution/s;
var e=s/g;if(n>e){return q;}break;}}return q-1;}},cleanMap:function(){this.displayed=false;this.initialized=false;
var l=new OM.event.MapEvent(OM.event.MapEvent.MAP_CLEAN,this);this.fire(l.type,l);if(this.graphics){this.graphics.clearGroup(this.draggableGroup);
this.graphics.clearGroup(this.fixedGroup);}this.$tileLayersDiv.empty();this.$fkGraphicLayersDiv.unbind();
var g=this;for(var e=0;e<this.decorationArray.length;e++){var d=this.decorationArray[e];if(d.type=="OverviewMap"){d.$DecorationBtnDiv.remove();
d.$DecorationDiv.remove();}}},checkCenter:function(){if(!this.overview&&this.hasExternal){return;}var q=this.getMapContextToken();
var o=q.universe;var n=q.zoomLevel;var l=o.zoomLevels[n].resolution;var g=o.zoomLevels[n].stretchRatio;
if(!q.homeCenter){q.homeCenter=new OM.geometry.Point((o.bound.getMinX()+o.bound.getMaxX())/2,(o.bound.getMinY()+o.bound.getMaxY())/2,o.srid);
}q.centerPoint=q.homeCenter.clone();var e=q.centerPoint;var m=o.bound;var t=q.deviceWindow;var w=e.getX()-t.w/2*l;
var s=e.getX()+t.w/2*l;var u=e.getY()-t.h/2*l*g;var r=e.getY()+t.h/2*l*g;var A={x:true,y:true};var d=q.centerPoint.getX();
var z=q.centerPoint.getY();if(w<m.getMinX()&&s>m.getMaxX()||s-w>m.width){d=(m.getMinX()+m.getMaxX())/2;
}else{if(w<m.getMinX()){d=m.getMinX()+t.w/2*l;}else{if(s>m.getMaxX()){d=m.getMaxX()-t.w/2*l;}else{A.x=false;
}}}if(u<m.minY&&r>m.maxY||r-u>m.height){z=(m.minY+m.maxY)/2;}else{if(u<m.minY){z=m.minY+t.h/2*l*g;}else{if(r>m.maxY){z=m.maxY-t.h/2*l*g;
}else{A.y=false;}}}q.centerPoint.setPoint(d,z);return A;},resetUniverse:function(t,w,l){var s=this.getMapContextToken();
s.universe=t;s.transform=null;var r=this.divLayers.length;for(var m=r-1;m>=0;m--){var o=this.divLayers[m];
if(o!=w&&o.tileLayerConfig&&!o.tileLayerConfig.equals(l)){this.removeLayer(o);}this.universeLayerIndex=0;
}r=this.svgLayers.length;for(var m=0;m<r;m++){var n=this.svgLayers[m];n.dataLoaded=false;n.loaded=false;
n.heatMap=null;if(n.renderingStyle&&n.renderingStyle.styleType=="HeatMap"&&n.renderingStyle.containerVectorLayer){n.renderingStyle.containerVectorLayer.dataLoaded=false;
}if(n.boundingTheme){n.loadedBoundingTheme=false;}}var q=s.universe;if(this.overview){var e=this.overview.submap.getMapContextToken();
var u=e.universe;if(this.overview.submap){u.zoomLevels=q.zoomLevels;u.srid=q.srid;u.bound=q.bound;if(this.overview.layer&&this.overview.layer.parentMap){var g=this.overview.layer;
if(g.copyFeatures){this.overview.mainmap.overviewLayer.deleteListener(OM.event.LayerEvent.FEATURES_LOADED,g.copyFeatures);
}this.overview.submap.removeLayer(this.overview.layer);}var d=this;s.centerPoint.transform(s.universe.srid,function(z){s.centerPoint=z;
e.centerPoint=s.centerPoint;e.homeCenter=s.centerPoint;e.zoomLevel=s.zoomLevel-d.overview.calMapZoomDiff();
d.overviewLayer=w;d.overview.layer=d.overviewLayer.clone("over_"+w.name);d.overview.submap.addLayer(d.overview.layer);
});}}this.boundingThemeLoading=false;this.boundingThemeLoaded=false;this.boundingLayerName=null;this.extentRect=null;
this.resetTag=true;this.init();},getMapAsSVG:function(g){var s=this.graphics;var t=s.oui;var n=t.viewportBounds;
var e=n.width;var w=n.height;var q=this.divLayers.length;var m=s.createGroup({x:0,y:0});for(var o=0;o<q;
o++){this.divLayers[o].exportToSVG(m,e,w);}var r=[m,this.draggableGroup];for(var o=0;o<this.decorationArray.length;
o++){var l=this.decorationArray[o];if(l instanceof OM.control.ScaleBar||l instanceof OM.control.CopyRight){r.push(l.defaultGroup);
}}var d=this;var u=function(){for(var A=0;A<q;A++){if(d.divLayers[A].loadImg!=0){window.setTimeout(u,200);
return;}}var z=new t.io.svg.SVGExporter().snapshotNodes(r,n,e,w);z.style="overflow:hidden";var B=t.io.XMLConverter.convert(z,"");
s.clearGroup(m);g(B);};window.setTimeout(u,0);},deleteFeatureInfoWindow:function(d){if(this.infoLayer){this.infoLayer.deleteInfoWindowById(d);
}},getMapAsXML:function(w,s,o){var B=OM.MapContext(this);if(!w){w="GIF_URL";}if(!s){s=B.getDeviceWidth();
}if(!o){o=B.getDeviceHeight();}var e='<?xml version="1.0" standalone="yes"?>';var q=this.defaultDataSource?this.defaultDataSource:"mvdemo";
var A=B.getUniverse().getSRID();e=e+'<map_request datasource="'+q+'" format="'+w+'" width="'+s+'" height="'+o+'" antialiase="true" '+(A?'srid="'+A+'"':"");
if(this.CopyRight){e=e+' footnote="'+this.CopyRight.textValue+'"';}e=e+">";var r=B.getUniverse().zoomLevels[B.getZoomLevel()];
var n=o*r.resolution*r.stretchRatio;var t=B.getCenterPoint();e+='<center size="'+n+'"><geoFeature><geometricProperty typeName="center"><Point><coordinates>'+t.getX()+","+t.getY()+"</coordinates></Point></geometricProperty></geoFeature></center>";
e+="<themes>";var d="<styles>";var C="";var g="";for(var u=0,z=this.divLayers.length;u<z;u++){if(this.divLayers[u].isVisible()&&this.divLayers[u] instanceof OM.layer.TileLayer){e+=this.divLayers[u].getXML();
}}for(var u=0,z=this.svgLayers.length;u<z;u++){if(this.svgLayers[u].isVisible()){var l=this.svgLayers[u].getXML();
e+=l[0];C+=l[1];d+=l[2];g+=l[3];}}e=e+"</themes>";d+="</styles>";if(this.ScaleBar){var D="SOUTH_WEST";
switch(this.scalebarPosition){case 1,2:D="NORTH_WEST";break;case 3:D="SOUTH_EAST";break;case 6:D="NORTH_EAST";
break;}var m="DUAL_MODES";if(this.ScaleBar.format!=null&&this.ScaleBar.format=="METRIC"){m="METRIC_MODE";
}else{if(this.ScaleBar.format!=null&&this.ScaleBar.format=="IMPERIAL"){m="US_MODE";}}e=e+'<scale_bar mode="'+m+'" position="'+D+'" ';
e=e+' color1="#000000" color2="#FFFFFF"';if(this.ScaleBar.anchorOffsetX){e=e+' offset_x="'+this.ScaleBar.anchorOffsetX;
}if(this.ScaleBar.anchorOffsetY){e=e+'" offset_y="'+this.ScaleBar.anchorOffsetY+'"';}if(this.ScaleBar.maxLength){e=e+' length_hint="'+this.ScaleBar.maxLength+'"';
}e=e+"/>";}e+=C+d+g;e=e+"</map_request>";return e;},print:function(){OM.$(document.body).css("cursor","wait");
this.$oracleMapDiv.css("cursor","wait");var d=this;this.getMapAsSVG(function(g){OM.$(document.body).css("cursor","");
d.$oracleMapDiv.css("cursor","");var e=window.open();e.document.write(g);e.print();});},enableMouseWheelZooming:function(d){this.enableMapAction.mousewheel=d;
},setHomeMap:function(d,e){var g=this.getMapContextToken();if(d){g.homeMapCenter=d;}if(e){g.homeMapZoomlevel=e;
}},enableZoomAnimation:function(d){this.tileLayerZoomAnimation=d;},enableInfoWindowEventPropagation:function(d){this.infoWindowEventPropogation=d;
},closeInfoWindows:function(){if(this.infoLayer){this.infoLayer.closeInfoWindows();}}});OM.Map.setProxyPath=function(d){if(d&&d.indexOf("/")===0){OM.gv.proxyPath=d;
}};OM.Map.getProxyPath=function(){return OM.gv.proxyPath;};OM.Map.setLocale=function(e,d){};OM.Map.setErrorHandler=function(d){OM.util.Logger.errorHandler=d;
};OM.Map.setAPIKey=function(d,g){var e=OM.util.HttpRequest.getDomain(g);OM.gv.mvKeyMap[e]=d;};OM.layer.Layer=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(g,e){this.name=g;
this.group=null;this.visible=true;this.minVisibleLevel=0;this.maxVisibleLevel=100;this.minVisibleScale=0;
this.maxVisibleScale=1000000000;this.visibleBound=null;this.parentMap=null;this.zIndex=null;this.opacity=1;
this.layerType=null;this.customType="";this.loaded=false;this.serverURL=null;var l=this;var d=OM.event.LayerEvent;
},init:function(d){},initLayer:function(l){this.init(l);var d=OM.event.LayerEvent;var g=new d(d.LAYER_INITIALIZED,this);
g.mapContext=this.parentMap.getMapContext();this.fire(d.LAYER_INITIALIZED,g);},panEvent:function(d){this.pan(d.xOffset,d.yOffset);
},refreshEvent:function(d){this.refresh(d,true);},setCenterAndZoomlevel:function(d){},recenter:function(d){},pan:function(d){},destroy:function(){this.parentMap=null;
},isVisible:function(){return this.visible;},setVisible:function(l){var d=OM.event.LayerEvent;var g=new d(d.LAYER_VISIBILITY_CHANGED,this);
var e=this.visible;var m=l;if(this.visible===l){return;}this.visible=l;if(this.setVisibleImpl){this.setVisibleImpl();
}else{if(this.visible){if(this.group&&this.parentMap&&this.parentMap.graphics){this.parentMap.graphics.applyStyle(this.group,{display:true});
}if(this.parentMap&&this.parentMap.displayed){this.refresh(null,false);}}else{if(this.group&&this.parentMap&&this.parentMap.graphics){this.parentMap.graphics.applyStyle(this.group,{display:false});
}}}g.newVisibility=m;g.oldVisibility=e;if(this.parentMap){g.mapContext=this.parentMap.getMapContext();
}this.fire(d.LAYER_VISIBILITY_CHANGED,g);},refresh:function(){var l=(arguments.length>0)?arguments[0]:null;
var g=(arguments.length>1)?arguments[1]:null;if(g){var d=OM.event.LayerEvent;var l=new d(d.BEFORE_REFRESH,this);
if(this.parentMap){l.mapContext=this.parentMap.getMapContext();}this.fire(d.BEFORE_REFRESH,l);}},redraw:function(){if(arguments.length>0){this.refresh(arguments[0],false);
}},setZoomLevelRange:function(e,d){this.minVisibleLevel=e;this.maxVisibleLevel=d;if(this.displayed){this.refresh(null,false);
}},setScaleRange:function(d,e){this.minVisibleScale=d;this.maxVisibleScale=e;},setVisibleBound:function(d){if(!d instanceof OM.geometry.Rectangle){return;
}this.visibleBound=d;if(this.displayed){if(this.changeVisibleBound){this.changeVisibleBound();}else{this.refresh();
}}},bringForward:function(){if(this.parentMap){return this.parentMap.bringForward(this);}},sendBackward:function(){if(this.parentMap){return this.parentMap.sendBackward(this);
}},bringToTop:function(){var d=false;if(arguments.length>0){d=arguments[0];}if(this.parentMap){return this.parentMap.bringToTop(this,d);
}},sendToBottom:function(){if(this.parentMap){return this.parentMap.sendToBottom(this);}},setZIndex:function(d){if(this.parentMap){return this.parentMap.setLayerIndex(this,d);
}},getZIndex:function(){if(this.parentMap){return this.parentMap.getLayerCurrentIndex(this);}},getName:function(){return this.name;
},setOpacity:function(d){if(!OM.util.ValidationUtil.isNumber(d)){return;}if(d>1||d<0){return;}else{this.opacity=d;
}if(this.displayed&&this.changeOpacity){this.changeOpacity();}},getOpacity:function(){return this.opacity;
},getLayerConfig:function(){var d=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
if(this.parentMap){d.mapContext=this.parentMap.getMapContext();}this.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,d);
},getDataSouce:function(){return this.dataSource;},clone:function(d){var e={};OM.$.extend(e,this);if(d){e.name=d;
}else{e.name=e.name+"_clone";}e.deleteAllListeners();return e;}});OM.layer.TileLayer=OM.layer.Layer.extend({initialize:function(e,d){this._super(e,d);
if(d){this.dataSource=d.dataSource;this.tileLayer=d.tileLayer;if(d.tileServerURL!=null){this.serverURL=d.tileServerURL;
}this.tileLayerConfig=d.tileLayerConfig;this.getTileURL=d.getTileURL;this.mapSource=this.dataSource+"."+this.tileLayer;
}this.enableZoomLevels=null;this.layerType=OM.LayerTypes.TILE;this.zIndex=0;this.initError=false;},setCenterAndZoomlevel:function(l){var g=this.parentMap.getMapContext();
var d=g.getCenterPoint();var m=l.preMapCenter;if(l.beforeZoomLevel!=null){this.zoom(l.beforeZoomLevel,g.getZoomLevel(),m,d);
}},getLayerConfig:function(e,d){this.getTileLayerConfig(e,d);},getTileLayerConfig:function(d,m){if(!this.tileLayerConfig){var q=this.dataSource+"."+this.tileLayer;
var l=OM.gv.CacheConfig[q];if(l){this.tileLayerConfig=l;}}if(this.tileLayerConfig){var r=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
r.config=this.getEnabledConfig(this.tileLayerConfig);r.mapContext=this.parentMap.getMapContext();this.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,r);
if(m){m(this.tileLayerConfig);}else{return this.tileLayerConfig;}}else{var n='<?xml version="1.0" standalone="yes"?><map_cache_admin_request><get_client_config map_cache_names="'+q+'" format="JSON"/></map_cache_admin_request>';
this.serverURL=this.getTileServerURL();var g=this.serverURL;var o=this;var s=function(){o.initError=true;
OM.util.Logger.alert("MAPVIEWER-05501","OM.layer.Tilelayer.getTileLayerConfig","["+q+"]");var t=OM.event;
var e=new t.LayerEvent(t.LayerEvent.INIT_ERROR,o);if(!o.parentMap){return;}e.mapContext=o.parentMap.getMapContext();
o.fire(t.LayerEvent.INIT_ERROR,e);return;};OM.util.HttpRequest.send(g,{xml_request:n},function(J){if(J&&J[0]){var C=J[0].coordSys;
var A=new OM.layer.TileLayerConfig();A.bounds=new OM.geometry.Rectangle(C.minX,C.minY,C.maxX,C.maxY,C.srid);
A.srid=C.srid;A.tileImageFormat=J[0].format;A.isTransparentImage=J[0].transparent;var H=J[0].zoomLevels;
var F=H.length;if(H&&F>0){A.tileImageWidth=H[0].tileImageWidth;A.tileImageHeight=H[0].tileImageHeight;
A.zoomLevels=new Array(F);for(var D=0;D<F;D++){var w=H[D].tileWidth/A.tileImageWidth;var E=H[D].tileHeight/A.tileImageHeight;
var u=E/w;A.zoomLevels[D]={resolution:w,stretchRatio:u,infotip:""};}}if(J[0].customTags){A.customTags=J[0].customTags;
}o.tileLayerConfig=A;if(J[0].clientTileAccess){var z;var B=J[0].clientTileAccess;if(B.lib_url&&B.key){B.lib_url=B.lib_url.replace("=$$key$$","="+B.key);
}if(B.map_type_visible=="false"){B.map_type_visible=false;}else{B.map_type_visible=true;}if(B.type=="google"){var I={key:B.key,libURL:B.lib_url,mapTypeList:B.map_type_values.replace(/MVGoogleTileLayer/g,"OM.layer.GoogleTileLayer"),mapTypeVisible:B.map_type_visible};
if(B.appID){I.appID=B.appID;}z=new OM.layer.GoogleTileLayer(B.type,I);}else{if(B.type=="bing"){var I={key:B.key,libURL:B.lib_url,mapTypeList:B.map_type_values.replace(/MVBingTileLayer/g,"OM.layer.BingTileLayer"),mapTypeVisible:B.map_type_visible};
if(B.appID){I.appID=B.appID;}z=new OM.layer.BingTileLayer(B.type,I);}else{if(B.type=="bingV7"){}else{if(B.type=="mapviewer"){if(B.appID){I.appID=B.appID;
}z=new OM.layer.ElocationTileLayer();}else{if(B.type=="nokia"){var I={key:B.key,libURL:B.lib_url,mapTypeList:B.map_type_values.replace(/MVNokiaTileLayer/g,"OM.layer.NokiaTileLayer"),mapTypeVisible:B.map_type_visible};
if(B.appID){I.appID=B.appID;}z=new OM.layer.NokiaTileLayer(B.type,I);}}}}}if(B.default_map_type){if(B.default_map_type=="OM.layer.GoogleTileLayer.TYPE_ROAD"){z.setMapType(OM.layer.GoogleTileLayer.TYPE_SATELLITE);
}if(B.default_map_type=="OM.layer.GoogleTileLayer.TYPE_SATELLITE"){z.setMapType(OM.layer.GoogleTileLayer.TYPE_SATELLITE);
}if(B.default_map_type=="OM.layer.GoogleTileLayer.TYPE_SHADED"){z.setMapType(OM.layer.GoogleTileLayer.TYPE_SHADED);
}if(B.default_map_type=="OM.layer.BingTileLayer.TYPE_ROAD"){z.setMapType(OM.layer.BingTileLayer.TYPE_ROAD);
}if(B.default_map_type=="OM.layer.BingTileLayer.TYPE_SATELLITE"){z.setMapType(OM.layer.BingTileLayer.TYPE_SATELLITE);
}if(B.default_map_type=="OM.layer.BingTileLayer.TYPE_HYBRID"){z.setMapType(OM.layer.BingTileLayer.TYPE_HYBRID);
}if(B.default_map_type=="OM.layer.BingTileLayer.TYPE_SHADED"){z.setMapType(OM.layer.BingTileLayer.TYPE_SHADED);
}if(B.default_map_type=="OM.layer.NokiaTileLayer.TYPE_ROAD"){z.setMapType(OM.layer.NokiaTileLayer.TYPE_ROAD);
}if(B.default_map_type=="OM.layer.NokiaTileLayer.TYPE_HYBRID"){z.setMapType(OM.layer.NokiaTileLayer.TYPE_HYBRID);
}if(B.default_map_type=="OM.layer.NokiaTileLayer.TYPE_TERRAIN"){z.setMapType(OM.layer.NokiaTileLayer.TYPE_TERRAIN);
}}z.tileLayerConfig=A;var G=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,o);G.config=o.getEnabledConfig(A);
G.mapContext=o.parentMap.getMapContext();o.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,G);var t=o.parentMap;
o.parentMap.removeLayer(o);t.addLayer(z);}else{var G=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,o);
G.config=o.getEnabledConfig(A);G.mapContext=o.parentMap.getMapContext();o.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,G);
}if(m){m(A);}}else{s();return null;}},"json",s);}},setEnabledZoomLevels:function(d){if(!OM.util.ValidationUtil.isNumberArray(d)){return;
}this.enableZoomLevels=d;if(this.displayed){this.parentMap.init();}},init:function(){var H=this.parentMap.getMapContext();
var C=H.getUniverse();this.winWidth=H.getDeviceWidth();this.winHeight=H.getDeviceHeight();var I=H.getCenterPoint();
var q=I.getX();var o=I.getY();var l=this.getRealZoomLevel(H.getZoomLevel());if(!this.checkVisible(l)){var t=OM.event;
var B=new t.LayerEvent(t.LayerEvent.FINISH_LOAD,this);B.mapContext=this.parentMap.getMapContext();this.fire(t.LayerEvent.FINISH_LOAD,B);
return;}this.tileImageWidth=this.tileLayerConfig.tileImageWidth;this.tileImageHeight=this.tileLayerConfig.tileImageHeight;
this.bufferX=Math.ceil(this.tileImageWidth/2);this.bufferY=Math.ceil(this.tileImageHeight/2);this.tileNumX=Math.ceil((this.winWidth+this.bufferX*2)/this.tileImageWidth);
this.centerMesh=null;this.centerMesh=new OM.layer.Mesh(this.tileLayerConfig,q,o,l);var m=this.tileLayerConfig.bounds;
this.tileNumInCSBoun=Math.ceil((m.getMaxX()-m.getMinX())/this.centerMesh.mw);var E=this.tileLayerConfig.zoomLevels[l];
var g=E.resolution;var J=E.resolution*E.stretchRatio;this.tileNumY=Math.ceil((this.winHeight+this.bufferY*2)/this.tileImageHeight);
this.tileMinX=0;this.tileMinY=0;this.initTileArray();var e=Math.floor(this.tileNumX/2);var D=Math.floor(this.tileNumY/2);
var z=this.winWidth/2-(q-this.centerMesh.minX)/g;var w=this.winHeight/2+(o-this.centerMesh.minY)/J-this.tileImageHeight;
while(true){var s=z-e*this.tileImageWidth;if(s>0){e++;continue;}var d=w-D*this.tileImageHeight;if(d>0){D++;
continue;}var n=z+(this.tileNumX-e)*this.tileImageWidth-this.winWidth;if(n<0){e--;continue;}var u=w+(this.tileNumY-D)*this.tileImageHeight-this.winHeight;
if(u<0){D--;continue;}var A=n+s,r=u+d;if(A>this.tileImageWidth){e++;continue;}else{if(A<(-1)*this.tileImageWidth){e--;
continue;}}if(r>this.tileImageHeight){D++;continue;}if(r<(-1)*this.tileImageHeight){D--;continue;}break;
}this.origLeft=z-e*this.tileImageWidth;this.origTop=w-D*this.tileImageHeight;this.jqLayerDiv.css({left:this.origLeft,top:this.origTop});
this.createImageNode(e,D,this.tileImageWidth,this.tileImageHeight,e*this.tileImageWidth,D*this.tileImageHeight);
this.centerMesh.moveMeshCode(-1,1);var G=Math.max(e,this.tileNumX-e);var F=Math.max(D,this.tileNumY-D);
for(radius=1;radius<=Math.max(G,F);radius++){for(xx=e-radius,yy=D-radius;xx<=e+radius;xx++){if(!(xx<0||xx>=this.tileNumX||yy<0||yy>=this.tileNumY)){this.createImageNode(xx,yy,this.tileImageWidth,this.tileImageHeight,xx*this.tileImageWidth,yy*this.tileImageHeight);
}this.centerMesh.moveMeshCode(1,0);}this.centerMesh.moveMeshCode(-(radius*2+1),-1);for(xx=e-radius,yy=D-radius+1;
yy<=D+radius-1;yy++){if(!(xx<0||xx>=this.tileNumX||yy<0||yy>=this.tileNumY)){this.createImageNode(xx,yy,this.tileImageWidth,this.tileImageHeight,xx*this.tileImageWidth,yy*this.tileImageHeight);
}this.centerMesh.moveMeshCode(0,-1);}for(xx=e-radius,yy=D+radius;xx<=e+radius;xx++){if(!(xx<0||xx>=this.tileNumX||yy<0||yy>=this.tileNumY)){this.createImageNode(xx,yy,this.tileImageWidth,this.tileImageHeight,xx*this.tileImageWidth,yy*this.tileImageHeight);
}this.centerMesh.moveMeshCode(1,0);}this.centerMesh.moveMeshCode(-1,1);for(xx=e+radius,yy=D+radius-1;
yy>=D-radius+1;yy--){if(!(xx<0||xx>=this.tileNumX||yy<0||yy>=this.tileNumY)){this.createImageNode(xx,yy,this.tileImageWidth,this.tileImageHeight,xx*this.tileImageWidth,yy*this.tileImageHeight);
}this.centerMesh.moveMeshCode(0,1);}this.centerMesh.moveMeshCode(-(radius*2+1),1);}this.centerMesh.moveMeshCode(radius,-(radius));
this.centerMesh.moveMeshCode(-e+Math.floor(this.tileNumX/2),D-Math.floor(this.tileNumY/2));if(!this.zoomControl){this.zoomControl=new OM.layer.TileZoomAnimation(this);
}this.zoomControl.tileInitialized();this.displayed=true;},initTileArray:function(){this.clearLayer();
this.jqLayerDiv=OM.$("<div id ='tilelayer_"+this.name+"'></div>");this.jqLayerDiv.css({position:"absolute","z-index":this.zIndex});
this.parentMap.$tileLayersDiv.append(this.jqLayerDiv);var d=OM.gv.transparentImg;if(d.indexOf("/")==0){var q=this.serverURL.indexOf("/mapviewer/mcserver");
if(this.serverURL&&!this.transImgURL&&q>=0){this.transImgURL=this.serverURL.substring(0,q)+d;}else{this.transImgURL=document.location.protocol+"//"+document.location.host+d;
}}else{this.transImgURL=d;}var r=this.tileLayerConfig.isTransparentImage;for(var n=0;n<this.tileNumX;
n++){var e=new Array();var o=OM.browser.touchSupported;for(var m=0;m<this.tileNumY;m++){var g=OM.util.DomUtil.createImageNode(this.transImgURL,r);
var l=OM.$(g);if(o){l.bind("click",function(s){s.preventDefault();return false;});l.bind("focus",function(s){s.preventDefault();
return false;});}this.jqLayerDiv.append(l);e.push(l);}this.tileArray.push(e);}},createImageNode:function(o,l,q,g,d,m){if(o==0&&l==0){this.leftNum=this.centerMesh.mX;
this.topNum=this.centerMesh.mY;}var s=this.meshImgPath(this.centerMesh.mX,this.centerMesh.mY);var n=this.tileArray[o][l];
if(n==null){var r=OM.util.DomUtil.createImageNode(null,this.isTransparent);n=OM.$(r);this.jqLayerDiv.append(n);
this.tileArray[o][l]=n;}n.css({position:"absolute",left:d,top:m});if(OM.browser.msie){n.css({width:q,height:g});
}if((this.zoomControl)&&(this.zoomControl.zooming)){n.css("display","none");}var e=this;n.imgLoadFinished=false;
n.bind("load",function(){n.imgLoadFinished=true;n.unbind("load");n.css("display","");});OM.util.DomUtil.setImageSrc(n[0],s,this.opacity,this.tileLayerConfig.isTransparentImage);
},meshImgPath:function(s,r){if(s<0||s>=(this.tileLayerConfig.bounds.getMaxX()-this.tileLayerConfig.bounds.getMinX())/this.centerMesh.mw||r<0||r>=(this.tileLayerConfig.bounds.getMaxY()-this.tileLayerConfig.bounds.getMinY())/this.centerMesh.mh){return this.transImgURL;
}if(this.visibleBound){var A=Math.floor((this.visibleBound.getMinX()-this.tileLayerConfig.bounds.getMinX())/this.centerMesh.mw);
var z=Math.ceil((this.visibleBound.getMaxX()-this.tileLayerConfig.bounds.getMinX())/this.centerMesh.mw);
var n=Math.floor((this.visibleBound.getMinY()-this.tileLayerConfig.bounds.getMinY())/this.centerMesh.mh);
var m=Math.ceil((this.visibleBound.getMaxY()-this.tileLayerConfig.bounds.getMinY())/this.centerMesh.mh);
if(s<A||s>=z||r<n||r>=m){return this.transImgURL;}}var t=this.centerMesh.zoom;if(this.getTileURL){var u=this.tileLayerConfig.zoomLevels[t];
var e=u.resolution;var F=u.resolution*u.stretchRatio;var d=this.tileLayerConfig.tileImageWidth*e;var q=this.tileLayerConfig.tileImageHeight*F;
var E=this.tileLayerConfig.bounds.getMinX()+s*d;var D=E+d;var C=this.tileLayerConfig.bounds.getMinY()+r*q;
var B=C+d;var g=new OM.geometry.Rectangle(E,C,D,B,this.tileLayerConfig.srid);var w=this.getTileURL(t,s,r,g);
if(!w){return this.transImgURL;}else{return w;}}else{var l=null;if(this.mapSource){l=this.mapSource;}else{l=this.dataSource+"."+this.tileLayer;
}var o=this.serverURL+"?request=gettile&format="+this.tileLayerConfig.tileImageFormat;o+="&zoomlevel="+t+"&mapcache="+l+"&mx="+s+"&my="+r;
if(this.reloadNumber){o+="&reload="+this.reloadNumber;}return o;}},pan:function(D,z){var g=this.getRealZoomLevel(this.parentMap.getMapContext().getZoomLevel());
if(!this.checkVisible(g)){var r=OM.event;var B=new r.MapEvent(r.LayerEvent.FINISH_LOAD,this);B.mapContext=this.parentMap.getMapContext();
this.fire(r.LayerEvent.FINISH_LOAD,B);return;}var N=OM.util.DomUtil.getElementPos(this.jqLayerDiv);this.jqLayerDiv.css({left:N.left+D,top:N.top+z});
var L=D+this.tileMinX+N.left;var K=z+this.tileMinY+N.top;var M=0;var s=0;while(true){var m=L-M*this.tileImageWidth;
if(m>0){M++;continue;}var e=K-s*this.tileImageHeight;if(e>0){s++;continue;}var l=L+(this.tileNumX-M)*this.tileImageWidth-this.winWidth;
if(l<0){M--;continue;}var t=K+(this.tileNumY-s)*this.tileImageHeight-this.winHeight;if(t<0){s--;continue;
}var C=l+m,n=t+e;if(C>this.tileImageWidth){M++;continue;}else{if(C<(-1)*this.tileImageWidth){M--;continue;
}}if(n>this.tileImageHeight){s++;continue;}if(n<(-1)*this.tileImageHeight){s--;continue;}break;}if(M==0&&s==0){return;
}var d=Math.floor(this.tileNumX/2);var F=Math.floor(this.tileNumY/2);var w=this.centerMesh.mX-d;var u=this.centerMesh.mY+F;
var I;if(M!=0){for(I=0;(M>0?I<M:I>M);(M>0?I++:I--)){var q;var o;var E;if(M>0){o=this.tileMinX-(I+1)*this.tileImageWidth;
}else{o=this.tileMinX+(this.tileNumX-I)*this.tileImageWidth;}if(M>0){this.leftNum--;}else{this.leftNum++;
}if(M>0){q=this.tileArray[this.tileArray.length-1];this.tileArray.pop();for(var J=0;J<q.length;J++){OM.util.DomUtil.setImageSrc(q[J],null);
if(s==0||(s>0&&J<q.length-s)||(s<0&&J>=-s)){OM.util.DomUtil.setImageSrc(q[J],this.meshImgPath(w-I-1,u-J));
}OM.$(q[J]).css("left",o);}this.tileArray.unshift(q);}else{q=this.tileArray[0];this.tileArray.shift();
for(var J=0;J<q.length;J++){OM.util.DomUtil.setImageSrc(q[J],null);if(s==0||(s>0&&J<q.length-s)||(s<0&&J>=-s)){OM.util.DomUtil.setImageSrc(q[J],this.meshImgPath(w+this.tileNumX-I,u-J));
}OM.$(q[J]).css("left",o);}this.tileArray.push(q);}}}if(s!=0){var H;for(H=0;(s>0?H<s:H>s);(s>0?H++:H--)){var A;
if(s>0){A=this.tileMinY-(H+1)*this.tileImageHeight;this.topNum++;}else{A=this.tileMinY+(this.tileNumY-H)*this.tileImageHeight;
this.topNum--;}for(I=0;I<this.tileArray.length;I++){var q=this.tileArray[I];var G;if(s>0){G=q[q.length-1];
OM.util.DomUtil.setImageSrc(G,null);q.pop();q.unshift(G);OM.$(G).css("top",A);OM.util.DomUtil.setImageSrc(G,this.meshImgPath(w-M+I,u+H+1));
}else{G=q[0];OM.util.DomUtil.setImageSrc(G,null);q.shift();q.push(G);OM.$(G).css("top",A);OM.util.DomUtil.setImageSrc(G,this.meshImgPath(w-M+I,u-this.tileNumY+H));
}}}}this.tileMinX=this.tileMinX-M*this.tileImageWidth;this.tileMinY=this.tileMinY-s*this.tileImageHeight;
this.centerMesh.moveMeshCode(-M,s);},refresh:function(l,g){if(g==undefined){g=true;}this._super(l,g);
this.reloadNumber=Math.round(Math.random()*10000000000);if(this.parentMap){this.clearLayer();this.init();
}if(g){var d=new OM.event.LayerEvent(OM.event.LayerEvent.AFTER_REFRESH,this);if(this.parentMap){d.mapContext=this.parentMap.getMapContext();
}this.fire(OM.event.LayerEvent.AFTER_REFRESH,d);}},checkVisible:function(e){if(this.initError){return false;
}if(!this.isVisible()){return false;}if(e>=this.tileLayerConfig.zoomLevels.length){return false;}if(e<this.minVisibleLevel||e>this.maxVisibleLevel){return false;
}if(this.enableZoomLevels){for(var d=0;d<this.enableZoomLevels.length;d++){if(this.enableZoomLevels[d]==e){return true;
}}return false;}return true;},clearLayer:function(){if(this.jqLayerDiv&&!(this.jqLayerDiv.zooming)){this.jqLayerDiv.remove();
this.jqLayerDiv=null;}this.tileArray=new Array();},changeOpacity:function(){var e=this.tileArray.length;
var g=this.tileLayerConfig.isTransparentImage;var l=OM.util.DomUtil.changeOpacity;for(i=0;i<e;i++){var d=this.tileArray[i].length;
for(j=0;j<d;j++){l(this.tileArray[i][j],this.opacity,g);}}},zoom:function(e,l,n,d){var m=this.getRealZoomLevel(e);
var g=this.getRealZoomLevel(l);if(!this.checkVisible(m)){this.init();return;}if(!this.zoomControl){this.zoomControl=new OM.layer.TileZoomAnimation(this);
}if(!this.checkVisible(g)){this.clearLayer();this.zoomControl.tileInitialized();return;}if(this.parentMap.tileLayerZoomAnimation){if(this.zoomControl.scaling){this.init();
this.zoomControl.endScaling();}else{this.zoomControl.showTiles(m,g,n,d);}}else{this.init();this.zoomControl.tileInitialized();
}},getTileServerURL:function(){if(this.serverURL==this.parentMap.mapviewerURL){this.serverURL=this.serverURL+"/mcserver";
}return this.serverURL;},setVisibleImpl:function(){if(this.jqLayerDiv){this.jqLayerDiv.css("visibility",this.visible?"visible":"hidden");
}if(this.visible){this.init();}},getXML:function(){var e='<theme name="'+this.name+'"><map_cache_theme map_cache_name="'+this.dataSource+"."+this.tileLayer+'" snap_to_cache_scale="true" ';
if(this.serverURL!=""){var d=this.serverURL.substring(0,this.serverURL.lastIndexOf("/"));if(d!=this.parentMap.mapviewerURL){d+="/";
e+='mapviewer_url="'+d+'"';}}e+="/></theme>";return e;},getCustomTags:function(){if(this.tileLayerConfig&&this.tileLayerConfig.customTags){return this.tileLayerConfig.customTags;
}else{return{};}},destroy:function(){this.clearLayer();if(this.zoomContorl){this.zoomControl.destroy();
}this.initError=null;this.zoomControl=null;this._super();},getEnabledConfig:function(e){if(this.enableZoomLevels){var l=new OM.layer.TileLayerConfig();
l.bounds=e.bounds;l.srid=e.srid;l.tileImageFormat=e.tileImageFormat;l.isTransparentImage=e.isTransparentImage;
l.tileImageWidth=e.tileImageWidth;l.tileImageHeight=e.tileImageHeight;l.customTags=e.customTags;l.zoomLevels=new Array();
for(var g=0;g<this.enableZoomLevels.length;g++){var d=e.zoomLevels[this.enableZoomLevels[g]];l.zoomLevels.push(d);
}return l;}return e;},getRealZoomLevel:function(e){if(this.enableZoomLevels){if(e>=this.enableZoomLevels.length){e==this.enableZoomLevels.length;
}var d=this.enableZoomLevels[e];return d;}return e;},exportToSVG:function(l){var d=parseInt(this.jqLayerDiv.css("left"));
var m=parseInt(this.jqLayerDiv.css("top"));var e=this.parentMap.graphics;e.setLeftTop(l,d,m);var g=this;
g.loadImg=0;this.jqLayerDiv.find("img").each(function(){var q=this.src;var o=OM.$(this);d=parseInt(o.css("left"));
m=parseInt(o.css("top"));g.loadImg++;var n=e.drawImage({x:d,y:m},{src:q,width:256,height:256},{group:l});
n.handleEvent=function(r){this.resourceUpdate(r);g.loadImg--;};});return l;},clone:function(d){var e=this._super(d);
if(e.displayed){e.jqLayerDiv=null;e.displayed=false;e.zoomControl=null;}return e;}});OM.layer.TileLayerConfig=function(d){this.tileImageWidth=256;
this.tileImageHeight=256;this.tileImageFormat="PNG";this.isTransparentImage=false;if(d){this.srid=d.srid;
this.zoomLevels=d.zoomLevels;this.bounds=d.bounds;if(d.tileImageWidth){this.tileImageWidth=d.tileImageWidth;
}if(d.tileImageHeight){this.tileImageHeight=d.tileImageHeight;}if(d.tileImageFormat){this.tileImageFormat=d.tileImageFormat;
}if(d.isTransparentImage){this.isTransparentImage=d.isTransparentImage;}if(d.customTags){this.customTags=d.customTags;
}}};OM.layer.TileLayerConfig.prototype.equals=function(e){if(this.srid!=e.srid){return false;}if(this.zoomLevels&&e.zoomLevels&&this.zoomLevels.length!=e.zoomLevels.length){return false;
}var d=this.zoomLevels.length;for(var g=0;g<d;g++){if(this.zoomLevels[g].resolution!=e.zoomLevels[g].resolution||this.zoomLevels[g].stretchRatio!=e.zoomLevels[g].stretchRatio){return false;
}}return true;};OM.layer.TileLayerConfig.CONFIG_ELOCATION=new OM.layer.TileLayerConfig();OM.layer.TileLayerConfig.CONFIG_GOOGLE=new OM.layer.TileLayerConfig();
OM.layer.TileLayerConfig.CONFIG_WGS84_WORLD=new OM.layer.TileLayerConfig();OM.layer.TileLayerConfig.CONFIG_OSM=new OM.layer.TileLayerConfig();
OM.layer.TileLayerConfig.setConstants=function(){var d=OM.layer.TileLayerConfig;var e=new OM.universe.ElocationUniverse();
d.CONFIG_ELOCATION.zoomLevels=e.getZoomLevels();d.CONFIG_ELOCATION.srid=e.getSRID();d.CONFIG_ELOCATION.bounds=e.getMapBounds();
d.CONFIG_ELOCATION.tileImageFormat="PNG";d.CONFIG_ELOCATION.isTransparentImage=false;e=new OM.universe.WorldMercatorUniverse();
d.CONFIG_GOOGLE.zoomLevels=e.getZoomLevels();d.CONFIG_GOOGLE.srid=e.getSRID();d.CONFIG_GOOGLE.bounds=e.getMapBounds();
e=new OM.universe.LatLonUniverse();d.CONFIG_WGS84_WORLD.zoomLevels=e.getZoomLevels();d.CONFIG_WGS84_WORLD.srid=e.getSRID();
d.CONFIG_WGS84_WORLD.bounds=e.getMapBounds();e=new OM.universe.OSMUniverse();d.CONFIG_OSM.zoomLevels=e.getZoomLevels();
d.CONFIG_OSM.srid=e.getSRID();d.CONFIG_OSM.bounds=e.getMapBounds();};OM.layer.TileLayerConfig.setConstants();
OM.layer.TileZoomAnimation=OM.Class.extend({initialize:function(d){this.ldiff=0;this.tdiff=0;this.tileLayer=d;
this.tileArray=null;this.animationLayerDiv=null;this.zoomStep=0.1;this.interval=40;this.zooming=false;
this.oldTilesLoaded=false;this.timeouts=new Array();this.imageWidth=d.tileLayerConfig.tileImageWidth;
},computeTilesOffset:function(){var e=this.tileLayer.jqLayerDiv;if(e){var d=OM.util.DomUtil.getElementPos(e);
this.ldiff=-d.left;this.tdiff=-d.top;}},getScreenCor:function(r,q,e){var m=this.tileLayer.tileLayerConfig.zoomLevels[e];
var l=1/m.resolution;var g=l/m.stretchRatio;var o=r-this.tileLayer.winWidth/2;var n=q-this.tileLayer.winHeight/2;
var d=this.newCenter;return{x:o/l+d.getX(),y:d.getY()-n/g};},getScreenXY:function(e,o,n){var g=this.tileLayer.tileLayerConfig.zoomLevels[n];
var m=1/g.resolution;var l=m/g.stretchRatio;var d=this.newCenter;return{x:(e-d.getX())*m+this.tileLayer.winWidth/2,y:(d.getY()-o)*l+this.tileLayer.winHeight/2};
},initZoomInfo:function(C,o,D){var w=this.tileLayer.tileLayerConfig;var A=w.zoomLevels;var t=A[C];var F=1/t.resolution;
var B=F/t.stretchRatio;var g=o;if(C-o>1){g=C-1;}else{if(C-o<-1){g=C+1;}}toConfig=A[g];var z=1/toConfig.resolution;
var u=z/toConfig.stretchRatio;var d=w.tileImageWidth;var r=w.tileImageWidth;var n=w.tileImageWidth*z/F;
var s=w.tileImageHeight*u/B;var E=OM.util.DomUtil.getElementPos(OM.$(D));var m=this.getScreenCor(E.left-this.ldiff,E.top-this.tdiff,C);
var l=this.getScreenXY(m.x,m.y,g);var e=l.x+this.ldiff;var q=l.y+this.tdiff;D.oldZoomInfo=new Object();
D.oldZoomInfo.lstart=E.left;D.oldZoomInfo.tstart=E.top;D.oldZoomInfo.lend=e;D.oldZoomInfo.tend=q;D.oldZoomInfo.fw=d;
D.oldZoomInfo.fh=r;D.oldZoomInfo.tiw=n;D.oldZoomInfo.tih=s;},zoomToFactor:function(r,n){if(n>1){return;
}var d=r.oldZoomInfo;var g=(d.lend-d.lstart)*n+d.lstart;var m=(d.tend-d.tstart)*n+d.tstart;var e=(d.tiw-d.fw)*n+d.fw;
var o=(d.tih-d.fh)*n+d.fh;var q=OM.$(r);q.css("left",g);q.css("top",m);q.width(e+1);q.height(o+1);},copyTiles:function(){if(this.animationLayerDiv&&this.animationLayerDiv.parent()){return false;
}this.animationLayerDiv=this.tileLayer.jqLayerDiv;this.animationLayerDiv.zooming=true;this.tileArray=this.tileLayer.tileArray;
this.animationLayerDiv.css("zIndex",this.tileLayer.zIndex+1);return true;},zoomToNewCenter:function(m){if((this.oldCenter)&&(this.newCenter)&&(this.oldCenter.getX()!=this.newCenter.getX()||this.oldCenter.getY()!=this.newCenter.getY())){var g=this.getScreenXY(this.oldCenter.getX(),this.oldCenter.getY(),m);
var l=this.getScreenXY(this.newCenter.getX(),this.newCenter.getY(),m);var e=l.x-g.x;var n=l.y-g.y;var d=OM.util.DomUtil.getElementPos(this.tileLayer.jqLayerDiv);
this.tileLayer.jqLayerDiv.css({left:d.left-e,top:d.top-n});}},clearLastZoom:function(){for(var e=0;e<this.tileLayer.tileArray.length;
e++){for(var d=0;d<this.tileLayer.tileArray[e].length;d++){if(!this.hasTileLoaded(this.tileLayer.tileArray[e][d])){this.tileLayer.tileArray[e][d][0].src=OM.gv.transparentImg;
this.tileLayer.tileArray[e][d].imgLoadFinished=true;}}}for(var e=0;e<this.timeouts.length;e++){clearTimeout(this.timeouts[e]);
}this.timeouts=new Array();},showTiles:function(g,n,o,e){if(!this.tileLayer.isVisible()||this.tileLayer.tileArray==null||this.tileLayer.tileLayerConfig.isTransparentImage){this.reset();
return;}this.newCenter=e;this.oldCenter=o;this.zooming=true;this.zoomToNewCenter(g);this.computeTilesOffset();
var d=this.copyTiles();this.clearLastZoom();this.tileLayer.init();for(var m=0;m<this.tileArray.length;
m++){for(var l=0;l<this.tileArray[m].length;l++){if(d){this.initZoomInfo(g,n,this.tileArray[m][l]);}this.runZoom(this,m,l,null,d);
}}},reset:function(){this.ldiff=0;this.tdiff=0;if(this.animationLayerDiv&&this.animationLayerDiv.parent()){this.animationLayerDiv.remove();
}this.tileArray=null;this.animationLayerDiv=null;this.zoomStep=0.2;this.interval=100;this.zooming=false;
this.oldTilesLoaded=false;for(var d=0;d<this.timeouts.length;d++){clearTimeout(this.timeouts[d]);}this.timeouts=new Array();
if(this.tileLayer.isVisible()){this.tileLayer.init();}},tileInitialized:function(){if(this.hasTilesLoadFinished()){if(!this.zooming){var l=OM.event;
var g=new l.LayerEvent(l.LayerEvent.FINISH_LOAD,this.tileLayer);g.mapContext=this.tileLayer.parentMap.getMapContext();
this.tileLayer.fire(l.LayerEvent.FINISH_LOAD,g);}}else{var d=this;var e=setTimeout(function(){d.tileInitialized();
},70);this.timeouts.push(e);}},runZoom:function(e,n,m,l,d){var o=e.tileArray[n][m];if(d){l=(l)?l:e.zoomStep;
e.zoomToFactor(o,l);}if(l>=1){o.oldZoomInfo=null;o.zoomFinished=true;if(this.hasZoomFinished()){this.startClear();
}return;}else{var g=setTimeout(function(){e.runZoom.call(e,e,n,m,l+e.zoomStep,d);},e.interval);this.timeouts.push(g);
}},hasZoomFinished:function(){if(!(this.tileArray)){return true;}for(var e=0;e<this.tileArray.length;
e++){for(var d=0;d<this.tileArray[e].length;d++){if(!this.tileArray[e][d].zoomFinished){return false;
}}}return true;},hasTilesLoadFinished:function(){if(!(this.tileArray)&&!this.tileLayer.tileArray){return true;
}for(var e=0;e<this.tileLayer.tileArray.length;e++){for(var d=0;d<this.tileLayer.tileArray[e].length;
d++){if(!this.hasTileLoaded(this.tileLayer.tileArray[e][d])){return false;}}}return true;},hasTileLoaded:function(d){if(d[0].src==this.tileLayer.transImgURL){return true;
}if(OM.browser.msie){return d.imgLoadFinished;}else{return(d[0].offsetWidth==this.imageWidth);}},startClear:function(){if(OM.browser.msie){for(var e=0;
e<this.tileLayer.tileArray.length;e++){for(var d=0;d<this.tileLayer.tileArray[e].length;d++){this.tileLayer.tileArray[e][d].css("display","");
}}}this.animationLayerDiv.css("zIndex",this.tileLayer.zIndex);this.clearCloneTiles();},clearCloneTiles:function(){if(this.hasTilesLoadFinished()){for(var l=0;
l<this.tileLayer.tileArray.length;l++){for(var g=0;g<this.tileLayer.tileArray[l].length;g++){this.tileLayer.tileArray[l][g].css("display","");
}}this.removeCloneTiles();for(var l=0;l<this.timeouts.length;l++){clearTimeout(this.timeouts[l]);}this.timeouts=new Array();
var n=OM.event;var m=new n.LayerEvent(n.LayerEvent.FINISH_LOAD,this.tileLayer);m.mapContext=this.tileLayer.parentMap.getMapContext();
this.tileLayer.fire(n.LayerEvent.FINISH_LOAD,m);}else{var d=this;var e=setTimeout(function(){d.clearCloneTiles();
},70);this.timeouts.push(e);}},removeCloneTiles:function(){if(this.animationLayerDiv&&this.animationLayerDiv.parent()){this.animationLayerDiv.remove();
this.animationLayerDiv=null;}this.zooming=false;},scaleTiles:function(l){if(!this.scaling&&(!this.tileLayer.isVisible()||this.tileLayer.tileArray==null)){this.reset();
return;}if(!this.scaling){this.computeTilesOffset();this.copyTiles();this.scaling=true;for(var o=0;o<this.tileArray.length;
o++){for(var n=0;n<this.tileArray[o].length;n++){var t=this.tileArray[o][n];var r=OM.util.DomUtil.getElementPos(OM.$(t));
t.origLeft=r.left;t.origTop=r.top;}}}var e=this.tileLayer.tileLayerConfig;var q=e.tileImageWidth*l;var d=e.tileImageWidth*l;
var m=this.tileLayer.parentMap.getMapContext();var s=m.getDeviceWidth()/2+this.ldiff;var g=m.getDeviceHeight()/2+this.tdiff;
for(var o=0;o<this.tileArray.length;o++){for(var n=0;n<this.tileArray[o].length;n++){var t=this.tileArray[o][n];
this.scaleTile(t,l,q,d,s,g);}}},scaleTile:function(o,r,e,n,m,q){o.zoomFinished=true;if(r==1){return;}var d=m-(m-o.origLeft)*r;
var g=q-(q-o.origTop)*r;OM.$(o).css({left:d,top:g,width:(e+1),height:(n+1)});},endScaling:function(){this.scaling=false;
var o=this.tileLayer.jqLayerDiv;if(o){var d=OM.util.DomUtil.getElementPos(o);var l=d.left;var n=d.top;
var m=OM.util.DomUtil.getElementPos(o.parent().parent());var e=m.left;var g=m.Top;o.css({left:l+this.parentLeft,top:n+this.parentTop});
}this.startClear();},destroy:function(){this.tileLayer=null;}});OM.layer.Mesh=function(g,e,d,l){var n=g.zoomLevels[l];
this.mw=g.tileImageWidth*n.resolution;this.mh=g.tileImageHeight*n.resolution*n.stretchRatio;var m=g.bounds;
this.mX=Math.floor((e-m.getMinX())/this.mw);this.mY=Math.floor((d-m.getMinY())/this.mh);this.zoom=l;this.minX=this.mX*this.mw+m.getMinX();
this.minY=this.mY*this.mh+m.getMinY();};OM.layer.Mesh.prototype.moveMeshCode=function(e,d){this.mX=this.mX+e;
this.mY=this.mY+d;};OM.layer.VectorLayer=OM.layer.Layer.extend({initialize:function(g,e){if(!e||!e.def||e.def.type==undefined){throw new Error("Invalid or null VectorLayer options found.");
}this.options=e;this._super(this,g);this.layerType=OM.LayerTypes.VECTOR;this.dataCache=new OM.util.GeoDataCache(g);
this.cachingEnabled=false;this.dataLoaded=false;this.initError=false;this.name=g;var o=OM.layer.VectorLayer;
this.type=e.def.type;this.xRatio=2;this.yRatio=2;this.selectArray=[];this.flag=true;if(this.type==o.TYPE_PREDEFINED){this.dataSource=e.def.dataSource;
this.themeName=e.def.theme;if(e.def.url){this.serverURL=e.def.url;}this.loadOnDemand=e.def.loadOnDemand;
this.featureArray=[];}else{if(this.type==o.TYPE_LOCAL){this.featureArray=[];var d=e.def.features?e.def.features.length:0;
for(var n=0;n<d;n++){var m=e.def.features[n];if(this.isValidId(m.id)){this.featureArray.push(m);}else{OM.util.Logger.alert("MAPVIEWER-05508","OM.layer.VectorLayer");
return;}}}else{if(this.type==o.TYPE_JDBC){this.dataSource=e.def.dataSource;this.sql=e.def.sql;this.serverURL=e.def.url;
this.featureArray=[];this.geometryColumn=e.def.geometryColumn;this.labelColumn=e.def.labelColumn?e.def.labelColumn.toUpperCase():null;
this.keyColumn=e.def.keyColumn?e.def.keyColumn.toUpperCase():null;this.loadOnDemand=e.def.loadOnDemand;
}else{if(this.type==o.TYPE_DATAPACK){if(e.def.url){this.serverURL=e.def.url;}else{if(e.def.dataPackUrl){this.serverURL=e.def.dataPackUrl;
}else{this.serverURL="invalid url";}}this.featureArray=[];this.geometryColumn=e.def.geometryColumn;this.labelColumn=e.def.labelColumn?e.def.labelColumn.toUpperCase():null;
}else{if(this.type==o.TYPE_GEORSS){this.serverURL=e.def.url;}else{if(this.type==o.TYPE_WFS){}}}}}}if(e.renderingStyle&&e.renderingStyle.effects&&e.renderingStyle.effects.length>0){this.visualFilter=e.renderingStyle.effects[0];
}this.renderingStyle=e.renderingStyle;if(e.renderingStyle){var q=e.renderingStyle;if(!(q instanceof OM.style.Style)&&q.dataSource&&q.name){var l=this;
OM.style.StyleStore.getServerSideStyle(q.dataSource,q.name,{url:q.url,callback:function(r){l.renderingStyle=r;
}});}else{this.renderingStyle=q;}}this.styleAttributes=e.styleAttributes;this.boundingTheme=e.boundingTheme;
this.infoWindow=e.infoWindow==undefined?true:e.infoWindow;this.boundingZoomLevel=null;this.selectionEnable=false;
this.selectionMode=OM.layer.VectorLayer.SINGLE_SELECTION;this.bringToTopFlag=true;this.selectedFeatures=[];
this.featureEditable=false;this.hoverFeature=null;this.hoverStyle=null;this.hoverEnable=false;this.mapping=false;
this.showToolTip=true;},setRenderingStyle:function(o,l){if(!o){return;}if(!(o instanceof OM.style.Style)&&o&&o.dataSource&&o.name){var n=this;
if(o.effects&&o.effects.length>0){this.setVisualFilter(o.effects[0]);}this.loadingStyle=true;OM.style.StyleStore.getServerSideStyle(o.dataSource,o.name,{url:o.url,callback:function(r){n.setRenderingStyle(r,l);
n.loadingStyle=false;}});return;}var e=this.renderingStyle;var m=this.styleAttributes;this.renderingStyle=o;
this.heatMap=null;if(l){this.styleAttributes=l;if(o instanceof OM.style.BucketStyle){o.generateBuckets(this.featureArray,this.styleAttributes,false);
}}if(o.effects&&o.effects.length>0){this.setVisualFilter(o.effects[0]);}if(!this.visible&&this.displayed){this.parentMap.graphics.remove(this.realGroup);
this.clearFeatureShapes();this.displayed=false;}if(this.displayed){var d=this.featureArray?this.featureArray.length:0;
if(OM.util.Logger.DEBUG){console.time("setRenerdingStyle");}var g=this.parentMap.graphics;g.remove(this.realGroup);
this.clearFeatureShapes();this.displayFeatures(false);if(OM.util.Logger.DEBUG){console.timeEnd("setRenerdingStyle");
}if(this.getFeatureGeometryType()=="POINT"||this.renderingStyle.styleType=="PieChart"||this.renderingStyle.styleType=="BarChart"){this.parentMap.refreshVectorLayerLabels();
}}if(e!=o||!OM.util.MiscUtil.arraysAreEqual(m,this.styleAttributes)){var q=new OM.event.LayerEvent(OM.event.LayerEvent.RENDERING_STYLE_CHANGED,this);
q.newStyle=o;q.attributes=l;if(this.parentMap){q.mapContext=this.parentMap.getMapContext();}this.fire(OM.event.LayerEvent.RENDERING_STYLE_CHANGED,q);
}},getAllFeatures:function(){return this.featureArray;},size:function(){return(this.featureArray)?this.featureArray.length:0;
},getRenderingStyle:function(){return this.renderingStyle;},setLabelingStyle:function(m){if(!m){return;
}this.labelingStyle=m;this.setLabelsVisible(true);var e=OM.event.LayerEvent;var n=new e(e.LABELING_STYLE_CHANGED,this);
n.style=m;if(this.parentMap){n.mapContext=this.parentMap.getMapContext();}this.fire(e.LABELING_STYLE_CHANGED,n);
if(this.displayed){var d=this.featureArray?this.featureArray.length:0;for(var l=0;l<d;l++){var g=this.featureArray[l];
g.setLabelingStyle(this.labelingStyle);}this.parentMap.refreshVectorLayerLabels();}},getLabelingStyle:function(){return this.labelingStyle;
},setLabelColumn:function(d){this.labelColumn=d;},getLabelColumn:function(){return this.labelColumn;},getSelectedFeatures:function(){return this.selectedFeatures;
},setSelectStyle:function(g){if(g===null){return;}else{if(!(g instanceof OM.style.Style)&&g&&g.dataSource&&g.name){var e=this;
OM.style.StyleStore.getServerSideStyle(g.dataSource,g.name,{url:g.url,callback:function(m){e.setSelectStyle(m);
}});return;}}this.enableFeatureSelection(true);this.selectionStyle=g;if(g.effects&&g.effects.length>0){this.setSelectVisualFilter(g.effects[0]);
}var d=OM.event.LayerEvent;var l=new d(d.SELECTION_STYLE_CHANGED,this);l.style=g;if(this.parentMap){l.mapContext=this.parentMap.getMapContext();
}this.fire(d.SELECTION_STYLE_CHANGED,l);},setHoverStyle:function(g){if(g===null){return;}else{if(!(g instanceof OM.style.Style)&&g&&g.dataSource&&g.name){var e=this;
OM.style.StyleStore.getServerSideStyle(g.dataSource,g.name,{url:g.url,callback:function(m){e.setHoverStyle(m);
}});return;}}this.enableFeatureHover(true);if(g.effects&&g.effects.length>0){this.setHoverVisualFilter(g.effects[0]);
}this.hoverStyle=g;var d=OM.event.LayerEvent;var l=new d(d.SELECTION_STYLE_CHANGED,this);l.style=g;if(this.parentMap){l.mapContext=this.parentMap.getMapContext();
}this.fire(d.HOVER_STYLE_CHANGED,l);},setHoverVisualFilter:function(d){this.hoverFilter=d;},clearSelectedFeatures:function(){var d=this.selectedFeatures?this.selectedFeatures.length:0;
for(var g=d;g>0;g--){var e=this.selectedFeatures.pop();e.enableFeatureEditing(false);this.resetFeatureStates(e);
}},resetFeatureStates:function(e){e.selected=false;e.hover=false;if(e.selectShape){e.graphics.remove(e.selectShape);
e.selectShape=null;}if(e.hoverShape){e.graphics.remove(e.hoverShape);e.hoverShape=null;}e.setRenderingStyle(e.oldStyle);
var d=this.parentMap.graphics;if(this.graphicFilter&&!this.visualFilter.applyToLayer){d.applyStyle(e.shape,{filter:this.graphicFilter});
}else{d.applyStyle(e.shape,{filter:d.oui.FiltersEnum.NONE});}},selectFeature:function(m){if(!this.selectionEnable||(!this.selectionStyle&&!this.featureEditable)){return;
}var g;if(m.parentFeature){var d=m.parentFeature;d.parentLayer.selectFeature(d);return d;}if(!m.selected&&m.displayed){if(this.selectionMode===OM.layer.VectorLayer.SINGLE_SELECTION){this.clearSelectedFeatures();
}if(m.hoverShape){m.graphics.remove(m.hoverShape);m.hoverShape=null;}if(this.selectionStyle){if(!m.oldStyle){m.oldStyle=m.renderingStyle;
}if(this.selectionStyle.styleType=="PulseAnimation"||this.selectionStyle.styleType=="AnimationColor"){var e=m.shape;
m.displayFeature([this.selectionStyle]);m.selectShape=m.shape;m.shape=e;}else{var n=this.getHoverSelectStyle(this.selectionStyle,m.oldStyle);
m.setRenderingStyle(n);}}if(m.displayed){g=this.parentMap.graphics;if(this.selectVisualFilter){var q=g.getGraphicFilter(this.selectVisualFilter);
g.applyStyle(m.shape,{filter:q});}else{g.applyStyle(m.shape,{filter:g.oui.FiltersEnum.NONE});}m.startAnimation();
}if(this.featureEditable){m.enableFeatureEditing(true);}this.selectedFeatures.push(m);m.selected=true;
var l=OM.event.LayerEvent;var o=new l(l.FEATURE_SELECTED,this);o.selectedFeature=m;o.mapContext=this.parentMap.getMapContext();
this.fire(l.FEATURE_SELECTED,o);}else{this.deselectFeature(m);}return m;},hover:function(g){if(!this.hoverEnable){return null;
}if(g.hover||g.selected){return null;}this.deHover(this.hoverFeature);if(!g.oldStyle){g.oldStyle=g.renderingStyle;
}var m={};if(this.hoverStyle){if(this.hoverStyle.styleType=="PulseAnimation"||this.hoverStyle.styleType=="AnimationColor"){var e=g.shape;
g.displayFeature([this.hoverStyle]);g.hoverShape=g.shape;g.shape=e;}else{var l=this.getHoverSelectStyle(this.hoverStyle,g.oldStyle);
g.setRenderingStyle(l);}}if(g.displayed){if(this.hoverFilter){var d=this.parentMap.graphics.getGraphicFilter(this.hoverFilter);
this.parentMap.graphics.applyStyle(g.shape,{filter:d});}else{this.parentMap.graphics.applyStyle(g.shape,{filter:this.parentMap.graphics.oui.FiltersEnum.NONE});
}g.startAnimation();}this.hoverFeature=g;g.hover=true;return g;},deHover:function(e){if(!e||!e.hover){return;
}var g=e.selected;if(e.editable){return;}if(e.hoverShape){e.graphics.remove(e.hoverShape);e.hoverShape=null;
}else{if(g){}else{e.setRenderingStyle(e.oldStyle);if(e.displayed){var d=this.parentMap.graphics;if(this.graphicFilter&&!this.visualFilter.applyToLayer){d.applyStyle(e.shape,{filter:this.graphicFilter});
}else{d.applyStyle(e.shape,{filter:d.oui.FiltersEnum.NONE});}}}}if(this.hoverFeature){this.hoverFeature.hover=false;
this.hoverFeature=null;}},deselectFeature:function(q){if(q.selected){q.enableFeatureEditing(false);if(q.selectShape){q.graphics.remove(q.selectShape);
q.selectShape=null;}if(q.hover){if(this.hoverStyle){if(this.hoverStyle.styleType=="PulseAnimation"||this.hoverStyle.styleType=="AnimationColor"){var n=q.shape;
q.displayFeature([this.hoverStyle]);q.hoverShape=q.shape;q.shape=n;}else{var e=this.getHoverSelectStyle(this.hoverStyle,q.oldStyle);
q.setRenderingStyle(e);}}if(q.displayed){var o=this.parentMap.graphics;if(this.hoverFilter){var m=this.parentMap.graphics.getGraphicFilter(this.hoverFilter);
o.applyStyle(q.shape,{filter:this.hoverGraphicFilter});}else{o.applyStyle(q.shape,{filter:o.oui.FiltersEnum.NONE});
}q.startAnimation();}}else{if(q.oldStyle){q.setRenderingStyle(q.oldStyle);}if(q.displayed){var o=this.parentMap.graphics;
if(this.graphicFilter&&!this.visualFilter.applyToLayer){o.applyStyle(q.shape,{filter:this.graphicFilter});
}else{o.applyStyle(q.shape,{filter:o.oui.FiltersEnum.NONE});}}}q.selected=false;var g=this.selectedFeatures?this.selectedFeatures.length:0;
for(var l=0;l<g;l++){if(this.selectedFeatures[l]==q){this.selectedFeatures.splice(l,1);break;}}var r=OM.event.LayerEvent;
var d=new r(r.FEATURE_DESELECTED,this);d.deselectedFeature=q;d.mapContext=this.parentMap.getMapContext();
this.fire(r.FEATURE_DESELECTED,d);}return q;},enableFeatureSelection:function(d,e){this.selectionEnable=d;
if(d){if(e==OM.layer.VectorLayer.MULTIPLE_SELECTION||e==OM.layer.VectorLayer.SINGLE_SELECTION){this.selectionMode=e;
}else{this.selectionMode=OM.layer.VectorLayer.SINGLE_SELECTION;}}},enableFeatureHover:function(d){this.hoverEnable=d;
},enableFeatureEditing:function(e){if(this.featureEditable==e){return;}this.featureEditable=e;if(e){this.selectionEnable=true;
return;}if(this.selectedFeatures){var d=this.selectedFeatures.length;for(var g=0;g<d;g++){this.selectedFeatures[g].enableFeatureEditing(false);
}}},enableCaching:function(g,e){var d=this.cachingEnabled;this.cachingEnabled=g;if(d&&!this.cachingEnabled){if(this.dataCache){this.dataCache.destroy();
}}},isFeatureEditable:function(){return this.featureEditable;},enableInfoWindow:function(d){this.infoWindow=d;
},setBoundingTheme:function(d){this.boundingTheme=d;},zoomToTheme:function(){var d=this.parentMap.getMapContext().getUniverse().getSRID();
var e=this;this.loadBoundingTheme(function(n,m,r,q){var l=e.calculateCenterAndZoomLevel(n,m,r,q);if(l&&l.length>1){var o=l[0];
var g=l[1];e.parentMap.setMapCenterAndZoomLevel(g,o);}});},centerToTheme:function(){var d=this.parentMap.getMapContext().getUniverse().getSRID();
var e=this;this.loadBoundingTheme(function(n,m,q,o){var l=e.calculateCenterAndZoomLevel(n,m,q,o);if(l&&l.length>1){var g=l[1];
e.parentMap.setMapCenter(g);}});},setBringToTopOnMouseOver:function(d){this.bringToTopFlag=d;},getFeatureGeometryType:function(){if(this.type==OM.layer.VectorLayer.TYPE_LOCAL){}else{if(this.featureArray&&this.featureArray.length>0){var d=this.featureArray[0].geo;
if(d.type=="Point"||d.type=="OrientedPoint"||d.type=="MultiPoint"||d.type=="OrientedMultiPoint"){return"POINT";
}else{if(d.type=="LineString"||d.type=="MultiLineString"){return"LINESTRING";}else{if(d.type=="Polygon"||d.type=="MultiPolygon"){return"POLYGON";
}}}}}return"";},setSelectVisualFilter:function(d){this.selectVisualFilter=d;},setVisualFilter:function(l){this.visualFilter=l;
if(this.displayed&&this.visualFilter){this.graphicFilter=this.parentMap.graphics.getGraphicFilter(this.visualFilter);
if(this.visualFilter.applyToLayer){this.parentMap.graphics.applyStyle(this.realGroup,{filter:this.graphicFilter});
}else{var d=this.featureArray?this.featureArray.length:0;for(var g=0;g<d;g++){var e=this.featureArray[g];
if(e.shape){this.parentMap.graphics.applyStyle(e.shape,{filter:this.graphicFilter});}}}}else{if(this.displayed&&this.visualFilter==null){this.graphicFilter=null;
this.parentMap.graphics.applyStyle(this.realGroup,{filter:this.parentMap.graphics.oui.FiltersEnum.NONE});
}}},getSelectVisualFilter:function(){return this.selectVisualFilter;},getVisualFilter:function(){return this.visualFilter;
},setLabelsVisible:function(d){this.showLables=d;},labelsVisible:function(){return this.showLables;},getExtent:function(){if(!this.mbr){var q=this.featureArray?this.featureArray.length:0;
var n=null;var l=null;var e=null;var d=null;var g=function(u){var z=u.getMBR();var t=z.getMinX();var w=z.getMinY();
var A=z.getMaxX();var s=z.getMaxY();n=(n==null||t<n)?t:n;l=(l==null||w<l)?w:l;e=(e==null||A>e)?A:e;d=(d==null||s>d)?s:d;
};var m=this.parentMap.getMapContext().getUniverse().getSRID();for(var o=0;o<q;o++){var r=this.featureArray[o].geo;
if(m!=r.srid){r.transform(m,function(s){feature.geo=s;comparem(s);});}else{g(r);}}this.mbr=new OM.geometry.Rectangle(n,l,e,d,m);
}return this.mbr;},getAttributeNames:function(){return this.attrNames;},setNSDP:function(d){if(!d){return;
}this.clearNSDP();this.nsdpKey=d.keyColumn;this.nsdpKey=this.nsdpKey.toUpperCase();this.nsdp=d;if(this.nsdp.ignoreCase==undefined){this.nsdp.ignoreCase=true;
}var g=this;var e=function(m){OM.util.Logger.finest("parsing NSDP data...");var l=null;if(typeof m==="string"){m=OM.$.trim(m);
var n=OM.$.parseXML(m);l=OM.$(n);}else{l=OM.$(m);}g.nsdpTitleArray=[];l.find("th").each(function(){var o=OM.$(this);
var q=o.text();g.nsdpTitleArray.push(q);});g.nsdpData=new Object();l.find("tr").each(function(){var r=OM.$(this);
var o=0;var q=null;var s=new Object();r.find("td").each(function(){if(o==0){q=OM.$(this).text();}else{var t=g.nsdpTitleArray[o].toUpperCase();
s[t]=OM.$(this).text();}o++;});if(q){q=g.nsdp.ignoreCase?q.toUpperCase():q;g.nsdpData[q]=s;}});if(g.displayed){if(g.renderingStyle instanceof OM.style.BucketStyle){g.renderingStyle.clearBuckets();
}g.redraw();}};if(d&&d.url){OM.$.get(d.url,null,function(l){e(l);});}else{if(d&&d.xml){e(OM.util.XMLUtil.parse(d.xml));
}}},applyFilter:function(e,d){if(d==undefined||d==true){if(e.filterMode==OM.filter.Filter.CLIENT_SIDE){if(!this.filterArray){this.filterArray=[];
}this.filterArray.push(e);this.replace=false;this.doFilter();this.loadOnDemand=false;return this;}else{}}else{if(e.filterMode==OM.filter.Filter.CLIENT_SIDE){var g=this.clone();
g.loadOnDemand=false;g.filterArray=this.filterArray?OM.$.extend([],this.filterArray):[];g.filterArray.push(e);
this.replace=false;g.doFilter();return g;}else{}}},removeFilter:function(e){if(this.filterArray){for(var d=this.filterArray.length;
d>-1;d--){if(e==this.filterArray[d]){this.filterArray.splice(d,1);break;}}}},removeFilterAll:function(){this.filterArray=new Array();
},doFilter:function(d,o){if((!this.filterArray||this.filterArray.length===0)&&(!o)){return;}var e=this.filterArray;
if(this.replace){e=[o];}for(var m=0;m<e.length;m++){var n=e[m];if(d){if(!n.evaluate(d)){return true;}}else{if(!this.featureArray||this.featureArray.length===0){return;
}else{for(var g=this.featureArray.length-1;g>-1;g--){var l=this.featureArray[g];if(this.replace&&l.selected){continue;
}if(n.evaluate(l)){if(this.replace){this.selectFeature(l);}}else{if(!this.replace){this.removeFeature(l);
}}}}}}},selectFeatureByFilter:function(d){if(!d){return;}this.enableFeatureSelection(true,OM.layer.VectorLayer.MULTIPLE_SELECTION);
if(d.filterMode==OM.filter.Filter.CLIENT_SIDE){this.replace=true;this.doFilter(null,d);this.replace=false;
this.loadOnDemand=false;return this;}},addFeature:function(g){if(this.doFilter(g)){return;}if(!this.featureArray){this.featureArray=new Array(g);
}else{if(this.isValidId(g.id)){this.featureArray.push(g);if(this.displayed){var e=g.geo;var m=this;var l=function(o){var q=o.getMBR();
var n=m.parentMap.getMapZoomLevel();if(m.clustering&&n<=m.maxClusteringLevel){m.vCluster.addFeature(g);
}if(!g.displayed){if(m.realGroup==null){m.realGroup=m.parentMap.graphics.createGroup();m.realGroup.applyStyle({cursor:OM.CursorTypes.POINTER});
m.group.appendChild(m.realGroup);}g.group=m.realGroup;g.screenTransformObj=m.parentMap.getMapContext().getTransform();
g.graphics=m.parentMap.graphics;g.parentLayer=m;m.display(g,q);}};var d=this.parentMap.getMapContext().getUniverse().getSRID();
if(d!=e.srid){e.transform(d,l);}else{l(e);}if(this.labelsVisible&&g.label){this.parentMap.refreshVectorLayerLabels();
}}}else{OM.util.Logger.alert("MAPVIEWER-05508","OM.layer.VectorLayer.addFeature");}}},addFeatures:function(g){if(!this.featureArray){this.featureArray=new Array(feature);
}var d=g?g.length:0;for(var e=0;e<d;e++){if(this.isValidId(g[e].id)&&!this.doFilter(g[e])){this.featureArray.push(g[e]);
}else{OM.util.Logger.alert("MAPVIEWER-05508","OM.layer.VectorLayer.addFeatures");return;}}},clearFeature:function(g){if(this.parentMap){var l=this.name+"_"+g.id;
this.parentMap.deleteFeatureInfoWindow(l);}g.clearAnimation();g.animations=null;if(g.moveAnimation){g.moveAnimation.pauseMoveAnimation();
}if(g.selected){this.deselectFeature(g);}if(g.shape){g.shape.feature=null;this.parentMap.graphics.remove(g.shape);
g.shape=null;}if(g.shapeGroup){var e=g.shapeGroup.length;for(var d=1;d<e;d++){g.shapeGroup[d].feature=null;
this.parentMap.graphics.remove(g.shapeGroup[d]);}g.shapeGroup=null;}if(g.labelShape){g.labelShape.feature=null;
this.parentMap.graphics.remove(g.labelShape);}g.group=null;g.screenTransformObj=null;g.graphics=null;
g.parentLayer=null;g.displayed=false;},removeFeature:function(l){var d;var g;var e=this.parentMap.getDefaultFeatureLayer();
if(l&&l.editable&&l.featureEditingProperties){var m=l.featureEditingProperties;e.removeFeature(m.bgFeature);
m.bgFeature=null;d=m.shapePoints.length;for(g=0;g<d;g++){e.removeFeature(m.shapePoints[g]);}m.shapePoints=[];
d=m.possiblePoints.length;for(g=0;g<d;g++){e.removeFeature(m.possiblePoints[g]);}m.possiblePoints=[];
}d=this.featureArray?this.featureArray.length:0;for(g=0;g<d;g++){if(this.featureArray[g]==l){this.featureArray.splice(g,1);
this.clearFeature(l);return l;}}return null;},removeAllFeatures:function(){var d=this.featureArray?this.featureArray.length:0;
this.parentMap.graphics.clearGroup(this.group);for(var g=d-1;g>=0;g--){var e=this.featureArray.pop();
this.clearFeature(e);}this.realGroup=null;this.featureArray=new Array();return d;},init:function(r){var l=this.parentMap.getMapContext();
var q=l.getUniverse();var u=l.getDeviceWidth();var n=l.getDeviceHeight();if(!this.serverURL&&(this.type==OM.layer.VectorLayer.TYPE_JDBC||this.type==OM.layer.VectorLayer.TYPE_PREDEFINED)){this.serverURL=this.parentMap.mapviewerURL;
}var s=this.parentMap.graphics;if(this.group){this.clearFeatureShapes();}this.group=s.createGroup({opacity:this.opacity,visibility:"visible"});
this.parentMap.draggableGroup.appendChild(this.group);var d=OM.event.MouseEvent;var o=this;o.timeStamp=0;
var t=function(w){var A=o.getTargetFeature(w.target);var D=o.parentMap.getMapContext();if(A!=undefined){var E=OM.event.MouseEvent;
var z=w.type;if(z==E.MOUSE_CLICK&&w.button==2||z==E.TOUCH_LONG_PRESS){z=E.MOUSE_RIGHT_CLICK;}else{if(z==E.TOUCH_TAP){z=E.MOUSE_CLICK;
}}if(!o.parentMap.enableMapAction.mouse){return;}var C=new E(z,A);C.evt=w;C.mapContext=D;A.fire(z,C);
C=new E(z,o);C.evt=w;C.feature=A;if((z==E.MOUSE_OVER||z==E.MOUSE_OUT)&&w.relatedTarget!=null){var B=o.getTargetFeature(w.relatedTarget);
if(A==B){return;}}if(z==E.MOUSE_OVER){if(o.bringToTopFlag){A.bringToTop();}if(o.hoverEnable){o.hover(A);
}}else{if(z==E.MOUSE_OUT){if(o.hoverEnable){o.deHover(A);}if(o.bringToTopFlag){A.sendBackward();}}else{if(z==E.MOUSE_CLICK||z==E.TOUCH_TAP){if(o.selectionEnable&&!A.cluster){o.selectFeature(A);
}if(o.infoWindow&&!A.cluster&&!o.featureEditable){o.showInfoWindow(A);}if(o.featureEditable){w.stopPropagation();
}if(A.parentFeature&&A.parentFeature.getGeometry().type==="OrientedPoint"){var e=A.parentFeature;e.parentLayer.deselectFeature(e);
}}else{if(z==E.TOUCH_END&&o.parentMap.enableMapAction.mouse){o.endFeatureDragging(w);w.stopPropagation();
}}}}C.mapContext=D;o.fire(z,C);}};s.attachEventListener(d.MOUSE_OVER,t,this.group);s.attachEventListener(d.MOUSE_OUT,t,this.group);
var m=function(e){if(e.button==2){return;}o.lastMouseDown=o.parentMap.getCursorLocation();var z=o.getTargetFeature(e.target);
if(!z){return;}var w=e.type;if(z&&z.editable){o.focusFeature=z;z.startDrag(e,true);}else{if(z&&z.parentFeature!=null){o.focusFeature=z.parentFeature;
z.parentFeature.startDrag(e,false);}}var B=o.parentMap.getMapContext();var A=new OM.event.MouseEvent(w,z);
A.evt=e;A.mapContext=B;z.fire(w,A);A=new OM.event.MouseEvent(w,o);A.evt=e;A.feature=z;o.fire(w,A);};if(OM.browser.touchSupported){s.attachEventListener(d.TOUCH_TAP,t,this.group);
s.attachEventListener(d.TOUCH_LONG_PRESS,t,this.group);s.attachEventListener(d.TOUCH_END,t,this.group);
s.attachEventListener(d.TOUCH_START,function(A){A.preventDefault();var z=OM.util.DomUtil;var w=z.getTouchCount(A);
if(w==1){A.button=0;var B=z.getTouchesClientPosition(A);A.clientX=B.x;A.clientY=B.y;m(A);}},this.group);
}else{s.attachEventListener(d.MOUSE_CLICK,t,this.group);s.attachEventListener(d.MOUSE_RIGHT_CLICK,t,this.group);
s.attachEventListener(d.MOUSE_UP,t,this.group);s.attachEventListener(d.MOUSE_DOWN,t,this.group);s.attachEventListener(OM.event.MouseEvent.MOUSE_DOWN,m,this.group);
}o.draggingFeature=function(e){if(o.focusFeature!=null){o.focusFeature.featureDragging(e);}};if(!OM.browser.touchSupported){this.parentMap.$oracleMapDiv.mousemove(o.draggingFeature);
}else{this.parentMap.$oracleMapDiv.bind("touchmove",function(w){w.preventDefault();w.stopPropagation();
var z=OM.util.DomUtil.getTouchesPosition(w);w.pageX=z.x;w.pageY=z.y;o.draggingFeature(w);});}o.endFeatureDragging=function(w){if(o.focusFeature!=null){var e=o.focusFeature;
if(e.endDragOrietation){w.focusFeature=e;e.endDragOrietation(w);}else{var A=e.endDrag(w);var z=o.focusFeature.geo.type;
}o.focusFeature=null;}};if(!OM.browser.touchSupported){OM.$(document).mouseup(o.endFeatureDragging);OM.$(document).mouseout(o.endFeatureDragging);
}else{this.parentMap.$oracleMapDiv.bind("touchend",function(w){w.preventDefault();w.stopPropagation();
var z=OM.util.DomUtil.getTouchesPosition(w);w.pageX=z.x;w.pageY=z.y;o.endFeatureDragging(w);});}this.orgWidth=u;
this.orgHeight=n;if((this.type==OM.layer.VectorLayer.TYPE_PREDEFINED||this.type==OM.layer.VectorLayer.TYPE_JDBC||this.type==OM.layer.VectorLayer.TYPE_DATAPACK||this.type==OM.layer.VectorLayer.TYPE_GEORSS)&&!(this.boundingTheme&&this.loadedBoundingTheme)){this.setWindow();
this.refreshImpl();}else{this.setWindow();if(!this.checkVisible()){var g=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_LOAD,this);
g.mapContext=this.parentMap.getMapContext();this.fire(OM.event.LayerEvent.FINISH_LOAD,g);return;}this.displayFeatures();
}},setWindow:function(){var l=this.parentMap.getMapContext();var s=l.getUniverse();var n=s.getZoomLevels();
if(!n){return;}var e=n[l.getZoomLevel()];var g=s.bound;this.minX=g.getMinX();this.minY=g.getMinY();this.windowW=g.getWidth();
this.windowH=g.getHeight();var t=this.parentMap.graphics;var r=t.getLeftTop(this.parentMap.draggableGroup);
this.orgDraggbleGroupPos=r;var d=l.getCenterPoint();var q=(d.getX()-this.minX)/e.resolution;var m=(this.minY+this.windowH-d.getY())/e.resolution/e.stretchRatio;
this.left=parseInt(this.orgWidth/2-r.x-q);this.top=parseInt(this.orgHeight/2-r.y-m);this.parentMap.graphics.setLeftTop(this.group,this.left,this.top);
var u=this.orgWidth*this.xRatio*e.resolution;var o=this.orgHeight*this.yRatio*e.resolution*e.stretchRatio;
this.dataBufferWindow={x:d.getX()-u/2,y:d.getY()-o/2,w:u,h:o};},refresh:function(g,d){if(d==undefined){d=true;
}this._super(g,d);this.reloadNumber=Math.round(Math.random()*10000000000);this.refreshImpl(g,d);},refreshImpl:function(u,g){if(this.group==null){return;
}if(g){this.loaded=false;this.parentMap.showLoadingIcon(true);this.clearFeatureShapes();this.clearAllLabels();
this.dataLoaded=false;}else{if((u&&u.beforeZoomLevel!=null&&u.afterZoomLevel!=null&&u.beforeZoomLevel!=u.afterZoomLevel)){this.setWindow();
}else{if(this.loadOnDemand){this.loaded=false;this.parentMap.showLoadingIcon(true);this.clearFeatureShapes();
this.clearAllLabels();this.dataLoaded=false;}else{this.clearAllLabels();}}}if(!this.checkVisible()){var l=OM.event;
var o=new l.MapEvent(l.LayerEvent.FINISH_LOAD,this);o.mapContext=this.parentMap.getMapContext();this.fire(l.LayerEvent.FINISH_LOAD,o);
return;}var z=this.parentMap.getMapContext();var n=z.getUniverse();var E=n.getZoomLevels();var r=E[z.getZoomLevel()];
var D=z.getCenterPoint();var m=this.orgWidth*this.xRatio*r.resolution;var q=this.orgHeight*this.yRatio*r.resolution*r.stretchRatio;
this.dataBufferWindow={x:D.getX()-m/2,y:D.getY()-q/2,w:m,h:q};var F=this;var s=n.getSRID();var d=null;
if(this.loadOnDemand){var C=this.visibleBound?Math.max(this.dataBufferWindow.x,this.visibleBound.getMinX()):this.dataBufferWindow.x;
var A=this.visibleBound?Math.max(this.dataBufferWindow.y,this.visibleBound.getMinY()):this.dataBufferWindow.y;
var B=this.visibleBound?Math.min(this.dataBufferWindow.x+m,this.visibleBound.getMaxX()):this.dataBufferWindow.x+m;
var t=this.visibleBound?Math.min(this.dataBufferWindow.y+q,this.visibleBound.getMaxY()):this.dataBufferWindow.y+q;
d=new OM.geometry.Rectangle(C,A,B,t,s);}if(this.loadOnDemand||!this.dataLoaded&&this.type!=OM.layer.VectorLayer.TYPE_LOCAL){this.getThemeData(d,function(){F.mapping=false;
if(F.renderingStyle instanceof OM.style.BucketStyle){F.renderingStyle.generateBuckets(this.featureArray,this.styleAttributes,false);
}F.displayFeatures(g);});}else{this.displayFeatures(g);}},delayDisplayFeatures:function(g){var e=this;
var d=function(l){if(e.loadingStyle){setTimeout(d,100,l);}else{e.displayFeatures(l);}};d();},displayFeatures:function(g){if(this.loadingStyle){this.delayDisplayFeatures(g);
return;}this.loading=true;this.loaded=false;this.displayCount=0;if(this.visualFilter){this.graphicFilter=this.parentMap.graphics.getGraphicFilter(this.visualFilter);
}var m=this;var d=this.parentMap.graphics;var l=false;if(this.realGroup==null){l=true;this.realGroup=d.createGroup();
this.realGroup.applyStyle({cursor:OM.CursorTypes.POINTER});}if(this.graphicFilter&&this.visualFilter.applyToLayer){this.parentMap.graphics.applyStyle(this.realGroup,{filter:this.graphicFilter});
}if(this.renderingStyle&&this.renderingStyle.styleType=="HeatMap"){this.displayHeatMap();return;}var e=this.parentMap.getMapZoomLevel();
if(this.clustering&&e<=this.maxClusteringLevel){this.vCluster.displayAsCluster(this.dataBufferWindow);
}this.mappingNSDP();this.displayBatch(0,l,this,g);},displayBatch:function(d,t,m,u){if(!m.group){return;
}if(m.renderingStyle&&m.renderingStyle instanceof OM.style.BucketStyle&&(!m.styleAttributes||m.styleAttributes.length==0)&&(!m.nsdpTitleArray||m.nsdpTitleArray.length<2)){OM.util.Logger.warning(null,"OM.layer.VectorLayer.displayBatch","Must specify style attributes for bucket style");
}var o;var n=m.featureArray?m.featureArray.length:0;var e=m.parentMap.getMapContext().getUniverse().getSRID();
for(var l=d;l<n;l++){var w=m.featureArray[l];if(w.displayed){continue;}if(m.enableBatch){m.displayCount++;
if(m.displayCount>m.numberInBatch){if(t){m.group.appendChild(m.realGroup);}else{for(var g=d;g<=l;g++){var w=m.featureArray[g];
if(w.displayed){w.startAnimation();}}}m.displayCount=0;var s=m.displayBatch;var r=function(){s(l,false,m,u);
};window.setTimeout(r,m.batchInterval);return;}}var q=w.geo;if(e!==q.srid){(function(C){var z=C.getGeometry();
z.transform(e,function(D){var E=D.getMBR();C.srid=e;C.geo=D;m.display(C,E);});if(w.labelBox){var B=C.labelBox;
var A=new OM.geometry.Rectangle(B[0],B[1],B[2],B[3],z.srid);A.transform(e,function(D){C.labelBox=[D.getMinX(),D.getMinY(),D.getMaxX(),D.getMaxY()];
});}})(w);}else{if(this.type!==OM.layer.VectorLayer.TYPE_LOCAL){o=null;if(!m.loadOnDemand){if(!q.mbr){if(q.coordinates){o=OM.geometry.Geometry.calculateMBR(q.coordinates,q.type);
}else{o=OM.geometry.Geometry.calculateGeomCollectionMBR(q.geometries,q.type);}q.mbr=new OM.geometry.Rectangle(o.minX,o.minY,o.maxX,o.maxY,q.srid);
}}m.display(w,q.mbr);}else{o=q.getMBR();m.display(w,o);}}}m.displayed=true;if(OM.util.Logger.DEBUG){console.timeEnd("["+this.name+"] displayFeatures");
}if(t){m.group.appendChild(m.realGroup);}for(var l=d;l<n;l++){var w=m.featureArray[l];if(w.displayed){w.startAnimation();
}}m.displayEnd(u);},displayEnd:function(g){if(OM.util.Logger.DEBUG){console.timeEnd("["+this.name+"] displayFeatures-complete");
}this.loading=false;var d=OM.event.LayerEvent;var e=this.parentMap.getMapContext();var l=new d(d.FINISH_LOAD,this);
l.mapContext=e;this.fire(d.FINISH_LOAD,l);l=new d(d.FEATURES_DISPLAYED,this);l.mapContext=e;this.fire(d.FEATURES_DISPLAYED);
if(g){l=new d(d.FEATURES_DISPLAYED,this);l.mapContext=this.parentMap.getMapContext();this.fire(d.AFTER_REFRESH,l);
}},display:function(u,q){var o=this.dataBufferWindow;if(q!=null&&(q.getMaxX()<o.x||q.getMaxY()<o.y||q.getMinX()>o.x+o.w||q.getMinY()>o.y+o.h)){return;
}if(q!=null&&this.visibleBound&&(q.getMinX()>this.visibleBound.getMaxX()||q.getMinY()>this.visibleBound.getMaxY()||q.getMaxX()<this.visibleBound.getMinX()||q.getMaxY()<this.visibleBound.getMinY())){return;
}if(this.mapping&&!u.mapping&&!this.nsdp.fullDisplay){return;}u.group=this.realGroup;u.screenTransformObj=this.parentMap.getMapContext().getTransform();
u.screenPoints=null;u.graphics=this.graphics?this.graphics:this.parentMap.graphics;u.parentLayer=this;
var r=u.geo;var d=null;if(this.renderingStyle){d=this.renderingStyle;}else{if(u.styleName){d=OM.style.StyleStore.getServerSideStyle(this.dataSource,u.styleName);
}else{d=u.renderingStyle;}}if(this.loadOnDemand){var m=this.selectedFeatures.length;for(var g=0;g<m;g++){if(this.selectedFeatures[g].id==u.id){u.selected=true;
this.selectedFeatures[g]=u;}}}if(d&&d.stylelist&&d.stylelist.length>1){u.lineGroup=this.getLineGroup();
}d=this.resolveStyle(u,d);u.oldStyle=null;u.hover=false;if(u.selected){u.oldStyle=d;if(u.selected&&this.selectionStyle){var e={};
if(this.selectionStyle.styleType=="PulseAnimation"||this.selectionStyle.styleType=="AnimationColor"){var n=u.shape;
u.displayFeature([this.selectionStyle]);u.selectShape=u.shape;u.shape=n;e=u.oldStyle;}else{e=this.getHoverSelectStyle(this.selectionStyle,u.oldStyle);
}d=e;}}if(d!=null){u.setRenderingStyle(d);d=[d];}else{d=[];}if(this.otherStyles){d=d.concat(this.otherStyles);
}if(d.length==0){return;}if(this.labelingStyle){u.setLabelingStyle(this.labelingStyle);}else{if(!u.labelStyle&&u.labelStyleName){var t=OM.style.StyleStore.getServerSideStyle(this.dataSource,u.labelStyleName);
u.setLabelingStyle(t);}}var l=this;var s=function(){if(d[0].styleType=="Marker"&&d[0].src&&(d[0].width==null||d[0].height==null)){setTimeout(s,300);
}else{u.displayFeature(d);if(l.selectVisualFilter&&u.selected){var w=l.parentMap.graphics.getGraphicFilter(l.selectVisualFilter);
l.parentMap.graphics.applyStyle(u.shape,{filter:w});}else{if(l.graphicFilter&&!l.visualFilter.applyToLayer&&u.shape){l.parentMap.graphics.applyStyle(u.shape,{filter:this.graphicFilter});
}}}};s();},mappingNSDP:function(){if(this.nsdpTitleArray&&!this.mapping){if(this.attrNames){if(this.nsdpTitleArray[0].toUpperCase()==this.nsdpKey){this.nsdpTitleArray.shift();
}this.attrNames=this.attrNames.concat(this.nsdpTitleArray);}else{if(this.nsdpTitleArray[0].toUpperCase()==this.nsdpKey){this.attrNames=this.nsdpTitleArray.slice(1);
}}}if(this.nsdpData&&this.nsdpKey&&!this.mapping){var e=this.featureArray?this.featureArray.length:0;
for(var m=0;m<e;m++){var l=this.featureArray[m];var q=l.attributes[this.nsdpKey];q=this.nsdp.ignoreCase?q.toUpperCase():q;
var d=this.nsdpData[q];if(d!=null){OM.$.extend(l.attributes,d);l.columns=new Array();for(var o in d){l.columns.push(o);
}l.mapping=true;}else{l.mapping=false;}}this.mapping=true;var g=OM.event.LayerEvent;var n=new g(g.NSDP_MAPPED,this);
this.fire(g.NSDP_MAPPED,n);}},clearNSDP:function(){if(!this.nsdpTitleArray){return;}var g=this.nsdpTitleArray.length;
var n=this.attrNames.length;this.attrNames.splice(n-g,g);if(this.nsdpData&&this.mapping){var d=this.featureArray?this.featureArray.length:0;
for(var m=0;m<d;m++){var l=this.featureArray[m];if(l.mapping){for(var e=0;e<g;e++){l.attributes[this.nsdpTitleArray[e]]=null;
}}l.mapping=false;}this.mapping=false;}},isValidId:function(g){var d=this.featureArray?this.featureArray.length:0;
for(var e=0;e<d;e++){if(this.featureArray[e].id==g){return false;}}return true;},getFeature:function(g){var d=this.featureArray?this.featureArray.length:0;
for(var e=0;e<d;e++){if(this.featureArray[e].id==g){return this.featureArray[e];}}return null;},getFeaturesByAttribute:function(q,u){var n,m,o,e,t=false,d,s,r;
var l=this.featureArray?this.featureArray.length:0;if(l===0){return null;}q=q.toUpperCase();o=this.getAttributeNames();
o.forEach(function(w){if(q===w){t=true;}});if(!t){return null;}var g=(u instanceof Array);if(g){r=u.length;
}n=[];for(e=0;e<l;e++){m=this.featureArray[e];s=m.getAttributeValue(q);if(!s){continue;}if(g){for(d=0;
d<r;d++){if(u[d]===s){n.push(m);}}}else{}}return n;},getAllThemeData:function(e,d){this.getThemeData(null,e,d);
},getThemeData:function(t,s,l){if(this.usedInOverview){return;}if(this.initError){s();return;}if(this.type==OM.layer.VectorLayer.TYPE_GEORSS){this.getGeoRss(t,s,l);
return;}if(this.type!=OM.layer.VectorLayer.TYPE_LOCAL&&this.loadOnDemand&&this.sessionId==null){this.getSessionId(t,s);
return;}if(this.getDataRequest!=null){this.getDataRequest.abort();}this.loading=true;var n=this;var d=this.serverURL;
if(this.type!==OM.layer.VectorLayer.TYPE_DATAPACK){d+="/dataserver/"+this.dataSource;}var g=new Object();
if(this.type==OM.layer.VectorLayer.TYPE_PREDEFINED){g.t=this.themeName;}else{if(this.type==OM.layer.VectorLayer.TYPE_JDBC){g.t=this.name;
g.sql=this.sql;if(this.keyColumn){g.id_col=this.keyColumn;}}}if(t){g.bbox=t.getMinX()+","+t.getMinY()+","+t.getMaxX()+","+t.getMaxY();
}var e=OM.util.HttpRequest.getDomain(this.serverURL);if(!e){e=OM.util.HttpRequest.localDomain;}var q=OM.gv.mvKeyMap[e];
if(q){g.key=q;}if(this.type!==OM.layer.VectorLayer.TYPE_DATAPACK){g.include_label_box="true";var r=null;
if(this.parentMap){r=this.parentMap.getMapContext().getUniverse().getSRID();}if(r){g.to_srid=r;g.bbox_srid=r;
}if(this.sessionId){g.ssid=this.sessionId;}}g.refresh=Math.round(Math.random()*100000);var o=n.type===OM.layer.VectorLayer.TYPE_DATAPACK?true:false;
var m=function(z,B,A){n.initError=true;n.getDataRequest=null;if(z){OM.util.Logger.alert("MAPVIEWER-05511","OM.layer.VectorLayer.getThemeData",z.responseText);
}if(l){l();}var w=OM.event;var u=new w.LayerEvent(w.LayerEvent.INIT_ERROR,n);u.mapContext=n.parentMap.getMapContext();
n.fire(w.LayerEvent.INIT_ERROR,u);return;};this.getDataRequest=OM.util.HttpRequest.send(d,g,function(H){if(H.error){var w=H.error.code;
var C=H.error.message;var P=H.error.details;n.dataLoaded=false;OM.util.Logger.alert(w,"OM.layer.VectorLayer.getThemeData",C);
m();return;}n.getDataRequest=null;var N=H.srs;var u=H.bbox;if(u){var B=new OM.geometry.Rectangle(u[0],u[1],u[2],u[3],N);
var R=n.parentMap.getMapContext().getUniverse().getSRID();if(N!==R){var I=new OM.geometry.LineString([u[0],u[1],u[2],u[3]],N);
I.transform(R,function(S){var T=S.coordinates;n.mbr=new OM.geometry.Rectangle(T[0],T[1],T[2],T[3],N);
u=[T[0],T[1],T[2],T[3]];});}else{n.mbr=B;}}var E=H.features;var M=E.length;var Q=new Object();var F=0;
n.featureArray=new Array();n.mapping=false;n.attrNames=H.attr_names;for(var L=0;L<M;L++){var J=E[L];var G=J.geometry;
var K=(typeof J._id!=="undefined")?J._id:L;G.srid=N;var D=new OM.Feature(K,G,{attributes:J.properties});
D.srid=N;if(n.doFilter(D)){continue;}D.labelBox=J.label_box;var z=function(S){if(!Q[S]){Q[S]=S;F++;OM.style.StyleStore.getServerSideStyle(n.dataSource,S,{url:n.serverURL,callback:function(T){F--;
}});}};if(n.type!==OM.layer.VectorLayer.TYPE_DATAPACK){if(J.styles&&J.styles.rendering&&J.styles.rendering.style){if(J.styles&&J.styles.rendering&&J.styles.rendering.columns){D.columns=J.styles.rendering.columns;
}var A=J.styles.rendering.style;D.styleName=A;z(A);}if(J.styles&&J.styles.labeling&&J.styles.labeling.style){if(J.styles&&J.styles.labeling&&J.styles.labeling.columns){D.labelColumn=J.styles.labeling.columns[0];
}D.labelStyleName=J.styles.labeling.style;z(D.labelStyleName);}}n.featureArray.push(D);}var O=function(){if(F==0){n.dataLoaded=true;
var T=OM.event;var S=new T.LayerEvent(T.LayerEvent.FEATURES_LOADED,n);S.mapContext=n.parentMap.getMapContext();
n.fire(T.LayerEvent.FEATURES_LOADED,S);s(u);H=null;}else{setTimeout(O,100);}};O();},"json",m,o);},getGeoRss:function(o,q,g){if(this.initError){q();
return;}this.loading=true;var m=this;var l=this.serverURL;var n=new Object();var e=function(t,w,u){m.initError=true;
m.getDataRequest=null;if(t){OM.util.Logger.alert("MAPVIEWER-05511","OM.layer.VectorLayer.getThemeData",t.responseText);
}if(g){g();}var s=OM.event;var r=new s.LayerEvent(s.LayerEvent.INIT_ERROR,m);r.mapContext=m.parentMap.getMapContext();
m.fire(s.LayerEvent.INIT_ERROR,r);return;};var d=8307;var m=this;this.attrNames=["link","updated"];this.getDataRequest=OM.util.HttpRequest.send(l,n,function(D){var z=Number.POSITIVE_INFINITY;
var t=Number.POSITIVE_INFINITY;var s=Number.NEGATIVE_INFINITY;var r=Number.NEGATIVE_INFINITY;OM.$(D).find("entry").each(function(){var O=OM.$(this);
var M=O.find("title").text();var K=O.find("link").attr("href");var G=O.find("id").text();var H=O.find("updated").text();
var I=O.find("summary").text();var F=O.find("georss\\:point").text();if(F==""){F=O.find("point").text();
}var E=F.split(" ");var L=Number(E[1]);var J=Number(E[0]);var N=new OM.geometry.Point(L,J,d);var P=new OM.Feature(G,N,{attributes:{_LABEL_:M,link:"<a href='"+K+"' target='_blank'>link</a>",updated:H,summary:I}});
if(L<z){z=L;}if(L>s){s=L;}if(J<t){t=J;}if(J>r){r=J;}m.addFeature(P);});m.dataLoaded=true;var C=OM.event;
var w=function(F){var E=new C.LayerEvent(C.LayerEvent.FEATURES_LOADED,m);E.mapContext=m.parentMap.getMapContext();
m.fire(C.LayerEvent.FEATURES_LOADED,E);q(F);};var u=m.parentMap.getMapContext().getUniverse().getSRID();
if(d!==u){var B=new OM.geometry.Rectangle(z,t,s,r,d);B.transform(u,function(E){var F=[E.getMinX(),E.getMinY(),E.getMaxX(),E.getMaxY()];
w(F);});}else{var A=[z,t,s,r];w(A);}},"xml",e,true,true);},isBoundingTheme:function(){return this.boundingTheme;
},loadBoundingTheme:function(q){var g=this;var d=this.parentMap.getMapContext();this.orgWidth=this.orgWidth?this.orgWidth:d.getDeviceWidth();
this.orgHeight=this.orgHeight?this.orgHeight:d.getDeviceHeight();var m=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
var o=function(e){if(!e){g.dataLoaded=false;return;}else{g.dataLoaded=true;}if(q){q(e[0],e[1],e[2],e[3]);
}else{m.bbox=new Array(e[0],e[1],e[2],e[3]);m.mapContext=g.parentMap.getMapContext();g.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,m);
}};var n=function(){g.loadedBoundingTheme=true;if(q){q(0,0,0,0);}else{m.bbox=[0,0,0,0];m.mapContext=g.parentMap.getMapContext();
g.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,m);}};if(this.type===OM.layer.VectorLayer.TYPE_PREDEFINED||this.type===OM.layer.VectorLayer.TYPE_JDBC||this.type===OM.layer.VectorLayer.TYPE_DATAPACK||this.type===OM.layer.VectorLayer.TYPE_GEORSS){if(this.mbr){var l=this.mbr;
o([l.getMinX(),l.getMinY(),l.getMaxX(),l.getMaxY()]);}else{if(!this.loadOnDemand&&this.dataLoaded){var l=this.getExtent();
o([l.getMinX(),l.getMinY(),l.getMaxX(),l.getMaxY()]);}else{this.getAllThemeData(o,n);}}}else{o([0,0,0,0]);
}},calculateCenterAndZoomLevel:function(m,g,e,d){var r=this.parentMap.getMapContext();var w=r.getUniverse();
if(m===0&&g===0&&e===0&&d===0){return[r.getZoomLevel(),r.getCenterPoint()];}if(this.type==OM.layer.VectorLayer.TYPE_LOCAL){var z=this.getExtent();
m=z.getMinX();g=z.getMinY();e=z.getMaxX();d=z.getMaxY();}else{if(this.mbr==null){var B=w.getSRID();this.mbr=new OM.geometry.Rectangle(m,g,e,d,B);
}}var A=(e-m)/r.getDeviceWidth();var q=(d-g)/r.getDeviceHeight();var t=w.getZoomLevels();var u=w.getZoomLevelNumber();
var l=null;for(var s=0;s<u;s++){if(A>t[s].resolution||q>t[s].resolution*t[s].stretchRatio){l=s==0?0:s-1;
break;}}l=l!=null?l:u-1;var o=(m+e)/2;var n=(g+d)/2;this.loadedBoundingTheme=true;this.boundingZoomLevel=l;
return new Array(l,new OM.geometry.Point(o,n,w.getSRID()));},getLayerConfig:function(g){var d=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
d.mapContext=this.parentMap.getMapContext();this.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,d);},setInfoTipStyle:function(d){this.infoTipStyle=d;
},setCenterAndZoomlevel:function(d){this.refreshImpl(d,false);},recenter:function(t){if(this.displayed){var u=this.dataBufferWindow;
var z=u.x+u.w/2;var w=u.y+u.h/2;var q=this.parentMap.getMapContext();var s=q.getUniverse();var d=q.getCenterPoint();
var r=s.getZoomLevels();var l=r[q.getZoomLevel()];var o=Math.abs(d.getX()-z)/l.resolution;var n=Math.abs(d.getY()-w)/l.resolution*l.stretchRatio;
var m=(this.orgWidth*this.xRatio-this.orgWidth)/2;var g=(this.orgHeight*this.yRatio-this.orgHeight)/2;
if(m<o||g<n){this.loaded=false;this.parentMap.showLoadingIcon(true);this.refreshImpl(t,false);}}},checkVisible:function(){if(!this.isVisible()){return false;
}var d=this.parentMap.getMapContext().getZoomLevel();if(d<this.minVisibleLevel||d>this.maxVisibleLevel){return false;
}return true;},clearFeatureShapes:function(){this.parentMap.graphics.clearGroup(this.group);var d=this.featureArray?this.featureArray.length:0;
for(var n=d-1;n>=0;n--){var m=this.featureArray[n];m.clearAnimation();m.animations=null;if(m.moveAnimation){m.pauseMoveAnimation();
}m.group=null;m.screenTransformObj=null;m.graphics=null;m.displayed=false;m.parentLayer=null;if(m.shapeGroup){var l=m.shapeGroup.length;
for(var g=0;g<l;g++){m.shapeGroup[g].feature=null;}m.shapeGroup=null;}else{if(m.shape){m.shape.feature=null;
m.shape=null;}}if(m.labelShape){m.labelShape.feature=null;}m.labelShape=null;}this.lineGroup=null;this.realGroup=null;
this.labelGroup=null;if(this.vCluster){this.vCluster.clearAllClusterFeatures();}var e=OM.$("#heatmap_"+this.name);
if(e.length>0){e.empty();}this.displayed=false;},showInfoWindow:function(z){var n="";var q=z.attributes;
if(!q){return;}if(this.type==OM.layer.VectorLayer.TYPE_LOCAL){var m=0;for(r in z.attributes){var u=z.attributes[r];
if(u){u=u.replace(/\s/g,"&nbsp;");}else{u="";}var g="#bbbbbb";if(m%2===0){g="#dddddd";}m++;if(r!=="_LABEL_"){n+="<tr bgcolor='"+g+"'><td align='right'>"+r+"</td><td align='left'>"+u+"</td></tr>";
}}if(m==0){return;}}else{if(!this.attrNames||this.attrNames.length<1){return;}var o=this.attrNames.length;
var l=0;for(m=0;m<o;m++){var r=this.attrNames[m];var w=r.toUpperCase();var g="#bbbbbb";if(l%2===0){g="#dddddd";
}if(w!="_LABEL_"&&z.attributes[w]){l++;u=z.attributes[w];if(u){if(typeof u==="string"){u=u.replace(/\s/g,"&nbsp;");
}}else{u="";}n+="<tr bgcolor='"+g+"'><td align='right'>"+r+"</td><td align='left'>"+u+"</td></tr>";}}}n="<table>"+n+"</table>";
var e=new Object();if(q._LABEL_!=undefined){var s=(z.attributes._LABEL_+"").replace(/ /g,"&nbsp;");e.title=s;
}var d=this.parentMap;var t=d.getCursorLocation();e.id=this.name+"_"+z.id;if(t!=null){d.displayInfoWindow(t,n,e);
}else{d.displayInfoWindow(z.getGeometry(),n,e);}},getSessionId:function(m,l){var d=this.serverURL+"/dataserver/"+this.dataSource;
var g={get_session_id:"yes"};var e=this;OM.util.HttpRequest.send(d,g,function(n){e.sessionId=n;e.getThemeData(m,l);
},"text");},resolveStyle:function(g,l){if(!l){return null;}if(typeof l.getRealStyle==="undefined"){return l;
}if(l.length>0){var d=l.length;for(var e=0;e<d;e++){l[e]=this._resolveStyle(g,l[e]);}}else{l=this._resolveStyle(g,l);
}return l;},_resolveStyle:function(e,l){if(l instanceof OM.style.BucketStyle){l.generateBuckets(this.featureArray,this.styleAttributes,false);
}var d=e.attributes;if(d){var g=null;if(this.styleAttributes!=null&&this.styleAttributes.length>0){g=d[this.styleAttributes[0].toUpperCase()];
}else{if(e.columns){g=d[e.columns[0].toUpperCase()];}}return l.getRealStyle(g);}else{return l;}},removeGraphics:function(){this.clearSelectedFeatures();
if(this.group){var d=this.parentMap.graphics;this.clearFeatureShapes();d.remove(this.group);this.group=null;
}},changeVisibleBound:function(){if(this.type==OM.layer.VectorLayer.TYPE_PREDEFINED&&!this.loadOnDemand){this.clearFeatureShapes();
}this.refreshImpl();},changeOpacity:function(){if(this.parentMap&&this.parentMap.graphics){this.parentMap.graphics.applyStyle(this.group,{opacity:this.opacity});
}},getXML:function(){var e=this.getNSDPXML();if(this.type==OM.layer.VectorLayer.TYPE_JDBC){var r='<theme name="'+this.name+'">';
r+='<jdbc_query datasource="'+this.dataSource+'"';if(this.renderingStyle){r+=' render_style="'+this.renderingStyle.styleName+'"';
}if(this.geometryColumn){r+=' spatial_column="'+this.geometryColumn+'"';}r+=">"+this.sql+"</jdbc_query></theme>";
var q="";if(this.renderingStyle){q=this.renderingStyle.getXML();}return[r,"",q,e];}else{if(this.type==OM.layer.VectorLayer.TYPE_LOCAL){var n=this.featureArray?this.featureArray.length:0;
var g="";var q="";for(var m=0;m<n;m++){var s=this.featureArray[m];var d=s.getRenderingStyle();var o=s.getGeometry().toGML();
g+='<geoFeature render_style="'+d.styleName+'"><geometricProperty>'+o+"</geometricProperty></geoFeature>";
if(d){q+=d.getXML();}}return["",g,q,e];}else{var l='<theme name="'+this.name+'" template_theme="'+this.themeName+'" render_labels="'+false+'" datasource="'+this.dataSource+'"';
if(this.renderingStyle){l+=' render_style="'+this.renderingStyle.styleName+'"';}l+=" />";var q="";if(this.renderingStyle){q=this.renderingStyle.getXML();
}return[l," ",q,e];}}},getNSDPXML:function(){if(!this.nsdp){return"";}var e='<ns_data_provider provider_id="defaultNSDP">';
e+='<for_theme name="'+this.name+'"/>';var d=null;e+='<join spatial_key_column="'+this.nsdpKey+'"/>';
e+="<parameters>";if(this.nsdp.xml){e+='<parameter name="xml" value="'+this.nsdp.xml.replace(/</g,"&lt;")+'"/>';
}else{if(this.nsdp.url){e+='<parameter name="xml_url" value="'+this.nsdp.url+'"/>';}}e+="</parameters>";
e+="</ns_data_provider>";return e;},selectAllFeatures:function(){var d=this.featureArray?this.featureArray.length:0;
for(var g=0;g<d;g++){var e=this.featureArray[g];if(this.selectionEnable&&!e.selected){if(!e.oldStyle){e.oldStyle=e.renderingStyle;
}e.setRenderingStyle(this.selectionStyle);if(this.selectedFeatures){this.selectedFeatures.push(e);}else{this.selectedFeatures=new Array(e);
}e.selected=true;}}return null;},addMarkerBoundToGrid:function(){var m=this.getFeatureGeometryType();
var d=this.renderingStyle;if(m==""||m=="LINESTRING"||m=="POLYGON"){return;}var l=this.featureArray?this.featureArray.length:0;
for(var e=0;e<l;e++){var s=this.featureArray[e];if(s.displayed&&s.screenPoints){var q=s.screenPoints.x;
var o=s.screenPoints.y;var r=s.markerSize?s.markerSize.w:s.renderingStyle.width;var g=s.markerSize?s.markerSize.h:s.renderingStyle.height;
var n=[q-r/2,o-g/2,q+r/2,o+g/2];this.parentMap.grid.insert(n);}}if(this.vCluster){this.vCluster.addClusterFeatureToLabelGrid();
}},addLabels:function(){if(!this.group){return;}var d=this.featureArray?this.featureArray.length:0;if(!this.labelGroup){this.labelGroup=this.parentMap.graphics.createGroup({opacity:this.opacity,visibility:"visible"});
this.group.appendChild(this.labelGroup);}for(var g=0;g<d;g++){var e=this.featureArray[g];if(e.labelShape){continue;
}e.addLabel(this.parentMap.grid);}},clearAllLabels:function(){this.mask=null;if(this.labelGroup){this.parentMap.graphics.clearGroup(this.labelGroup);
}var d=this.featureArray?this.featureArray.length:0;for(var g=0;g<d;g++){var e=this.featureArray[g];if(e.labelShape){e.labelShape.feature=null;
e.labelShape=null;}}},enableDisplayInBatch:function(e,d){this.enableBatch=e;if(e){this.batchInterval=d&&d.interval?d.interval:200;
this.numberInBatch=d&&d.numberInBatch?d.numberInBatch:100;}},enableClustering:function(e,d){this.clustering=e;
if(e){this.vCluster=new OM.layer.VectorLayerCluster(this,d);}this.maxClusteringLevel=d&&d.maxClusteringLevel?d.maxClusteringLevel:100;
this.clickZoomInLevels=-1;if(d&&d.enableZoomIn===false){this.clickZoomInLevels=0;}else{if(d&&d.zoomInLevels){this.clickZoomInLevels=parseInt(d.zoomInLevels);
}}},getFeatureIndex:function(g){var d=this.featureArray.length;if(d==0){return -1;}for(var e=0;e<d;e++){if(this.featureArray[e]==g){return e+1;
}}return -1;},bringFeatureForward:function(m){var e=this.getFeatureIndex(m);var d=this.featureArray.length;
if(e==-1||e==d){return e;}var l=this.featureArray[e];this.featureArray[e]=m;this.featureArray[e-1]=l;
if(m.displayed){var g=this.graphics;m.graphics.bringForward(m.shape);}return e+1;},sendFeatureBackward:function(l){var d=this.getFeatureIndex(l);
if(d==-1||d==1){return d;}var g=this.featureArray[d-2];this.featureArray[d-2]=l;this.featureArray[d-1]=g;
if(l.displayed){var e=this.graphics;l.graphics.sendBackward(l.shape);}return d-1;},bringFeatureToTop:function(m){var e=this.getFeatureIndex(m);
var d=this.featureArray.length;if(e==-1||e==d){return e;}this.featureArray.splice(e-1,1);this.featureArray.push(m);
if(m.displayed){var g=this.graphics;if(m.shapeGroup&&m.shapeGroup.length>1){for(var l=0;l<m.shapeGroup.length;
l++){m.graphics.bringToTop(m.shapeGroup[l]);}}else{m.graphics.bringToTop(m.shape);}if(m.labelShape){m.graphics.bringToTop(m.labelShape);
}}return e+1;},sendFeatureToBottom:function(m){var e=this.getFeatureIndex(m);var d=this.featureArray.length;
if(e==-1||e==1){return e;}this.featureArray.splice(e-1,1);this.featureArray.splice(0,0,m);if(m.displayed){var g=this.graphics;
if(m.shapeGroup&&m.shapeGroup.length>1){for(var l=0;l<m.shapeGroup.length;l++){m.graphics.sendToBottom(m.shapeGroup[l]);
}}else{m.graphics.sendToBottom(m.shape);}}return e+1;},getTargetFeature:function(d){var e=d.feature;while(e==undefined&&d.parentNode){d=d.parentNode;
e=d.feature;}return e;},getLineGroup:function(d){if(!this.lineGroup){this.lineGroup=new Array();var g=this.parentMap.graphics;
for(var e=0;e<4;e++){this.lineGroup[e]=g.createGroup();this.realGroup.appendChild(this.lineGroup[e]);
}}return this.lineGroup;},redraw:function(d){var e=this.parentMap.getMapContext();this.orgWidth=e.getDeviceWidth();
this.orgHeight=e.getDeviceHeight();this.setWindow();this.clearFeatureShapes();this.refreshImpl();},calculateLayerGradientBound:function(){var e=this.parentMap.getMapContext();
var q=e.getUniverse();var d=e.getMapCenter();var o=q.getZoomLevels();var n=o[e.getZoomLevel()];var m=(d.getX()-this.minX)/n.resolution;
var g=(d.getY()-this.minY)/n.resolution/n.stretchRatio;var l={x1:m-this.orgWidth/2,y1:g-this.orgHeight/2,x2:m+this.orgWidth/2,y2:g+this.orgHeight/2,useObjectBoundingBox:false};
return l;},clearLayer:function(){this.removeGraphics();var d=this.featureArray?this.featureArray.length:0;
this.featureArray=null;this.transform=null;this.dataCache=null;this.dataLoaded=false;this.vCluster=null;
if(this.draggingFeature){this.parentMap.$oracleMapDiv.unbind("mousemove",this.draggingFeature);}this.draggingFeature=null;
if(this.endFeatureDragging){OM.$(document).unbind("mouseup",this.endFeatureDragging);OM.$(document).unbind("mouseout",this.endFeatureDragging);
}this.endFeatureDragging=null;this.toolTipCustomizer=null;},destroy:function(){this.clearLayer();this._super();
},addSecondaryStyle:function(d){if(!this.otherStyles){this.otherStyles=[d];}else{this.otherStyles.push(d);
}},removeSecondaryStyle:function(g){if(this.otherStyles===null){return null;}var d=this.otherStyles.length;
for(var e=0;e<d;e++){if(this.otherStyles[e]===g){this.otherStyles.splice(e,1);return g;}}return null;
},setVisibleImpl:function(){if(this.heatMap){var d=OM.$("#heatmap_"+layer.name);d.toggle(this.visible);
}if(this.group&&this.parentMap&&this.parentMap.graphics){this.parentMap.graphics.applyStyle(this.group,{display:this.visible});
}if(this.visible&&this.parentMap&&this.parentMap.displayed&&!this.displayed){if(this.type!==OM.layer.VectorLayer.TYPE_LOCAL&&!this.dataLoaded&&!this.initError){this.refresh(null,false);
}else{this.displayFeatures();}}if(this.parentMap&&this.parentMap.displayed){this.parentMap.refreshVectorLayerLabels();
}return;},clone:function(e,q,m){var o=this._super(e);o.getDataRequest=null;o.boundingTheme=false;o.sessionId=null;
if(this.renderingStyle&&this.renderingStyle.styleType=="HeatMap"&&this.renderingStyle.containerVectorLayer){o.renderingStyle=this.renderingStyle.clone();
o.renderingStyle.containerVectorLayer=o.renderingStyle.containerVectorLayer.clone("over_"+o.renderingStyle.containerVectorLayer.name,true,true);
}if(o.displayed||o.dataLoaded){o.featureArray=[];var d=this.featureArray.length;for(var l=0;l<d;l++){var g=this.featureArray[l].clone();
o.featureArray.push(g);}}else{if(q){o.usedInOverview=true;o.containerLayer=m;var n=OM.event;o.copyFeatures=function(s){var w=s.target;
o.featureArray=[];var r=w.featureArray.length;for(var u=0;u<r;u++){var t=w.featureArray[u].clone();o.featureArray.push(t);
}o.dataLoaded=true;if(!o.containerLayer){o.displayFeatures();}};this.on(n.LayerEvent.FEATURES_LOADED,o.copyFeatures);
}}o.displayed=false;o.group=null;o.realGroup=null;o.labelGroup=null;o.lineGroup=null;o.graphics=null;
return o;},displayHeatMap:function(){this.parentMap.showLoadingIcon(true);var r=this.featureArray?this.featureArray.length:0;
var d=this.parentMap.getMapContext();var e=d.getUniverse().getSRID();var g=d.getTransform();var u=this.orgWidth*this.xRatio;
var n=this.orgHeight*this.yRatio;var t=g.toScreenPoint(this.dataBufferWindow.x,this.dataBufferWindow.y+this.dataBufferWindow.h);
if(!this.heatMap){this.heatMap=new OM.layer.VectorLayerHeatMap(this.renderingStyle,this);}if(this.styleAttributes&&this.styleAttributes.length>0){this.heatMap.isValued=true;
}OM.style.Style.calculateStyleSize(this.renderingStyle,this.parentMap);this.heatMap.init(u,n,t.x,t.y,this.renderingStyle.spotlightRadius);
var o=this;var q=0;for(var m=0;m<r;m++){var A=this.featureArray[m];var s=A.getGeometry();if(s.type!="Point"&&s.type!="OrientedPoint"&&s.type!="MultiPoint"&&s.type!="OrientedMultiPoint"){continue;
}if(e!==s.srid){q++;(function(w){s.transform(e,function(B){q--;w.srid=e;w.geo=B;o.addFeatureToHeatMap(w,t);
});})(A);}else{o.addFeatureToHeatMap(A,t);}}var z=function(E){var H=OM.$("#heatmap_"+o.name);if(H.length==0){H=OM.$("<div id='heatmap_"+o.name+"' style='position:absolute;'>");
o.parentMap.$heatMapDiv.append(H);}else{H.empty();}H.css({display:"block",left:"0px",top:"0px",width:o.orgWidth+"px",height:o.orgHeight+"px"});
var D=o.parentMap.getMapContext();var G=D.getUniverse();var B=D.getZoomLevel();var C=G.getZoomLevels()[B];
var w=D.getCenterPoint();var F=(o.dataBufferWindow.x-w.getX())/C.resolution+D.getDeviceWidth()/2;var I=(w.getY()-o.dataBufferWindow.y-o.dataBufferWindow.h)/C.resolution/C.stretchRatio+D.getDeviceHeight()/2;
E.style.cssText="position:absolute;left:"+F+"px;top:"+I+"px;";H[0].appendChild(E);o.displayed=true;if(OM.util.Logger.DEBUG){console.timeEnd("["+o.name+"] displayFeatures");
}o.displayEnd();};var l=function(w){if(q!=0||o.heatMap.loadingBoundaray){setTimeout(l,100);}else{o.heatMap.drawHeatMap(z);
}};l();},addFeatureToHeatMap:function(o,l){var q=1;var n=o.geo;var r=this.parentMap.getMapContext().getTransform();
if(this.styleAttributes!=null&&this.styleAttributes.length>0){q=Number(o.getAttributeValue(this.styleAttributes[0]));
}if(isNaN(q)){q=1;}if(n.type=="Point"||n.type=="OrientedPoint"){var g=r.toHeatMapPoint(n.coordinates[0],n.coordinates[1],l.x,l.y,this.heatMap.scale);
this.heatMap.addData(g.x,g.y,q);}else{if(n.type=="MultiPoint"||n.type=="OrientedMultiPoint"){var e=n.coordinates.length;
for(var d=0;i<e;i++){var g=this.screenTransformObj.toHeatMapPoint(n.coordinates[d][0],n.coordinates[d][1],l.x,l.y,this.heatMap.scale);
this.heatMap.addData(g.x,g.y,q);}}}},pan:function(g,e){if(this.displayed&&this.heatMap){var d=OM.$("#heatmap_"+this.name);
if(d.length>0){var l=OM.util.DomUtil.getElementPos(d);d.css({left:l.left+g,top:l.top+e});}}},getHoverSelectStyle:function(l,d){if(l.styleType!="Color"){return l;
}var g={};if(d.styleType=="Marker"){if(d.vectorDef&&d.vectorDef.length>0&&d.vectorDef[0].style){OM.$.extend(true,g,d);
OM.$.extend(g.vectorDef[0].style,l.origConfig);}else{g=l;}}else{if(d.styleType=="Line"){var e={};OM.$.extend(e,d.origConfig,l.origConfig);
g=new OM.style.Line(e);}else{OM.$.extend(g,d,l.origConfig);}}return g;},setToolTipCustomizer:function(d){if(d&&typeof d==="function"){this.toolTipCustomizer=d;
}},enableToolTip:function(d){this.showToolTip=d;if(this.displayed){this.redraw();}}});OM.layer.VectorLayer.SINGLE_SELECTION=0;
OM.layer.VectorLayer.MULTIPLE_SELECTION=1;OM.layer.VectorLayer.TYPE_PREDEFINED=0;OM.layer.VectorLayer.TYPE_JDBC=1;
OM.layer.VectorLayer.TYPE_DATAPACK=2;OM.layer.VectorLayer.TYPE_LOCAL=3;OM.layer.VectorLayer.TYPE_GEORSS=4;
OM.layer.VectorLayer.TYPE_WFS=5;OM.layer.VectorLayer.ERROR_COUNT=5;OM.layer.BuiltinExternalTileLayer=OM.layer.TileLayer.extend({initialize:function(d){this._super(d);
this.layerType=OM.LayerTypes.EXTERNAL;this.tileLayerConfig=null;},init:function(d){},pan:function(d,e){},setCenterAndZoomlevel:function(){},setMapType:function(d){},resize:function(){},setVisibleImpl:function(){if(this.container){var d=OM.$(this.container);
d.css("visibility",this.visible?"visible":"hidden");d.css("display",this.visible?"":"none");}if(this.visible&&this.parentMap.displayed){this.init(this.container);
}},checkVisible:function(){if(!this.isVisible()){return false;}if(this.parentMap.zoomLevel>=this.tileLayerConfig.zoomLevels.length){return false;
}if(this.parentMap.zoomLevel<this.minVisibleLevel||this.parentMap.zoomLevel>this.maxVisibleLevel){return false;
}return true;},setContainer:function(e){var d=OM.$("<div id ='tilelayer_"+this.name+"'></div>");d.css({position:"absolute",left:"0px","z-index":this.zIndex,top:"0px",width:"100%",height:"100%",overflow:"hidden"});
this.parentMap.$tileLayersDiv.append(d);this.container=d[0];},getLayerConfig:function(){var d=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
d.config=this.getEnabledConfig(this.tileLayerConfig);if(this.parentMap){d.mapContext=this.parentMap.getMapContext();
}this.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,d);},destroy:function(){if(this.mapTypeControl){this.mapTypeControl.destory();
}if(this.container){OM.$(this.container).empty().remove();}},refresh:function(l,d){if(d==undefined){d=true;
}this._super(l,d);this.reloadNumber=Math.round(Math.random()*10000000000);if(this.parentMap){this.init();
}if(d){var g=new OM.event.LayerEvent(OM.event.LayerEvent.AFTER_REFRESH,this);if(this.parentMap){g.mapContext=this.parentMap.getMapContext();
}this.fire(OM.event.LayerEvent.AFTER_REFRESH,g);}},exportToSVG:function(r,q,m){var e=0,s=0;if(this.maxWidth&&q>this.maxWidth){e=(q-this.maxWidth)/2;
q=this.maxWidth;}else{if(this.minWidth&&q<this.minWidth){e=(this.minWidth-q)/2;q=this.minWidth;}}if(this.maxHeight&&m>this.maxHeight){s=(m-this.maxHeight)/2;
m=this.maxHeight;}else{if(this.minHeight&&m<this.minHeight){s=(this.minHeight-m)/2;m=this.minHeight;}}var n=this;
n.loadImg=0;var d=this.getStaticMapURL(q,m);var o=this.parentMap.graphics;n.loadImg++;var g=o.drawImage({x:e,y:s},{src:d,width:q,height:m},{group:r});
g.handleEvent=function(l){this.resourceUpdate(l);n.loadImg--;};return r;}});OM.layer.BingTileLayer=OM.layer.BuiltinExternalTileLayer.extend({initialize:function(g,e){this._super(g);
this.key=e&&e.key?e.key:"your_bing_api_key";this.libURL=null;this.over=arguments.length>2?arguments[2]:false;
var d=OM.layer.BingTileLayer;if(typeof Microsoft!="undefined"){finishLoadBingJsV7();}if(!this.over&&!d.LOADEDJS&&!d.LOADING){d.LOADING=true;
if(e&&e.libURL){this.libURL=e.libURL;OM.$.getScript(this.libURL+"&onscriptload=finishLoadBingJsV7");}else{OM.$.getScript("http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&onscriptload=finishLoadBingJsV7");
}}this.mapType=(e&&e.mapType)?e.mapType:d.TYPE_ROAD;this.map_type_values=(e&&e.mapTypeList)?e.mapTypeList:null;
this.tileLayerConfig=OM.layer.TileLayerConfig.CONFIG_GOOGLE;this.mapTypeVisible=(e&&e.mapTypeVisible!=null)?e.mapTypeVisible:true;
this.maxWidth=900;this.maxHeight=834;this.minWidth=80;this.minHeight=80;},init:function(){if(!this.container){return;
}var e=this;var g=function(n){var l=e.parentMap.getMapContext();var m=function(t){if(t!=null){center=new Microsoft.Maps.Location(t.getY(),t.getX());
}else{center=new Microsoft.Maps.Location(l.getCenterPoint().getY(),l.getCenterPoint().getX());}e.checkMapType();
try{e.map=new Microsoft.Maps.Map(n,{credentials:e.key,center:center,mapTypeId:OM.layer.BingTileLayer.TYPES[e.mapType],zoom:e.getRealZoomLevel(l.getZoomLevel())+1,animate:false,labelOverlay:Microsoft.Maps.LabelOverlay.hidden,showDashboard:false,showCopyright:false,showScalebar:false,disableKeyboardInput:true});
if(e.map_type_values&&!e.over){var w=e.map_type_values.split(";");var q={road:null,satellite:null,shaded:null};
for(var s=0;s<w.length;s++){if(w[s]=="OM.layer.BingTileLayer.TYPE_ROAD"){q.road=OM.layer.BingTileLayer.TYPE_ROAD;
}else{if(w[s]=="OM.layer.BingTileLayer.TYPE_AERIAL"){q.satellite=OM.layer.BingTileLayer.TYPE_AERIAL;}}}var z=null;
for(var r in q){if(q[r]==e.mapType){z=r;}}e.mapTypeControl=new OM.control.MapTypeControl(e.parentMap,e,{enableTypes:q,type:z});
e.mapTypeControl.infoDecoration.setVisible(e.mapTypeVisible);}}catch(u){}var o=function(C){var B=OM.event;
var A=new B.MapEvent(B.LayerEvent.FINISH_LOAD,e);A.mapContext=l;e.fire(B.LayerEvent.FINISH_LOAD,A);};
Microsoft.Maps.Events.addHandler(e.map,"viewchangeend",o);};l.getCenterPoint().transform(8307,function(o){m(o);
});};var d=function(){if(OM.layer.BingTileLayer.LOADEDJS){g(e.container);}else{setTimeout(d,500);}};d();
},pan:function(e,g){if(this.map){var d=this.map.getOptions();d.center=this.map.getCenter();d.animate=false;
d.centerOffset=new Microsoft.Maps.Point(e,g);this.map.setView(d);}},setCenterAndZoomlevel:function(){if(this.map){var d=this.parentMap.getMapContext();
var l=this.getRealZoomLevel(d.getZoomLevel());var g=this;var e=function(n){var m=g.map.getOptions();m.zoom=l+1;
m.center=new Microsoft.Maps.Location(n.getY(),n.getX());g.map.setView(m);};d.getCenterPoint().transform(8307,function(m){e(m);
});}},setMapType:function(e){this.mapType=e;var d=null;if(this.map){this.checkMapType();d=OM.layer.BingTileLayer.TYPES[this.mapType];
this.map.setMapType(d);if(this.cloneLayer){this.cloneLayer.setMapType(this.mapType);}}},resize:function(){if(this.map){var d=this.parentMap.getMapContext();
this.map.setOptions({height:d.getDeviceWidth(),width:d.getDeviceHeight()});}},getMapType:function(){return this.mapType;
},checkMapType:function(){var d=OM.layer.BingTileLayer.TYPES[this.mapType];if(!d){this.mapType=OM.layer.BingTileLayer.TYPE_ROAD;
}},getStaticMapURL:function(n,g){var q="http://dev.virtualearth.net/REST/V1/Imagery/Map/";var m=this.map.getCenter();
var d=m.latitude+","+m.longitude;var e;var l=OM.layer.BingTileLayer;switch(this.mapType){case l.TYPE_AERIAL:e="Aerial";
break;case l.TYPE_MERCATOR:e="AerialWithLabels";break;default:e="Road";}var r=this.map.getZoom();var s="mapSize="+n+","+g;
var o="key="+this.key;q=q+e+"/"+d+"/"+r+"?"+s+"&"+o;return q;},clone:function(d){if(!d){d=this.name+"_clone";
}this.cloneLayer=new OM.layer.BingTileLayer(d,{key:this.key,libURL:this.libURL,mapType:this.mapType},true);
return this.cloneLayer;}});OM.layer.BingTileLayer.TYPE_ROAD="road";OM.layer.BingTileLayer.TYPE_AERIAL="aerial";
OM.layer.BingTileLayer.TYPE_AUTO="auto";OM.layer.BingTileLayer.TYPE_MERCATOR="mercator";OM.layer.BingTileLayer.TYPES=[];
OM.layer.BingTileLayer.LOADEDJS=false;OM.layer.BingTileLayer.LOADING=false;finishLoadBingJsV7=function(){OM.layer.BingTileLayer.LOADEDJS=true;
OM.layer.BingTileLayer.TYPES[OM.layer.BingTileLayer.TYPE_ROAD]=Microsoft.Maps.MapTypeId.road;OM.layer.BingTileLayer.TYPES[OM.layer.BingTileLayer.TYPE_AERIAL]=Microsoft.Maps.MapTypeId.aerial;
OM.layer.BingTileLayer.TYPES[OM.layer.BingTileLayer.TYPE_AUTO]=Microsoft.Maps.MapTypeId.auto;OM.layer.BingTileLayer.TYPES[OM.layer.BingTileLayer.TYPE_MERCATOR]=Microsoft.Maps.MapTypeId.mercator;
};OM.layer.ElocationTileLayer=OM.layer.TileLayer.extend({initialize:function(d){this._super(d,{dataSource:"ELOCATION_MERCATOR",tileLayer:"world_map",tileServerURL:"http://maps.oracle.com/mapviewer/mcserver",tileLayerConfig:OM.layer.TileLayerConfig.CONFIG_ELOCATION});
}});OM.layer.NokiaTileLayer=OM.layer.BuiltinExternalTileLayer.extend({initialize:function(name,config){this._super(name);
this.libURL=null;var NokiaLayer=OM.layer.NokiaTileLayer;this.over=arguments.length>2?arguments[2]:false;
if(!this.over&&eval("typeof nokia")=="undefined"&&!NokiaLayer.LOADING){if(config&&config.libURL){this.libURL=config.libURL;
}else{this.libURL="http://api.maps.nokia.com/2.2.1/jsl.js?map=none&search=none&routing=none&positioning=none&ui=none";
}OM.$.getScript(this.libURL);NokiaLayer.LOADING=true;}this.key=(config&&config.key)?config.key:null;this.appID=(config&&config.appID)?config.appID:null;
this.defaultLanguage=(config&&config.defaultLanguage)?config.defaultLanguage:null;this.mapType=(config&&config.mapType)?config.mapType:NokiaLayer.TYPE_NORMAL;
this.map_type_values=(config&&config.mapTypeList)?config.mapTypeList:null;this.mapTypeVisible=(config&&config.mapTypeVisible!=null)?config.mapTypeVisible:true;
this.tileLayerConfig=OM.layer.TileLayerConfig.CONFIG_GOOGLE;this.maxWidth=2048;this.maxHeight=2048;},init:function(){var zoom=null;
var nokia_map=this;var init_Nokia=function(){var mapContext=nokia_map.parentMap.getMapContext();var universe=mapContext.getUniverse();
var center=mapContext.getCenterPoint();var showNokiaMap=function(geom){var cx=center.getX();var cy=center.getY();
if(geom){cx=geom.getX();cy=geom.getY();}zoom=nokia_map.getRealZoomLevel(mapContext.getZoomLevel())+1;
nokia_map.checkMapType();if(nokia_map.map){return;}nokia.Settings.set("appId",nokia_map.appID);nokia.Settings.set("authenticationToken",nokia_map.key);
if(nokia_map.defaultLanguage){nokia.Settings.set("defaultLanguage",nokia_map.defaultLanguage);}nokia_map.map=new nokia.maps.map.Display(nokia_map.container,{zoomLevel:zoom,center:[cy,cx]});
nokia_map.map.set("baseMapType",nokia_map.map[nokia_map.mapType]);if(nokia_map.map_type_values&&!nokia_map.over){var val=nokia_map.map_type_values.split(";");
var type_values={road:null,satellite:null,shaded:null};for(var i=0;i<val.length;i++){if(val[i]=="OM.layer.NokiaTileLayer.TYPE_NORMAL"){type_values.road=OM.layer.NokiaTileLayer.TYPE_NORMAL;
}else{if(val[i]=="OM.layer.NokiaTileLayer.TYPE_SATELLITE"){type_values.satellite=OM.layer.NokiaTileLayer.TYPE_SATELLITE;
}else{if(val[i]=="OM.layer.NokiaTileLayer.TYPE_TERRAIN"){type_values.shaded=OM.layer.NokiaTileLayer.TYPE_TERRAIN;
}}}}var defaultType=null;for(var key in type_values){if(type_values[key]==nokia_map.mapType){defaultType=key;
}}nokia_map.mapTypeControl=new OM.control.MapTypeControl(nokia_map.parentMap,nokia_map,{enableTypes:type_values,type:defaultType});
nokia_map.mapTypeControl.infoDecoration.setVisible(nokia_map.mapTypeVisible);}var event_pkg=OM.event;
var event=new event_pkg.MapEvent(event_pkg.LayerEvent.FINISH_LOAD,nokia_map);event.mapContext=nokia_map.parentMap.getMapContext();
nokia_map.fire(event_pkg.LayerEvent.FINISH_LOAD,event);};center.transform(8307,function(geom){showNokiaMap(geom);
});};var laodFeatureInterval=window.setInterval(function(){if(eval("typeof nokia")!="undefined"){clearInterval(laodFeatureInterval);
nokia.Features.load({map:"auto"},init_Nokia,function(){OM.util.Logger.alert("","OM.layer.NokiaTileLayer","error loading nokia map lib");
});}},500);},setCenterAndZoomlevel:function(m){var g=this.parentMap.getMapContext();var n=this.getRealZoomLevel(g.getZoomLevel());
var d=this;var l=function(e){if(d.map){d.map.setAttributes(undefined,new nokia.maps.geo.Coordinate(e.getY(),e.getX()),n+1,undefined,undefined);
var q=OM.event;var o=new q.MapEvent(q.LayerEvent.FINISH_LOAD,d);o.mapContext=d.parentMap.getMapContext();
d.fire(q.LayerEvent.FINISH_LOAD,o);}};g.getCenterPoint().transform(8307,function(e){l(e);});},setMapType:function(e){this.mapType=e;
var d=this;if(this.map){this.checkMapType();this.map.set("baseMapType",this.map[this.mapType]);if(this.cloneLayer){this.cloneLayer.setMapType(this.mapType);
}}},getMapType:function(){return this.mapType;},checkMapType:function(){var d=OM.layer.NokiaTileLayer;
var e=d.TYPES[this.mapType];if(!e){this.mapType=d.TYPE_ROAD;}},pan:function(d,e){if(this.map){this.map.pan(0,0,-d,-e);
}},clone:function(d){if(!d){d=this.name+"_clone";}this.cloneLayer=new OM.layer.NokiaTileLayer(d,{libURL:this.libURL,mapType:this.mapType,key:this.key,appID:this.appID},true);
return this.cloneLayer;},getStaticMapURL:function(e,o){var n="http://m.nok.it/";var l=this.map.center;
var d=l.latitude+","+l.longitude;var g="&t=0";var m=OM.layer.NokiaTileLayer;if(this.mapType==m.TYPE_TERRAIN){g="&t=2";
}else{if(this.mapType==m.TYPE_SATELLITE){g="&t=1";}}var q=this.map.zoomLevel;var r="&w="+e+"&h="+o;n=n+"?app_id"+this.appID+"&token"+this.key+"&c="+d+"&z="+q+g+r+"&nord ";
return n;}});OM.layer.NokiaTileLayer.TYPE_NORMAL="NORMAL";OM.layer.NokiaTileLayer.TYPE_TERRAIN="TERRAIN";
OM.layer.NokiaTileLayer.TYPE_SATELLITE="SATELLITE";OM.layer.NokiaTileLayer.LOADING=false;OM.layer.NokiaTileLayer.TYPES=[];
OM.layer.NokiaTileLayer.TYPES[OM.layer.NokiaTileLayer.TYPE_NORMAL]="NORMAL";OM.layer.NokiaTileLayer.TYPES[OM.layer.NokiaTileLayer.TYPE_TERRAIN]="TERRAIN";
OM.layer.NokiaTileLayer.TYPES[OM.layer.NokiaTileLayer.TYPE_SATELLITE]="SATELLITE";OM.layer.GoogleTileLayer=OM.layer.BuiltinExternalTileLayer.extend({initialize:function(name,config){this._super(name);
this.libURL=null;var googleLayer=OM.layer.GoogleTileLayer;this.over=arguments.length>2?arguments[2]:false;
this.map_type_values=(config&&config.mapTypeList)?config.mapTypeList:null;this.mapTypeVisible=(config&&config.mapTypeVisible!=null)?config.mapTypeVisible:true;
if(eval("typeof google")!="undefined"){finishLoadGoogleV3();}else{if(!this.over&&!googleLayer.LOADING){if(config&&config.libURL){this.libURL=config.libURL+"&callback=finishLoadGoogleV3";
}else{this.libURL="http://maps.google.com/maps/api/js?v=3&sensor=false&callback=finishLoadGoogleV3";}OM.$.getScript(this.libURL);
googleLayer.LOADING=true;}}this.tileLayerConfig=OM.layer.TileLayerConfig.CONFIG_GOOGLE;this.mapType=(config&&config.mapType)?config.mapType:OM.layer.GoogleTileLayer.TYPE_ROAD;
this.maxWidth=800;this.maxHeight=600;},init:function(){var o=null;var g=null;var d=this;var e=OM.layer.GoogleTileLayer;
var n=this.container;var m=function(){var r=d.parentMap.getMapContext();var q=r.getCenterPoint();var s=function(E){var z=q.getX();
var w=q.getY();if(E){z=E.getX();w=E.getY();}if(z!=null&&w!=null){o=new google.maps.LatLng(w,z);}var D=r.getZoomLevel();
if(D!=null){g=d.getRealZoomLevel(D)+1;}d.checkMapType();var G={zoom:g,center:o,mapTypeId:e.TYPES[d.mapType],navigationControl:false,mapTypeControl:false,streetViewControl:false,draggable:false,keyboardShortcuts:false,mapTypeControl:false,scrollwheel:false};
d.map=new google.maps.Map(n,G);if(d.map_type_values&&!d.over){var u=d.map_type_values.split(";");var t={road:null,satellite:null,shaded:null};
for(var A=0;A<u.length;A++){if(u[A]=="OM.layer.GoogleTileLayer.TYPE_ROAD"){t.road=e.TYPE_ROAD;}else{if(u[A]=="OM.layer.GoogleTileLayer.TYPE_SATELLITE"){t.satellite=e.TYPE_SATELLITE;
}else{if(u[A]=="OM.layer.GoogleTileLayer.TYPE_SHADED"){t.shaded=e.TYPE_SHADED;}}}}var B=null;for(var F in t){if(t[F]==d.mapType){B=F;
}}d.mapTypeControl=new OM.control.MapTypeControl(d.parentMap,d,{enableTypes:t,type:B});d.mapTypeControl.infoDecoration.setVisible(d.mapTypeVisible);
}var C=function(J){var I=OM.event;var H=new I.MapEvent(I.LayerEvent.FINISH_LOAD,d);H.mapContext=r;d.fire(I.LayerEvent.FINISH_LOAD,H);
};google.maps.event.addListener(d.map,"tilesloaded",C);};q.transform(8307,function(t){s(t);});};var l=window.setInterval(function(){if(!e.LOADING&&OM.layer.GoogleTileLayer.LOADED){clearInterval(l);
m();}},500);},setCenterAndZoomlevel:function(m){if(this.map){var g=this.parentMap.getMapContext();var n=this.getRealZoomLevel(g.getZoomLevel());
var d=this;var l=function(e){d.map.setOptions({zoom:n+1,center:new google.maps.LatLng(e.getY(),e.getX())});
};g.getCenterPoint().transform(8307,function(e){l(e);});}},setMapType:function(d){this.mapType=d;if(this.map){this.checkMapType();
this.map.setMapTypeId(OM.layer.GoogleTileLayer.TYPES[this.mapType]);if(this.cloneLayer){this.cloneLayer.setMapType(this.mapType);
}}},resize:function(){if(this.map){google.maps.event.trigger(this.map,"resize");}},getMapType:function(){return this.mapType;
},checkMapType:function(){var e=OM.layer.GoogleTileLayer;var d=e.TYPES[this.mapType];if(!d){this.mapType=e.TYPE_ROAD;
}},pan:function(d,e){if(this.map){this.map.panBy(-d,-e);}},clone:function(d){if(!d){d=this.name+"_clone";
}this.cloneLayer=new OM.layer.GoogleTileLayer(d,{libURL:this.libURL,mapType:this.mapType},true);return this.cloneLayer;
},getStaticMapURL:function(e,q){var n="http://maps.google.com/maps/api/staticmap?";var o=this.map.getCenter();
var d="center="+o.lat()+","+o.lng();var r="zoom="+(this.map.getZoom());var s="size="+e+"x"+q;var l;switch(this.mapType){case OM.layer.GoogleTileLayer.TYPE_SATELLITE:l="satellite";
break;case OM.layer.GoogleTileLayer.TYPE_HYBRID:l="hybrid";break;case OM.layer.GoogleTileLayer.TYPE_SHADED:l="terrain";
break;default:l="roadmap";}l="maptype="+l;var g="sensor=false";var m="&";n=n+d+m+r+m+s+m+l+m+g;return n;
}});finishLoadGoogleV3=function(){var d=OM.layer.GoogleTileLayer;OM.layer.GoogleTileLayer.LOADED=true;
OM.layer.GoogleTileLayer.LOADING=false;if(d.TYPES==null){d.TYPES=[];d.TYPES[d.TYPE_ROAD]=google.maps.MapTypeId.ROADMAP;
d.TYPES[d.TYPE_SATELLITE]=google.maps.MapTypeId.SATELLITE;d.TYPES[d.TYPE_HYBRID]=google.maps.MapTypeId.HYBRID;
d.TYPES[d.TYPE_SHADED]=google.maps.MapTypeId.TERRAIN;}};OM.layer.GoogleTileLayer.TYPE_ROAD="road";OM.layer.GoogleTileLayer.TYPE_SATELLITE="satellite";
OM.layer.GoogleTileLayer.TYPE_HYBRID="hybrid";OM.layer.GoogleTileLayer.TYPE_SHADED="shaded";OM.layer.GoogleTileLayer.LOADING=false;
OM.layer.GoogleTileLayer.LOADED=false;OM.layer.GoogleTileLayer.TYPES=null;OM.layer.Cluster=OM.Class.extend({initialize:function(d,g,e){this.clusterX=d;
this.clusterY=g;this.numberOfPoints=1;this.featureArray=[e];this.updateFlag=true;},addFeature:function(d,g,e){this.clusterX=(this.clusterX*this.numberOfPoints+d)/(this.numberOfPoints+1);
this.clusterY=(this.clusterY*this.numberOfPoints+g)/(this.numberOfPoints+1);this.numberOfPoints++;this.featureArray.push(e);
this.updateFlag=true;},addCluster:function(d){this.clusterX=(this.clusterX*this.numberOfPoints+d.clusterX*d.numberOfPoints)/(this.numberOfPoints+d.numberOfPoints);
this.clusterY=(this.clusterY*this.numberOfPoints+d.clusterY*d.numberOfPoints)/(this.numberOfPoints+d.numberOfPoints);
this.numberOfPoints+=d.numberOfPoints;this.featureArray=this.featureArray.concat(d.featureArray);},getMBR:function(){var r=this.featureArray[0].geo.coordinates[0];
var o=this.featureArray[0].geo.coordinates[1];var s=this.featureArray[0].geo.srid;var l=r;var e=r;var g=o;
var d=o;var n=this.featureArray.length;for(var m=1;m<n;m++){var t=this.featureArray[m];r=t.geo.coordinates[0];
o=t.geo.coordinates[1];if(r<l){l=r;}if(r>e){e=r;}if(o<g){g=o;}if(o>d){d=o;}}var q=new OM.geometry.Rectangle(l,g,e,d,s);
return q;},removeFeature:function(d,l,g){for(var e=0;e<this.featureArray.length;e++){if(this.featureArray[e]==g){if(this.numberOfPoints>1){this.clusterX=(this.clusterX*this.numberOfPoints-d)/(this.numberOfPoints-1);
this.clusterY=(this.clusterY*this.numberOfPoints-l)/(this.numberOfPoints-1);}this.numberOfPoints--;this.featureArray.splice(e,1);
this.updateFlag=true;return true;}}return false;},createClusterFeature:function(n,e,m){var d=new OM.geometry.Point(this.clusterX,this.clusterY,e);
this.clusterFeatureId=n;var l=new OM.Feature(n,d,{renderingStyle:m});l.cluster=this;var g=function(r){var q=r.target;
var o=q.parentLayer;var t=o.parentMap;var s=q.cluster.getMBR();if(o.clickZoomInLevels==-1){t.zoomToExtent(s);
}else{if(o.clickZoomInLevels>0){t.setMapCenterAndZoomLevel(s.getCenter(),t.getMapZoomLevel()+o.clickZoomInLevels);
}}};l.addListener(OM.event.MouseEvent.MOUSE_CLICK,g);this.updateFlag=false;return l;}});OM.layer.VectorLayerCluster=OM.Class.extend({initialize:function(e,d){this.vectorLayer=e;
this.threshold=d&&d.threshold?d.threshold:30;this.clusterStyle=d&&d.clusterStyle?d.clusterStyle:null;
this.minPointCount=d&&d.minPointCount?d.minPointCount:2;},initCluster:function(l,e){this.gridSizeInX=this.threshold*l;
this.gridSizeInY=this.threshold*e;this.clusters=new Object();var d=this.vectorLayer.parentMap.getMapContext();
var m=d.getUniverse().getMapBounds();var g=this.vectorLayer.visibleBound;this.minX=g?Math.max(g.getMinX(),m.getMinX()):m.getMinX();
this.maxX=g?Math.min(g.getMaxX(),m.getMaxX()):m.getMaxX();this.minY=g?Math.max(g.getMinY(),m.getMinY()):m.getMinY();
this.maxY=g?Math.min(g.getMaxY(),m.getMaxY()):m.getMaxY();this.numInX=Math.ceil((this.maxX-this.minX)/this.gridSizeInX);
this.numInY=Math.ceil((this.maxY-this.minY)/this.gridSizeInY);this.clusterFeatureArray=new Array();this.initialized=true;
},addFeatureToCluster:function(e){var d=e.geo.coordinates[0];var m=e.geo.coordinates[1];var l=Math.floor((d-this.minX)/this.gridSizeInX);
var g=Math.floor((m-this.minY)/this.gridSizeInY);if(!this.clusters[l]){this.clusters[l]=new Object();
}if(!this.clusters[l][g]){this.clusters[l][g]=new OM.layer.Cluster(d,m,e);}else{this.clusters[l][g].addFeature(d,m,e);
}return{x:l,y:g};},displayAsCluster:function(g){var l=this.vectorLayer.parentMap.getMapContext();var o=l.getUniverse();
var d=l.getZoomLevel();if(this.vectorLayer.maxClusteringLevel<d){return;}if(!this.initialized){var u=o.getZoomLevels()[d];
this.initCluster(u.resolution,u.resolution*u.stretchRatio);}this.startX=Math.floor((g.x-this.minX)/this.gridSizeInX);
this.endX=Math.ceil((g.x+g.w-this.minX)/this.gridSizeInX);this.startY=Math.floor((g.y-this.minY)/this.gridSizeInY);
this.endY=Math.ceil((g.y+g.h-this.minY)/this.gridSizeInY);var s=this.vectorLayer.featureArray;var q=s?s.length:0;
var e=o.getSRID();var r=this;var n=0;for(var m=0;m<q;m++){var w=s[m];if(w.geo.type=="Point"&&!w.displayed){if(w.geo.srid!==e){n++;
(function(A){var z=A.getGeometry();z.transform(e,function(B){A.srid=e;A.geo=B;r.addFeatureToCluster(A);
n--;});})(w);}else{this.addFeatureToCluster(w);}}}var t=function(){if(n===0){var z=r.mergeAllClusters(g);
while(z){z=r.mergeAllClusters(g);}r.showAllClusters();}else{window.setTimeout(t,100);}};t();},showAllClusters:function(){var d=this.parent;
var e=this.vectorLayer.parentMap.getMapContext().getUniverse().getSRID();for(var l=this.startX;l<this.endX;
l++){for(var g=this.startY;g<this.endY;g++){if(this.clusters[l]&&this.clusters[l][g]!=null&&this.clusters[l][g].numberOfPoints>=this.minPointCount){var n="-CL"+l+"-"+g;
var m=this.getClusterFeatureById(n);if(!m){m=this.clusters[l][g].createClusterFeature(n,e,this.clusterStyle);
this.displayClusterFeature(m);}else{this.updateMarkerText(m);}}}}},displayClusterFeature:function(e){this.clusterFeatureArray.push(e);
e.group=this.vectorLayer.realGroup;e.screenTransformObj=this.vectorLayer.parentMap.getMapContext().getTransform();
e.graphics=this.vectorLayer.parentMap.graphics;e.parentLayer=this.vectorLayer;e.markerText=e.cluster.numberOfPoints;
e.displayFeature([e.renderingStyle]);if(e.shape){e.shape.applyStyle({tooltip:e.cluster.numberOfPoints+""});
}for(var d=0;d<e.cluster.featureArray.length;d++){e.cluster.featureArray[d].displayed=true;}},mergeAllClusters:function(){var g=false;
for(var e=this.startX;e<this.endX;e++){for(var l=this.startY;l<this.endY;l++){if(this.clusters[e]!=null&&this.clusters[e][l]!=null){var d=this.mergeCluster(e,l);
if(d!=null){g=true;}}}}return g;},mergeCluster:function(r,q){var n=this.gridSizeInX*this.gridSizeInY;
var e=n;var l=n;var o=n;var d=n;var u=n;var g=n;var m=n;var t=n;if(r+1<this.numInX&&this.clusters[r+1]!=null&&this.clusters[r+1][q]!=null){e=this.getSquareDistance(this.clusters[r][q],this.clusters[r+1][q]);
}if(q+1<this.numInY&&this.clusters[r][q+1]!=null){l=this.getSquareDistance(this.clusters[r][q],this.clusters[r][q+1]);
}if(r-1>=0&&this.clusters[r-1]!=null&&this.clusters[r-1][q]!=null){o=this.getSquareDistance(this.clusters[r][q],this.clusters[r-1][q]);
}if(q-1>=0&&this.clusters[r][q-1]!=null){d=this.getSquareDistance(this.clusters[r][q],this.clusters[r][q-1]);
}if(r+1<this.numInX&&q+1<this.numInY&&this.clusters[r+1]!=null&&this.clusters[r+1][q+1]!=null){u=this.getSquareDistance(this.clusters[r][q],this.clusters[r+1][q+1]);
}if(r-1>=0&&q+1<this.numInY&&this.clusters[r-1]!=null&&this.clusters[r-1][q+1]!=null){g=this.getSquareDistance(this.clusters[r][q],this.clusters[r-1][q+1]);
}if(r+1<this.numInX&&q-1>=0&&this.clusters[r+1]!=null&&this.clusters[r+1][q-1]!=null){m=this.getSquareDistance(this.clusters[r][q],this.clusters[r+1][q-1]);
}if(r-1>=0&&q-1>=0&&this.clusters[r-1]!=null&&this.clusters[r-1][q-1]!=null){t=this.getSquareDistance(this.clusters[r][q],this.clusters[r-1][q-1]);
}var s=Math.min(e,Math.min(l,Math.min(o,Math.min(d,Math.min(u,Math.min(g,Math.min(m,t)))))));if(s<n){if(e==s){this.mergeHorizontal(r,q,1);
return{directionX:1,directionY:0};}else{if(l==s){this.mergeVertical(r,q,1);return{directionX:0,directionY:1};
}else{if(o==s){this.mergeHorizontal(r,q,-1);return{directionX:-1,directionY:0};}else{if(d==s){this.mergeVertical(r,q,-1);
return{directionX:0,directionY:-1};}else{if(u==s){this.mergeDiagonal(r,q,1,1);return{directionX:1,directionY:1};
}else{if(g==s){this.mergeDiagonal(r,q,-1,1);return{directionX:-1,directionY:1};}else{if(m==s){this.mergeDiagonal(r,q,1,-1);
return{directionX:1,directionY:-1};}else{this.mergeDiagonal(r,q,-1,-1);return{directionX:-1,directionY:-1};
}}}}}}}return null;}},getSquareDistance:function(e,d){return(e.clusterX-d.clusterX)*(e.clusterX-d.clusterX)+(e.clusterY-d.clusterY)*(e.clusterY-d.clusterY);
},mergeHorizontal:function(d,l,g){this.clusters[d][l].addCluster(this.clusters[d+1*g][l]);var e=Math.floor((this.clusters[d][l].clusterX-this.minX)/this.gridSizeInX);
if(e==d){this.removeAllFeatureInCluster(this.clusters[d+1*g][l]);this.clusters[d+1*g][l]=null;}else{if(e==(d+g)){this.removeAllFeatureInCluster(this.clusters[d+1*g][l]);
this.clusters[d+1*g][l]=this.clusters[d][l];this.removeAllFeatureInCluster(this.clusters[d][l]);this.clusters[d][l]=null;
}}},mergeVertical:function(d,l,g){this.clusters[d][l].addCluster(this.clusters[d][l+1*g]);var e=Math.floor((this.clusters[d][l].clusterY-this.minY)/this.gridSizeInY);
if(e==l){this.removeAllFeatureInCluster(this.clusters[d][l+1*g]);this.clusters[d][l+1*g]=null;}else{if(e==(l+g)){this.removeAllFeatureInCluster(this.clusters[d][l+1*g]);
this.clusters[d][l+1*g]=this.clusters[d][l];this.removeAllFeatureInCluster(this.clusters[d][l]);this.clusters[d][l]=null;
}}},mergeDiagonal:function(d,n,g,e){this.clusters[d][n].addCluster(this.clusters[d+1*g][n+e]);var m=Math.floor((this.clusters[d][n].clusterX-this.minX)/this.gridSizeInX);
var l=Math.floor((this.clusters[d][n].clusterY-this.minY)/this.gridSizeInY);if(m==d&&l==n){this.removeAllFeatureInCluster(this.clusters[d+g][n+e]);
this.clusters[d+1*g][n+1*e]=null;}else{if(m==(d+g)&&l==(n+e)){this.removeAllFeatureInCluster(this.clusters[d+g][n+e]);
this.clusters[d+1*g][n+1*e]=this.clusters[d][n];this.removeAllFeatureInCluster(this.clusters[d][n]);this.clusters[d][n]=null;
}else{if(this.clusters[m][l]==null){this.clusters[m][l]=this.clusters[d][n];}else{this.clusters[m][l].addCluster(this.clusters[d][n]);
}this.removeAllFeatureInCluster(this.clusters[d][n]);this.clusters[d][n]=null;this.removeAllFeatureInCluster(this.clusters[d+g][n+e]);
this.clusters[d+g][n+e]=null;}}},removeAllFeatureInCluster:function(g){var q=g.clusterFeatureId;if(q==null){for(var e=0;
e<g.featureArray.length;e++){var n=g.featureArray[e];if(n.parentLayer){n.parentLayer.clearFeature(n);
}}return;}var o=this.getClusterFeatureById(q);if(o){o.parentLayer.clearFeature(o);}g.clusterFeatureId=null;
var d=this.clusterFeatureArray?this.clusterFeatureArray.length:0;for(var l=0;l<d;l++){if(this.clusterFeatureArray[l]==o){this.clusterFeatureArray.splice(l,1);
break;}}},reDrawClusert:function(l,g,q){if(l==null){return;}var m=this.vectorLayer.parentMap.getMapContext().getUniverse().getSRID();
if(l.numberOfPoints>=this.minPointCount){var o="-CL"+g+"-"+q;var n=this.getClusterFeatureById(o);if(!n){this.removeAllFeatureInCluster(l);
var e=this.clusterFeatureArray.length;n=l.createClusterFeature(o,m,this.clusterStyle);this.displayClusterFeature(n);
return true;}else{var d=new OM.geometry.Point(l.clusterX,l.clusterY,m);n.setGeometry(d);this.updateMarkerText(n);
return true;}}return false;},getClusterFeatureById:function(e){for(var d=0;d<this.clusterFeatureArray.length;
d++){if(this.clusterFeatureArray[d].id==e){return this.clusterFeatureArray[d];}}return null;},clearAllClusterFeatures:function(){var d=this.clusterFeatureArray?this.clusterFeatureArray.length:0;
for(var g=d-1;g>0;g--){var e=this.clusterFeatureArray[g];e.group=null;e.screenTransformObj=null;e.graphics=null;
e.displayed=false;e.parentLayer=null;this.clusterFeatureArray.pop();}this.clusterFeatureArray=null;this.initialized=false;
},updateMarkerText:function(e){if(e.shape.childrenCount>1){var d=e.shape.lastChild;d.applyStyle({textValue:e.cluster.numberOfPoints});
}},addFeature:function(l){var m=this.addFeatureToCluster(l);var n=this.mergeCluster(m.x,m.y);var g=this.clusters[m.x][m.y];
var e=false;if(n==null){e=this.reDrawClusert(g,m.x,m.y);}else{var d=m.x+n.directionX;var o=m.y+n.directionY;
if(g!=null){e=this.reDrawClusert(g,m.x,m.y);}else{if(this.clusters[d][o]!=null){e=this.reDrawClusert(this.clusters[d][o],d,o);
}}}if(e){l.displayed=true;}},addClusterFeatureToLabelGrid:function(){var e=this.clusterFeatureArray?this.clusterFeatureArray.length:0;
for(var l=0;l<e;l++){var o=this.clusterFeatureArray[l];if(o.displayed&&o.screenPoints){var d=o.screenPoints.x;
var q=o.screenPoints.y;var g=o.renderingStyle.width;var m=o.renderingStyle.height;var n=[d-g/2,q-m/2,d+g/2,q+m/2];
this.vectorLayer.parentMap.grid.insert(n);}}}});OM.layer.InteractiveTileLayer=OM.layer.TileLayer.extend({initialize:function(g,e){this._super(g,e);
if(!e||!e.themes){return;}this.themes=new Array();var d=e.themes.length;for(var l=0;l<d;l++){this.themes.push({name:e.themes[l],identify:false});
}this.tileLayerConfig=e.tileLayerConfig;this.origServerURL=e.tileServerURL;this.registerIds=new Array(d);
this.registered=false;},init:function(){if(!this.registered){this.registerThemes();}else{this._super(this);
}},registerThemes:function(){var e=this.getTileServerURL();var m=this.parentMap.getMapContext();var r=m.getUniverse();
var g=r.getMapBounds();var s=r.getSRID()+";"+g.getMinX()+";"+g.getMinY()+";"+g.getMaxX()+";"+g.getMaxY();
var o=r.getZoomLevels();var u="";var t=o.length;for(var n=0;n<t;n++){u+=1/o[n].resolution+";";}t=this.themes.length;
var q=this;var l={request:"rt",cs:s,zl:u};for(var n=0;n<t;n++){var d=this.themes[n].name;l.theme=d;(function(w){OM.util.HttpRequest.send(e,l,function(J){var B=OM.$.trim(J);
var E=OM.$(B);var H=E.filter("mcs_error")[0];if(H!==undefined){var z=H.innerHTML;z=z.trim();var I=z.length;
var K=z.split(":");if(K.length>2){var C=K[1];var D=K[2];OM.util.Logger.alert(C,"OM.layer.InteractiveTileLayer.registerThemes",D);
}q.registerIds[w]="";}else{q.registerIds[w]=B;}var G=q.registerIds.length;for(var F=0;F<G;F++){if(q.registerIds[F]===undefined){return;
}}q.registered=true;q.mapSource=q.registerIds.join(";");G=q.registerIds.length;for(var F=0;F<G;F++){if(q.registerIds[F]!==""){q.init(q);
q.combineClickableIds();return;}}q.initError=true;var L=OM.event;var A=new L.LayerEvent(L.LayerEvent.INIT_ERROR,q);
A.mapContext=q.parentMap.getMapContext();q.fire(L.LayerEvent.INIT_ERROR,A);return;},"text");})(n);}},enableFeatureIdentification:function(l,e){var d=this.themes.length;
for(var g=0;g<d;g++){var m=this.themes[g];if(m.name==l){m.identify=e;}}if(this.displayed){this.combineClickableIds();
}},combineClickableIds:function(){var g="";var d=this.themes.length;for(var e=0;e<d;e++){if(this.themes[e].identify){g=g+this.registerIds[e]+";";
}}var d=g.length;if(d>=1){this.clickIds=g.substring(0,d-1);}else{this.clickIds=0;}},identifyFeatures:function(clickPoint){if(!this.clickIds){return;
}var url=this.getFOIServerURL();var mapContext=this.parentMap.getMapContext();var universe=mapContext.getUniverse();
var bbox=this.parentMap.getMapWindowBoundingBox();var config=universe.getZoomLevels()[mapContext.getZoomLevel()];
var request={request:"idtf",tids:this.clickIds,x:clickPoint.getX(),y:clickPoint.getY(),ratx:1/config.resolution,raty:config.stretchRatio/config.resolution,bbox:bbox.getMinX()+":"+bbox.getMinY()+":"+bbox.getMaxX()+":"+bbox.getMaxY()};
var layer=this;OM.util.HttpRequest.send(url,request,function(response){var features=null;eval("features = "+response);
if(features.foiarray.length<1||!features.attrnames){return;}var len=features.attrnames.length;var feature=features.foiarray[0];
var html="";for(var i=0;i<len;i++){var attrName=features.attrnames[i];var attrValue=feature.attrs[i];
var color="#bbbbbb";if(i%2==0){color="#dddddd";}html+="<tr bgcolor='"+color+"'><td align='right'>"+attrName+"</td><td align='left'>"+attrValue+"</td></tr>";
}html="<table>"+html+"</table>";var opt=new Object();if(feature.name!=undefined){var title=(feature.name+"").replace(/ /g,"&nbsp;");
opt.title=title;}opt.id=feature.name+"_"+feature.id;layer.parentMap.displayInfoWindow(clickPoint,html,opt);
},"text");},getLayerConfig:function(){var d=new OM.event.LayerEvent(OM.event.LayerEvent.FINISH_GOT_CONFIG,this);
if(this.tileLayerConfig){d.config=this.tileLayerConfig;}if(this.parentMap){d.mapContext=this.parentMap.getMapContext();
}this.fire(OM.event.LayerEvent.FINISH_GOT_CONFIG,d);},setLayerConfig:function(e){var d={};d.tileImageWidth=256;
d.tileImageHeight=256;d.tileImageFormat="PNG";d.isTransparentImage=true;d.srid=e.getSRID();d.zoomLevels=e.getZoomLevels();
d.bounds=e.getMapBounds();this.tileLayerConfig=new OM.layer.TileLayerConfig(d);},getFOIServerURL:function(){if(!this.FOIServerURL){if(this.origServerURL){this.FOIServerURL=this.FOIServerURL+"/foi";
}else{this.FOIServerURL=this.parentMap.mapviewerURL+"/foi";}}return this.FOIServerURL;}});OM.layer.EditableFeature=OM.Feature.extend({initialize:function(l,g,d){if(g!=null){this._super(l,g,d);
}this.edit=false;this.editable=true;this.dragging=false;this.modified=false;this.editing=false;this.init();
var e=this;this.setParentThat=function(m){e=m;};this.endEditing=function(m){if(m&&m.evt&&(m.evt.relatedTarget||e.dragging)){return;
}var n;if(m&&m.target){n=m.target.parentFeature;}if(!n&&m&&m.focusFeature){n=m.focusFeature.parentFeature;
}if(!n&&m){n=m.focusFeature;}if(!n){n=e;}n.parentLayer.parentMap.deleteListener(OM.event.MapEvent.I_MAP_CENTER_ZOOM,this.calDistance,this);
var o=n.geo;if(o.type=="Point"){n.deleteEditingProperties();n.setRenderingStyle(n.normalStyle);return;
}else{if(o.type=="OrientedPoint"){n.deleteEditingProperties();n.displayFeature([n.renderingStyle]);return;
}else{if(o.type=="Polygon"||o.type=="LineString"){n.deleteEditingProperties();}}}n.editable=false;n.editing=false;
};this.shapePointMoving=function(m){e.dragging=true;e.featurePointMoving(m,true);};this.possiblePointMoving=function(m){e.dragging=true;
e.featurePointMoving(m,false);};this.showContextMenu=function(s){var o=s.target.parentLayer.parentMap;
var m=s.evt.clientX;var t=s.evt.clientY;var r=s.target;var q=new OM.layer.Menu(o,{left:m,top:t});var n=function(){if(r){e.deleteShapePoint(r);
if(r.parentFeature){r.parentFeature.fire(OM.event.LayerEvent.FEATURE_EDITED);}}};q.addMenuItem("DELETE",n);
q.show=true;};},init:function(){this.relatedFeature=[];},startDrag:function(e,l){var g=this;var o=g.parentLayer.parentMap.$oracleMapDiv.offset();
g.startX=e.clientX+o.left;g.startY=e.clientY+o.top;g.lastX=e.clientX+o.left;g.lastY=e.clientY+o.top;if(g.parentLayer.parentMap.enableMapAction.drag){g.parentLayer.parentMap.enableMapAction.drag=false;
}else{g.lockedParMap=true;}this.dragging=true;if(g.parentFeature!=null&&l){var d=g.parentFeature;d.relatedFeature=[];
var n=d.featureEditingProperties;if(g.orientation){var m=d.featureEditingProperties.shapePoints[0];g.centerX=m.screenPoints.x;
g.centerY=m.screenPoints.y;g.posX=this.screenPoints.x;g.posY=this.screenPoints.y;g.endDragOrietation=function(C){var u=g.parentLayer;
u.parentMap.enableMapAction.drag=true;var s=g.parentLayer.parentMap.$oracleMapDiv.offset();var B=g.screenPoints.x-g.centerX;
var A=g.centerY-g.screenPoints.y;g.startX=null;g.startY=null;g.posX=null;g.posY=null;var w=g.parentFeature;
if(w.tool){var q=w.tool.currentPoint;var t=new OM.geometry.Point(q.getX(),q.getY(),q.srid,B,A);w.tool.currentPoint=t;
}else{var q=w.geo;var t=new OM.geometry.Point(q.getX(),q.getY(),q.srid,B,A);var r=w.screenPoints;r.angel=-Math.atan2(A,B);
w.setGeometry(t);w.screenPoints=r;}g.dragging=false;if(u.labelsVisible()){u.parentMap.refreshVectorLayerLabels();
}var D=OM.event.LayerEvent;var z=new D(D.FEATURE_MOVED,g);g.fire(z);};return;}else{if(g.pos){n.shapePoints[1].setVisible(false);
n.shapePoints[2].setVisible(false);}}this.calRelatedFeature(n,g);}else{this.deleteEditingProperties();
}},calRelatedFeature:function(l,g){var e=g.parentFeature;var d=l.shapePoints.length;g.relatedFeature=[];
while(d--){if(l.shapePoints[d]==g){if(e.geo.type=="Polygon"||e.geo.type=="LineString"){if(d!=0){g.relatedFeature.push(l.possiblePoints[d-1]);
g.relatedFeature.push(l.shapePoints[d-1]);}else{if(e.geo.type=="Polygon"){g.relatedFeature.push(l.possiblePoints[l.shapePoints.length-1]);
g.relatedFeature.push(l.shapePoints[l.possiblePoints.length-1]);}}g.relatedFeature.push(l.possiblePoints[d]);
if(d==l.shapePoints.length-1&&e.geo.type=="Polygon"){d=-1;}else{if(d==l.shapePoints.length-1){return;
}}g.relatedFeature.push(l.shapePoints[d+1]);return;}}}d=l.possiblePoints.length;while(d--){if(l.possiblePoints[d]==g){if(e.geo.type=="Polygon"||e.geo.type=="LineString"){g.relatedFeature.push(d);
g.relatedFeature.push(l.shapePoints[d]);if(d==l.shapePoints.length-1){d=-1;}g.relatedFeature.push(l.shapePoints[d+1]);
return;}}}},featureDragging:function(n){var g=this;if(!g.parentLayer){return;}var d=OM.event.LayerEvent;
var o=n.pageX-g.lastX;var m=n.pageY-g.lastY;g.mouseLocX=n.pageX;g.mouseLocY=n.pageY;g.moving=true;if(g.orientation){g.posX=g.posX+o;
g.posY=g.posY+m;var C=Math.atan2(g.centerY-g.posY,g.posX-g.centerX);var r=g.parentFeature;var F=r.geo;
if(r.tool){F=r.tool.currentPoint;}var E=g.parentLayer.parentMap.getMapContext();var q=E.getUniverse();
var B=q.getZoomLevels()[E.getZoomLevel()];var s=F.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE+20,B,C);
g.setGeometry(s);var u=F.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE/2,B,C);var t=F.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE/2+20,B,C);
var l=new OM.geometry.LineString([u.getX(),u.getY(),t.getX(),t.getY()],u.srid);r.featureEditingProperties.shapePoints[2].setGeometry(l);
var w=new OM.event.LayerEvent(OM.event.LayerEvent.FEATURE_ORIENTATION_CHANGING,g.parentLayer);w.angle=C;
r.fire(d.FEATURE_ORIENTATION_CHANGING,w);}else{if(g.shapeGroup){var A=g.shapeGroup.length;for(var z=0;
z<A;z++){g.shapeGroup[z].translate(o,m);}}else{if(g.scale&&(g.geo.type=="Point"||g.geo.type=="OrientedPoint")){o/=g.scale;
m/=g.scale;g.shape.translate(o,m);}else{if(g.shape!=null){g.shape.translate(o,m);}}}}g.lastX=n.pageX;
g.lastY=n.pageY;if(g.labelShape){g.labelShape.translate(o,m);}var D=new d(d.FEATURE_MOVING,g);D.orgEvt=n;
g.fire(d.FEATURE_MOVING,D);},endDrag:function(t){var m=this;var D=m.parentLayer;if(D==null){return;}this.dragging=false;
if(!m.moving){if(m.pos){var d=m.parentFeature;var g=d.featureEditingProperties;g.shapePoints[1].setVisible(true);
g.shapePoints[2].setVisible(true);}return;}m.moving=false;var n=m.parentLayer.parentMap.$oracleMapDiv.offset();
if(!m.lockedParMap){D.parentMap.enableMapAction.drag=true;}var u=m.startX-m.mouseLocX;var s=m.startY-m.mouseLocY;
var C=D.parentMap.getMapContext();var w=C.getUniverse();var A=w.getZoomLevels()[C.getZoomLevel()];m.move(u,s,A);
m.startX=null;m.startY=null;if(D.labelsVisible()){D.parentMap.refreshVectorLayerLabels();}var l=OM.event.LayerEvent;
if(m.pos){var d=m.parentFeature;var g=d.featureEditingProperties;g.shapePoints[1].move(u,s,A);g.shapePoints[1].shape.translate(-u,-s);
g.shapePoints[2].move(u,s,A);g.shapePoints[2].shape.translate(-u,-s);g.shapePoints[1].setVisible(true);
g.shapePoints[2].setVisible(true);var q=this.geo.getX();var o=this.geo.getY();if(d.tool){var r=d.tool.currentPoint==d.geo;
d.tool.currentPoint.setPoint(q,o);}else{var E=d.geo;E.setPoint(q,o);var z={x:m.screenPoints.x,y:m.screenPoints.y,angle:d.screenPoints.angle};
d.setGeometry(E);d.screenPoints=z;}}var B=new l(l.FEATURE_MOVED,m);m.fire(l.FEATURE_MOVED,B);this.addEditProperties(true);
return u&&s;},addEditProperties:function(M){if(this.parentFeature!=null){return;}var l=this.getGeometry();
var u=this.parentLayer.parentMap.getMapContext().getUniverse();if(l.type!="Polygon"&&l.type!="LineString"&&l.type!="Point"&&l.type!="OrientedPoint"){return;
}var N=this.parentLayer.parentMap.getDefaultFeatureLayer();var d={};var E=OM.layer.EditableFeature;var t=l;
var H=E.bgLineStyle;if(l.type=="Polygon"){H=E.bgPolyStyle;}else{if(l.type=="Point"){H=E.POINT_BACKGROUND;
}else{if(l.type=="OrientedPoint"){H=E.ORIENTEDPOINT_BACKGROUND;t=new OM.geometry.Point(l.getX(),l.getY(),l.srid);
}}}d.shapePoints=[];d.possiblePoints=[];this.featureEditingProperties=d;if(l.type=="Point"||l.type=="OrientedPoint"){if(l.type=="OrientedPoint"){var w=new OM.geometry.Point(l.getX(),l.getY(),l.srid);
var O=new OM.layer.EditableFeature(this.id+"pos",w,{renderingStyle:E.pointStyle});O.parentFeature=this;
O.pos=true;N.addFeature(O);d.shapePoints.push(O);var K=this.parentLayer.parentMap.getMapContext();var u=K.getUniverse();
var G=u.getZoomLevels()[K.getZoomLevel()];w=l.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE+20,G);
var e=new OM.layer.EditableFeature(this.id+"orien",w,{renderingStyle:E.ORIENTATION_POINT_STYLE});e.parentFeature=this;
e.orientation=true;N.addFeature(e);d.shapePoints.push(e);var A=l.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE/2,G);
var z=l.getOrientationPoint(OM.layer.EditableFeature.MARKER_SIZE/2+20,G);var s=new OM.geometry.LineString([A.getX(),A.getY(),z.getX(),z.getY()],A.srid);
var L=new OM.Feature(this.id+"orienline",s,{renderingStyle:E.ORIENTATION_LINE_STYLE});L.parentFeature=this;
N.addFeature(L);d.shapePoints.push(L);}}if(l.type!="Polygon"&&l.type!="LineString"){return;}var F=null;
var g=null;if(l.type=="Polygon"){g=l.coordinates[0];F=g.length/2-1;}else{g=l.coordinates;F=g.length/2;
}for(var D=0;D<F;D++){point=new OM.layer.EditableFeature(this.id+"shapePoints"+D,new OM.geometry.Point(g[D*2],g[D*2+1],l.srid),{renderingStyle:E.pointStyle});
point.parentFeature=this;point.addListener(OM.event.LayerEvent.FEATURE_MOVING,point.shapePointMoving);
point.addListener(OM.event.MouseEvent.MOUSE_RIGHT_CLICK,point.showContextMenu);point.addListener(OM.event.LayerEvent.FEATURE_MOVED,point.shapePointMoved);
d.shapePoints.push(point);N.addFeature(point);}for(var D=0;D<F;D++){var B=D+1;if(B==F&&l.type=="Polygon"){B=0;
}else{if(B==F){break;}}var J=d.shapePoints[D].geo.getX();var I=d.shapePoints[D].geo.getY();var q=d.shapePoints[B].geo.getX();
var n=d.shapePoints[B].geo.getY();var r=J+(q-J)/2;var o=I+(n-I)/2;point=new OM.layer.EditableFeature(this.id+"possiblePoints"+D,new OM.geometry.Point(r,o,l.srid),{renderingStyle:E.possibleStyle});
point.parentFeature=this;point.addListener(OM.event.LayerEvent.FEATURE_MOVING,point.possiblePointMoving);
point.addListener(OM.event.LayerEvent.FEATURE_MOVED,point.possiblePointMoved);d.possiblePoints.push(point);
N.addFeature(point);}this.calDistance();var m=this;var C=function(U){var Q=U.target.parentLayer.parentMap;
var P=U.evt.pageX;var V=U.evt.pageY;var T=U.target;var S=new OM.layer.Menu(Q,{left:P,top:V});var R=function(){if(T&&T.parentFeature){var W=new OM.tool.RedlineTool(map,OM.tool.RedlineTool.TYPE_POLYGON);
W.setStyle({type:OM.tool.RedlineTool.TYPE_POLYGON,style:new OM.style.Color({styleName:"polygonToolStyle",fillOpacity:1,stroke:"#ff00C0",fill:"#FFFFFF",strokeThickness:1})});
W.start();}};S.show=true;};},calDistance:function(){var u=null;var t=OM.layer.EditableFeature;var g=null;
var z=this.getGeometry();var d=this.featureEditingProperties;var q=this.parentLayer.parentMap.getDefaultFeatureLayer();
if(z.type=="Polygon"){g=z.coordinates[0];u=g.length/2-1;}else{g=z.coordinates;u=g.length/2;}for(var n=0;
n<u;n++){var m=n+1;if(m==u&&z.type=="Polygon"){m=0;}else{if(m==u){break;}}var s=d.shapePoints[n].geo.getX();
var o=d.shapePoints[n].geo.getY();var A=d.shapePoints[m].geo.getX();var w=d.shapePoints[m].geo.getY();
var l=this.parentLayer.parentMap.getMapContext();var r=l.getUniverse();var e=r.getZoomLevels()[l.getZoomLevel()];
var B=Math.pow(Math.pow((s-A)/e.resolution,2)+Math.pow((o-w)/e.resolution*e.stretchRatio,2),1/2);if(B<OM.layer.EditableFeature.NEAREST_DISTANCE){d.possiblePoints[n].setVisible(false);
}else{d.possiblePoints[n].setVisible(true);}}},startEditing:function(d){if(this.dragging){return;}if(this.parentFeature!=null){return;
}var n=this.geo;if(n instanceof OM.geometry.Circle||n instanceof OM.geometry.Rectangle){return;}var m=OM.layer.EditableFeature;
this.editing=true;if(n.type=="Point"&&this.parentFeature==null){this.normalStyle=this.renderingStyle;
this.setRenderingStyle(m.pointStyle);this.deleteEditingProperties();this.addEditProperties(true);return;
}else{if(n.type=="OrientedPoint"&&this.parentFeature==null){if(this.tool){this.tool.currentPoint=this.geo.clone();
var e=this.tool;if(e.textFeature&&e.textFeature!==this){e.textFeature.parentLayer.deselectFeature(e.textFeature);
}OM.tool.WhiteBoardTool.showDialog(map,this.tool,this);}this.remove();this.displayed=false;this.deleteEditingProperties();
this.addEditProperties(true);return;}else{if(n.type=="Polygon"||n.type=="LineString"){this.deleteEditingProperties();
this.addEditProperties(true);var g=this.parentLayer.parentMap;var l=this.featureEditingProperties;g.on(OM.event.MapEvent.I_MAP_CENTER_ZOOM,this.calDistance,this);
}else{OM.util.Logger.alert("","OM.EditableFeature.startEditing","Unsupported editing geometry!");}}}},deleteEditingProperties:function(e){var m=this.featureEditingProperties;
var l=this.parentLayer.parentMap.getDefaultFeatureLayer();if(m==null){return;}var d=m.shapePoints.length;
for(var g=0;g<d;g++){l.removeFeature(m.shapePoints[g]);}m.shapePoints=[];d=m.possiblePoints.length;for(var g=0;
g<d;g++){l.removeFeature(m.possiblePoints[g]);}m.possiblePoints=[];OM.$("#"+l.group._id).unbind();this.featureEditingProperties=null;
},shapePointMoved:function(d){this.dragging=false;this.parentFeature.featurePointMoved(d,true);this.parentFeature.fire(OM.event.LayerEvent.FEATURE_EDITED);
},possiblePointMoved:function(d){this.dragging=false;this.parentFeature.featurePointMoved(d,false);this.parentFeature.fire(OM.event.LayerEvent.FEATURE_EDITED);
},digHole:function(){console.info("hole");},deleteShapePoint:function(t){var w=t.parentFeature;var e=w.featureEditingProperties;
var l=t.parentLayer.parentMap.getDefaultFeatureLayer();var u=null;var n=null;var o=null;var q=null;if(w.geo.type=="Polygon"||w.geo.type=="LineString"){var m=e.shapePoints.length;
if(m<=2){OM.util.Logger.alert("","OM.EditableFeature.deleteShapePoint","line need at least 2 shape points");
return;}if(w.geo.type=="Polygon"&&m<=3){OM.util.Logger.alert("","OM.EditableFeature.deleteShapePoint","Polygon need at least 3 shape points");
return;}while(m--){if(e.shapePoints[m]==t){if(m!=0&&m!=(e.shapePoints.length-1)){u=e.possiblePoints[m-1];
o=e.shapePoints[m-1];n=e.possiblePoints[m];q=e.shapePoints[m+1];var s=o.geo.getX()+(q.geo.getX()-o.geo.getX())/2;
var r=o.geo.getY()+(q.geo.getY()-o.geo.getY())/2;n.setGeometry(new OM.geometry.Point(s,r,t.geo.srid));
}else{if(w.geo.type=="Polygon"){if(m==0){u=e.possiblePoints[e.possiblePoints.length-1];o=e.shapePoints[e.shapePoints.length-1];
n=e.possiblePoints[m];q=e.shapePoints[m+1];}else{if(m==(e.shapePoints.length-1)){u=e.possiblePoints[m-1];
o=e.shapePoints[m-1];n=e.possiblePoints[m];q=e.shapePoints[0];}}var s=o.geo.getX()+(q.geo.getX()-o.geo.getX())/2;
var r=o.geo.getY()+(q.geo.getY()-o.geo.getY())/2;n.setGeometry(new OM.geometry.Point(s,r,t.geo.srid));
}else{if(w.geo.type=="LineString"){if(m==0){n=e.possiblePoints[m];l.removeFeature(n);e.possiblePoints.splice(m,1);
}else{if(m==(e.shapePoints.length-1)){u=e.possiblePoints[m-1];}}}}}}}}for(var g=0;g<e.shapePoints.length;
g++){if(e.shapePoints[g]==t){e.shapePoints.splice(g,1);l.removeFeature(t);}}if(u){for(var g=0;g<e.possiblePoints.length;
g++){if(e.possiblePoints[g]==u){e.possiblePoints.splice(g,1);l.removeFeature(u);}}}var d=[];for(var g=0;
g<e.shapePoints.length;g++){e.shapePoints[g].id=w.id+"shapePoints"+g;d.push(e.shapePoints[g].geo.getX());
d.push(e.shapePoints[g].geo.getY());}if(w.geo.type=="Polygon"){d.push(e.shapePoints[0].geo.getX());d.push(e.shapePoints[0].geo.getY());
w.setGeometry(new OM.geometry.Polygon([d],w.geo.srid));}else{if(w.geo.type=="LineString"){w.setGeometry(new OM.geometry.LineString(d,w.geo.srid));
}}for(var g=0;g<e.possiblePoints.length;g++){e.possiblePoints[g].id=w.id+"possiblePoints"+g;}},featurePointMoving:function(t,g){var u=t.target.parentFeature;
var l=u.parentLayer.parentMap;var e=new OM.style.Line({stroke:"#8684F3",strokeThickness:5,strokeOpacity:0.5});
var d=t.target.graphics;var m=null;var n=null;if(u&&(u.geo.type=="Polygon"||u.geo.type=="LineString")){if(g){if(t.target.relatedFeature.length<1){u.calRelatedFeature(u.featureEditingProperties,t.target);
}m=t.target.relatedFeature[1];n=t.target.relatedFeature[3];}else{if(t.target.relatedFeature.length<1){u.calRelatedFeature(u.featureEditingProperties,t.target);
}m=t.target.relatedFeature[1];n=t.target.relatedFeature[2];}var w=d.getLeftTop(m.parentLayer.group);var r=d.getLeftTop(l.draggableGroup);
var q=t.orgEvt.pageX-l.$oracleMapDiv.offset().left-w.x-r.x;var o=t.orgEvt.pageY-l.$oracleMapDiv.offset().top-w.y-r.y;
var s=m.parentLayer.group;if(!u.editingLineBefore&&!u.editingLineAfter){if(m){u.editingLineBefore=d.drawPath([[m.screenPoints.x,m.screenPoints.y,q,o]],e,{group:s});
u.editingLineBefore.setStrokeDashArray([10]);m.bringToTop();}if(n){u.editingLineAfter=d.drawPath([[n.screenPoints.x,n.screenPoints.y,q,o]],e,{group:s});
u.editingLineAfter.setStrokeDashArray([10]);n.bringToTop();}t.target.bringToTop();}else{if(m){d.setPath(u.editingLineBefore,[[m.screenPoints.x,m.screenPoints.y,q,o]]);
}if(n){d.setPath(u.editingLineAfter,[[n.screenPoints.x,n.screenPoints.y,q,o]]);}}}},featurePointMoved:function(u,w){if(u.target.relatedFeature.length==0){return;
}u.target.graphics.remove(this.editingLineBefore);this.editingLineBefore=null;u.target.graphics.remove(this.editingLineAfter);
this.editingLineAfter=null;var r=u.target;var z=r.parentFeature;var e=z.featureEditingProperties;var J=z.parentLayer.parentMap.getDefaultFeatureLayer();
var D=OM.layer.EditableFeature;var I=J.parentMap.getMapContext();var A=I.getUniverse();var F=A.getZoomLevels()[I.getZoomLevel()];
if(w){if(z.geo.type=="Polygon"||z.geo.type=="LineString"){var s=r.geo.getX()+(u.target.relatedFeature[1].geo.getX()-r.geo.getX())/2;
var q=r.geo.getY()+(u.target.relatedFeature[1].geo.getY()-r.geo.getY())/2;u.target.relatedFeature[0].setGeometry(new OM.geometry.Point(s,q,r.geo.srid));
var H=r.geo.getX();var G=r.geo.getY();var o=u.target.relatedFeature[1].geo.getX();var n=u.target.relatedFeature[1].geo.getY();
var t=Math.pow(Math.pow((H-o)/F.resolution,2)+Math.pow((G-n)/F.resolution*F.stretchRatio,2),1/2);if(t<OM.layer.EditableFeature.NEAREST_DISTANCE){u.target.relatedFeature[0].setVisible(false);
}else{u.target.relatedFeature[0].setVisible(true);}if(u.target.relatedFeature[3]){s=r.geo.getX()+(u.target.relatedFeature[3].geo.getX()-r.geo.getX())/2;
q=r.geo.getY()+(u.target.relatedFeature[3].geo.getY()-r.geo.getY())/2;u.target.relatedFeature[2].setGeometry(new OM.geometry.Point(s,q,r.geo.srid));
o=u.target.relatedFeature[3].geo.getX();n=u.target.relatedFeature[3].geo.getY();t=Math.pow(Math.pow((H-o)/F.resolution,2)+Math.pow((G-n)/F.resolution*F.stretchRatio,2),1/2);
if(t<OM.layer.EditableFeature.NEAREST_DISTANCE){u.target.relatedFeature[2].setVisible(false);}else{u.target.relatedFeature[2].setVisible(true);
}}}}else{if(z.geo.type=="Polygon"||z.geo.type=="LineString"){var m=u.target.relatedFeature[0];e.shapePoints.splice(m+1,0,r);
r.setRenderingStyle(D.pointStyle);r.addListener(OM.event.LayerEvent.FEATURE_MOVING,r.possiblePointMoving);
r.addListener(OM.event.LayerEvent.FEATURE_MOVING,r.shapePointMoving);r.deleteListener(OM.event.LayerEvent.FEATURE_MOVED,r.possiblePointMoved);
r.addListener(OM.event.LayerEvent.FEATURE_MOVED,r.shapePointMoved);r.addListener(OM.event.MouseEvent.MOUSE_RIGHT_CLICK,r.showContextMenu);
for(var C=0;C<e.shapePoints.length;C++){e.shapePoints[C].id=z.id+"shapePoints"+C;}var d=u.target.relatedFeature[1].geo;
var g=r.geo;s=d.getX()+(g.getX()-d.getX())/2;q=d.getY()+(g.getY()-d.getY())/2;var B=new OM.layer.EditableFeature(z.id+"possiblePoints"+m,new OM.geometry.Point(s,q,r.geo.srid),{renderingStyle:D.pointStyle});
B.parentFeature=z;B.addListener(OM.event.LayerEvent.FEATURE_MOVING,B.possiblePointMoving);B.addListener(OM.event.LayerEvent.FEATURE_MOVED,B.possiblePointMoved);
J.addFeature(B);e.possiblePoints.splice(m,1,B);var H=r.geo.getX();var G=r.geo.getY();var o=u.target.relatedFeature[1].geo.getX();
var n=u.target.relatedFeature[1].geo.getY();var t=Math.pow(Math.pow((H-o)/F.resolution,2)+Math.pow((G-n)/F.resolution*F.stretchRatio,2),1/2);
if(t<OM.layer.EditableFeature.NEAREST_DISTANCE){B.setVisible(false);}else{B.setVisible(true);}s=r.geo.getX()+(u.target.relatedFeature[2].geo.getX()-r.geo.getX())/2;
q=r.geo.getY()+(u.target.relatedFeature[2].geo.getY()-r.geo.getY())/2;B=new OM.layer.EditableFeature(z.id+"possiblePoints"+e.possiblePoints.lenth,new OM.geometry.Point(s,q,r.geo.srid),{renderingStyle:D.pointStyle});
B.parentFeature=z;B.addListener(OM.event.LayerEvent.FEATURE_MOVING,B.possiblePointMoving);B.addListener(OM.event.LayerEvent.FEATURE_MOVED,B.possiblePointMoved);
J.addFeature(B);e.possiblePoints.splice(m+1,0,B);o=u.target.relatedFeature[2].geo.getX();n=u.target.relatedFeature[2].geo.getY();
t=Math.pow(Math.pow((H-o)/F.resolution,2)+Math.pow((G-n)/F.resolution*F.stretchRatio,2),1/2);if(t<OM.layer.EditableFeature.NEAREST_DISTANCE){B.setVisible(false);
}else{B.setVisible(true);}for(var C=0;C<e.possiblePoints.length;C++){e.possiblePoints[C].id=z.id+"possiblePoints"+C;
e.possiblePoints[C].setRenderingStyle(D.possibleStyle);}}}var E=e.shapePoints.length;var l=[];for(var C=0;
C<E;C++){l.push(e.shapePoints[C].geo.getX());l.push(e.shapePoints[C].geo.getY());}if(z.geo.type=="Polygon"){l.push(e.shapePoints[0].geo.getX());
l.push(e.shapePoints[0].geo.getY());z.setGeometry(new OM.geometry.Polygon([l],z.geo.srid));}else{if(z.geo.type=="LineString"){z.setGeometry(new OM.geometry.LineString(l,z.geo.srid));
}}}});OM.layer.EditableFeature.MARKER_SIZE=10;OM.layer.EditableFeature.NEAREST_DISTANCE=35;if(OM.browser.touchSupported){OM.layer.EditableFeature.MARKER_SIZE=20;
OM.layer.EditableFeature.NEAREST_DISTANCE=50;}OM.layer.EditableFeature.POINT_BACKGROUND=new OM.style.Marker({width:30,height:30,vectorDef:[{shape:{type:"rectangle",x:0,y:0,width:30,height:30},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1,fillOpacity:0,strokeOpacity:0}}]});
OM.layer.EditableFeature.ORIENTEDPOINT_BACKGROUND=new OM.style.Marker({width:70,height:70,vectorDef:[{shape:{type:"rectangle",x:0,y:0,width:70,height:70},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1,fillOpacity:0,strokeOpacity:0}}]});
OM.layer.EditableFeature.ORIENTATION_POINT_STYLE=new OM.style.Marker({styleName:"_orientationPointStyle",width:OM.layer.EditableFeature.MARKER_SIZE,height:OM.layer.EditableFeature.MARKER_SIZE,vectorDef:[{shape:{type:"circle",cx:OM.layer.EditableFeature.MARKER_SIZE/2,cy:OM.layer.EditableFeature.MARKER_SIZE/2},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1}}]});
OM.layer.EditableFeature.ORIENTATION_LINE_STYLE=new OM.style.Line({styleName:"_orientationLinetyle",stroke:"#0000ff",strokeThickness:1});
OM.layer.EditableFeature.pointStyle=new OM.style.Marker({width:OM.layer.EditableFeature.MARKER_SIZE,height:OM.layer.EditableFeature.MARKER_SIZE,vectorDef:[{shape:{type:"rectangle",x:0,y:0,width:OM.layer.EditableFeature.MARKER_SIZE,height:OM.layer.EditableFeature.MARKER_SIZE},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1}}]});
OM.layer.EditableFeature.possibleStyle=new OM.style.Marker({width:OM.layer.EditableFeature.MARKER_SIZE,height:OM.layer.EditableFeature.MARKER_SIZE,vectorDef:[{shape:{type:"rectangle",x:0,y:0,width:OM.layer.EditableFeature.MARKER_SIZE,height:OM.layer.EditableFeature.MARKER_SIZE},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1,fillOpacity:0.4,strokeOpacity:0.4}}]});
OM.layer.EditableFeature.bgPolyStyle=new OM.style.Color({styleName:"polygonToolStyle",fillOpacity:0,fill:"#8D8DFF",stroke:"#C0C0C0",strokeThickness:15,strokeOpacity:0});
OM.layer.EditableFeature.bgLineStyle=new OM.style.Line({styleName:"polygonToolStyle",fillOpacity:0,fill:"#8D8DFF",stroke:"#C0C0C0",strokeThickness:15,strokeOpacity:0});
OM.layer.XMLMapLayer=OM.layer.Layer.extend({setXMLRequest:function(d){this.xmlRequest=d;}});OM.layer.OSMTileLayer=OM.layer.TileLayer.extend({initialize:function(d){this._super(d,{tileLayerConfig:OM.layer.TileLayerConfig.CONFIG_OSM,getTileURL:function(g,e,t,n){var q=this.tileLayerConfig.bounds;
var m=this.tileLayerConfig.tileImageHeight;var s=this.tileLayerConfig.zoomLevels[g];var r=(q.getMaxY()-n.getMaxY())/s.resolution/m;
var o=(e+r)%3;var l="a";switch(o){case 1:l="b";break;case 2:l="c";}url="http://"+l+".tile.openstreetmap.org/"+g+"/"+e+"/"+r+".png";
return url;}});}});OM.layer.Menu=OM.Class.extend({initialize:function(l,m){var g=this;this.map=l;this.menuId="menu_0";
this.menuTableId="mvmenu_table_0";this.menuTableBodyId="mvmenu_table_body_0";this.show=false;for(var e=0;
e<this.map.decorationArray.length;e++){if(this.map.decorationArray[e]&&this.map.decorationArray[e].sblx=="menu_0"){this.map.removeMapDecoration(this.map.decorationArray[e]);
}}var d="<table id='"+this.menuTableId+"' cellpadding=0 cellspacing=0 style='width:0px'><tr><td style='border-width:0px;border-style:solid;border-color:black;background-color:white'><table width=100%><tbody id='"+this.menuTableBodyId+"'></tbody></table></td></tr></table>";
this.menu=new OM.control.MapDecoration(d,{offsetX:m.left,offsetY:m.top},{draggable:true,panelOptions:{style:{"border-style":"solid","border-color":"#0000ff","border-width":"1px",backgroundColor:"#FDFDFD",filter:"alpha(Opacity=80)","-moz-opacity":"0.8",opacity:"0.8"}}});
this.menu.sblx="menu_0";this.map.addMapDecoration(this.menu);OM.layer.Menu.count=OM.layer.Menu.count+1;
this.removeRightClickMenu=function(n){n&&n.preventDefault();if(g.menu){if(g.show){g.map.removeMapDecoration(g.menu);
g.map.deleteListener(OM.event.MouseEvent.MOUSE_CLICK,g.removeRightClickMenu);g.menu=null;g.show=false;
}}};if(!OM.browser.touchSupported){this.map.$oracleMapDiv.bind("click",this.removeRightClickMenu);}else{this.map.$oracleMapDiv.bind("touchstart",this.removeRightClickMenu);
}},addMenuItem:function(q,g){var d=document.getElementById(this.menuTableBodyId);var o=document.getElementById(this.menuTableId).style.width;
var e=parseInt(o.substr(0,o.length-2));document.getElementById(this.menuTableId).style.width=(q.length*12)+"px";
var r=document.createElement("tr");d.appendChild(r);r.style.fontFamily="Arial, Helvetica, Geneva, sans-serif";
r.style.fontSize="12px";r.style.cursor="pointer";r.align="center";var l=document.createElement("td");
l.innerHTML=q;r.appendChild(l);r.onmouseover=function(){this.style.backgroundColor="#336699";this.style.color="#ffffff";
};r.onmouseout=function(){this.style.backgroundColor="transparent";this.style.color="#000000";};if(g){var m=function(s){s.stopPropagation();
s.preventDefault();n.removeRightClickMenu();g();};var n=this;if(!OM.browser.touchSupported){OM.$(r).mousedown(m);
}else{OM.$(r).bind("touchstart",m);}}}});OM.layer.Menu.count=0;OM.layer.VectorLayerHeatMap=OM.Class.extend({initialize:function(g,e){this.opacity=g&&g.opacity>0&&g.opacity<1?g.opacity:1;
this.initColor(g.colorStops);this.vectorLayer=e;this.maxValue=g.maxValue;this.minValue=g.minValue;this.loadingBoundaray=false;
var d=this;this.containerVectorLayer=g.containerVectorLayer;if(this.containerVectorLayer&&this.containerVectorLayer.serverURL==null){this.containerVectorLayer.serverURL=e.parentMap.mapviewerURL;
}if(this.containerVectorLayer&&!this.containerVectorLayer.dataLoaded&&!this.containerVectorLayer.loading&&!this.containerVectorLayer.usedInOverview){d.containerVectorLayer.parentMap=d.vectorLayer.parentMap;
d.loadingBoundaray=true;d.containerVectorLayer.dataBufferWindow=d.vectorLayer.dataBufferWindow;d.containerVectorLayer.getThemeData(null,function(){d.containerVectorLayer.loading=false;
d.loadingBoundaray=false;},function(){d.containerVectorLayer.loading=false;d.loadingBoundaray=false;});
}else{if(this.containerVectorLayer){d.loadingBoundaray=true;var l=function(){if(d.containerVectorLayer.dataLoaded){d.loadingBoundaray=false;
return;}else{setTimeout(l,100);}};l();}}},init:function(e,q,l,g,m){var s=OM.layer.VectorLayerHeatMap.size;
this.realWidth=e;this.realHeight=q;this.width=e;this.height=q;this.scale=1;this.minX=l;this.minY=g;if(e>s||q>s){var o=Math.ceil(e/s);
var n=Math.ceil(q/s);if(o>n){this.scale=o;}else{this.scale=n;}this.width=parseInt(e/this.scale);this.height=parseInt(q/this.scale);
}this.data=[];this.realMaxValue=Number.NEGATIVE_INFINITY;this.realMinValue=Number.POSITIVE_INFINITY;var d=m/this.scale;
this.radius=d>1?Math.floor(d):1;if(this.radius>50){this.radius=50;}},addData:function(d,n,m){if(d>this.maxX){this.maxX=d;
}if(!this.data[d]){this.data[d]=[];}if(!this.data[d][n]){this.data[d][n]={num:0,value:0};}var l=this.data[d][n].num;
if(this.isValued){var g=(this.data[d][n].value*l+m)/(l+1);this.data[d][n]={num:l+1,value:g};if(g>this.realMaxValue){this.realMaxValue=g;
}if(g<this.realMinValue){this.realMinValue=g;}}else{var e=this.data[d][n].value+m;this.data[d][n]={num:l+1,value:e};
if(e>this.realMaxValue){this.realMaxValue=e;}if(e<this.realMinValue){this.realMinValue=e;}}},drawHeatMap:function(m){this.numClass=this.origNum;
this.max=this.realMaxValue,this.min=this.realMinValue;if(this.maxValue!=undefined){this.max=this.maxValue;
if(this.maxValue<this.realMaxValue){this.numClass--;}}if(this.minValue!=undefined){this.min=this.minValue;
if(this.minValue>this.realMinValue){this.numClass--;}}if(this.numClass<=0){this.numClass=1;}this.step=(this.max-this.min)/this.numClass;
var d=this.drawShrunkenMap();var e=document.createElement("canvas");e.width=this.realWidth;e.height=this.realHeight;
var g=e.getContext("2d");this.clip(g);var l=Math.round(this.scale/2);g.drawImage(d,0,0,this.width,this.height,0-l,0-l,this.realWidth-this.scale/2,this.realHeight-this.scale/2);
m(e);},initColor:function(g){var l=document.createElement("canvas");l.width="1";l.height="256";var e=l.getContext("2d");
var n=e.createLinearGradient(0,0,1,256);var d=g.length;for(var m=0;m<d;m++){n.addColorStop(m/d,g[m]);
}e.fillStyle=n;e.fillRect(0,0,1,256);this.colorData=e.getImageData(0,0,1,256).data;this.origNum=d;},drawShrunkenMap:function(){var l=document.createElement("canvas");
l.width=this.width;l.height=this.height;var u=l.getContext("2d");var q=u.getImageData(0,0,this.width,this.height);
var e=q.data;if(this.isValued){var w=[];for(var o=0;o<this.width;o++){if(!w[o]){w[o]=[];}for(var n=0;
n<this.height;n++){if(!this.data[o]||!this.data[o][n]){continue;}w[o][n]=this.data[o][n];this.calculate(w,o,n,this.radius);
}}for(var o=0;o<this.height;o++){for(var n=0;n<this.width;n++){var s=(o*this.width+n)*4;var d={r:255,g:255,b:255};
if(w[n][o]&&w[n][o].num>=1){d=this.getPixelValue(w[n][o].value);}e[s]=d.r;e[s+1]=d.g;e[s+2]=d.b;if(d.r==255&&d.b==255&&d.g==255){e[s+3]=0;
}else{e[s+3]=this.opacity*255;}}}}else{for(var o=0;o<this.width;o++){for(var n=0;n<this.height;n++){if(this.data[o]&&this.data[o][n]){var r=this.data[o][n].value/this.max;
var t=u.createRadialGradient(o,n,0,o,n,this.radius);t.addColorStop(0,"rgba(0,0,0,"+r+")");t.addColorStop(1,"rgba(0,0,0,0)");
u.fillStyle=t;u.beginPath();u.arc(o,n,this.radius,0,Math.PI*2,true);u.closePath();u.fill();}}}var q=u.getImageData(0,0,this.width,this.height);
var e=q.data;var g=e.length;for(var o=3;o<g;o+=4){var m=e[o];if(m!=0){var s=m*4;e[o-3]=this.colorData[s];
e[o-2]=this.colorData[s+1];e[o-1]=this.colorData[s+2];e[o]=this.opacity*255;}}}q.data=e;u.putImageData(q,0,0);
return l;},clip:function(e){if(!this.containerVectorLayer){return;}var l=this.vectorLayer.parentMap.getMapContext().getTransform();
var A=this.containerVectorLayer.size();if(A==0){return;}e.beginPath();var w=0;for(var o=0;o<A;o++){var n=this.containerVectorLayer.featureArray[o].getGeometry();
var t=n.getMBR();var s=this.vectorLayer.dataBufferWindow;if(t!=null&&(t.maxX<s.x||t.maxY<s.y||t.minX>s.x+s.w||t.minY>s.y+s.h)){continue;
}if(n.type=="Polygon"){var q=n.coordinates.slice(0);for(var m=0;m<1;m++){var u=q[m].slice(0);u=l.transformHeatMapSegment(u,1,n.dim,this.minX,this.minY,1);
if(!u){continue;}var g=u.length;if(g<6){continue;}e.moveTo(u[0],u[1]);for(var d=2;d<g;d+=2){e.lineTo(u[d],u[d+1]);
}}}else{if(n.type=="MultiPolygon"){var q=n.coordinates.slice(0);var r=q.length;var z=[];for(var m=0;m<r;
m++){var u=q[m][0].slice(0);u=l.transformHeatMapSegment(u,1,n.dim,this.minX,this.minY,1);if(!u){continue;
}var g=u.length;if(g<6){continue;}e.moveTo(u[0],u[1]);for(var d=2;d<g;d+=2){e.lineTo(u[d],u[d+1]);}}}}}e.closePath();
e.clip();},getPixelValue:function(e){if(e>this.max&&this.maxValue!=undefined){e=this.max;}if(e<this.min&&this.minValue!=undefined){e=this.min;
}var d=parseInt((e-this.min)/this.step);var g=parseInt(d*255/this.numClass)*4;return{r:this.colorData[g],g:this.colorData[g+1],b:this.colorData[g+2]};
},calculate:function(B,z,u,r){for(var l=-r;l<=r;l++){var w=u+l;if(w<0){continue;}var o=Math.sqrt(r*r-(u-w)*(u-w));
var e=Math.floor(z-o),d=Math.ceil(z+o);e=e<0?0:e;for(var g=e;g<=d;g++){if(!B[g]){B[g]=[];}if(z!=g||u!=w){var t=Math.sqrt((g-z)*(g-z)+l*l);
var q=B[z][u].num/t;var A=B[z][u].value*q;if(B[g][w]){var s=B[g][w].num+q;B[g][w]={num:s,value:(B[g][w].num*B[g][w].value+A)/s};
}else{B[g][w]={num:q,value:A/q};}}}}}});OM.layer.VectorLayerHeatMap.size=256;OM.visualfilter.VisualFilter=OM.Class.extend({initialize:function(){}});
OM.visualfilter.DropShadow=OM.visualfilter.VisualFilter.extend({initialize:function(d){this.type="DROPSHADOW";
this.angle=d&&d.angle!=undefined?d.angle:45;this.color=d&&d.color!=undefined?d.color:null;this.knockout=d&&d.knockout!=undefined?d.knockout:null;
this.offset=d&&d.offset!=undefined?d.offset:2;this.opacity=d&&d.opacity!=undefined?d.opacity:0.5;this.radius=d&&d.radius!=undefined?d.radius:2;
this.applyToLayer=d&&d.applyToLayer!=undefined?d.applyToLayer:true;}});OM.visualfilter.Glow=OM.visualfilter.VisualFilter.extend({initialize:function(d){this.type="GLOW";
this.color=d&&d.color!=undefined?d.color:null;this.strength=d&&d.strength!=undefined?d.strength:3;this.applyToLayer=d&&d.applyToLayer!=undefined?d.applyToLayer:true;
}});OM.infowindow.MVInfoLayerControl=function(l,n,g,d){this.minX;this.minY;this.maxX;this.maxY;var e=l.getMapContext();
this.width=e.getDeviceWidth();this.height=e.getDeviceHeight();this.parentMap=l;this.wininfo=null;this.$div=OM.$("<div style='position:absolute;z-index:3000'></div>");
this.parentMap.$infoWinLayerDIV.append(this.$div);this.div=this.$div[0];this.infoWindows=new Array(0);
this.enablePropagation=false;this.mouseOver=false;this.id=n;l.addListener(OM.event.MapEvent.I_MAP_DRAGGING,OM.infowindow.MVInfoLayerControl.panEventAction);
l.addListener(OM.event.MapEvent.MAP_BEFORE_REFRESH,OM.infowindow.MVInfoLayerControl.refreshEventAction);
l.addListener(OM.event.MapEvent.I_MAP_CENTER_ZOOM,OM.infowindow.MVInfoLayerControl.zoomEventAction);l.addListener(OM.event.MapEvent.MAP_RESIZED,OM.infowindow.MVInfoLayerControl.resizeEventAction);
l.addListener(OM.event.MapEvent.MAP_DESTROY,OM.infowindow.MVInfoLayerControl.destroyEventAction);l.addListener(OM.event.MapEvent.MAP_CLEAN,OM.infowindow.MVInfoLayerControl.refreshEventAction);
var m=this;m.infoStopPropagation=function(o){if(!m.parentMap.infoWindowEventPropogation){o.stopPropagation();
}};m.infoMouseOver=function(o){m.mouseOnInfoWindow=true;if(m.div){m.div.style.zIndex=3001;}m.infoStopPropagation(o);
};m.infoMouseOut=function(o){m.mouseOnInfoWindow=false;if(m.div){m.div.style.zIndex=3000;}m.infoStopPropagation(o);
};this.$div.bind("mouseout",function(o){o.stopPropagation();});this.$div.bind("mousewheel mousedown mouseup mouseover mouseout click keyup keydown keypress dblclick",m.infoStopPropagation);
this.$div.bind("mouseover",m.infoMouseOver);this.$div.bind("mouseout",m.infoMouseOut);};OM.infowindow.MVInfoLayerControl.prototype.showInfoWindow=function(g){var m=OM.infowindow.MVInfoWindowStyle;
var s="infowin_"+g.id;var l=g.typeId?g.typeId:this.parentMap.mapInstanceId+"_1";if(m.redrawHandle&&m.redrawHandle[s]){clearTimeout(m.redrawHandle[s]);
m.redrawHandle[s]=null;}var I=this.parentMap;if(g.tabs==null||g.tabs.length==0){return;}var H=g.tabs;
var r=0;if(g.index>0){r=g.index;if(r>H.length-1){r=H.length-1;}}var E=0;for(;E<this.infoWindows.length;
E++){if(s&&this.infoWindows[E].nid==s){this.deleteInfoWindow(this.infoWindows[E]);return;}if(l&&this.infoWindows[E].typeId==l){this.deleteInfoWindow(this.infoWindows[E]);
}}var B=OM.$('<div id="'+s+'"></div>');var J=this.parentMap.getMapContext();var C=J.getUniverse();var G=C.getZoomLevels()[J.getZoomLevel()];
var q=G.resolution;var A=G.stretchRatio;var u=q;var t=q*A;var o=this.width*u/2;var e=this.height*t/2;
var K=J.getCenterPoint();var d={minX:K.getX()-o,maxX:K.getX()+o,minY:K.getY()-e,maxY:K.getY()+e};var D=OM.util.ScreenTransform.getScreenCoordinates(this.parentMap,d.minX,d.minY,d.maxX,d.maxY,this.width,this.height,g.x,g.y);
var n=OM.util.DomUtil.getElementPos(this.$div);D.x-=n.left;D.y-=n.top;B.css({position:"absolute",visibility:"hidden"});
this.div.appendChild(B[0]);this.wininfo=null;var z=g.width;var F=g.height;if(this.domDiv){new OM.infowindow.MVInfoWindow(B,0,0,null,r,z,F,style,false,this,D,{hideCloseButton:true},this.domDiv,id);
}else{if(H.length>1){if(!z||z=="undefined"||z<OM.gv.infoWindowTabsWidth){z=OM.gv.infoWindowTabsWidth;
}if(!F||F=="undefined"||F<OM.gv.infoWindowTabsHeight){F=OM.gv.infoWindowTabsHeight;}}new OM.infowindow.MVInfoWindow({mpane:B,width:z,height:F,tabs:H,parameters:g.styleParameters,screenLoc:D,id:s,typeId:l,parent:this});
}this.infoWindows.push(B);B.nid=s;B.typeId=l;B.winX=D.x;B.winY=D.y;B.css({left:D.x,top:D.y,visibility:"visible","z-index":1200});
};OM.infowindow.MVInfoLayerControl.prototype.showHtmlWindow=function(n,d,o,e){var m=e?e:{};if(m.title){m.title+="&nbsp";
}var l=new OM.infowindow.MVInfoWindowTab(m.title,n);var g=new Array(l);m.tabs=g;m.x=d;m.y=o;this.showInfoWindow(m);
};OM.infowindow.MVInfoLayerControl.prototype.deleteInfoWindow=function(g){var e=OM.infowindow.MVInfoWindowStyle;
var l=this.id;if(e.redrawHandle&&e.redrawHandle[l]){clearTimeout(e.redrawHandle[l]);e.redrawHandle[l]=null;
}var d=0;for(d=0;d<this.infoWindows.length;d++){if(this.infoWindows[d]==g){this.infoWindows.splice(d,1);
}}this.$div.off("mouseover mouseout mousedown mouseup click touchend","**");this.$div.empty();this.mouseOnInfoWindow=false;
};OM.infowindow.MVInfoLayerControl.prototype.setTimeout=function(timeoutHandler,elapseTime){var Ie="tempVar"+MV_timeoutCounter;
MV_timeoutCounter++;eval(Ie+" = this;");var oi=timeoutHandler.replace(/\\/g,"\\\\");oi=oi.replace(/\"/g,'\\"');
return window.setTimeout(Ie+'._setTimeoutDispatcher("'+oi+'");'+Ie+" = null;",elapseTime);};OM.infowindow.MVInfoLayerControl.prototype._setTimeoutDispatcher=function(func){eval(func);
};OM.infowindow.MVInfoLayerControl.prototype.scrollInfoLayer=function(){for(var d=0;d<this.infoWindows.length;
d++){if(this.infoWindows[d].winX<this.parent.mapWindowMinLon||this.infoWindows[d].winX>this.parent.mapWindowMaxLon||this.infoWindows[d].winY<this.parent.mapWindowMinLat||this.infoWindows[d].winY>this.parent.mapWindowMaxLat){this.infoWindows[d].style.visibility="hidden";
}else{this.infoWindows[d].style.visibility="visible";}}};OM.infowindow.MVInfoLayerControl.prototype.replaceWhiteSpace=function(e){var d=e.indexOf("<");
if(d>=0&&e.indexOf(">",d)>=0){return e;}return e.replace(/  /g," &nbsp;");};OM.infowindow.MVInfoLayerControl.prototype.destroy=function(){this.deleteInfoWindows();
this.$div.unbind("mousewheel mousedown mouseup mouseover mouseout click keyup keydown keypress",this.infoStopPropagation);
this.$div.unbind("mouseover",this.infoMouseOver);this.$div.unbind("mouseout",this.infoMouseOut);this.infoStopPropagation=null;
this.infoMouseOver=null;this.infoMouseOut=null;OM.$(this.infoTip).empty();this.infoTip=null;this.div=null;
this.$div=null;this.infoWindows=null;this.wininfo=null;};OM.infowindow.MVInfoLayerControl.prototype.showTabbedHtmlWindow=function(g,d,l,e){e.tabs=g;
e.x=d;e.y=l;this.showInfoWindow(e);};OM.infowindow.MVInfoLayerControl.panEventAction=function(g){var d=g.target.infoLayer;
if(d.$div){var l=OM.util.DomUtil.getElementPos(d.$div);d.$div.css({left:l.left+g.xOffset,top:l.top+g.yOffset});
}};OM.infowindow.MVInfoLayerControl.refreshEventAction=function(d){var g=d.target.infoLayer;g.deleteInfoWindows();
};OM.infowindow.MVInfoLayerControl.zoomEventAction=function(d){var g=d.target.infoLayer;g.closeInfoWindows();
};OM.infowindow.MVInfoLayerControl.destroyEventAction=function(d){var g=d.target.infoLayer;g.destroy();
};OM.infowindow.MVInfoLayerControl.resizeEventAction=function(g){var l=g.target.infoLayer;l.deleteInfoWindows();
var d=l.parentMap.getMapContext();l.width=d.getDeviceWidth();l.height=d.getDeviceHeight();};OM.infowindow.MVInfoLayerControl.prototype.closeInfoWindows=function(){for(var g=0,d=this.infoWindows.length;
g<d;g++){this.deleteInfoWindow(this.infoWindows[g]);}var e=OM.infowindow.MVInfoWindowStyle.redrawHandle;
for(each in e){clearTimeout(e[each]);e[each]=null;}};OM.infowindow.MVInfoLayerControl.prototype.deleteInfoWindows=function(){if(this.infoWindows&&this.infoWindows.length>0){var d=this.infoWindows.pop();
}var e=OM.infowindow.MVInfoWindowStyle.redrawHandle;for(each in e){clearTimeout(e[each]);e[each]=null;
}this.$div.off("mouseover mouseout mousedown mouseup click touchend","**");this.$div.empty();this.mouseOnInfoWindow=false;
};OM.infowindow.MVInfoLayerControl.prototype.deleteInfoWindowById=function(l){var g="infowin_"+l;var d=this.infoWindows.length;
for(var e=0;e<d;e++){if(g&&this.infoWindows[e].nid==g){this.deleteInfoWindow(this.infoWindows[e]);return;
}}};OM.infowindow.MVInfoWindow=function(options){var MVInfoWindowStyle=OM.infowindow.MVInfoWindowStyle;
var globalVariables=OM.gv;var domUtil=OM.util.DomUtil;var width=options.width!=null&&options.width>0?options.width:0;
var height=options.height!=null&&options.height>0?options.height:0;this.parentMap=options.parentMap;var parent=options.parent;
var mpane=options.mpane;var id=options.typeId;var close=function(){if(MVInfoWindowStyle.redrawHandle&&MVInfoWindowStyle.redrawHandle[id]){clearTimeout(MVInfoWindowStyle.redrawHandle[id]);
MVInfoWindowStyle.redrawHandle[id]=null;}parent.deleteInfoWindow(mpane);};if(true){var winDiv=this.winDiv;
MVInfoWindowStyle.init(options.parameters);this.winId=id;var mvinfo=this;var autoResize=false;if(width==0||height==0){autoResize=true;
}var drawInfoWindow=function(){if(autoResize==true){width=0;height=0;}if(MVInfoWindowStyle.sizeChanged(id)){if(options.domDiv&&options.domDiv.parentNode){options.domDiv.parentNode.removeChild(domDiv);
}mpane.empty();winDiv=OM.$('<div style="position:absolute;left:0px;top:0px;z-index:200"></div>');var contentDiv;
if(options.tabs==null&&options.domDiv!=null){contentDiv=MVInfoWindowStyle.createContentByDiv(mvId,domDiv,autoResize,width,height);
winDiv.appendChild(contentDiv);mpane.appendChild(winDiv);}else{if(options.tabs.length==1){var tab=options.tabs[0];
contentDiv=MVInfoWindowStyle.createTitleAndContent(id,tab.getTitle(),tab.getContent(),autoResize,width,height,close,options.mouseOver,mpane.parent());
winDiv[0].appendChild(contentDiv);mpane.append(winDiv);var $titleCell=OM.$("#"+id+"_title");if($titleCell[0]){var titleHeight=$titleCell[0].offsetHeight;
var mvInfoStyle=OM.infowindow.MVInfoWindowStyle;var hh=mvInfoStyle.CONTENT_PADDING_TOP+mvInfoStyle.CONTENT_PADDING_BOTTOM+mvInfoStyle.TITLE_PADDING_TOP+titleHeight;
if(height&&height>hh){var conDiv=OM.$("#"+id+"_content");conDiv.css("height",height-hh);}}}else{if(width==0){width=globalVariables.infoWindowWidth;
}if(height==0){height=globalVariables.infoWindowHeight;}mpane.append(winDiv);contentDiv=MVInfoWindowStyle.createTabsAndContent(id,options.tabs,options.index,width,height,winDiv,close,mpane.parent());
var jqueryDiv=OM.$(contentDiv);jqueryDiv.bind("dblclick",function(evt){evt.stopPropagation();evt.preventDefault();
});}}if(autoResize){width=contentDiv.offsetWidth;if(width<globalVariables.infoWindowWidth){contentDiv.style.width=OM.util.DomUtil.pixel(globalVariables.infoWindowWidth);
width=globalVariables.infoWindowWidth;}height=contentDiv.offsetHeight;if(height<globalVariables.infoWindowHeight){contentDiv.style.height=OM.util.DomUtil.pixel(globalVariables.infoWindowHeight);
height=globalVariables.infoWindowHeight;}}var dialogDiv=MVInfoWindowStyle.createWindow(0,0,width,height,options.tabs,id,close,options.mouseOver);
winDiv[0].appendChild(dialogDiv);var table=OM.$("#infowindow4_"+id);if(table&&table[0]){MVInfoWindowStyle.infoWindowWidth[id]=table[0].offsetWidth;
MVInfoWindowStyle.infoWindowHeight[id]=table[0].offsetHeight;if(!isNaN(options.screenLoc.x)){var infoPos=mvinfo.checkInfoWindowOverLayer(parent,id,table,options.screenLoc,MVInfoWindowStyle.windowOffset);
var l=infoPos.x-options.screenLoc.x;var t=infoPos.y-options.screenLoc.y;table.css({left:l,top:t});if(MVInfoWindowStyle.$transCloseImg){MVInfoWindowStyle.getPageDirection(winDiv[0]);
var imgLeft;var imgTop=t+6+13/2-30/2;if(MVInfoWindowStyle.pageDirection){imgLeft=l+width-5-13-17/2;}else{imgLeft=l+5+13/2-30/2;
}MVInfoWindowStyle.$transCloseImg.css({left:imgLeft,top:imgTop});winDiv.append(MVInfoWindowStyle.$transCloseImg);
}if(contentDiv!=null){contentDiv.style.left=OM.util.DomUtil.pixel(l);contentDiv.style.top=OM.util.DomUtil.pixel(t);
}if(!options.mouseOver){MVInfoWindowStyle.renderCone(mpane[0],id);}}else{if(!options.mouseOver){MVInfoWindowStyle.renderCone(mpane[0],id);
}}}}MVInfoWindowStyle.redrawHandle[id]=setTimeout(drawInfoWindow,500);};drawInfoWindow();this.winDiv=winDiv;
}else{div=this.createContentArea(tabs[0].getContent(),width);eval(style+".addContent(div)");if(!mouseOver){eval(style+".addCloseButton(close)");
}}};OM.infowindow.MVInfoWindow.prototype.isVisible=function(){return this.winDiv&&this.winDiv.style.display!="none";
};OM.infowindow.MVInfoWindow.prototype.checkInfoWindowOverLayer=function(u,e,D,d,g){var z=D[0].offsetWidth;
var m=D[0].offsetHeight;var t=u.$div.position();var s=t.left;var o=t.top;var l=u.width;var q=u.height;
var C=d.x;var B=d.y;var A=true;var r=true;if(s+C>l/2){A=false;}if(o+B<q/2){r=false;}var n=false;if(r){if(o+B-g-m>=0){B=B-g-m;
}else{B=-o+g;n=true;}}else{if(o+B+g+m<=q){B=B+g;}else{B=q-o-g-m;n=true;}}if(A){if(s+C+g+z<=l||n){C=C+g;
}else{C=l-s-g-z;}}else{if(s+C-g-z>=0||n){C=C-g-z;}else{C=-s+g;}}return{x:C,y:B};};OM.infowindow.MVInfoWindow.TYPE_NORMAL=1;
OM.infowindow.MVInfoWindow.TYPE_LIST=2;OM.infowindow.MVInfoWindowStyle=function(){};OM.infowindow.MVInfoWindowStyle.defaultStyleParameters=null;
OM.infowindow.MVInfoWindowStyle.closeButtonImgURL=null;OM.infowindow.MVInfoWindowStyle.infoWindowWidth=new Object();
OM.infowindow.MVInfoWindowStyle.infoWindowHeight=new Object();OM.infowindow.MVInfoWindowStyle.redrawHandle=new Object();
OM.infowindow.MVInfoWindowStyle.pageDirection=null;OM.infowindow.MVInfoWindowStyle.TotalMarginHeight=20;
OM.infowindow.MVInfoWindowStyle.MultiFeatureListTotalMarginWidth=15;OM.infowindow.MVInfoWindowStyle.setStyleParameters=function(e){var d=OM.infowindow.MVInfoWindowStyle;
if(e&&e.hideCloseButton){this.hideCloseButton=true;}else{this.hideCloseButton=false;}if(e&&e.coneStyle){this.style_coneStyle=e.coneStyle;
var g=e.coneStyle.split(/;|:/);if(g){for(i=0;i<g.length;i++){if(g[i].indexOf("opacity")>=0&&i<g.length){this.style_coneOpacity=parseInt(g[i+1]);
break;}}}}else{this.style_coneStyle="background-color:#a0a0a0;opacity:30";this.style_coneOpacity=30;}if(e&&e.offset){d.windowOffset=e.offset;
}else{d.windowOffset=20;}if(e&&e.tabStyle!=undefined&&e.tabStyle.toLowerCase()=="f"){this.tabStyle="f";
}else{this.tabStyle="p";}};OM.infowindow.MVInfoWindowStyle.init=function(g){var d=OM.gv.resourcePath();
var e=OM.infowindow.MVInfoWindowStyle;e.windowHeaderLeft=d+"infoicons/dialog-header-left.png";e.windowHeaderMiddle=d+"infoicons/dialog-header-middle.png";
e.windowHeaderRight=d+"infoicons/dialog-header-right.png";e.windowFooterLeft=d+"infoicons/dialog-footer-left.png";
e.windowFooterMiddle=d+"infoicons/dialog-footer-middle.png";e.windowFooterRight=d+"infoicons/dialog-footer-right.png";
e.windowTabsHeaderLeft=d+"infoicons/dialog-tabs-header-left.png";e.windowTabsHeaderMiddle=d+"infoicons/dialog-tabs-header-middle.png";
e.windowTabsHeaderRight=d+"infoicons/dialog-tabs-header-right.png";e.closeButtonEnableImgURL=d+"infoicons/close_ena.png";
e.closeButtonOverImgURL=d+"infoicons/close_ovr.png";e.closeButtonDownImgURL=d+"infoicons/close_dwn.png";
e.closeButtonImgURL=e.closeButtonEnableImgURL;e.tabEnableStartImgURL=d+"infoicons/t3_above_start_n.png";
e.tabEnableMidImgURL=d+"infoicons/t3_above_mid_n.png";e.tabEnableEndImgURL=d+"infoicons/t3_above_end_n.png";
e.tabDisableStartImgURL=d+"infoicons/t3_above_start_d.png";e.tabDisableMidImgURL=d+"infoicons/t3_above_mid_d.png";
e.tabDisableEndImgURL=d+"infoicons/t3_above_end_d.png";e.tabSelectedStartImgURL=d+"infoicons/t3_above_start_a.png";
e.tabSelectedMidImgURL=d+"infoicons/t3_above_mid_a.png";e.tabSelectedEndImgURL=d+"infoicons/t3_above_end_a.png";
e.tabContentHeadStartImgURL=d+"infoicons/ptts.png";e.tabContentHeadMidImgURL=d+"infoicons/ptt.png";e.tabContentHeadEndImgURL=d+"infoicons/ptte.png";
e.tabContentMidStartImgURL=d+"infoicons/pts.png";e.tabContentMidMidImgURL=d+"infoicons/ptc.png";e.tabContentMidEndImgURL=d+"infoicons/pte.png";
e.tabContentFooterStartImgURL=d+"infoicons/ptbs.png";e.tabContentFooterMidImgURL=d+"infoicons/ptb.png";
e.tabContentFooterEndImgURL=d+"infoicons/ptbe.png";e.overFlowLeftEnable=d+"infoicons/overflow_left_ena.png";
e.overFlowLeftDown=d+"infoicons/overflow_left_dwn.png";e.overFlowLeftOver=d+"infoicons/overflow_left_ovr.png";
e.overFlowRightEnable=d+"infoicons/overflow_right_ena.png";e.overFlowRightDown=d+"infoicons/overflow_right_dwn.png";
e.overFlowRightOver=d+"infoicons/overflow_right_ovr.png";if(g){e.setStyleParameters(g);}else{e.setStyleParameters(e.defaultStyleParameters);
}this.coneDiv=null;this.x=null;this.y=null;OM.infowindow.MVInfoWindowStyle.CONTENT_PADDING_TOP=5;OM.infowindow.MVInfoWindowStyle.CONTENT_PADDING_BOTTOM=5;
OM.infowindow.MVInfoWindowStyle.BUTTON_PADDING_TOP=5;OM.infowindow.MVInfoWindowStyle.TITLE_PADDING_LEFT=5;
OM.infowindow.MVInfoWindowStyle.TITLE_PADDING_TOP=5;OM.infowindow.MVInfoWindowStyle.CONTENT_PADDING_LEFT=5;
OM.infowindow.MVInfoWindowStyle.BUTTON_WIDTH=13;OM.infowindow.MVInfoWindowStyle.PADDING_RIGHT=5;};OM.infowindow.MVInfoWindowStyle.createWindow=function(A,w,H,F,O,n,E,o){var m=OM.util.DomUtil;
var e=m.FigLayer;var q=OM.infowindow.MVInfoWindowStyle;this.x=A;this.y=w;this.windowDiv=document.createElement("div");
this.windowDiv.id="infowindow4_"+n;var s=document.createElement("table");s.id="infowindow4table_"+n;s.dir="ltr";
this.windowDiv.appendChild(s);s.style.borderSpacing="0px";s.style.fontSize="0px";s.cellPadding="0";s.cellSpacing="0";
s.border="0";s.style.width=m.pixel(H);s.style.height=m.pixel(F);var l=document.createElement("tbody");
s.appendChild(l);var N=document.createElement("tr");l.appendChild(N);var u=document.createElement("td");
N.appendChild(u);var K=null;if(O&&O.length>1){K=new e(q.windowTabsHeaderLeft,5,31,null,null,null,true);
}else{K=new e(q.windowHeaderLeft,5,31,null,null,null,true);}u.appendChild(K);var t=document.createElement("td");
if(OM.browser.touchSupported){var z='<img width="100%" height="31" src="/mapviewer/fsmc/images/infoicons/dialog-header-middle.png" ';
z+='style="width: 100%; height: 31px; -moz-user-select: none; border: 0pt none; padding: 0pt; margin: 0pt; font-size: 0px;">';
t.innerHTML=z;}else{t.style.paddingTop=m.pixel(6);if(O&&O.length>1){t.style.backgroundImage="url("+q.windowTabsHeaderMiddle+")";
}else{t.style.backgroundImage="url("+q.windowHeaderMiddle+")";}t.style.backgroundRepeat="repeat-x";t.style.textAlign="right";
t.style.verticalAlign="top";t.style.width="100%";t.style.height="100%";}N.appendChild(t);var r=document.createElement("td");
N.appendChild(r);var D=null;if(O&&O.length>1){D=new e(q.windowTabsHeaderRight,5,31,null,null,null,true);
}else{D=new e(q.windowHeaderRight,5,31,null,null,null,true);}r.appendChild(D);var M=document.createElement("tr");
l.appendChild(M);var J=document.createElement("td");M.appendChild(J);J.colSpan="3";J.style.backgroundColor="#EBEFF5";
J.style.borderLeft="1px solid #C2C7D3";J.style.borderRight="1px solid #C2C7D3";var G=document.createElement("div");
G.style.width=m.pixel(H-2);G.style.height=m.pixel(F-62>0?F-62:0);J.appendChild(G);var L=document.createElement("tr");
l.appendChild(L);var g=document.createElement("td");L.appendChild(g);var I=new e(q.windowFooterLeft,5,31,null,null,null,true);
g.appendChild(I);var d=document.createElement("td");L.appendChild(d);var B=new e(q.windowFooterMiddle,H-5-5,31,null,null,null,true);
d.appendChild(B);var Q=document.createElement("td");L.appendChild(Q);var P=new e(q.windowFooterRight,5,31,null,null,null,true);
Q.appendChild(P);if(!s.style.width||s.style.width==""||s.style.width=="0"||s.style.width=="0px"){if(H){s.style.width=m.pixel(H);
}else{s.style.width=m.pixel(q.infoWindowWidth[n]);}}if(!s.style.height||s.style.height==""||s.style.height=="0"||s.style.height=="0px"){if(F){s.style.height=m.pixel(F);
}else{s.style.height=m.pixel(q.infoWindowHeight[n]);}}var C=q.createWindowShadow(H,F);this.windowDiv.appendChild(C);
this.windowDiv.style.left=m.pixel(A-q.windowOffset);this.windowDiv.style.top=m.pixel(w+q.windowOffset);
this.windowDiv.style.position="absolute";this.windowDiv.style.zIndex=200;return this.windowDiv;};OM.infowindow.MVInfoWindowStyle.createWindowShadow=function(e,r){var o=OM.util.DomUtil;
var q=0;var m=0;var g=[24,16,12,10,8,6,6,4,4,4,4,2,2,2,2,2,2,2];var s=document.createElement("DIV");s.style.zIndex="-1";
s.style.position="absolute";s.style.left=o.pixel(3);s.style.top=o.pixel(3);for(var l=0;l<18;l++){var d=document.createElement("DIV");
d.style.backgroundColor="#000000";d.style.left=o.pixel(q);d.style.top=o.pixel(m);d.style.position="absolute";
d.style.width=o.pixel(e-3);d.style.height=o.pixel(r-3);var n=g[l];OM.infowindow.MVInfoWindowStyle.setOpaque(d,n);
if(l%2==0){q++;}else{m++;}s.appendChild(d);}if(OM.browser.touchSupported){d=document.createElement("DIV");
d.style.backgroundColor="#EBEFF5";d.style.left=o.pixel(0);d.style.top=o.pixel(10);d.style.position="absolute";
d.style.width=o.pixel(e-4);d.style.height=o.pixel(r-20);s.appendChild(d);}return s;};OM.infowindow.MVInfoWindowStyle.createTitleAndContent=function(w,Y,A,u,d,l,ap,al,ac){var am=OM.util.DomUtil;
var ar=OM.gv.resourcePath();var C=OM.infowindow.MVInfoWindowStyle;var ay=document.createElement("table");
ay.id="infowindow4tablebutton_"+w;ay.style.left="0px";ay.style.top="0px";ay.style.width=am.pixel(d);ay.style.height=am.pixel(l);
ay.style.position="absolute";ay.style.zIndex="250";ay.cellPadding="0";ay.cellSpacing="0";var P=document.createElement("tbody");
ay.appendChild(P);var T=document.createElement("tr");P.appendChild(T);var L=document.createElement("td");
T.appendChild(L);var q=document.createElement("td");T.appendChild(q);var aw=OM.infowindow.MVInfoWindowStyle;
if(Y==null||Y==""){L.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.CONTENT_PADDING_LEFT+"px'>";
L.width=am.pixel(aw.CONTENT_PADDING_LEFT);var aq=document.createElement("td");aq.width=am.pixel(aw.BUTTON_WIDTH);
aq.height="100%";if(!al){var ao=document.createElement("table");ao.style.height="100%";ao.cellPadding="0";
ao.cellSpacing="0";aq.style.verticalAlign="top";aq.appendChild(ao);var Q=document.createElement("tbody");
ao.appendChild(Q);var ab=document.createElement("tr");Q.appendChild(ab);var K=document.createElement("td");
K.height=am.pixel(aw.BUTTON_PADDING_TOP);K.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.BUTTON_PADDING_TOP+"px'>";
K.style.fontSize="0px";ab.appendChild(K);var aa=document.createElement("tr");Q.appendChild(aa);var J=document.createElement("td");
J.height=am.pixel(aw.BUTTON_WIDTH);aa.appendChild(J);var Z=document.createElement("tr");Q.appendChild(Z);
var I=document.createElement("td");I.style.height="100%";I.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.PADDING_RIGHT+"px'>";
Z.appendChild(I);var an=C.addCloseButton(ap,w,ac);if(an!=null){J.appendChild(an);}}T.appendChild(aq);
var N=document.createElement("td");N.width=am.pixel(aw.PADDING_RIGHT);N.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.PADDING_RIGHT+"px'>";
T.appendChild(N);var B=document.createElement("table");B.cellPadding="0";B.cellSpacing="0";B.style.width="100%";
B.style.height="100%";q.style.verticalAlign="top";q.appendChild(B);var z=document.createElement("tbody");
B.appendChild(z);var G=document.createElement("tr");z.appendChild(G);var ax=document.createElement("td");
ax.height=am.pixel(aw.CONTENT_PADDING_TOP);ax.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.CONTENT_PADDING_TOP+"px'>";
ax.style.fontSize="0px";G.appendChild(ax);var F=document.createElement("tr");z.appendChild(F);var av=document.createElement("td");
av.style.height="100%";av.style.verticalAlign="top";F.appendChild(av);var M=document.createElement("div");
M.style.overflow="auto";M.id=w+"_content";M.innerHTML=A;var R=aw.CONTENT_PADDING_TOP+aw.CONTENT_PADDING_BOTTOM;
if(l&&l>R){M.style.height=am.pixel(l-R);}var D=aw.CONTENT_PADDING_LEFT+aw.BUTTON_WIDTH+aw.PADDING_RIGHT;
if(d&&d>D){M.style.width=am.pixel(d-D);}av.appendChild(M);var E=document.createElement("tr");z.appendChild(E);
var au=document.createElement("td");au.height=am.pixel(aw.CONTENT_PADDING_BOTTOM);au.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.CONTENT_PADDING_BOTTOM+"px'>";
au.style.fontSize="0px";E.appendChild(au);}else{L.style.width=am.pixel(aw.TITLE_PADDING_LEFT);q.style.height="100%";
q.style.verticalAlign="top";L.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.TITLE_PADDING_LEFT+"px'>";
var S=document.createElement("table");S.cellPadding="0";S.cellSpacing="0";S.style.width="100%";S.style.height="100%";
q.appendChild(S);var s=document.createElement("tbody");S.appendChild(s);var X=document.createElement("tr");
s.appendChild(X);var o=document.createElement("td");o.width="100%";X.appendChild(o);var g=document.createElement("table");
g.style.width="100%";g.cellPadding="0";g.cellSpacing="0";o.appendChild(g);var H=document.createElement("tbody");
g.appendChild(H);var O=document.createElement("tr");H.appendChild(O);var ak=document.createElement("td");
ak.style.width="100%";O.appendChild(ak);var e=document.createElement("table");e.style.width="100%";e.cellPadding="0";
e.cellSpacing="0";ak.appendChild(e);var W=document.createElement("tbody");e.appendChild(W);var ah=document.createElement("tr");
W.appendChild(ah);var aj=document.createElement("td");aj.height=aw.TITLE_PADDING_TOP+"px";aj.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.TITLE_PADDING_TOP+"px'>";
aj.style.fontSize="0px";ah.appendChild(aj);var af=document.createElement("tr");W.appendChild(af);var ag=document.createElement("td");
ag.style.cssText="font-family: Tahoma; font-size: 12px;font-weight: bold; color:#3E403D";af.appendChild(ag);
ag.id=w+"_title";ag.innerHTML=Y;var ad=document.createElement("tr");W.appendChild(ad);var ae=document.createElement("td");
ae.height=aw.CONTENT_PADDING_TOP+"px";ae.style.fontSize="0px";ae.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.CONTENT_PADDING_TOP+"px'>";
ad.appendChild(ae);var ai=document.createElement("td");ai.style.width=am.pixel(aw.PADDING_RIGHT+aw.BUTTON_WIDTH);
O.appendChild(ai);if(!al){var ao=document.createElement("table");ao.cellPadding="0";ao.cellSpacing="0";
ao.style.height="100%";ao.style.width=am.pixel(aw.PADDING_RIGHT+aw.BUTTON_WIDTH);ai.style.height="100%";
ai.appendChild(ao);ai.style.verticalAlign="top";var Q=document.createElement("tbody");ao.appendChild(Q);
var ab=document.createElement("tr");Q.appendChild(ab);var K=document.createElement("td");K.style.height=am.pixel(aw.BUTTON_PADDING_TOP);
K.style.fontSize="0px";K.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.BUTTON_PADDING_TOP+"px'>";
K.colSpan="2";ab.appendChild(K);var aa=document.createElement("tr");Q.appendChild(aa);var t=document.createElement("td");
t.style.height=am.pixel(13);t.style.width=am.pixel(13);aa.appendChild(t);var r=document.createElement("td");
r.style.width=am.pixel(aw.PADDING_RIGHT);r.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.PADDING_RIGHT+"px'>";
aa.appendChild(r);var aa=document.createElement("tr");Q.appendChild(aa);var I=document.createElement("td");
I.style.height="100%";I.colSpan="2";aa.appendChild(I);var an=C.addCloseButton(ap,w,ac);if(an!=null){t.appendChild(an);
}}var V=document.createElement("tr");s.appendChild(V);var n=document.createElement("td");n.width="100%";
n.height="100%";V.appendChild(n);var U=document.createElement("tr");s.appendChild(U);var m=document.createElement("td");
m.height=am.pixel(aw.CONTENT_PADDING_BOTTOM);m.style.fontSize="0px";m.innerHTML="<img src='"+ar+"transparent.gif' height='"+aw.CONTENT_PADDING_BOTTOM+"px'>";
U.appendChild(m);var B=document.createElement("table");B.cellPadding="0";B.cellSpacing="0";B.style.height="10px";
B.style.width="100%";n.style.verticalAlign="top";n.appendChild(B);var z=document.createElement("tbody");
B.appendChild(z);G=document.createElement("tr");z.appendChild(G);ax=document.createElement("td");var at=aw.CONTENT_PADDING_LEFT-aw.TITLE_PADDING_LEFT;
at=at>0?at:0;ax.style.width=am.pixel(at);ax.innerHTML="<img src='"+ar+"transparent.gif' width='"+(at)+"px'>";
G.appendChild(ax);av=document.createElement("td");G.appendChild(av);au=document.createElement("td");au.style.width=am.pixel(aw.PADDING_RIGHT);
au.innerHTML="<img src='"+ar+"transparent.gif' width='"+aw.PADDING_RIGHT+"px'>";G.appendChild(au);var M=document.createElement("div");
M.style.overflow="auto";M.innerHTML=A;M.id=w+"_content";if(d&&d>aw.PADDING_RIGHT+aw.CONTENT_PADDING_LEFT){M.style.width=am.pixel(d-aw.PADDING_RIGHT-aw.CONTENT_PADDING_LEFT);
}av.style.verticalAlign="top";av.appendChild(M);}return ay;};OM.infowindow.MVInfoWindowStyle.createTabsAndContent=function(q,g,m,l,d,e,o,n){e=e[0];
return OM.infowindow.MVInfoWindowStyle.tabStyleOne(q,g,m,l,d,e,o,this.tabStyle,n);};OM.infowindow.MVInfoWindowStyle.tabStyleTwo=function(V,q,A,d,l,T,Z,S){var X=OM.util.DomUtil;
var z=OM.infowindow.MVInfoWindowStyle;var Y=z.addCloseButton(Z,V,S);var af=document.createElement("div");
var R=null;var ag=9;var G=30;var r=0;var C=0;var M=true;var I=document.createElement("div");var ad=X.createImageNode(z.overFlowLeftEnable,true);
var o=X.createImageNode(z.overFlowRightEnable,true);var u=null;var D=null;var F=null;var N={startImg:null,midImg:null,endImag:null};
var s=0;var ab=new Array();var E=d-15-13-10-5;var e;var J=15;var H;var P;z.getPageDirection(T);var B=X.createImageNode(z.tabSelectedStartImgURL,true);
B.style.width=J+"px";B.style.height="24px";var L=X.createImageNode(z.tabEnableStartImgURL,true);L.style.width=J+"px";
L.style.height="24px";var w=X.createImageNode(z.tabSelectedEndImgURL,true);w.style.width="36px";w.style.height="24px";
var U=X.createImageNode(z.tabEnableEndImgURL,true);U.style.width="36px";U.style.height="24px";if(A!=null||A!=undefined){r=A;
}for(var ae=0;ae<q.length;ae++){ab[ae]=z.getRealWithOfOneTab(T,q[ae],E);}af.style.position="absolute";
af.style.width=X.pixel(d);af.style.height=X.pixel(l);af.style.zIndex="220";T.appendChild(af);af.appendChild(I);
if(z.pageDirection){I.style.cssText="float:left";I.style.direction="ltr";}else{I.style.cssText="float:right";
I.style.direction="ltr";}I.style.zIndex="210";I.style.position="absolute";I.style.top="5px";I.style.overflow="auto";
I.style.width=d-ag-15+"px";I.style.height=l*0.3+"px";Y.style.zIndex="300";if(Y!=null){Y.style.position="absolute";
Y.style.top="5px";if(z.pageDirection){Y.style.right="10px";}else{Y.style.left="10px";}af.appendChild(Y);
}if(z.pageDirection){I.style.left="15px";}else{I.style.right="15px";}D=document.createElement("div");
D.style.position="absolute";D.style.borderColor="black";D.style.backgroundColor="#ffffe1";D.style.borderWidth="1px";
D.style.borderStyle="solid";D.style.fontSize="14px";D.style.whiteSpace="nowrap";D.style.padding="2px";
D.style.zIndex="300";D.style.fontFamily="Tahoma";if(z.pageDirection){D.style.direction="ltr";}else{D.style.direction="rtl";
}function W(ah){ah=(ah)?ah:((window.event)?event:null);var ai=ah.target;u=ai.style.color;ai.style.color="#78c3ff";
if(q[ai.parentNode.parentNode.indexInList].showTitle!=undefined){D.innerHTML=q[ai.parentNode.parentNode.indexInList].title;
D.style.top=ai.parentNode.parentNode.parentNode.offsetTop+30+"px";if(z.pageDirection){D.style.left=ai.parentNode.parentNode.offsetLeft+5+"px";
}else{D.style.right=ai.parentNode.parentNode.offsetLeft+5+"px";}ai.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(D);
}}function Q(ah){ah=(ah)?ah:((window.event)?event:null);var ai=ah.target;ai.style.color=u;if(q[ai.parentNode.parentNode.indexInList].showTitle!=undefined){ai.parentNode.parentNode.parentNode.parentNode.parentNode.removeChild(D);
}}function t(ah){ah=(ah)?ah:((window.event)?event:null);var ai=ah.target;}function m(ah){ah=(ah)?ah:((window.event)?event:null);
var ai=ah.target;r=ai.parentNode.parentNode.indexInList;u="#00234c";ai.parentNode.parentNode.style.zIndex=200;
N.startImg.parentNode.style.zIndex=100;if(ai.parentNode.parentNode.parentNode.style.zIndex!=P){e.style.zIndex=ai.parentNode.parentNode.parentNode.style.zIndex;
e.style.top=ai.parentNode.parentNode.parentNode.style.top;ai.parentNode.parentNode.parentNode.style.zIndex=P;
ai.parentNode.parentNode.parentNode.style.top=H;e=ai.parentNode.parentNode.parentNode;}OM.$(N.startImg).empty();
N.startImg.appendChild(L.cloneNode(true));if(z.pageDirection){N.startImg=ai.parentNode.parentNode.firstChild;
}else{N.startImg=ai.parentNode.parentNode.childNodes[2];}OM.$(N.startImg).empty();N.startImg.appendChild(B.cloneNode(true));
N.midImg.style.backgroundImage="url('"+z.tabEnableMidImgURL+"')";ai.parentNode.style.backgroundImage="url('"+z.tabSelectedMidImgURL+"')";
N.midImg.firstChild.style.color="#e9f6fe";N.midImg=ai.parentNode;ai.style.color="#00234c";OM.$(N.endImg).empty();
N.endImg.appendChild(U.cloneNode(true));if(z.pageDirection){N.endImg=ai.parentNode.parentNode.childNodes[2];
}else{N.endImg=ai.parentNode.parentNode.firstChild;}OM.$(N.endImg).empty();N.endImg.appendChild(w.cloneNode(true));
document.getElementById("realContentDivId").innerHTML=q[ai.parentNode.parentNode.indexInList].content;
I.scrollTop=I.scrollHeight;}function O(ao,ai,ah){var am=document.createElement("div");ao.appendChild(am);
am.style.position="absolute";am.style.zIndex=s;am.style.top=s*20+"px";H=am.style.top;P=am.style.zIndex;
s++;R=5;if(z.pageDirection){am.style.left="0px";}else{am.style.right="0px";}for(var an=0;an<ai.length;
an++){var au=document.createElement("div");var ar=document.createElement("div");var at=document.createElement("div");
var ak=document.createElement("div");var aq=document.createElement("a");var al=an*(-19);var aj;var ap;
am.appendChild(au);if(z.pageDirection){au.appendChild(ar);au.appendChild(at);au.appendChild(ak);au.style.cssText="float:left;";
au.style.left=al+"px";ar.style.cssText="float:left;";at.style.cssText="float:left;";ak.style.cssText="float:left;";
}else{au.appendChild(ak);au.appendChild(at);au.appendChild(ar);au.style.cssText="float:right;";au.style.right=al+"px";
ar.style.cssText="float:left;";at.style.cssText="float:left;";ak.style.cssText="float:left;";}au.indexInList=ai[an];
if(ai[an]==r){au.style.zIndex="200";}else{au.style.zIndex="100";}au.style.position="relative";ar.style.width=J+"px";
ar.style.height="24px";ar.style.backgroundPosition="bottom";ar.style.position="relative";if(ai[an]==r){aj=B.cloneNode(true);
}else{aj=L.cloneNode(true);}ar.appendChild(aj);if(ai[an]==r){at.style.backgroundImage="url('"+z.tabSelectedMidImgURL+"')";
}else{at.style.backgroundImage="url('"+z.tabEnableMidImgURL+"')";}at.style.backgroundRepeat="repeat-x";
at.style.position="relative";at.style.lineHeight="1.3em";at.style.height="24px";if(z.pageDirection){at.style.direction="ltr";
}else{at.style.direction="rtl";}at.appendChild(aq);aq.style.cursor="pointer";aq.style.fontFamily="Tahoma";
aq.style.fontSize="11px";aq.style.fontWeight="bold";if(ai[an]==r){aq.style.color="#00234c";}else{aq.style.color="#e9f6fe";
}if(q[ai[an]].showTitle!=undefined){aq.innerHTML=q[ai[an]].showTitle.replace(/\s/g,"&nbsp;");}else{aq.innerHTML=q[ai[an]].title.replace(/\s/g,"&nbsp;");
}ah.on("mouseover",$mid_link,W);ah.on("mouseout",$mid_link,Q);ah.on("mousedown",$mid_link,t);ah.on("mouseup",$mid_link,m);
ak.style.width="36px";ak.style.height="24px";ak.style.backgroundPosition="bottom";ak.style.position="relative";
if(ai[an]==r){ap=w.cloneNode(true);}else{ap=U.cloneNode(true);}ak.appendChild(ap);R=R+at.clientWidth+J+36;
am.style.width=R+"px";if(ai[an]==r){N.endImg=ak;N.startImg=ar;N.midImg=at;}}}var g=z.groupingTabs(ab,E);
for(var ac=0;ac<g.length;ac++){for(var aa=0;aa<g[ac].length;aa++){if(g[ac][aa]==r){var n=g[ac][0];g[ac][0]=g[ac][aa];
g[ac][aa]=n;var K=g[g.length-1];g[g.length-1]=g[ac];g[ac]=K;break;}}}for(var ae=0;ae<g.length;ae++){O(I,g[ae],S);
}e=I.lastChild;if(I.clientHeight>=I.scrollHeight){F=z.createContentDiv(d-ag,l-G-(s-1)*20,I.offsetTop+15+(s-1)*20);
}else{I.style.top=I.offsetTop+13+"px";F=z.createContentDiv(d-ag,l-I.offsetTop-I.offsetHeight-5,I.offsetTop+I.offsetHeight-6);
I.scrollTop=I.scrollHeight;}af.appendChild(F);document.getElementById("realContentDivId").innerHTML=q[r].content;
return af;};OM.infowindow.MVInfoWindowStyle.tabStyleOne=function(Z,m,z,d,e,X,ae,M,W){var ac=OM.util.DomUtil;
var w=OM.infowindow.MVInfoWindowStyle;var ad=w.addCloseButton(ae,Z,W);var al=document.createElement("div");
var U=null;var ao=9;var H=30;var n=0;var D=0;var P=true;var I=document.createElement("div");var u=document.createElement("div");
var ai=ac.createImageNode(w.overFlowLeftEnable,true);ai.id="_mv_info_tabofleft";var l=ac.createImageNode(w.overFlowRightEnable,true);
l.id="_mv_info_tabofright";var s=null;var F=null;var G=null;var K=10;var J=20;var B=12;var N=B;var M=this.tabStyle;
var q;var Q={startImg:null,midImg:null,endImag:null};if(z!=null||z!=undefined){n=z;}w.getPageDirection(X);
var A=ac.createImageNode(w.tabSelectedStartImgURL,true,true);A.style.width=K+"px";A.style.height="24px";
var O=ac.createImageNode(w.tabEnableStartImgURL,true,true);O.style.width=K+"px";O.style.height="24px";
var t=ac.createImageNode(w.tabSelectedEndImgURL,true,true);t.style.width=J+"px";t.style.height="24px";
var Y=ac.createImageNode(w.tabEnableEndImgURL,true,true);Y.style.width=J+"px";Y.style.height="24px";al.style.position="absolute";
al.style.width=ac.pixel(d);al.style.height=ac.pixel(e);al.style.zIndex="220";X.appendChild(al);for(var aj=0;
aj<m.length;aj++){N+=w.getOrignalWithOfOneTab(X,m[aj])-B;}al.appendChild(u);u.appendChild(I);if(w.pageDirection){u.style.left="15px";
I.style.cssText="float:left";I.style.direction="ltr";}else{u.style.right="15px";I.style.cssText="float:right";
I.style.direction="ltr";}u.style.position="absolute";u.style.zIndex="210";u.style.top="5px";u.style.height="24px";
u.style.width=d-2-13-25-13+"px";u.style.overflow="hidden";I.style.position="absolute";I.style.top="0px";
G=w.createContentDiv(d-ao,e-H,20);al.appendChild(G);ad.style.zIndex="300";if(ad!=null){ad.style.position="absolute";
ad.style.top="5px";if(w.pageDirection){ad.style.right="10px";}else{ad.style.left="10px";}al.appendChild(ad);
}function ab(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowLeftOver;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftOver+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowRightOver;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightOver+"', sizingMethod='image');";
}}}}function af(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowLeftEnable;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftEnable+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowRightEnable;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightEnable+"', sizingMethod='image');";
}}}}function r(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowLeftDown;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftDown+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowRightDown;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightDown+"', sizingMethod='image');";
}}}}function L(aq){aq=(aq)?aq:((window.event)?event:null);var at=aq.target;if(w.pageDirection){if(at.tagName=="IMG"){at.src=w.overFlowLeftEnable;
}else{if(at.tagName=="DIV"){at.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftEnable+"', sizingMethod='image');";
}}}else{if(at.tagName=="IMG"){at.src=w.overFlowRightEnable;}else{if(at.tagName=="DIV"){at.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightEnable+"', sizingMethod='image');";
}}}if(w.pageDirection){var au=I.style.left.toString();var ap=parseInt(au.substr(0,au.length-2));I.style.left=ac.pixel(ap+30);
}else{var au=I.style.right.toString();var ar=parseInt(au.substr(0,au.length-2));I.style.right=ac.pixel(ar+30);
}if(I.offsetLeft>=0){ai.style.visibility="hidden";}else{ai.style.visibility="visible";}var av=document.getElementById("inforwindowtab_"+(m.length-1));
if(av.offsetLeft+av.offsetWidth+I.offsetLeft<=u.offsetWidth){l.style.visibility="hidden";}else{l.style.visibility="visible";
}}al.appendChild(ai);if(w.pageDirection){ai.style.left="2px";}else{ai.style.right="2px";if(ai.tagName=="IMG"){ai.src=w.overFlowRightEnable;
}else{if(ai.tagName=="DIV"){ai.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightEnable+"', sizingMethod='image')";
}}}ai.style.width="13px";ai.style.top="5px";ai.style.position="absolute";ai.style.zIndex=500;ai.style.visibility="hidden";
W.on("mouseover","#"+ai.id,ab);W.on("mouseout","#"+ai.id,af);W.on("mousedown","#"+ai.id,r);W.on("mouseup","#"+ai.id,L);
function V(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowRightOver;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightOver+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowLeftOver;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftOver+"', sizingMethod='image');";
}}}}function S(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowRightEnable;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightEnable+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowLeftEnable;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftEnable+"', sizingMethod='image');";
}}}}function E(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;if(w.pageDirection){if(aq.tagName=="IMG"){aq.src=w.overFlowRightDown;
}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightDown+"', sizingMethod='image');";
}}}else{if(aq.tagName=="IMG"){aq.src=w.overFlowLeftDown;}else{if(aq.tagName=="DIV"){aq.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftDown+"', sizingMethod='image');";
}}}}function an(aq){aq=(aq)?aq:((window.event)?event:null);var at=aq.target;if(w.pageDirection){if(at.tagName=="IMG"){at.src=w.overFlowRightEnable;
}else{if(at.tagName=="DIV"){at.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowRightEnable+"', sizingMethod='image');";
}}}else{if(at.tagName=="IMG"){at.src=w.overFlowLeftEnable;}else{if(at.tagName=="DIV"){at.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftEnable+"', sizingMethod='image');";
}}}if(w.pageDirection){var au=I.style.left.toString();var ap=au.substr(0,au.length-2).valueOf();I.style.left=ac.pixel(ap-30);
if(I.offsetLeft>=0){ai.style.visibility="hidden";}else{ai.style.visibility="visible";}var av=document.getElementById("inforwindowtab_"+(m.length-1));
if(av.offsetLeft+av.offsetWidth+I.offsetLeft<=u.offsetWidth){l.style.visibility="hidden";}else{l.style.visibility="visible";
}}else{var au=I.style.right.toString();var ar=au.substr(0,au.length-2).valueOf();I.style.right=ac.pixel(ar-30);
if(I.offsetLeft>=0){ai.style.visibility="hidden";}else{ai.style.visibility="visible";}var av=document.getElementById("inforwindowtab_"+(m.length-1));
if(av.offsetLeft+av.offsetWidth+I.offsetLeft<=u.offsetWidth){l.style.visibility="hidden";}else{l.style.visibility="visible";
}}}if(w.pageDirection){l.style.right="25px";}else{l.style.left="25px";if(l.tagName=="IMG"){l.src=w.overFlowLeftEnable;
}else{if(l.tagName=="DIV"){l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+w.overFlowLeftEnable+"', sizingMethod='image')";
}}}l.style.width="13px";l.style.top="5px";l.style.position="absolute";l.style.zIndex="500";l.style.visibility="hidden";
W.on("mouseover","#"+l.id,V);W.on("mouseout","#"+l.id,S);W.on("mousedown","#"+l.id,E);W.on("mouseup","#"+l.id,an);
al.appendChild(l);if(w.pageDirection){I.style.left="0px";}else{I.style.right="0px";}F=document.createElement("div");
F.style.position="absolute";F.style.borderColor="black";F.style.backgroundColor="#ffffe1";F.style.borderWidth="1px";
F.style.borderStyle="solid";F.style.fontSize="14px";F.style.whiteSpace="nowrap";F.style.padding="2px";
F.style.zIndex="10000";F.style.fontFamily="Tahoma";F.id="TabbedInforwindowToolTip";function aa(ap){ap=(ap)?ap:((window.event)?event:null);
var aq=ap.target;s=aq.style.color;aq.style.color="#78c3ff";F.topOffset=15;F.leftOffset=15;if(window.innerWidth){F.topOffset+=window.pageYOffset;
F.leftOffset+=window.pageXOffset;}else{if(document.documentElement&&document.documentElement.clientWidth){F.topOffset+=document.documentElement.scrollTop;
F.leftOffset+=document.documentElement.scrollLeft;}else{if(document.body.clientWidth){F.topOffset+=document.body.scrollTop;
F.leftOffset+=document.body.scrollLeft;}}}F.innerHTML=m[aq.parentNode.parentNode.indexInList].title;F.style.top=ap.clientY+F.topOffset+"px";
F.style.left=ap.clientX+F.leftOffset+"px";document.body.appendChild(F);}function T(ap){ap=(ap)?ap:((window.event)?event:null);
var aq=ap.target;aq.style.color=s;if(F&&F.parentNode){document.body.removeChild(F);}}function o(ap){ap=(ap)?ap:((window.event)?event:null);
var aq=ap.target;}function g(ap){ap=(ap)?ap:((window.event)?event:null);var aq=ap.target;ap.stopPropagation();
n=aq.parentNode.parentNode.indexInList;Q.startImg.parentNode.style.zIndex=100;aq.parentNode.parentNode.style.zIndex=200;
OM.$(Q.startImg).empty();Q.startImg.appendChild(O.cloneNode(true));if(w.pageDirection){Q.startImg=aq.parentNode.parentNode.firstChild;
}else{Q.startImg=aq.parentNode.parentNode.childNodes[2];}OM.$(Q.startImg).empty();Q.startImg.appendChild(A.cloneNode(true));
Q.midImg.style.backgroundImage="url('"+w.tabEnableMidImgURL+"')";aq.parentNode.style.backgroundImage="url('"+w.tabSelectedMidImgURL+"')";
Q.midImg.firstChild.style.color="#e9f6fe";Q.midImg=aq.parentNode;aq.style.color="#00234c";OM.$(Q.endImg).empty();
Q.endImg.appendChild(Y.cloneNode(true));if(w.pageDirection){Q.endImg=aq.parentNode.parentNode.childNodes[2];
}else{Q.endImg=aq.parentNode.parentNode.firstChild;}OM.$(Q.endImg).empty();Q.endImg.appendChild(t.cloneNode(true));
document.getElementById("realContentDivId").innerHTML=m[aq.parentNode.parentNode.indexInList].content;
s=aq.style.color;}function R(az,aw,av,at,ap){U=0;for(aj=0;aj<az.length;aj++){var aF=document.createElement("div");
var aB=document.createElement("div");var aC=document.createElement("div");var ar=document.createElement("div");
var ay=document.createElement("a");var au=aj*(-B);var aq;var ax;aw.appendChild(aF);if(w.pageDirection){aF.appendChild(aB);
aF.appendChild(aC);aF.appendChild(ar);aF.style.cssText="float:left;";aF.style.left=au+"px";aB.style.cssText="float:left;";
aC.style.cssText="float:left;";ar.style.cssText="float:left;";}else{aF.appendChild(ar);aF.appendChild(aC);
aF.appendChild(aB);aF.style.cssText="float:right;";aF.style.right=au+"px";aB.style.cssText="float:left;";
aC.style.cssText="float:left;";ar.style.cssText="float:left;";}aF.indexInList=aj;if(aj==n){aF.style.zIndex="200";
av.innerHTML=az[aj].content;}else{aF.style.zIndex="100";}aF.style.position="relative";aB.style.width=K+"px";
aB.style.height="24px";aB.style.backgroundPosition="bottom";aB.style.position="relative";if(aj==n){aq=ac.createImageNode(w.tabSelectedStartImgURL,true,true);
}else{aq=ac.createImageNode(w.tabEnableStartImgURL,true,true);}aq.style.width=K+"px";aq.style.height="24px";
aB.appendChild(aq);if(aj==n){aC.style.backgroundImage="url('"+w.tabSelectedMidImgURL+"')";}else{aC.style.backgroundImage="url('"+w.tabEnableMidImgURL+"')";
}aC.style.backgroundRepeat="repeat-x";aC.style.position="relative";aC.style.lineHeight="1.3em";aC.style.height="24px";
aC.appendChild(ay);ay.style.cursor="pointer";ay.style.fontFamily="Tahoma";ay.style.fontSize="11px";ay.style.fontWeight="bold";
ay.style.whiteSpace="nowrap";ay.id="tablinkid_"+aj;if(aj==n){ay.style.color="#00234c";}else{ay.style.color="#e9f6fe";
}ay.innerHTML=az[aj].title.replace(/\s/g,"&nbsp;");if(N>u.offsetWidth+20&&M=="p"){var aA=aC.clientWidth;
ay.innerHTML=az[aj].title;var aE;if(az[aj].title.length-2>at){aE=az[aj].title.substr(0,at)+"..";}else{aE=az[aj].title;
}ay.innerHTML=aE;}var aD=OM.$(ay);ap.on("mouseover","#tablinkid_"+aj,aa);ap.on("mouseout","#tablinkid_"+aj,T);
ap.on("mousedown","#tablinkid_"+aj,o);ap.on("mouseup","#tablinkid_"+aj,g);if(OM.browser.touchSupported){OM.$("#tablinkid_"+aj).bind("touchend",g);
}ar.style.width=J+"px";ar.style.height="24px";ar.style.backgroundPosition="bottom";ar.style.position="relative";
if(aj==n){ax=ac.createImageNode(w.tabSelectedEndImgURL,true,true);}else{ax=ac.createImageNode(w.tabEnableEndImgURL,true,true);
}ax.style.width=J+"px";ax.style.height="24px";ar.appendChild(ax);U=U+aC.clientWidth+K+J;aw.style.width=U+"px";
aF.id="inforwindowtab_"+aj;if(aj==n){Q.endImg=ar;Q.startImg=aB;Q.midImg=aC;}}}var ag=document.getElementById("realContentDivId");
if(N<=u.offsetWidth+20||M=="f"){R(m,I,ag,1,W);}else{R(m,I,document.getElementById("realContentDivId"),1,W);
if(I.offsetWidth-B*(m.length-1)<u.offsetWidth+20){OM.$(I).empty();for(q=2;q<400;q++){R(m,I,document.getElementById("realContentDivId"),q,W);
if(I.offsetWidth-B*(m.length-1)==u.offsetWidth+20){u.style.width=d-2-13-25-13+20+"px";return al;}else{if(I.offsetWidth-B*(m.length-1)>u.offsetWidth+20){for(var ah=1;
ah<3;ah++){for(var aj=0;aj<m.length;aj++){var am=document.getElementById("tablinkid_"+aj);var ak=am.offsetWidth;
if(m[aj].title.length-2>q-ah){am.innerHTML=m[aj].title.substr(0,q-ah)+"..";}else{am.innerHTML=m[aj].title;
}var C=am.offsetWidth;I.style.width=I.offsetWidth+C-ak;if(I.offsetWidth-B*(m.length-1)<=u.offsetWidth+20){u.style.width=d-2-13-25-13+20+"px";
return al;}}if(I.offsetWidth-B*(m.length-1)<=u.offsetWidth+20){u.style.width=d-2-13-25-13+20+"px";return al;
}}u.style.width=d-2-13-25-13+20+"px";return al;}}OM.$(I).empty();}}else{if(I.offsetWidth-B*(m.length-1)>u.offsetWidth+20){OM.$(I).empty();
q=4;R(m,I,document.getElementById("realContentDivId"),q,W);}}}if(I.offsetWidth-B*(m.length-1)>u.offsetWidth+20){l.style.visibility="visible";
}else{if(I.offsetWidth-B*(m.length-1)>u.offsetWidth){u.style.width=d-2-13-25+7+"px";}}return al;};OM.infowindow.MVInfoWindowStyle.createContentDiv=function(F,E,D){var e=document.createElement("div");
var q=OM.util.DomUtil;var r=OM.infowindow.MVInfoWindowStyle;e.style.left="5px";e.style.top=D+"px";e.style.width=F+"px";
if(E<30){E=70;}e.style.height=E+"px";e.style.position="absolute";var n=document.createElement("div");
var u=document.createElement("div");var m=q.createImageNode(r.tabContentHeadStartImgURL,true);var H=document.createElement("div");
var w=document.createElement("div");var I=q.createImageNode(r.tabContentHeadEndImgURL,true);n.style.position="absolute";
n.style.top="5px";u.style.width="5px";u.style.height="5px";u.style.position="absolute";m.style.width="5px";
m.style.position="absolute";u.appendChild(m);n.appendChild(u);H.style.width=(F-5-8)+"px";H.style.height="5px";
H.style.position="absolute";H.style.backgroundRepeat="repeat-x";H.style.backgroundImage="url("+r.tabContentHeadMidImgURL+")";
n.appendChild(H);w.style.width="8px";w.style.height="5px";w.style.position="absolute";I.style.width="8px";
I.style.position="absolute";w.appendChild(I);n.appendChild(w);e.appendChild(n);var d=document.createElement("div");
var A=document.createElement("div");var B=document.createElement("div");var o=document.createElement("div");
var G=document.createElement("div");d.style.position="absolute";d.style.top="10px";A.style.width="5px";
A.style.height=(E-5-7)+"px";A.style.position="absolute";A.style.backgroundImage="url("+r.tabContentMidStartImgURL+")";
d.appendChild(A);B.style.width=(F-5-8)+"px";B.style.height=(E-5-7)+"px";B.style.position="absolute";B.style.backgroundRepeat="repeat-x";
B.style.backgroundColor="#F8F8FB";B.style.backgroundImage="url("+r.tabContentMidMidImgURL+")";o.style.overflow="auto";
o.style.width=(F-5-8)+"px";o.style.height=(E-5-7-6-9)+"px";o.style.position="absolute";o.style.top="15px";
o.style.left="0px";o.id="realContentDivId";B.appendChild(o);d.appendChild(B);G.style.width="8px";G.style.height=(E-5-7)+"px";
G.style.position="absolute";G.style.backgroundImage="url("+r.tabContentMidEndImgURL+")";d.appendChild(G);
e.appendChild(d);var t=document.createElement("div");var z=document.createElement("div");var s=q.createImageNode(r.tabContentFooterStartImgURL,true);
var g=document.createElement("div");var C=document.createElement("div");var l=q.createImageNode(r.tabContentFooterEndImgURL,true);
t.style.position="absolute";t.style.top=(E-7+5)+"px";z.style.width="6px";z.style.height="7px";z.style.position="absolute";
s.style.width="6px";s.style.position="absolute";z.appendChild(s);t.appendChild(z);g.style.width=(F-6-8)+"px";
g.style.height="7px";g.style.position="absolute";g.style.backgroundRepeat="repeat-x";g.style.backgroundImage="url("+r.tabContentFooterMidImgURL+")";
t.appendChild(g);C.style.width="8px";C.style.height="7px";C.style.position="absolute";l.style.width="8px";
l.style.position="absolute";C.appendChild(l);t.appendChild(C);e.appendChild(t);if(r.pageDirection){n.style.left="0px";
d.style.left="0px";t.style.left="0px";u.style.left="0px";A.style.left="0px";z.style.left="0px";H.style.left="5px";
w.style.left=(F-8)+"px";B.style.left="5px";G.style.left=(F-8)+"px";g.style.left="6px";C.style.left=(F-8)+"px";
}else{n.style.right="0px";d.style.right="0px";t.style.right="0px";u.style.right="0px";A.style.right="0px";
z.style.right="0px";H.style.right="5px";w.style.right=(F-8)+"px";B.style.right="5px";G.style.right=(F-8)+"px";
g.style.right="6px";C.style.right=(F-8)+"px";}return e;};OM.infowindow.MVInfoWindowStyle.addCloseButton=function(s,m,d){if(this.hideCloseButton){return null;
}var r=OM.util.DomUtil;var o=OM.infowindow.MVInfoWindowStyle;var g=r.createImageNode(o.closeButtonImgURL,true);
if(!m){m=0;}g.id="_mv_closebut_"+m;g.style.width=r.pixel(13);g.style.height=r.pixel(13);var e=function(t){o.closeButtonImgURL=o.closeButtonOverImgURL;
t=(t)?t:((window.event)?event:null);var u=t.target;if(u.tagName=="IMG"){u.src=o.closeButtonImgURL;}else{if(u.tagName=="DIV"){u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+o.closeButtonImgURL;
}}+"', sizingMethod='image');";};var q=function(t){o.closeButtonImgURL=o.closeButtonEnableImgURL;t=(t)?t:((window.event)?event:null);
var u=t.target;if(u.tagName=="IMG"){u.src=o.closeButtonImgURL;}else{if(u.tagName=="DIV"){u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+o.closeButtonImgURL;
}}+"', sizingMethod='image');";};var l=function(t){o.closeButtonImgURL=o.closeButtonDownImgURL;t=(t)?t:((window.event)?event:null);
var u=t.target;if(u.tagName=="IMG"){u.src=o.closeButtonImgURL;}else{if(u.tagName=="DIV"){u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+o.closeButtonImgURL;
}}+"', sizingMethod='image');";};var n=function(t){o.closeButtonImgURL=o.closeButtonOverImgURL;t=(t)?t:((window.event)?event:null);
var u=t.target;if(u.tagName=="IMG"){u.src=o.closeButtonImgURL;}else{if(u.tagName=="DIV"){u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+o.closeButtonImgURL;
}}+"', sizingMethod='image');";};if(OM.browser.touchSupported){this.$transCloseImg=OM.$("<img src='"+OM.gv.transparentImg+"' style='position:absolute;z-index:300' width='30' height='30'>");
if(s!=null){this.$transCloseImg.bind("touchend",s);}}else{d.on("mouseover","#_mv_closebut_"+m,e);d.on("mouseout","#_mv_closebut_"+m,q);
d.on("mousedown","#_mv_closebut_"+m,l);d.on("mouseup","#_mv_closebut_"+m,n);if(s!=null){d.on("click","#_mv_closebut_"+m,s);
}}return g;};OM.infowindow.MVInfoWindowStyle.renderCone=function(e,d){OM.infowindow.MVInfoWindowStyle.renderTrail(e,this.x,this.y,d);
};OM.infowindow.MVInfoWindowStyle.renderTrail=function(o,u,t,s){if(this.style_coneOpacity==0){return;
}var E=document.getElementById("infowindow4_"+s);var M=E.style.zIndex-1;var g=E.offsetLeft;var e=E.offsetTop;
g-=u;e-=t;var J=1;var n=1;var l=E.offsetWidth;var z=E.offsetHeight;var B=0;var d=50;var N=260;var q=340;
var r=50;if(this.coneDiv){OM.$(this.coneDiv).empty();if(this.coneDiv.parentNode){this.coneDiv.parentNode.removeChild(this.coneDiv);
}}var A=document.createElement("DIV");A.id=E.id+"cones";A.style.position="absolute";A.style.left=u+"px";
A.style.top=t+"px";A.style.border="0px solid #000000";A.style.zIndex=M;this.coneDiv=A;o.appendChild(A);
zcounter=0;var C=r;var G=Math.round((this.style_coneOpacity/r)*7);var I=Math.abs(g/r);var H=Math.abs(e/r);
var F=Math.abs(I/H);var L=0;for(var D=0;D<r;D++){var K=((g*1/r)*D);var m=((e*1/r)*D);N=J+Math.abs(((l-J)/r*D));
q=n+Math.abs(((z-n)/r*D));var w=document.createElement("DIV");w.id=E.id+"D"+D;w.style.cssText=this.style_coneStyle;
OM.$(w).css({left:K,top:m,width:N,height:q,position:"absolute",border:"0px solid black",fontSize:"1px",lineHeight:0});
A.appendChild(w);OM.infowindow.MVInfoWindowStyle.setOpaque(w,G);w.style.zIndex=zcounter;zcounter++;L++;
C-=D;}coneDone=true;};OM.infowindow.MVInfoWindowStyle.setOpaque=function(d,e){OM.$(d).css("opacity",e/100);
};OM.infowindow.MVInfoWindowStyle.sizeChanged=function(l){var g=OM.infowindow.MVInfoWindowStyle;var d=document.getElementById("infowindow4_"+l);
var e=document.getElementById("infowindow4tablebutton_"+l);if(d&&e){if(Math.abs(e.offsetWidth-d.offsetWidth)>=5){return true;
}if(Math.abs(e.offsetHeight-d.offsetHeight)>=5){return true;}}if((d&&g.infoWindowWidth[l]&&Math.abs(g.infoWindowWidth[l]-d.offsetWidth)<5&&g.infoWindowHeight[l]&&Math.abs(g.infoWindowHeight[l]-d.offsetHeight)<5)){return false;
}else{return true;}};OM.infowindow.MVInfoWindowStyle.clear=function(){if(this.windowDiv){OM.$(this.windowDiv).empty();
this.windowDiv=null;}if(this.coneDiv){OM.$(this.coneDiv).empty();}this.coneDiv=null;};OM.infowindow.MVInfoWindowStyle.createContentByDiv=function(o,z,e,w,s){var m=OM.util.DomUtil;
var q=OM.infowindow.MVInfoWindowStyle;var C=document.createElement("table");C.style.position="absolute";
C.style.zIndex="300";C.cellPadding="0";C.cellSpacing="0";var d=document.createElement("tbody");C.appendChild(d);
var D=document.createElement("tr");d.appendChild(D);var t=document.createElement("td");t.rowSpan="3";
t.style.width=m.pixel(10);t.innerHTML="<img src='"+OM.gv.transparentImg+"' width='10px'>";D.appendChild(t);
var n=document.createElement("td");n.style.height=m.pixel(10);n.innerHTML="<img src='"+OM.gv.transparentImg+"' height='10px'>";
D.appendChild(n);var r=document.createElement("td");r.style.width=m.pixel(5);r.rowSpan="3";r.innerHTML="<img src='"+OM.gv.transparentImg+"' width='5px'>";
D.appendChild(r);var B=document.createElement("tr");d.appendChild(B);var l=document.createElement("td");
l.style.verticalAlign="top";var u=document.createElement("div");u.id=o+"_content";u.appendChild(z);l.appendChild(u);
B.appendChild(l);var A=document.createElement("tr");var g=document.createElement("td");g.style.height=m.pixel(10);
g.innerHTML="<img src='"+OM.gv.transparentImg+"' height='10px'>";A.appendChild(g);d.appendChild(A);if(!e){u.style.width=m.pixel(w-q.MultiFeatureListTotalMarginWidth);
u.style.height=m.pixel(s-q.TotalMarginHeight);u.style.overflow="auto";}return C;};OM.infowindow.MVInfoWindowStyle.getPageDirection=function(q){var d=OM.gv.resourcePath();
var l=OM.infowindow.MVInfoWindowStyle;if(l.pageDirection==null){var e=document.createElement("table");
var r=document.createElement("tr");var o=document.createElement("td");var n=document.createElement("td");
var m=document.createElement("tbody");e.cellSpacing=0;e.cellPadding=0;o.innerHTML="fsdfsds";n.innerHTML="p";
m.appendChild(r);e.appendChild(m);r.appendChild(o);r.appendChild(n);q.appendChild(e);var g=o.offsetLeft;
if(g==0){l.pageDirection=true;}else{l.pageDirection=false;}q.removeChild(e);}if(!l.pageDirection){l.tabEnableStartImgURL=d+"infoicons/t3_above_start_n_r.png";
l.tabEnableMidImgURL=d+"infoicons/t3_above_mid_n_r.png";l.tabEnableEndImgURL=d+"infoicons/t3_above_end_n_r.png";
l.tabDisableStartImgURL=d+"infoicons/t3_above_start_d_r.png";l.tabDisableMidImgURL=d+"infoicons/t3_above_mid_d_r.png";
l.tabDisableEndImgURL=d+"infoicons/t3_above_end_d_r.png";l.tabSelectedStartImgURL=d+"infoicons/t3_above_start_a_r.png";
l.tabSelectedMidImgURL=d+"infoicons/t3_above_mid_a_r.png";l.tabSelectedEndImgURL=d+"infoicons/t3_above_end_a_r.png";
l.tabContentHeadStartImgURL=d+"infoicons/ptts_r.png";l.tabContentHeadMidImgURL=d+"infoicons/ptt_r.png";
l.tabContentHeadEndImgURL=d+"infoicons/ptte_r.png";l.tabContentMidStartImgURL=d+"infoicons/pts_r.png";
l.tabContentMidMidImgURL=d+"infoicons/ptc_r.png";l.tabContentMidEndImgURL=d+"infoicons/pte_r.png";l.tabContentFooterStartImgURL=d+"infoicons/ptbs_r.png";
l.tabContentFooterMidImgURL=d+"infoicons/ptb_r.png";l.tabContentFooterEndImgURL=d+"infoicons/ptbe_r.png";
}};OM.infowindow.MVInfoWindowStyle.getRealWithOfOneTab=function(e,l,d){var n=0;var m=document.createElement("a");
var q=document.createElement("div");q.style.position="absolute";m.style.cursor="pointer";m.style.fontFamily="Tahoma";
m.style.fontSize="11px";m.style.fontWeight="bold";e.appendChild(q);q.appendChild(m);var g=(d-9-36)/6;
g=g-g%1+1;if(g>l.title.length){g=l.title.length;}m.innerHTML=l.title.replace(/\s/g,"&nbsp;");n=q.offsetWidth+9+36;
while(n>d){var o=l.title.substring(0,g).replace(/\s/g,"&nbsp;")+"..";m.innerHTML=o;n=q.offsetWidth+9+36;
l.showTitle=o;g--;}e.removeChild(q);return n;};OM.infowindow.MVInfoWindowStyle.getOrignalWithOfOneTab=function(d,e){var l=0;
var g=document.createElement("a");var o=document.createElement("div");var m=10;var n=20;o.style.position="absolute";
g.style.cursor="pointer";g.style.fontFamily="Tahoma";g.style.fontSize="11px";g.style.fontWeight="bold";
g.style.whiteSpace="nowrap";d.appendChild(o);o.appendChild(g);g.innerHTML=e.title.replace(/\s/g,"&nbsp;");
l=o.offsetWidth+m+n;d.removeChild(o);return l;};OM.infowindow.MVInfoWindowStyle.groupingTabs=function(l,m){var z;
var t=new Array();var s=0;for(var n=0;n<l.length;n++){t.push([n,l[n]]);s=s+l[n];}t=t.sort(function(B,q){return q[1]-B[1];
});if(s%m==0){minRowNum=s/m;}else{minRowNum=(s-s%m)/m+1;}for(var r=1;r<=l.length;r++){var A=new Array(r);
var u=0;var g=t.slice(0);z=new Array(r);for(var d=0;d<z.length;d++){z[d]=new Array();A[d]=0;}var w=0;
while(true){for(var e=w;e<r;e++){for(var o=0;o<g.length;o++){A[e]+=g[o][1];if(u!=0){A[e]-=19;}if(A[e]>m){A[e]-=g[o][1];
if(u!=0){A[e]+=19;}if(o==g.length-1){w=e+1;}}else{z[e][u]=g[o][0];g.splice(o,1);break;}}}if(g.length==0){break;
}if(w==r){break;}u++;}if(g.length==0){break;}}return z;};OM.infowindow.MVInfoWindowTab=function(e,d){this.title=e;
this.content=d;};OM.infowindow.MVInfoWindowTab.prototype.getTitle=function(){return this.title;};OM.infowindow.MVInfoWindowTab.prototype.getContent=function(){return this.content;
};OM.tool.Tool=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(d){this._$container=d.$oracleMapDiv;
this._geometry=null;this._graphic=d.graphics;this._map=d;this._toolShape=null;this._group=null;this._style=new OM.style.Line({stroke:"#000000",strokeThickness:2});
this._style.fill=d.graphics.oui.NO_PAINT;this.toolFeature=null;this.featureStyle=this._style;this.status=OM.tool.Tool.STOPPED;
},start:function(){throw Error("A subclass must implement the method: start");},clear:function(){throw Error("A subclass must implement the method: clear");
},clear_base:function(){if(this._group){this._graphic.remove(this._group);this._group=null;}this._toolShape=null;
this.status=OM.tool.Tool.STOPPED;if(this.toolFeature){var d=this._map.getToolFeatureLayer();if(d!=null){d.removeFeature(this.toolFeature);
}this.toolFeature=null;var g=OM.event.ToolEvent;var e=new g(g.TOOL_CLEAR,this);this.fire(e.type,e);}},getStatus:function(){return this.status;
},getGeometry:function(){return this._geometry;},setDrawingStyle:function(d){if(!d){return this;}this._style=d.clone();
return this;},setStyle:function(d){this.featureStyle=d.clone();if(this.toolFeature){this.toolFeature.setRenderingStyle(this.featureStyle);
}return this;}});OM.tool.Tool.STOPPED=0;OM.tool.Tool.STARTED=1;OM.tool.Tool.FINISHED=3;OM.tool.CircleTool=OM.tool.Tool.extend({initialize:function(g){this._super(g);
this._radius=0;this._geoCenter=null;var d=this;var m=OM.event.ToolEvent;var e=null;var l=null;this.begin=function(r){if(d.status!=OM.tool.Tool.STARTED){return;
}d._geoCenter=d._map.getCursorLocation();l=r.pageX;var u=r.pageX-d._$container.offset().left;var s=r.pageY-d._$container.offset().top;
var n=d._graphic.getLeftTop(d._map.draggableGroup);var q=n.x;var t=n.y;var o={cx:u-q,cy:s-t,width:1,height:1};
e={x:u,y:s};d._style.fill=d._graphic.oui.NO_PAINT;if(!d._toolShape){d._toolShape=d._graphic.drawEllipse(o,d._style,{group:d._group});
}else{d._graphic.setEllipse(d._toolShape,o);}d._toolShape.setStrokeDashArray([10]);if(!OM.browser.touchSupported){OM.$(document).bind("mousemove",d.drawShape);
}else{d._$container.bind("touchmove",function(A){var z=OM.util.DomUtil;var w=z.getTouchCount(A);if(w>1){return;
}var B=z.getTouchesPosition(A);A.pageX=B.x;A.pageY=B.y;d.drawShape(A);});}};this.drawShape=function(r){if(d.status!=OM.tool.Tool.STARTED){return;
}var u=r.pageX-d._$container.offset().left;var s=r.pageY-d._$container.offset().top;if(u<=0||s<0||u>d._map.getMapContext().getDeviceWidth()||s>d._map.getMapContext().getDeviceHeight()){d.finish();
}var t=Math.round(Math.sqrt((u-e.x)*(u-e.x)+(s-e.y)*(s-e.y)));var o=d._map.getMapContext().getUniverse().getZoomLevels()[d._map.getMapContext().getZoomLevel()].resolution;
d._radius=t*o;var n={width:t*2,height:t*2};d._graphic.setEllipse(d._toolShape,n);var q=new m(m.CIRCLE_DRAG,d);
d.fire(q.type,q);};this.finish=function(n){d._map.enableMapAction.drag=true;d._map.enableMapAction.mouse=true;
e=null;if(!OM.browser.touchSupported){d._$container.unbind("mousedown",d.begin);OM.$(document).unbind("mousemove",d.drawShape);
d._$container.unbind("mouseup",d.finish);}else{d._$container.unbind("touchstart",d.begin);d._$container.unbind("touchmove",d.drawShape);
d._$container.unbind("touchend",d.finish);}d._graphic.remove(d._toolShape);d.status=OM.tool.Tool.FINISHED;
l=null;if(d._geoCenter){d._geometry=new OM.geometry.Circle(d._geoCenter.getX(),d._geoCenter.getY(),d._radius,d._geoCenter.srid);
d.toolFeature=new OM.Feature("circleTool"+new Date().getTime(),d._geometry,{renderingStyle:d.featureStyle});
d._map.getToolFeatureLayer().addFeature(d.toolFeature);d._geoCenter=null;var n=new m(m.TOOL_END,d);d.fire(n.type,n);
}};},start:function(){var l=OM.event.ToolEvent;this._radius=0;this._geoCenter=null;this.clear();this._map.enableMapAction.drag=false;
this._map.enableMapAction.mouse=false;if(!this._group){this._group=this._graphic.createGroup({visibility:true});
this._graphic.addGroup(this._group,this._map.draggableGroup);}if(!OM.browser.touchSupported){this._$container.bind("mousedown",this.begin);
this._$container.bind("mouseup",this.finish);}else{var d=this;this._$container.bind("touchstart",function(o){var n=OM.util.DomUtil;
var m=n.getTouchCount(o);if(m>1){return;}var q=n.getTouchesPosition(o);o.pageX=q.x;o.pageY=q.y;d.begin(o);
});this._$container.bind("touchend",this.finish);}this.status=OM.tool.Tool.STARTED;var g=new l(l.TOOL_START,this);
this.fire(g.type,g);return this;},clear:function(){this.finish();this.clear_base();},getCenter:function(){return this._geoCenter;
},getRadius:function(){return this._radius;}});OM.tool.RectangleTool=OM.tool.Tool.extend({initialize:function(l){this._super(l);
var e=this;var o=OM.event.ToolEvent;var n={};var g=null;var d=null;var m=null;this.begin=function(s){if(e.status!=OM.tool.Tool.STARTED){return;
}d=e._map.getCursorLocation();m=s.pageX;var u=s.pageX-e._$container.offset().left;var t=s.pageY-e._$container.offset().top;
n={x:u,y:t};var q=e._graphic.getLeftTop(e._map.draggableGroup);var r={x:u-q.x,y:t-q.y,width:1,height:1};
if(!e._toolShape){e._toolShape=e._graphic.drawRectangle(r,e._style,{group:e._group});}else{e._graphic.setRectangle(e._toolShape,r);
}e._toolShape.setStrokeDashArray([10]);if(!OM.browser.touchSupported){OM.$(document).bind("mousemove",e.drawShape);
}else{e._$container.bind("touchmove",function(A){var z=OM.util.DomUtil;var w=z.getTouchCount(A);if(w>1){return;
}var B=z.getTouchesPosition(A);A.pageX=B.x;A.pageY=B.y;e.drawShape(A);});}};this.drawShape=function(t){if(e.status!=OM.tool.Tool.STARTED){return;
}var r=n.x;var z=n.y;var w=t.pageX-e._$container.offset().left;var u=t.pageY-e._$container.offset().top;
if(w<=0||u<0||w>e._map.getMapContext().getDeviceWidth()||u>e._map.getMapContext().getDeviceHeight()){e.finish();
}var q=e._graphic.getLeftTop(e._map.draggableGroup);var s={width:Math.abs(w-r),height:Math.abs(u-z),x:r<w?r-q.x:w-q.x,y:z<u?z-q.y:u-q.y};
e._graphic.setRectangle(e._toolShape,s);var t=new o(o.RECTANGLE_DRAG,e);e.fire(t.type,t);};this.finish=function(s){e._map.enableMapAction.drag=true;
e._map.enableMapAction.mouse=true;if(!OM.browser.touchSupported){e._$container.unbind("mousedown",e.begin);
OM.$(document).unbind("mousemove",e.drawShape);e._$container.unbind("mouseup",e.finish);}else{e._$container.unbind("touchstart",e.begin);
e._$container.unbind("touchmove",e.drawShape);e._$container.unbind("touchend",e.finish);}e._graphic.remove(e._toolShape);
m=null;e.status=OM.tool.Tool.FINISHED;if(d){g=e._map.getCursorLocation();var q=[d.getX(),d.getY(),g.getX(),g.getY()];
var r=0;if(q[0]>q[2]){r=q[0];q[0]=q[2];q[2]=r;}if(q[1]>q[3]){r=q[1];q[1]=q[3];q[3]=r;}e._geometry=new OM.geometry.Rectangle(q[0],q[1],q[2],q[3],g.srid);
e.toolFeature=new OM.Feature("rectangleTool"+new Date().getTime(),e._geometry,{renderingStyle:e.featureStyle});
e._map.getToolFeatureLayer().addFeature(e.toolFeature);d=null;var s=new o(o.TOOL_END,e);e.fire(s.type,s);
}};},start:function(){var l=OM.event.ToolEvent;this.clear();this._map.enableMapAction.drag=false;this._map.enableMapAction.mouse=false;
if(!this._group){this._group=this._graphic.createGroup({visibility:true});this._graphic.addGroup(this._group,this._map.draggableGroup);
}if(!OM.browser.touchSupported){this._$container.bind("mousedown",this.begin);this._$container.bind("mouseup",this.finish);
}else{var d=this;this._$container.bind("touchstart",function(o){var n=OM.util.DomUtil;var m=n.getTouchCount(o);
if(m>1){return;}var q=n.getTouchesPosition(o);o.pageX=q.x;o.pageY=q.y;d.begin(o);});this._$container.bind("touchend",this.finish);
}this.status=OM.tool.Tool.STARTED;var g=new l(l.TOOL_START,this);this.fire(g.type,g);return this;},clear:function(){this.finish();
this.clear_base();}});OM.tool.DistanceTool=OM.tool.Tool.extend({initialize:function(e){this._super(e);
this._tool=new OM.tool.RedlineTool(e,OM.tool.RedlineTool.TYPE_LINESTRING);this._map=e;this._distanceInfo=null;
this._subTotalDis=0;var d=this;this.newPoint=function(){var g=d._tool;if(g._points.length>1){var n=[];
var m=null;for(var l=0;l<g._points.length;l++){m=g._points[l].geo;n.push(m.getX());n.push(m.getY());}d.calTotalDistance(new OM.geometry.LineString(n,d._map.getMapContext().getUniverse().srid));
}};this.drawing=function(){var m=d._map.getMapContext().getUniverse().srid;if(m==8307||m==8265||m==53004||m==54004||m==3785){if(OM.$("#sub_tr_"+1)){OM.$("#sub_tr_"+1).show();
}d._distanceInfo.setVisible(true);var n=d._map.getCursorLocation();var l=d._tool._points[d._tool._points.length-1].geo;
var g=OM.util.GeomUtil.getLength(new OM.geometry.LineString([n.getX(),n.getY(),l.getX(),l.getY()],d._map.getMapContext().getUniverse().srid),null,{unit:"kilometer",transformToGeodetic:true});
var g=Math.round(g*100)/100;OM.$("#distance_total_"+1).text(Math.round((d._subTotalDis+g)*100)/100+"KM");
OM.$("#distance_sub_"+1).text(g+"KM");}};this.finish=function(){if(d.status!=OM.tool.Tool.STARTED){return;
}d.calTotalDistance(d._tool.toolFeature.geo);d.status=OM.tool.Tool.FINISHED;d._tool.finish();var g=new OM.event.ToolEvent(OM.event.ToolEvent.TOOL_END,d);
d.fire(g.type,g);};this.edit=function(){d.calTotalDistance(d._tool.toolFeature.geo);var g=new OM.event.ToolEvent(OM.event.ToolEvent.DISTANCE_UPDATE,d);
d.fire(g.type,g);};this._tool.on(OM.event.ToolEvent.REDLINE_POINT_CREATE,d.newPoint);this._tool.on(OM.event.ToolEvent.REDLINE_DRAW,d.drawing);
this._tool.on(OM.event.ToolEvent.TOOL_END,d.finish);this._tool.on(OM.event.ToolEvent.REDLINE_EDITED,d.edit);
},start:function(){this.clear();this._distanceInfo=new OM.control.MapDecoration("<table style='width:100%;border:0'> <tr><td align='right'>Total&nbsp;Distance:</td><td align='left'><span id='distance_total_"+1+"'>0KM</span></td></tr><tr id='sub_tr_"+1+"'><td align='right'>Sub&nbsp;Distance:</td><td align='left'><span id='distance_sub_"+1+"'>0KM</span></td></tr></table>",{left:0.5,top:0.7},{draggable:true,panelOptions:{style:{"border-style":"solid","border-color":"#0000ff","border-width":"1px",backgroundColor:"#FDFDFD",filter:"alpha(Opacity=80)","-moz-opacity":"0.8",opacity:"0.8"}}});
this._map.addMapDecoration(this._distanceInfo);this._distanceInfo.setVisible(false);this._tool.start();
this.status=OM.tool.Tool.STARTED;var d=new OM.event.ToolEvent(OM.event.ToolEvent.TOOL_START,this);this.fire(d.type,d);
return this;},clear:function(){if(this._distanceInfo){this._distanceInfo.setVisible(false);this._map.removeMapDecoration(this._distanceInfo);
this._distanceInfo=null;}this._subTotalDis=0;this._tool.clear();},getGeometry:function(){return this._tool.getGeometry();
},calTotalDistance:function(g){var d=this;var e=function(l){if(l!=0){d._subTotalDis=Math.round(l*100)/100;
d._distanceInfo.setVisible(true);OM.$("#distance_total_"+1).text(d._subTotalDis+"KM");if(OM.$("#sub_tr_"+1)){OM.$("#sub_tr_"+1).hide();
}}};if(g.coordinates.length>=4){OM.util.GeomUtil.getLength(g,e,{unit:"kilometer",transformToGeodetic:true});
}},setDrawingStyle:function(d){if(!d){return this;}if(this._tool){this._tool.setDrawingStyle(d);}},setStyle:function(d){if(this._tool){this._tool.setStyle({type:OM.tool.DistanceTool.TYPE_LINESTRING,style:d});
}}});OM.tool.DistanceTool.TYPE_POINT=1;OM.tool.DistanceTool.TYPE_LINESTRING=2;OM.tool.RedlineTool=OM.tool.Tool.extend({initialize:function(n,d){this._super(n);
var g=this;this._geoType=(d&&typeof d=="number")?d:OM.tool.RedlineTool.TYPE_POLYGON;this._pointStyle=new OM.style.Marker({width:10,height:10,vectorDef:[{shape:{type:"rectangle",x:0,y:0,width:10,height:10},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1}}]});
this.featurePointStyle=this._pointStyle;this.featureStyle=this._style;this.featurePolygonStyle=new OM.style.Color({styleName:"polygonToolStyle",fillOpacity:0.7,stroke:"#C0C0C0",fill:"#8D8DFF",strokeThickness:1});
this._points=[];this._lines=[];this._editFlag=true;var q=null;var l=null;var e=null;var m=null;var o=OM.event.ToolEvent;
this.downEventAction=function(r){if(r.button==0){q=r.pageX;}else{if(r.button==2){g.finish();}}r.stopPropagation();
};this.newShapePoint=function(A){if(g.status==OM.tool.Tool.STOPPED||g.status==OM.tool.Tool.FINISHED){return;
}var z=g._map.getToolFeatureLayer();if(A.pageX==q&&A.pageX!=m){var w=new o(o.REDLINE_POINT_CREATE,g);
var s=g._graphic.getLeftTop(g._map.draggableGroup);l=A.pageX-g._$container.offset().left-s.x;e=A.pageY-g._$container.offset().top-s.y;
var u=g._map.getCursorLocation();var r=null;g._points.push(new OM.Feature("RedlinePoints"+g._points.length,u,{renderingStyle:g._pointStyle}));
if(g._geoType==OM.tool.RedlineTool.TYPE_POINT){z.removeAllFeatures();z.addFeature(g._points[g._points.length-1]);
if(g._points.length>2){g._points=[g._points[1],g._points[2]];}}else{z.addFeature(g._points[g._points.length-1]);
if(g._points.length>1){g._graphic.remove(g._toolShape);g._toolShape=null;r=g._points[g._points.length-2].getGeometry();
var t=new OM.Feature("RedlineLines"+g._lines.length,new OM.geometry.LineString([r.getX(),r.getY(),u.getX(),u.getY()],r.srid),{renderingStyle:g._style});
g._lines.push(t);z.addFeature(t);t.sendToBottom();}else{g._$container.bind("mousemove",g.drawShape);}}g.fire(w.type,w);
}m=A.pageX;};this.drawShape=function(u){if(g.status==OM.tool.Tool.STOPPED){return;}if(g._geoType!=OM.tool.RedlineTool.TYPE_POINT){var t=g._graphic.getLeftTop(g._map.draggableGroup);
var s=u.pageX-g._$container.offset().left-t.x;var w=u.pageY-g._$container.offset().top-t.y;if(!g._toolShape){if(g._zoom){var r=g._map.getScreenPoint(g._points[g._points.length-1].geo.x,g._points[g._points.length-1].geo.y);
l=r[0];e=r[1];g._zoom=false;}g._toolShape=g._graphic.drawPath([[l,e,s,w]],g._style,{group:g._group});
g._toolShape.setStrokeDashArray([10]);}else{g._graphic.setPath(g._toolShape,[[l,e,s,w]]);}var u=new o(o.REDLINE_DRAW,g);
g.fire(u.type,u);}};this.zoomAction=function(r){g.finish();};this.finish=function(u){if(g.status!=OM.tool.Tool.STARTED){return;
}var C=g._map.getToolFeatureLayer();g._map.deleteListener(OM.event.MapEvent.MAP_BEFORE_ZOOM,g.zoomAction,g);
if(!OM.browser.touchSupported){g._$container.unbind("mousemove",g.drawShape);g._$container.unbind("mouseup",g.newShapePoint);
g._$container.unbind("mousedown",g.downEventAction);}else{g._$container.unbind("touchstart",g.touchStart);
g._$container.unbind("touchmove",g.touchMove);g._$container.unbind("touchend",g.touchEnd);}g._graphic.remove(g._toolShape);
if(g._points.length==0){return;}var r=[];for(var t=0;t<g._points.length;t++){r.push(g._points[t].getGeometry().getX());
r.push(g._points[t].getGeometry().getY());C.removeFeature(g._points[t]);}for(var t=0;t<g._lines.length;
t++){C.removeFeature(g._lines[t]);}var B=null;switch(g._geoType){case OM.tool.RedlineTool.TYPE_POINT:g._geometry=new OM.geometry.Point(r[r.length-2],r[r.length-1],g._points[0].getGeometry().srid);
B=g.featurePointStyle;break;case OM.tool.RedlineTool.TYPE_LINESTRING:if(g._points.length<2){OM.util.Logger.alert("","OM.tool.RedlineTool.finish","Two points needed at least.");
g.status=OM.tool.Tool.FINISHED;var z=new o(o.TOOL_END,g);g.fire(z.type,z);g._map.enableMapAction.dbclick=true;
g._map.enableMapAction.mouse=true;return;}g._geometry=new OM.geometry.LineString(r,g._points[0].getGeometry().srid);
B=g.featureStyle;break;case OM.tool.RedlineTool.TYPE_POLYGON:if(g._points.length<3){OM.util.Logger.alert("","OM.tool.RedlineTool.finish","Three points needed at least.");
g.status=OM.tool.Tool.FINISHED;var z=new o(o.TOOL_END,g);g.fire(z.type,z);return;}var A=g._points[0].getGeometry();
r.push(A.getX());r.push(A.getY());g._geometry=new OM.geometry.Polygon(r,A.srid);B=g.featurePolygonStyle;
break;}C=g._map.getToolFeatureLayer();g.toolFeature=new OM.Feature("RedlineTool"+C.featureArray.length,g._geometry,{renderingStyle:B});
g._map.getToolFeatureLayer();C.enableFeatureEditing(true);C.addFeature(g.toolFeature);var s=function(){g._geometry=g.toolFeature.geo;
var D=new o(o.REDLINE_EDITED,g);g.fire(D.type,D);};var w=function(){g._geometry=g.toolFeature.geo;var D=new o(o.REDLINE_EDITED,g);
g.fire(D.type,D);};g.toolFeature.on(OM.event.LayerEvent.FEATURE_MOVED,w,g.toolFeature);g.toolFeature.on(OM.event.LayerEvent.FEATURE_EDITED,s,g.toolFeature);
g.status=OM.tool.Tool.FINISHED;var z=new o(o.TOOL_END,g);g.fire(z.type,z);g._map.enableMapAction.dbclick=true;
g._map.enableMapAction.mouse=true;};this.touchStart=function(t){var s=OM.util.DomUtil;var r=s.getTouchCount(t);
if(r==1){t.button=0;var u=s.getTouchesPosition(t);g.touchPos=u;t.pageX=u.x;t.pageY=u.y;}else{if(r==2){t.button=2;
}else{return;}}g.downEventAction(t);};this.touchMove=function(r){g.touchPos=null;};this.touchEnd=function(r){if(g.touchPos){r.pageX=g.touchPos.x;
r.pageY=g.touchPos.y;g.newShapePoint(r);}};},start:function(){var g=OM.event.ToolEvent;this.clear();this._map.enableMapAction.dbclick=false;
this._map.enableMapAction.mouse=false;if(!this._group){this._group=this._graphic.createGroup({visibility:true});
this._graphic.addGroup(this._group,this._map.draggableGroup);}this._points=[];this._lines=[];this._map.on(OM.event.MapEvent.MAP_BEFORE_ZOOM,this.zoomAction,this);
if(!OM.browser.touchSupported){this._$container.bind("mousedown",this.downEventAction);this._$container.bind("mouseup",this.newShapePoint);
}else{this._$container.bind("touchstart",this.touchStart);this._$container.bind("touchmove",this.touchMove);
this._$container.bind("touchend",this.touchEnd);}this.status=OM.tool.Tool.STARTED;var d=new g(g.TOOL_START,this);
this.fire(g.type,g);return this;},clear:function(){this.finish();this.clear_base();},setDrawingStyle:function(d){if(!d){return this;
}if(d.type==OM.tool.RedlineTool.TYPE_POINT){this._pointStyle=d.style.clone();}if(d.type==OM.tool.RedlineTool.TYPE_LINESTRING){this._style=d.style.clone();
}return this;},setStyle:function(d){if(d.type==OM.tool.RedlineTool.TYPE_POINT){this.featurePointStyle=d.style.clone();
if(this.toolFeature&&this._geoType==OM.tool.RedlineTool.TYPE_POINT){this.toolFeature.setRenderingStyle(this.featurePointStyle);
}}if(d.type==OM.tool.RedlineTool.TYPE_LINESTRING){this.featureStyle=d.style.clone();if(this.toolFeature&&this._geoType==OM.tool.RedlineTool.TYPE_LINESTRING){this.toolFeature.setRenderingStyle(this.featureStyle);
}}if(d.type==OM.tool.RedlineTool.TYPE_POLYGON){this.featurePolygonStyle=d.style.clone();if(this.toolFeature&&this._geoType==OM.tool.RedlineTool.TYPE_POLYGON){this.toolFeature.setRenderingStyle(this.featurePolygonStyle);
}}return this;}});OM.tool.RedlineTool.TYPE_POINT=1;OM.tool.RedlineTool.TYPE_LINESTRING=2;OM.tool.RedlineTool.TYPE_POLYGON=3;
OM.tool.MarqueeZoomTool=OM.tool.Tool.extend({initialize:function(e,g){this._super(e);var d=this;this.mode=g?g:OM.tool.MarqueeZoomTool.PROMPT;
this._tool=new OM.tool.RectangleTool(e);this._tool._style=new OM.style.Color({stroke:"#00FF00",fill:"#FF0000",strokeThickness:1,fillOpacity:0.5});
this._tool.featureStyle=new OM.style.Color({stroke:"#00FF00",fill:"#FF0000",strokeThickness:1,fillOpacity:0.5});
this.finish=function(){if(d.status!=OM.tool.Tool.STARTED||d._tool.status!=OM.tool.Tool.FINISHED){return;
}var q=d._tool.getGeometry();var o=function(r){d._tool.clear();if(r){d._map.zoomToExtent(q);}};var l=function(){o(false);
e.deleteListener(OM.event.MouseEvent.MOUSE_CLICK,l);};var m=function(){o(true);e.deleteListener(OM.event.MouseEvent.MOUSE_CLICK,l);
};if(d.mode!=OM.tool.MarqueeZoomTool.PROMPT){o(true);}else{d._tool.toolFeature.on(OM.event.MouseEvent.MOUSE_CLICK,m);
e.on(OM.event.MouseEvent.MOUSE_CLICK,l);}if(d.mode==OM.tool.MarqueeZoomTool.CONTINUOUS){d._tool.start();
}else{d.status=OM.tool.Tool.FINISHED;}var n=new OM.event.ToolEvent(OM.event.ToolEvent.TOOL_END,d);d.fire(n.type,n);
};this._tool.on(OM.event.ToolEvent.TOOL_END,d.finish);},start:function(){this._tool.clear();this._tool.start();
this.status=OM.tool.Tool.STARTED;var d=new OM.event.ToolEvent(OM.event.ToolEvent.TOOL_START,this);this.fire(d.type,d);
return this;},clear:function(){this.status=OM.tool.Tool.STOPPED;this._tool.clear();},setMode:function(d){this.mode=d;
},setStyle:function(d){if(this._tool){this._tool._style=d;}}});OM.tool.MarqueeZoomTool.ONE_TIME=1;OM.tool.MarqueeZoomTool.CONTINUOUS=2;
OM.tool.MarqueeZoomTool.PROMPT=3;OM.tool.WhiteBoardTool=OM.tool.Tool.extend({initialize:function(e){this._super(e);
var z=e.mapInstanceId;if(!e.$dialog){var A=OM.tool.WhiteBoardTool;if(OM.browser.touchSupported){var s="<tr><td>Text:</td><td><input type='text' size='30' id='_wb_text"+z+"'></td><td>"+A.genSizes()+"</td></tr>";
e.$dialog=OM.$('<div id="_wb_dialog'+e.mapInstanceId+'" title="Add Text" style="overflow:visible"><table width=100%>'+s+"</table></div>");
}else{var s="<tr><td><table><tr><td>Text:</td><td><input type='text' style='width:400px'  id='_wb_text"+z+"'></td></tr></table></td></tr>";
var o="<tr><td><table><tr><td>Orietation&nbsp;value&nbsp;X&nbsp;axis:</td><td><input type='text' style='width:100px' value='1' id='_wb_orienx"+z+"'></td><td>&nbsp;&nbsp;Y&nbsp;axis:</td><td><input type='text' style='width:100px' value='0' id='_wb_orieny"+z+"'></td></tr></table></td></tr>";
e.weightBut=new OM.tool.ImageButton("_wb_weight"+z,{toolTip:"Bold",buttonEnableIcon:OM.tool.WhiteBoardTool.img_bold_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_bold_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_bold_dwn});
e.styleBut=new OM.tool.ImageButton("_wb_style"+z,{toolTip:"Italic",buttonEnableIcon:OM.tool.WhiteBoardTool.img_italic_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_italic_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_italic_dwn});
e.hAlignGroup=new OM.tool.ButtonGroup();var l=new OM.tool.ImageButton("_wb_halign_left"+z,{toolTip:"left align format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_leftalign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_leftalign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_leftalign_dwn});
var C=new OM.tool.ImageButton("_wb_halign_center"+z,{toolTip:"center align format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_centeralign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_centeralign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_centeralign_dwn,status:OM.tool.ImageButton.STATUS_DOWN});
var r=new OM.tool.ImageButton("_wb_halign_right"+z,{toolTip:"right align format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_rightalign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_rightalign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_rightalign_dwn});
e.hAlignGroup.addButton(l);e.hAlignGroup.addButton(C);e.hAlignGroup.addButton(r);e.vAlignGroup=new OM.tool.ButtonGroup();
var w=new OM.tool.ImageButton("_wb_valign_bottom"+z,{toolTip:"bottom align veritcal format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_bottomalign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_bottomalign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_bottomalign_dwn});
var q=new OM.tool.ImageButton("_wb_valign_center"+z,{toolTip:"center align veritcal format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_centervalign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_centervalign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_centervalign_dwn,status:OM.tool.ImageButton.STATUS_DOWN});
var m=new OM.tool.ImageButton("_wb_valign_top"+z,{toolTip:"top align veritcal format",buttonEnableIcon:OM.tool.WhiteBoardTool.img_topalign_ena,buttonOverIcon:OM.tool.WhiteBoardTool.img_topalign_ovr,buttonDownIcon:OM.tool.WhiteBoardTool.img_topalign_dwn});
e.vAlignGroup.addButton(m);e.vAlignGroup.addButton(q);e.vAlignGroup.addButton(w);var n="<tr><td><table><tr><td>"+A.genColor(z)+"</td><td>";
n+=e.weightBut.createHTML()+"</td><td>"+e.styleBut.createHTML();n+="</td><td>"+e.hAlignGroup.createHTML()+"</td><td>"+e.vAlignGroup.createHTML()+"</td><td>";
n+=A.genFontFamily()+"</td><td>"+A.genSizes()+"</td></tr></table></td></tr>";e.$dialog=OM.$('<div id="_wb_dialog'+e.mapInstanceId+'" title="Add Text" style="overflow:visible"><table width=100% cellSpacing=0 borderSpacing=0 style=\'font-size:13px\'>'+s+o+n+"</table></div>");
}}var g=null;var B=null;var d=null;var u=null;var t=this;this.allTextFeatures=[];this.downEventAction=function(E){if(E.which===3){t.finish();
}else{if(E.type=="touchstart"){var D=OM.util.DomUtil;if(D.getTouchCount(E)==1){var F=D.getTouchesPosition(E);
g=F.x;d=F.y;}else{return;}}else{g=E.pageX;d=E.pageY;}}};this.newShapePoint=function(G){var M=t._map.getToolFeatureLayer();
if(M.focusFeature){return;}if(t.status===OM.tool.Tool.STOPPED){return;}if(t._map.currentTool!=t){return;
}var J=null;var I=null;if(G.type=="touchend"){var E=OM.util.DomUtil;if(E.getTouchCount(G)===1){loc=E.getChangedTouchesPosition(G);
J=loc[0].x;I=loc[0].y;}else{return;}}else{J=G.pageX;I=G.pageY;}if(Math.abs(J-g)<2&&J!=B&&Math.abs(I-d)<2&&I!=u){var D=t._graphic.getLeftTop(t._map.draggableGroup);
lastX=J-t._$container.offset().left-D.x;lastY=I-t._$container.offset().top-D.y;var H=t._map.getCursorLocation();
t.currentPoint=null;OM.tool.WhiteBoardTool.showDialog(e,t);var L=1;var K=0;if(!OM.browser.touchSupported){L=parseFloat(OM.$("#_wb_orienx"+z).val());
K=parseFloat(OM.$("#_wb_orieny"+z).val());if(isNaN(L)){L=1;}if(isNaN(K)){K=0;}}t.currentPoint=new OM.geometry.Point(H.getX(),H.getY(),H.srid,L,K);
if(t.toolFeature){M.removeFeature(t.toolFeature);}if(t.textFeature){var F=t.textFeature;if(F.saved){if(F.editable){F.parentLayer.deselectFeature(F);
}else{if(F.old){F.setText(F.old.text);F.setRenderingStyle(F.old.style);}}F=null;t.textFeature=null;}else{M.removeFeature(F);
}}t.toolFeature=new OM.Feature("_wb_point"+OM.tool.WhiteBoardTool.textFeatureIdSeq,t.currentPoint,{renderingStyle:OM.tool.WhiteBoardTool.pointStyle});
if(!OM.browser.touchSupported){t.toolFeature.addListener(OM.event.LayerEvent.FEATURE_ORIENTATION_CHANGING,function(O){var P=O.angle;
var N=P<=Math.PI/2&&P>=-Math.PI/2?1:-1;var Q=Math.tan(P)*N;OM.$("#_wb_orienx"+z).val(N);OM.$("#_wb_orieny"+z).val(Q);
});t.addEventLisenterButtons();}M.addFeature(t.toolFeature);M.selectFeature(t.toolFeature);t.toolFeature.tool=t;
}B=J;u=I;};},start:function(){var g=OM.event.ToolEvent;this.clear();if(OM.browser.touchSupported){this._$container.bind("touchstart",this.downEventAction);
this._$container.bind("touchend",this.newShapePoint);}else{this._$container.bind("mousedown",this.downEventAction);
this._$container.bind("click",this.newShapePoint);}this.status=OM.tool.Tool.STARTED;this._map.currentTool=this;
var d=new g(g.TOOL_START,this);this.fire(d.type,d);return this;},clear:function(){this.clearAll();},finish:function(){this._$container.unbind("mousedown",this.downEventAction);
this._$container.unbind("click",this.newShapePoint);this._$container.unbind("touchstart",this.downEventAction);
this._$container.unbind("touchend",this.newShapePoint);var l=tool._map.getToolFeatureLayer();if(this.toolFeature){l.removeFeature(this.toolFeature);
}this.toolFeature=null;if(map.$dialog.dialog("isOpen")){map.$dialog.dialog("close");}var d=this.allTextFeatures.length;
for(var g=0;g<d;g++){var e=this.allTextFeatures[g];e.enableEditing=null;}return this;},clearAll:function(){var l=this._map.getToolFeatureLayer();
var d=this.allTextFeatures.length;for(var g=d-1;g>=0;g--){var e=this.allTextFeatures.pop();l.removeFeature(e);
}},getTextStyle:function(){var l;if(!OM.browser.touchSupported){var m=this._map.mapInstanceId;var e=OM.$("#_wb_weight"+m)[0].down?"BOLD":"NORMAL";
var n=OM.$("#_wb_style"+m)[0].down?"ITALIC":"NORMAL";var o=OM.$("#_wb_valign_bottom"+m)[0].down?"BOTTOM":OM.$("#_wb_valign_top"+m)[0].down?"TOP":"CENTERV";
var d=OM.$("#_wb_halign_left"+m)[0].down?"LFET":OM.$("#_wb_halign_right"+m)[0].down?"RIGHT":"CENTER";
var g=OM.tool.WhiteBoardTool;l={fontFamily:g.currentFontFamily,fontSize:g.currentSize,fill:g.currentColor,fontWeight:e,fontStyle:n,vAlign:o,hAlign:d};
}else{l={fontSize:OM.tool.WhiteBoardTool.currentSize};}return new OM.style.Text(l);},addText:function(d){var e=this._map.mapInstanceId;
var n=OM.$("#_wb_text"+e).val();var m=this.getTextStyle();var l=map.getToolFeatureLayer();if(this.textFeature!==this.toolFeature){l.removeFeature(this.toolFeature);
}if(this.textFeature){var g=this.textFeature;if(!g.old){g.old={text:this.textFeature.getText(),style:this.textFeature.getRenderingStyle(),point:this.textFeature.getGeometry()};
}g.setText(n);g.setRenderingStyle(m);g.screenPoints=null;g.setGeometry(d);l.deselectFeature(g);}else{var o="_wb_textfeature"+(OM.tool.WhiteBoardTool.textFeatureIdSeq++);
this.toolFeature=new OM.TextFeature(o,d,n,m);this.toolFeature.tool=this;l.addFeature(this.toolFeature);
}},addEventLisenterButtons:function(){this._map.hAlignGroup.attachEvents();this._map.vAlignGroup.attachEvents();
this._map.weightBut.attachEvents();this._map.styleBut.attachEvents();}});OM.tool.WhiteBoardTool.pointStyle=new OM.style.Marker({width:20,height:20,vectorDef:[{shape:{type:"path",coords:[[0,7,0,13,10,13,10,20,20,10,10,0,10,7,0,7]],width:20,height:20},style:{fill:"#ffffff",stroke:"#0000ff",strokeThickness:1}}]});
OM.tool.WhiteBoardTool.textFeatureIdSeq=0;OM.tool.WhiteBoardTool.fontFamilyArray=new Array("Arial","Bookman Old Style","Courier New","Garamond","Lucida Console","Symbol","Tahoma","Times New Roman","Verdana");
OM.tool.WhiteBoardTool.currentFontFamily="Arial";OM.tool.WhiteBoardTool.genFontFamily=function(m){var g='<select id="_wb_fontfamily'+m+'" onchange="OM.tool.WhiteBoardTool.setFontFamily('+m+')">';
var l="";var d=OM.tool.WhiteBoardTool.fontFamilyArray.length;for(var e=0;e<d;e++){if(OM.tool.WhiteBoardTool.fontFamilyArray[e]==OM.tool.WhiteBoardTool.currentFontFamily){l="selected=true";
}else{l="";}g+="<option "+l+' value="'+OM.tool.WhiteBoardTool.fontFamilyArray[e]+'">'+OM.tool.WhiteBoardTool.fontFamilyArray[e]+"</option>";
}g+="</select>";return g;};OM.tool.WhiteBoardTool.setFontFamily=function(e){var d=OM.$("#_wb_fontfamily"+e).val();
OM.tool.WhiteBoardTool.currentFontFamily=d;};OM.tool.WhiteBoardTool.addFont=function(e){var d=MVAnnotationTool.fontFamilyArray.length-1;
for(var g=0;g<d;g++){if(OM.tool.WhiteBoardTool.fontFamilyArray[g]==e){return;}if(OM.tool.WhiteBoardTool.fontFamilyArray[g]<e&&OM.tool.WhiteBoardTool.fontFamilyArray[g+1]>e){OM.tool.WhiteBoardTool.fontFamilyArray.splice(g+1,0,e);
return;}}OM.tool.WhiteBoardTool.fontFamilyArray.push(e);};OM.tool.WhiteBoardTool.removeFont=function(e){var d=OM.tool.WhiteBoardTool.fontFamilyArray.length-1;
for(var g=0;g<d;g++){if(OM.tool.WhiteBoardTool.fontFamilyArray[g]==e){OM.tool.WhiteBoardTool.fontFamilyArray.splice(g,1);
return;}}};OM.tool.WhiteBoardTool.genSizes=function(l){var e='<select id="_wb_fontsize'+l+'" onchange="OM.tool.WhiteBoardTool.setSize('+l+')">';
var g="";for(var d=5;d<50;d++){if(d==OM.tool.WhiteBoardTool.currentSize){g="selected=true";}else{g="";
}e+="<option "+g+' value="'+d+'px">'+d+"px</option>";}e+="</select>";return e;};OM.tool.WhiteBoardTool.setSize=function(e){var d=OM.$("#_wb_fontsize"+e).val();
OM.tool.WhiteBoardTool.currentSize=parseInt(d,10);};OM.tool.WhiteBoardTool.genColor=function(g){var e=OM.tool.WhiteBoardTool;
var d='<div id="_wb_color'+g+'" style="background: url(\''+e.color_picker_icon+"') ";d+="repeat scroll center center transparent; height: 28px;left: 4px;top: 4px;width: 28px;background-color: ";
d+=e.currentColor+'"></div>';return d;};OM.tool.WhiteBoardTool.showDialog=function(l,e,d){var g=e._map.getToolFeatureLayer();
if(d){e.textFeature=d;d.addListener(OM.event.LayerEvent.FEATURE_ORIENTATION_CHANGING,function(n){var o=n.angle;
var m=o<=Math.PI/2&&o>=-Math.PI/2?1:-1;var q=Math.tan(o)*m;OM.$("#_wb_orienx"+e._map.mapInstanceId).val(m);
OM.$("#_wb_orieny"+e._map.mapInstanceId).val(q);});e.currentPoint=d.getGeometry().clone();if(e.textFeature!==e.toolFeature){g.removeFeature(e.toolFeature);
}}l.$dialog.dialog({position:{of:l.$oracleMapDiv,at:"center"},resizable:false,width:OM.browser.touchSupported?450:510,height:OM.browser.touchSupported?190:230,buttons:[{closeOnEscape:true,text:"Ok",click:function(){if(d){var n=OM.$("#_wb_text"+l.mapInstanceId).val();
d.setText(n);var m=e.getTextStyle();d.setRenderingStyle(m);d.screenPoints=null;d.setGeometry(e.currentPoint);
g.deselectFeature(d);d.old=null;e.toolFeature=null;e.textFeature=null;}else{e.addText(e.currentPoint);
e.toolFeature.tool=e;e.toolFeature.saved=true;e.allTextFeatures.push(e.toolFeature);e.toolFeature.old=null;
e.toolFeature=null;}OM.$(this).dialog("close");}},{text:"Preview",click:function(){e.addText(e.currentPoint);
}}],close:function(m,n){e.currentEditingFeature=null;if(e.toolFeature){g.removeFeature(e.toolFeature);
}if(d){if(d.old){d.setText(d.old.text);d.setRenderingStyle(d.old.style);d.setGeometry(d.old.point);}if(d.parentLayer){d.parentLayer.deselectFeature(d);
}}e.toolFeature=null;e.textFeature=null;}});if(!OM.browser.touchSupported){l.$dialog.parent().draggable("option","containment",l.$oracleMapDiv);
OM.$("#_wb_color"+l.mapInstanceId).ColorPicker({color:"#000000",onShow:function(m){OM.$(m).fadeIn(500);
return false;},onHide:function(m){OM.$(m).fadeOut(500);return false;},onChange:function(m,o,n){OM.$("#_wb_color"+l.mapInstanceId).css("backgroundColor","#"+o);
OM.tool.WhiteBoardTool.currentColor="#"+o;},onSubmit:function(m,q,n,o){OM.tool.WhiteBoardTool.currentColor="#"+q;
OM.$(o).ColorPickerHide();}});}if(d){OM.$("#_wb_text"+l.mapInstanceId).val(d.getText());}else{OM.$("#_wb_text"+l.mapInstanceId).val("");
}};OM.tool.WhiteBoardTool.currentSize=15;OM.tool.WhiteBoardTool.currentColor="#000000";OM.tool.WhiteBoardTool.setIconsPath=function(){var e=OM.gv.resourcePath()+"txt/",d=OM.tool.WhiteBoardTool;
d.color_picker_icon=e+"colorpicker.png";d.img_bold_ena=e+"bold_ena.png";d.img_bold_ovr=e+"bold_ovr.png";
d.img_bold_dwn=e+"bold_dwn.png";d.img_italic_ena=e+"italic_ena.png";d.img_italic_ovr=e+"italic_ovr.png";
d.img_italic_dwn=e+"italic_dwn.png";d.img_leftalign_ena=e+"leftalign_ena.png";d.img_leftalign_ovr=e+"leftalign_ovr.png";
d.img_leftalign_dwn=e+"leftalign_dwn.png";d.img_centeralign_ena=e+"centeralign_ena.png";d.img_centeralign_ovr=e+"centeralign_ovr.png";
d.img_centeralign_dwn=e+"centeralign_dwn.png";d.img_rightalign_ena=e+"rightalign_ena.png";d.img_rightalign_ovr=e+"rightalign_ovr.png";
d.img_rightalign_dwn=e+"rightalign_dwn.png";d.img_bottomalign_ena=e+"bottomalignment_ena.png";d.img_bottomalign_ovr=e+"bottomalignment_ovr.png";
d.img_bottomalign_dwn=e+"bottomalignment_dwn.png";d.img_centervalign_ena=e+"centeralignment_ena.png";
d.img_centervalign_ovr=e+"centeralignment_ovr.png";d.img_centervalign_dwn=e+"centeralignment_dwn.png";
d.img_topalign_ena=e+"topalignment_ena.png";d.img_topalign_ovr=e+"topalignment_ovr.png";d.img_topalign_dwn=e+"topalignment_dwn.png";
};OM.tool.WhiteBoardTool.setIconsPath();OM.tool.ButtonGroup=OM.Class.extend({initialize:function(d){this.butGroupId=d;
this.buttonArray=[];},createHTML:function(){var g="<table><tbody><tr>";var d=this.buttonArray.length;
for(var e=0;e<d;e++){g+="<td>";g+=this.buttonArray[e].createHTML();g+="</td>";}g+="</tr></tbody></table>";
return g;},addButton:function(d){d.parent=this;this.buttonArray.push(d);},removeButton:function(g){var d=this.buttonArray.length;
for(var e=0;e<d;e++){if(this.buttonArray[e]==g){this.buttonArray.splice(e,1);g.parent=null;}}},attachEvents:function(){var d=this.buttonArray.length;
for(var e=0;e<d;e++){this.buttonArray[e].attachEvents();}},setDownButton:function(e){var d=this.buttonArray.length;
for(var l=0;l<d;l++){var g=this.buttonArray[l];if(g==e){g.setStatus(true);}else{g.setStatus(false);}}}});
OM.tool.ImageButton=OM.Class.extend({initialize:function(e,d){this.btID=e;if(d){this.btIcon=d.buttonEnableIcon;
this.btOverIcon=d.buttonOverIcon;this.btDownIcon=d.buttonDownIcon;this.btDisableIcon=d.buttonDisableIcon;
this.tip=d.toolTip;this.width=d.width;this.height=d.height;}this.status=d&&d.status?d.status:OM.tool.ImageButton.STATUS_UP;
},createHTML:function(){var d='<a href="javascript:void(0)" style="vertical-align:bottom"';d+=this.tip==null?">":' title="'+this.tip+'">';
d+='<img id="'+this.btID+'" src='+this.btIcon+" border=0></a>";return d;},attachEvents:function(){this.$icon=OM.$("#"+this.btID);
if(this.status==OM.tool.ImageButton.STATUS_DOWN){this.$icon.attr("src",this.btDownIcon);this.$icon[0].down=true;
}if(this.attched){return;}this.attched=true;var d=this;OM.$(this.$icon).hover(function(e){if(d.btOverIcon&&!this.down){d.$icon.attr("src",d.btOverIcon);
}else{}},function(e){if(d.btOverIcon&&!this.down){d.$icon.attr("src",d.btIcon);}else{}}).mousedown(function(e){if(d.btDownIcon){d.$icon.attr("src",d.btDownIcon);
}}).click(function(e){if(d.parent instanceof OM.tool.ButtonGroup){if(!this.down){this.down=true;d.parent.setDownButton(d);
}}else{d.setStatus(!this.down);}});},setStatus:function(d){if(d){this.$icon.attr("src",this.btDownIcon);
this.$icon[0].down=true;this.status=OM.tool.ImageButton.STATUS_DOWN;}else{this.$icon.attr("src",this.btIcon);
this.$icon[0].down=false;this.status=OM.tool.ImageButton.STATUS_UP;}}});OM.tool.ImageButton.STATUS_DOWN="DOWN";
OM.tool.ImageButton.STATUS_UP="UP";OM.control.MapDecoration=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(e,d){this.dragDiv=false;
this.id="DECORATION_"+(new Date()).getTime()+Math.random().toString().replace(/\./,0);this.visible=true;
this.collapsible=false;this.minimized=false;this.title="";this.isHtml=false;this.bfinit=true;this.cleaned=false;
this.X=0;this.Y=0;this.anchored=false;this.anchorOffsetX=5;this.anchorOffsetY=5;this.relativePosition=false;
this.draggable=false;this.inAnimation=false;if(e&&e.substr){this.isHtml=true;this.content=e;}if(d){this.mapType=d.mapType;
this.draggable=d.draggable?d.draggable:false;if(d.draggable==undefined){this.draggable=true;}this.X=0;
this.Y=0;this.left=d.offsetX?d.offsetX:20;this.top=d.offsetY?d.offsetY:20;this.isPanel=true;this.width=d.width?d.width:0;
this.height=d.height?d.height:0;this.title=d.title?d.title:"";this.collapsible=d.collapsible?d.collapsible:false;
this.titleStyle=d.titleStyle?d.titleStyle:null;this.contentStyle=d.contentStyle?d.contentStyle:null;}},display:function(l,e){var m=this.map||l;
var d=this.graphics=m.graphics;var g=m.getMapContext();this.parentMapWidth=g.getDeviceWidth();this.parentMapHeight=g.getDeviceHeight();
if(this.isHtml){this.container=m.$fixedLayerDIV;this.generateHtmlDecoration();this.setDraggable(this.draggable);
this.delegate("mousedown",function(n){n.stopPropagation();});}else{this.container=m.fixedGroup;this.defaultGroup=d.createGroup({opacity:1});
d.addGroup(this.defaultGroup,this.container);this.delegate("dblclick",function(n){n.stopPropagation();
n.preventDefault();});this.delegate("mousedown",function(n){n.stopPropagation();n.preventDefault();});
this.delegate("mouseup",function(n){n.stopPropagation();n.preventDefault();});}this.map.on(OM.event.MapEvent.MAP_RESIZED,this.resize,this);
if(!this.anchorPosition){if(!this.ap){this.setPosition(this.left,this.top);}else{this.setPosition(this.position.left,this.position.top);
}this.setPosition(this.position.left,this.position.top);}if(this.type==undefined){this.setAnchorPosition(this.anchorPosition);
}if(this.relativePosition&&!this.draggable){this.map.addListener(OM.event.MapEvent.MAP_RESIZED,this.setPosition,this);
}if(this.graphics&&!this.visible){this.graphics.setVisible(this.defaultGroup,this.visible);}},remove:function(){if(this.relativePosition){this.map.deleteListener(OM.event.MapEvent.MAP_RESIZED,this.setPosition,this);
}this.unDelegate();if(this.isHtml){this.$DecorationDiv.remove();if(this.$DecorationBtnDiv){this.$DecorationBtnDiv.remove();
}}},clean:function(){if(this.unDelegate){this.unDelegate();}if(this.isHtml){this.$DecorationDiv.remove();
if(this.$DecorationBtnDiv){this.$DecorationBtnDiv.remove();}}else{this.graphics.clearGroup(this.defaultGroup);
}this.cleaned=true;},setPosition:function(d,g){this.ap=true;position={left:d,top:g};var e=this.position=position||this.position;
if(e){this.X=e.left||0;this.Y=e.top||0;this.xLeft=this.X;this.yTop=this.Y;this.anchored=false;}if(this.map&&this.parentMapWidth){if(this.X<1&&this.X>0){this.X=this.X*this.parentMapWidth;
this.relativePosition=true;}if(this.Y<1&&this.Y>0){this.Y=this.Y*this.parentMapHeight;this.relativePosition=true;
}}if(this.defaultGroup&&this.graphics){this.graphics.setLeftTop(this.defaultGroup,this.X,this.Y);}else{if(this.isHtml&&this.$DecorationDiv){this.$DecorationDiv.css("top",this.Y);
this.$DecorationDiv.css("left",this.X);}}if(this.anchorPosition){this.setAnchorPosition(this.anchorPosition);
}},getAnchorPosition:function(o,t,n){var q=0;var s=0;var e=this.map.getMapContext();this.parentMapWidth=e.getDeviceWidth();
this.parentMapHeight=e.getDeviceHeight();var l=this.parentMapWidth||0;var r=this.parentMapHeight||0;var d=t?t:this.minimized?0:this.width;
var u=n?n:this.minimized?0:this.height;var m=this.anchorOffsetX==undefined||t?0:this.anchorOffsetX;var g=this.anchorOffsetY==undefined||n?0:this.anchorOffsetY;
if(!o||isNaN(o)||o<1||o>6){return{left:m,top:g};}switch(o){case 1:return{left:s+m,top:q+g};case 2:return{left:s+l/2-d/2+m,top:q+g};
case 3:return{left:s+l-d-m,top:q+g};case 4:return{left:s+m,top:q+r-u-g};case 5:return{left:s+l/2-d/2+m,top:q+r-u-g};
case 6:return{left:s+l-d-m,top:q+r-u-g};}},setAnchorPosition:function(e){var d,l;if(this.left&&!this.ap){d=this.left;
l=this.top;}else{if(this.parentMapWidth){if(this.xLeft<1&&this.xLeft>0){this.xLeft=this.xLeft*this.parentMapWidth;
}if(this.yTop<1&&this.yTop>0){this.yTop=this.yTop*this.parentMapHeight;}}d=this.xLeft;l=this.yTop;}var g=parseInt(e);
if(isNaN(g)){e=null;}this.anchored=true;this.anchorPosition=e||this.anchorPosition;this.anchorOffsetX=d==undefined?this.anchorOffsetX:d;
this.anchorOffsetY=l==undefined?this.anchorOffsetY:l;if(this.$DecorationDiv||this.graphics){this.doSetAnchorPosition();
}},doSetAnchorPosition:function(){var d=this.getAnchorPosition(this.anchorPosition);this.X=d.left;this.Y=d.top;
if(this.isHtml){if(this.collapsible){var e=this.getAnchorPosition(this.anchorPosition,this.btnW,this.btnH);
this.$DecorationBtnDiv.css("left",e.left);this.$DecorationBtnDiv.css("top",e.top);}this.$DecorationDiv.css("left",this.X);
this.$DecorationDiv.css("top",this.Y);}else{if(this.graphics){this.graphics.setLeftTop(this.defaultGroup,this.X,this.Y);
}}if(this.adjustAnchorPosition){this.adjustAnchorPosition();}},setSize:function(e,d){if(!e||!d){return;
}this.width=e;this.height=d;if(this.isHtml){this.$DecorationDiv.width(this.width);this.$DecorationDiv.height(this.height);
}},setDraggable:function(d){this.draggable=d;},setVisible:function(d){this.visible=d;if(this.isHtml){if(this.$DecorationDiv==undefined){return;
}else{if(d){this.$DecorationDiv.css("display","");}else{this.$DecorationDiv.css("display","none");}}if(this.$DecorationBtnDiv==undefined){return;
}else{if(d){this.$DecorationBtnDiv.css("display","");}else{this.$DecorationBtnDiv.css("display","none");
}}}else{if(this.graphics){this.graphics.setVisible(this.defaultGroup,d);}}},generateHtmlDecoration:function(){var o=this;
if(this.type!="OverviewMap"){this.minimized=false;}this.$DecorationDiv=OM.$("<div></div>");if(this.type==undefined){this.$DecorationDiv.css({"z-index":"200",position:"absolute",overflow:"auto"});
}else{this.$DecorationDiv.css({"z-index":"200",position:"absolute"});}if(!this.visible){this.$DecorationDiv.css("display","none");
}this.mapWidth=this.map.getMapContext().getDeviceWidth();this.mapHeight=this.map.getMapContext().getDeviceHeight();
if(this.collapsible){if(OM.browser.touchSupported){this.btnW=this.btnH=24;this.$DecorationBtnDiv=OM.$("<div><img src='"+OM.control.MapDecoration.getImage(this)+"' style='height:24px;width:24px'></div>");
}else{this.btnW=this.btnH=18;this.$DecorationBtnDiv=OM.$("<div><img src='"+OM.control.MapDecoration.getImage(this)+"' style='height:18px;width:18px'></div>");
}this.$DecorationBtnDiv.css({"z-index":"201",position:"absolute"});this.$DecorationBtnDiv.css("left",this.leftBtn);
this.$DecorationBtnDiv.css("top",this.topBtn);if(!this.visible){this.$DecorationBtnDiv.css("display","none");
}this.container.append(this.$DecorationBtnDiv);}this.container.append(this.$DecorationDiv);if(this.type=="Magnifier"){this.$Content=OM.$("<div style='overflow:auto'></div>");
this.$hideDiv=OM.$("<div style='overflow:auto'></div>");this.$hideDiv.css(this.hideStyle);this.$Content.css(this.defaultStyle);
this.$DecorationDiv.append(this.$Content);this.$DecorationDiv.append(this.$hideDiv);}if(this.type=="LayerControl"){this.$Content=OM.$("<div style='overflow:auto'></div>");
this.$Content.css(this.defaultStyle);this.$title=OM.$("<div >Vector layer list</div>");this.$title.css(this.titleStyle);
this.$DecorationDiv.append(this.$title);this.$DecorationDiv.append(this.$Content);}if(this.type==="OverviewMap"){this.width=this.parentMapWidth*0.3;
this.height=this.parentMapHeight*0.3;this.$DecorationDiv.css({"border-style":"solid","border-width":"1px 0px 0px 1px","border-color":"#000000",backgroundColor:"#FDFDFD"});
this.$DecorationDiv.width(Math.round(this.width));this.$DecorationDiv.height(Math.round(this.height));
this.setAnchorPosition(6,0,0);}if(this.type=="ToolBar"||this.mapType){var l=this.$Content=OM.$("<div style='overflow:false'></div>");
var m=this.$realContent=OM.$("<div>"+this.content+"</div>");this.defaultStyle={"border-style":"solid","border-color":"#101418","border-width":"1px",padding:"0px","font-size":"16px",color:"#000000",backgroundColor:"#FDFDFD"};
if(this.contentStyle){m.css(this.contentStyle);}else{m.css(this.defaultStyle);}if(this.title){this.title=this.title.replace(/\ /g,"&nbsp;");
var d=this.$titleDiv=OM.$("<div>"+this.title+"</div>");this.defaultTitleStyle={"border-style":"solid","border-color":"#391EA6","border-width":"1px",backgroundColor:"#0D0D0D","font-size":"18px","font-weight":"bold",color:"#FDFDFD"};
if(this.titleStyle){d.css(this.titleStyle);}else{d.css(this.defaultTitleStyle);}l.append(this.$titleDiv);
}l.append(m);this.$DecorationDiv.append(l);if(this.width){l.width(this.width);}if(this.height){l.height(this.height);
}if(!this.width){this.width=this.$DecorationDiv.width();}if(!this.height){this.height=this.$DecorationDiv.height();
}}if(!this.type&&!this.mapType){var r=OM.$('<table border="" cellspacing="0">');if(this.title){this.title=this.title.replace(/\ /g,"&nbsp;");
var q=OM.$("<tr></tr>");q.appendTo(r);var g=OM.$("<td>"+this.title+"</td>");g.appendTo(q);this.defaultTitleStyle={"border-style":"solid","border-color":"#391EA6","border-width":"1px",backgroundColor:"#0D0D0D","font-size":"18px","font-weight":"bold",color:"#FDFDFD"};
if(this.titleStyle){g.css(this.titleStyle);}else{g.css(this.defaultTitleStyle);}}var n=OM.$("<tr></tr>");
n.appendTo(r);var e=OM.$("<td>"+this.content+"</td>");e.appendTo(n);this.defaultStyle={"border-style":"solid","border-color":"#101418","border-width":"1px",padding:"0px","font-size":"16px",color:"#000000",backgroundColor:"#FDFDFD"};
if(this.contentStyle){e.css(this.contentStyle);}else{e.css(this.defaultStyle);}this.$DecorationDiv.append(r);
if(this.width){this.$DecorationDiv.width(this.width);r.width(this.width);}if(this.height){this.$DecorationDiv.height(this.height);
r.height(this.height);}if(!this.width){this.width=this.$DecorationDiv.width();}if(!this.height){this.height=this.$DecorationDiv.height();
}}if(this.anchorPosition&&this.type!="OverviewMap"){this.doSetAnchorPosition();}if(this.collapsible){if(OM.browser.touchSupported){this.$DecorationBtnDiv.bind("touchstart",function(){if(o.type=="OverviewMap"){if(o.collapsible){if(o.minimized){o.restore();
}else{o.collapse();}}}else{if(!o.minimized){o.collapse();o.minimized=true;}else{o.restore();o.minimized=false;
}}event.stopPropagation();});}else{this.$DecorationBtnDiv.mouseover(function(t){var s=t.target;s.src=o.minimized===false?o.getMinimizeIcon():o.getRestoreIcon();
t.stopPropagation();}).mouseout(function(t){var s=t.target;s.src=OM.control.MapDecoration.getImage(o);
t.stopPropagation();}).dblclick(function(s){s.stopPropagation();}).click(function(s){if(o.type=="OverviewMap"){if(o.collapsible){if(o.minimized){o.restore();
}else{o.collapse();}}}else{if(!o.minimized){o.collapse();o.minimized=true;}else{o.restore();o.minimized=false;
}}s.stopPropagation();}).dblclick(function(s){s.stopPropagation();}).mousemove(function(s){s.stopPropagation();
}).mousedown(function(s){s.stopPropagation();});}}if(this.type=="Magnifier"){if(this.width){this.$Content.width(this.width);
}if(this.height){this.$Content.height(this.height);}if(!this.width){this.width=this.$DecorationDiv.width();
}if(!this.height){this.height=this.$DecorationDiv.height();}}o=this;this.moveX=0;this.moveY=0;this.flag=false;
if(this.type=="LayerControl"){this.$title.mousedown(function(s){o.mousedown(s);}).mouseup(function(s){o.mouseup(s);
}).dblclick(function(s){s.stopPropagation();}).mouseover(function(s){o.map.$oracleMapDiv.css("cursor","pointer");
s.stopPropagation();}).mouseout(function(s){o.map.$oracleMapDiv.css("cursor","default");s.stopPropagation();
});}if(this.type==undefined||this.type=="Magnifier"||this.type=="ToolBar"){this.$DecorationDiv.bind("touchstart",function(s){o.touchstart(s);
});this.$DecorationDiv.mousedown(function(s){if(OM.browser.chrome){if(s.offsetY>(OM.$(this).height()-21)&&s.offsetY<OM.$(this).height()){return;
}if(s.offsetX>(OM.$(this).width()-21)){return;}}if(OM.browser.msie){if(s.offsetY>(OM.$(this).height()-17)&&s.offsetY<OM.$(this).height()){return;
}if(s.offsetX>(OM.$(this).width()-17)){return;}}OM.$(this).css("cursor","default");if(o.draggable){OM.$(this).css("cursor","move");
}o.mousedown(s);}).mouseup(function(s){OM.$(this).css("cursor","default");o.map.moveflag=false;o.mouseup(s);
}).dblclick(function(s){s.stopPropagation();}).mouseover(function(s){s.stopPropagation();}).mouseout(function(s){if(o.type!="ToolBar"){o.mouseup(s);
}s.stopPropagation();}).mousewheel(function(s){s.stopPropagation();}).click(function(s){s.stopPropagation();
}).scroll(function(s){o.mouseup(s);});}if(this.type=="LayerControl"){this.$DecorationDiv.mousedown(function(s){s.stopPropagation();
}).mouseup(function(s){s.stopPropagation();}).dblclick(function(s){s.stopPropagation();}).mouseover(function(s){s.stopPropagation();
}).mouseout(function(s){s.stopPropagation();}).mousewheel(function(s){s.stopPropagation();}).click(function(s){s.stopPropagation();
});}if(this.type!="OverviewMap"){OM.$(document).mouseup(function(s){o.mouseup(s);});this.map.$oracleMapDiv.mousemove(function(s){o.mousemove(s);
});if(this.type=="LayerControl"){this.$title.bind("touchstart",function(s){o.touchstart(s);});this.$title.bind("touchend",function(s){s.stopPropagation();
s.preventDefault();o.touchend(s);});this.$Content.bind("touchmove touchstart touchend",function(s){s.stopPropagation();
s.preventDefault();});}this.map.$oracleMapDiv.bind("touchmove",function(s){s.stopPropagation();s.preventDefault();
o.touchmove(s);});this.map.$oracleMapDiv.bind("touchend",function(s){s.stopPropagation();s.preventDefault();
o.touchend(s);});}},resize:function(){this.moveX=(this.moveX+this.width/2)*this.map.getMapContext().getDeviceWidth()/this.mapWidth-this.width/2;
this.moveY=(this.moveY+this.height/2)*this.map.getMapContext().getDeviceHeight()/this.mapHeight-this.height/2;
this.mapWidth=this.map.getMapContext().getDeviceWidth();this.mapHeight=this.map.getMapContext().getDeviceHeight();
if(this.anchorPosition){this.setAnchorPosition(this.anchorPosition);}},mousedown:function(d){if(this.draggable){this.dragDiv=true;
if(!this.map.enableMapAction.drag){return;}this.dragging=true;this.map.enableMapAction.drag=false;this.startX=parseInt(d.clientX);
this.startY=parseInt(d.clientY);this.positionX=parseInt(this.$DecorationDiv.css("left"));this.positionY=parseInt(this.$DecorationDiv.css("top"));
this.dragStartFlag=true;d.stopPropagation();}},mousemove:function(d){this.parentMapHeight=this.map.getMapContext().getDeviceHeight();
this.parentMapWidth=this.map.getMapContext().getDeviceWidth();document.onselectstart=new Function("return false");
this.height=this.$DecorationDiv.height();if(this.type=="LayerControl"){this.height=this.$Dom.height();
}if(!this.dragging){return;}if(this.dragStartFlag==true){var g=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG_START,this);
this.fire(OM.event.MapDecorationEvent.DRAG_START,g);this.dragStartFlag=false;}this.moveX=this.positionX+d.clientX-this.startX;
this.moveY=this.positionY+d.clientY-this.startY;this.$DecorationDiv.css("left",this.moveX);this.$DecorationDiv.css("top",this.moveY);
var g=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG,this);this.fire(OM.event.MapDecorationEvent.DRAG,g);
d.stopPropagation();},mouseup:function(d){this.flag=false;this.dragDiv=false;this.v_isDrag=false;if(this.dragging==true&&this.startX!=parseInt(d.clientX)&&this.startY!=parseInt(d.clientY)){var g=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG_END,this);
this.fire(OM.event.MapDecorationEvent.DRAG_END,g);}if(this.dragging){this.dragStartFlag=false;this.dragging=false;
this.map.enableMapAction.drag=true;}d.stopPropagation();},touchstart:function(g){if(this.draggable){this.dragDiv=true;
if(!this.map.enableMapAction.drag){return;}this.dragging=true;this.map.enableMapAction.drag=false;var d=OM.util.DomUtil;
this.touchCount=d.getTouchCount(g);if(this.touchCount>2){return;}var e=[];if(this.touchCount==1){var l=d.getTouchesPosition(g);
e.push(l);}this.touchStartX=parseInt(e[0].x);this.touchStartY=parseInt(e[0].y);this.touchPositionX=parseInt(this.$DecorationDiv.css("left"));
this.touchPositionY=parseInt(this.$DecorationDiv.css("top"));this.dragStartFlag=true;}},touchmove:function(l){var d=OM.util.DomUtil;
var g=[];if(this.touchCount==1){var n=d.getTouchesPosition(l);g.push(n);}if(!this.dragging){return;}if(this.dragStartFlag==true){var m=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG_START,this);
this.fire(OM.event.MapDecorationEvent.DRAG_START,m);this.dragStartFlag=false;}this.touchMoveX=this.touchPositionX+g[0].x-this.touchStartX;
this.touchMoveY=this.touchPositionY+g[0].y-this.touchStartY;this.moveX=this.touchMoveX;this.moveY=this.touchMoveY;
this.$DecorationDiv.css("left",this.touchMoveX);this.$DecorationDiv.css("top",this.touchMoveY);var m=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG,this);
this.fire(OM.event.MapDecorationEvent.DRAG,m);l.stopPropagation();},touchend:function(l){this.flag=false;
this.dragDiv=false;var d=OM.util.DomUtil;var g=[];if(this.touchCount==1){var n=d.getTouchesPosition(l);
g.push(n);}if(this.dragging==true&&this.touchStartX!=parseInt(g[0].x)&&this.touchStartY!=parseInt(g[0].y)){var m=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.DRAG_END,this);
this.fire(OM.event.MapDecorationEvent.DRAG_END,m);}if(this.dragging){this.dragStartFlag=false;this.dragging=false;
this.map.enableMapAction.drag=true;}this.map.touchStartLocs=[];l.stopPropagation();},delegate:function(d,e,n){var o;
var g=(e instanceof Object)?true:false;if(this.isHtml){o=this.$DecorationDiv;if(g&&n!=null){var q=e.attr("id")||"selector_"+Math.random().toString().replace(/\./,0);
e.attr("id",q);OM.$(o).on(d,"#"+q,n);}else{OM.$(o).on(d,e,n);}}else{o=this.defaultGroup;if(e&&typeof e==="function"){return this.delegate(d,o,e);
}var m=this.delegateListeners=this.delegateListeners||[];m[d]=m[d]||[];var l=n.id=n.id||"fn_"+Math.random().toString().replace(/\./,0);
var r;r=function(s){var t=s.target.getAncestors();for(var u=t.length-1;u>0;u--){if(g){if(t[u]===e){s.delegateTarget=t[u];
n.call(null,s);}}else{if(t[u].queryType&&t[u].queryType.indexOf("#"+e)!=-1){s.delegateTarget=t[u];n.call(null,s);
}}if(t[u]===s.currentTarget){return;}}};r.id=l;o.addEventListener(d,r);m[d].push(r);}return this;},unDelegate:function(e,g,q){var r;
e=e||"mouseover mouseout mousemove mousedown mouseup click dblclick";var l=(g instanceof Object)?true:false;
if(this.isHtml){r=this.$DecorationDiv;if(l){var s=g.attr("id");OM.$(r).off(e,"#"+s,q);}else{OM.$(r).off(e,g,q);
}}else{r=this.defaultGroup;var o=this.delegateListeners;var d=e.split(" ");for(var m=0;m<d.length;m++){var u=d[m];
if(r.listeners&&r.listeners[u]){if(q){var t;for(var n=0;n<o[u].length;n++){if(o[u][n].id===q.id){t=o[u][n];
o[u].splice(n,1);break;}}r.removeEventListener(u,t);}else{r.listeners[u]=[];this.delegateListeners[u]=[];
}}}}return this;},getRestoreIcon:function(){var d=this.anchorPosition||1;switch(d){case 1:return OM.control.MapDecoration.BUTTON_RESTORE_TOP_LEFT;
case 2:return OM.control.MapDecoration.BUTTON_RESTORE_TOP_LEFT;case 3:return OM.control.MapDecoration.BUTTON_RESTORE_TOP_RIGHT;
case 4:return OM.control.MapDecoration.BUTTON_RESTORE_LOWER_LEFT;case 5:return OM.control.MapDecoration.BUTTON_RESTORE_LOWER_LEFT;
case 6:return OM.control.MapDecoration.BUTTON_RESTORE_LOWER_RIGHT;}},getMinimizeIcon:function(){var d=this.anchorPosition||1;
switch(d){case 1:return OM.control.MapDecoration.BUTTON_MINIMIZE_TOP_LEFT;case 2:return OM.control.MapDecoration.BUTTON_MINIMIZE_TOP_LEFT;
case 3:return OM.control.MapDecoration.BUTTON_MINIMIZE_TOP_RIGHT;case 4:return OM.control.MapDecoration.BUTTON_MINIMIZE_LOWER_LEFT;
case 5:return OM.control.MapDecoration.BUTTON_MINIMIZE_LOWER_LEFT;case 6:return OM.control.MapDecoration.BUTTON_MINIMIZE_LOWER_RIGHT;
}},collapse:function(){if(this.inAnimation||this.minimized){return;}this.inAnimation=true;var l=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.BEFORE_COLLAPSE,this);
this.fire(l.type,l);var n=this.$DecorationDiv.position();var g={width:"0",height:"0",opacity:"0"};if(this.anchorPosition==3||this.anchorPosition==6){g.left=n.left+this.width;
}else{if(this.anchorPosition==2||this.anchorPosition==5){g.left=n.left+this.width/2;}}if(this.anchorPosition==4||this.anchorPosition==5||this.anchorPosition==6){g.top=n.top+this.height;
}var m=this;this.tempWidth=this.$DecorationDiv.width();this.tempHeight=this.$DecorationDiv.height();this.$DecorationDiv.animate(g,200,"swing",function(){m.minimized=true;
m.inAnimation=false;var o=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.AFTER_COLLAPSE,m);
m.fire(o.type,o);});var d=this.$DecorationBtnDiv.children("img");if(d.attr("src")==this.getMinimizeIcon()){d.attr("src",this.getRestoreIcon());
}else{if(d.attr("src")==this.getRestoreIcon()){d.attr("src",this.getMinimizeIcon());}}},restore:function(){if(this.inAnimation||!this.minimized){return;
}this.inAnimation=true;var m=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.BEFORE_RESTORE,this);
this.fire(m.type,m);var l=this.$DecorationDiv.position();this.width=this.tempWidth;this.height=this.tempHeight;
var e={width:this.width,height:this.height,opacity:"1"};if(this.anchorPosition==3||this.anchorPosition==6){e.left=l.left-this.width;
}else{if(this.anchorPosition==2||this.anchorPosition==5){e.left=l.left-this.width/2;}}if(this.anchorPosition==4||this.anchorPosition==5||this.anchorPosition==6){e.top=l.top-this.height;
}var g=this;this.$DecorationDiv.animate(e,200,"swing",function(){g.minimized=false;g.inAnimation=false;
var n=new OM.event.MapDecorationEvent(OM.event.MapDecorationEvent.AFTER_RESTORE,g);g.fire(n.type,n);});
var d=this.$DecorationBtnDiv.children("img");if(d.attr("src")==this.getRestoreIcon()){d.attr("src",this.getMinimizeIcon());
}else{if(d.attr("src")==this.getMinimizeIcon()){d.attr("src",this.getRestoreIcon());}}},isVisible:function(){return this.visible;
}});OM.control.MapDecoration.POSITION_UPPER_LEFT=1;OM.control.MapDecoration.POSITION_UPPER_CENTER=2;OM.control.MapDecoration.POSITION_UPPER_RIGHT=3;
OM.control.MapDecoration.POSITION_LOWER_LEFT=4;OM.control.MapDecoration.POSITION_LOWER_CENTER=5;OM.control.MapDecoration.POSITION_LOWER_RIGHT=6;
OM.control.MapDecoration.setIconsPath=function(){var e=OM.gv.resourcePath(),g=OM.control.MapDecoration;
g.OVER_VIEW_ICON=e+"overviewicon.gif";g.BUTTON_MINIMIZE_LOWER_LEFT=e+"button_minimize_l.gif";g.BUTTON_RESTORE_LOWER_LEFT=e+"button_restore_l.gif";
g.BUTTON_MINIMIZE_LOWER_RIGHT=e+"button_minimize.gif";g.BUTTON_RESTORE_LOWER_RIGHT=e+"button_restore.gif";
g.BUTTON_MINIMIZE_TOP_LEFT=e+"button_restore.gif";g.BUTTON_RESTORE_TOP_LEFT=e+"button_minimize.gif";g.BUTTON_MINIMIZE_TOP_RIGHT=e+"button_restore_l.gif";
g.BUTTON_RESTORE_TOP_RIGHT=e+"button_minimize_l.gif";g.MAGNIFIER=e+"magnifier.gif";g.TH_BG_S=e+"th_bg_s.png";
};OM.control.MapDecoration.setIconsPath();OM.control.MapDecoration.setCustomIcons=function(d){if(d){if(d.overview){OM.control.MapDecoration.OVER_VIEW_ICON=d.overview;
}if(d.minimize){OM.control.MapDecoration.BUTTON_MINIMIZE=d.minimize;}if(d.restore){OM.control.MapDecoration.BUTTON_RESTORE=d.restore;
}if(d.magnifier){OM.control.MapDecoration.MAGNIFIER=d.magnifier;}}};OM.control.MapDecoration.getImage=function(d){if(d.type=="Magnifier"){return OM.control.MapDecoration.MAGNIFIER;
}else{return OM.control.MapDecoration.OVER_VIEW_ICON;}};OM.control.MapControl={anchored:true,achorOffsetX:5,achorOffsetY:5,getAnchorPosition:function(n){var o=0;
var r=0;var g=this.parentMapWidth||0;var q=this.parentMapHeight||0;var d=this.width;var s=this.height;
var m=this.anchorOffsetX||5;var e=this.anchorOffsetY||5;if(!n||isNaN(n)||n<1||n>6){return{left:m,top:e};
}var l;switch(n){case 1:return{left:r+m,top:o+e};case 2:return{left:r+g/2-d/2,top:o+e};case 3:return{left:r+g-d-m,top:o+e};
case 4:return{left:r+m,top:o+q-s-e};case 5:return{left:r+g/2-d/2,top:o+q-s-e};case 6:return{left:r+g-d-m,top:o+q-s-e};
}},setAnchorPosition:function(g,e,l){this.anchored=true;this.anchorPosition=g||this.anchorPosition;this.anchorOffsetX=e||this.anchorOffsetX;
this.anchorOffsetY=l||this.anchorOffsetY;var d=this.getAnchorPosition(this.anchorPosition);this.X=d.left;
this.Y=d.top;if(this.isHtml){this.defaultDiv.css("left",this.X);this.defaultDiv.css("top",this.Y);}else{if(this.graphics){this.graphics.setLeftTop(this.defaultGroup,this.X,this.Y);
}}if(this.adjustAnchorPosition){this.adjustAnchorPosition();}}};OM.control.MapControl.POSITION_UPPER_LEFT=1;
OM.control.MapControl.POSITION_UPPER_CENTER=2;OM.control.MapControl.POSITION_UPPER_RIGHT=3;OM.control.MapControl.POSITION_LOWER_LEFT=4;
OM.control.MapControl.POSITION_LOWER_CENTER=5;OM.control.MapControl.POSITION_LOWER_RIGHT=6;OM.control.NavigationPanelBar=OM.control.MapDecoration.extend({initialize:function(d){this._super();
this.orientation=OM.control.NavigationPanelBar.ORIENTATION_VERTICAL;this.style=OM.control.NavigationPanelBar.STYLE_FULL;
this.anchorPosition=OM.control.MapDecoration.POSITION_UPPER_LEFT;this.anchored=true;if(d){this.orientation=d.orientation?parseInt(d.orientation):OM.control.NavigationPanelBar.ORIENTATION_VERTICAL;
this.style=d.style?parseInt(d.style):OM.control.NavigationPanelBar.STYLE_FULL;this.anchorPosition=d.anchorPosition?parseInt(d.anchorPosition):OM.control.MapControl.POSITION_UPPER_LEFT;
}this.type="NavigationPanelBar";this.size=16;this.enableZoomLevelInfoTip=true;this.infoTips=null;this.levelTips=[];
this.navigationPanel=null;this.zoomBar=null;this.baseStyle={opacity:1,visibility:"visible"};this.backgroundStyle_filter=null;
this.backgroundStyle={fill:"#FFFFFF",fillOpacity:1,strokeThickness:1,stroke:"#9A9A9A",filter:this.backgroundStyle_filter};
this.backgroundStyle_={fill:"#FFFFFF",fillOpacity:1,strokeThickness:1,stroke:"#9A9A9A"};this.lineStyle_filter=null;
this.lineStyle={fill:"#5A5A5A",strokeThickness:2,stroke:"#5A5A5A",filter:this.lineStyle_filter};this.lineStyle_={fill:"#5A5A5A",strokeThickness:2,stroke:"#5A5A5A"};
this.lineStyle_mouseover={fill:"#ff0000",strokeThickness:2,stroke:"#ff0000"};this.ScopeStyle={fill:"#9A9A9A",fillOpacity:0};
},setZoomLevel:function(g){var l=this.map.getMapContext();var e=l.getZoomLevel();var d=this.currentLevel;
if(g instanceof Object){this.renderCursor(e-d);this.currentLevel=e;}else{this.renderCursor(g-d);this.currentLevel=g;
this.map.setMapZoomLevel(g);}},renderCursor:function(n){var l=this.orientation;var g=this.graphics;var m=this.d;
var e=g.getLeftTop(this.cursor_pointer);if(l==OM.control.NavigationPanelBar.ORIENTATION_VERTICAL){g.setLeftTop(this.cursor_pointer,e.x,e.y-m*n);
}else{g.setLeftTop(this.cursor_pointer,e.x+m*n,e.y);}},setStyle:function(d){if(!d){return;}if(d.position){this.setPosition(d.position.left,d.position.top);
}if(d.backgroundColor){this.backgroundStyle.fill=d.backgroundColor;this.backgroundStyle_.fill=d.backgroundColor;
}if(d.buttonColor){this.lineStyle.stroke=d.buttonColor;this.lineStyle_.stroke=d.buttonColor;}if(d.size){this.size=d.size;
}},setZoomLevelInfoTips:function(d){if(this.infoTips!=null){this.infoTips=null;}this.infoTips=d;},display:function(m,g){if(OM.browser.touchSupported){this.style=OM.control.NavigationPanelBar.STYLE_ZOOM_BUTTONS_ONLY;
this.size=24;}this._super(m,g);var e=this;var o=this.map;var d=this.graphics;if(!o.displayed&&!o.getMapContext().getZoomLevel()){return;
}o.navigationPanelBar=this;this.backgroundStyle_filter=d.getGraphicFilter({type:"DROPSHADOW",opacity:0.2,color:"#000000",offset:5});
this.backgroundStyle.filter=this.backgroundStyle_filter;this.lineStyle_filter=d.getGraphicFilter({type:"DROPSHADOW",opacity:0.2,color:"#000000",offset:4});
this.NavigationPanelBarGroup=this.defaultGroup;this.NavigationPanelBarGroup.setName("NavigationPanelBarGroup");
this.option=g?g:{navigationpanel_option:{directions:8}};this.navigationPanel=this.NavigationPanel(this.option.navigationpanel_option);
this.zoomBar=this.orientation==OM.control.NavigationPanelBar.ORIENTATION_VERTICAL?this.ZoomBarVertical(this.option.zoombar_option):this.ZoomBarHorizontal(this.option.zoombar_option);
if(this.orientation==OM.control.NavigationPanelBar.ORIENTATION_VERTICAL){d.setLeftTop(this.zoomBar,this.size,3.5*this.size);
}else{d.setLeftTop(this.navigationPanel,3.5*this.size,0);d.setLeftTop(this.zoomBar,0,3.5*this.size);}if(this.style==OM.control.NavigationPanelBar.STYLE_FULL){d.addGroup(this.navigationPanel,this.NavigationPanelBarGroup);
d.addGroup(this.zoomBar,this.NavigationPanelBarGroup);this.width=this.graphics.getWidthHeight(this.navigationPanel).w;
}else{if(this.style==OM.control.NavigationPanelBar.STYLE_PAN_ONLY){d.addGroup(this.navigationPanel,this.NavigationPanelBarGroup);
d.setLeftTop(this.navigationPanel,0,0);this.width=this.graphics.getWidthHeight(this.navigationPanel).w;
}else{if(this.style==OM.control.NavigationPanelBar.STYLE_ZOOM_ONLY){d.addGroup(this.zoomBar,this.NavigationPanelBarGroup);
d.setLeftTop(this.zoomBar,0,0);this.width=this.graphics.getWidthHeight(this.zoomInBtn).w;}else{if(this.style==OM.control.NavigationPanelBar.STYLE_ZOOM_BUTTONS_ONLY){d.addGroup(this.zoomOutBtn,this.NavigationPanelBarGroup);
d.addGroup(this.zoomInBtn,this.NavigationPanelBarGroup);d.setLeftTop(this.zoomInBtn,0,0);d.setLeftTop(this.zoomOutBtn,0,-90-((this.size/12-1)*90));
this.width=d.getWidthHeight(this.NavigationPanelBarGroup).w;}}}}var n=OM.event.MapEvent;this.height=d.getWidthHeight(this.NavigationPanelBarGroup).h;
if(this.anchored){this.setAnchorPosition();o.on(n.MAP_RESIZED,this.setAnchorPosition,this);}this._adjustBaseXY=function(){if(e.zoomLevel_scopeRectangle){if(e.orientation==OM.control.NavigationPanelBar.ORIENTATION_VERTICAL){e.baseY=parseFloat(e.zoomLevel_scopeRectangle.getGlobalTransformMatrix().ty+e.zoomLevel_scopeRectangle._y);
}else{e.baseX=parseFloat(e.zoomLevel_scopeRectangle.getGlobalTransformMatrix().tx+e.zoomLevel_scopeRectangle._x)+e.d;
}}};this._adjustBaseXY();o.on(n.MAP_RESIZED,this._adjustBaseXY,this);o.on(n.I_MAP_CENTER_ZOOM,this.setZoomLevel,this);
var l=this;this.delegate("dblclick",function(q){q.stopPropagation();q.preventDefault();});this.delegate("mousedown",function(q){q.stopPropagation();
q.preventDefault();});this.delegate("mouseup",function(q){q.stopPropagation();q.preventDefault();o.moveflag=false;
o.$oracleMapDiv.css("cursor","default");});},ZoomBarVertical:function(R,O){var ab=this;var F=this.map;
var T=this.graphics;var B=this.baseStyle;var A=this.backgroundStyle;var n=this.ScopeStyle;var z=this.lineStyle;
var N=this.lineStyle_mouseover;var r=this.size;var H=0;var G=0;this.barHeight=r*8;var K=F.getMapContext();
this.totalLevels=K.getUniverse().getZoomLevelNumber();this.currentLevel=K.getZoomLevel();this.levelCursors=[];
var D=this.zoomBar=T.createGroup(B);var P=this.zoomInBtn=T.createGroup(B);P.queryType="#zoomInBtn#hilightable";
var ad=T.createGroup(B);ad.queryType="#zoomLevelBar";var w=this.zoomOutBtn=T.createGroup(B);w.queryType="#zoomOutBtn#hilightable";
var L=T.drawRectangle({x:H,y:G,rx:r/4,ry:r/4,width:r,height:r},OM.$.extend({},A),{group:P});L.queryType="#zoomInRect#bgStyle";
var aa=H+r/2;var Y=G+0.2*r;var E=T.drawPath([[aa,Y,aa,Y+0.6*r],[aa-0.3*r,Y+0.3*r,aa+0.3*r,Y+0.3*r]],OM.$.extend({},z),{group:P});
E.queryType="#zoomInPlus#lineStyle_#hilight";E.iniStyle=z;E.hilightStyle=N;var Z=H+0.33*r;var X=G+r;var M=this.barHeight;
this.zoomLevel_axis=T.drawRectangle({x:Z,y:X,width:0.3*r,height:M},OM.$.extend({},A),{group:ad});this.d=M/(parseFloat(this.totalLevels)+1);
var ac=this.d;for(var V=1;V<parseFloat(this.totalLevels)+1;V++){var C=T.drawPath([[Z,X+ac*V,Z+0.25*r,X+ac*V]],OM.$.extend({},z),{group:ad});
var U={};U.Y=X-0.9*ac+ac*V;U.X=H;this.levelCursors.push(U);}this.levelCursors.reverse();this.cursor_pointer=T.createGroup(B);
this.cursor_pointer.queryType="#cursor#bgStyle#hilightable";this.cursor_pointer_rectangle=T.drawRectangle({x:this.levelCursors[this.currentLevel].X,y:this.levelCursors[this.currentLevel].Y,rx:ac/4,ry:ac/4,width:r,height:ac*1.9},OM.$.extend({},A),{group:this.cursor_pointer});
this.cursor_pointer._y=this.levelCursors[this.currentLevel].Y;this.cursor_pointer_line=T.drawPath([[this.levelCursors[this.currentLevel].X+0.2*r,this.levelCursors[this.currentLevel].Y+ac*0.9,this.levelCursors[this.currentLevel].X+0.8*r,this.levelCursors[this.currentLevel].Y+ac*0.9]],OM.$.extend({},z),{group:this.cursor_pointer});
this.cursor_pointer_line.queryType="#cursorLine#lineStyle_#hilight";this.cursor_pointer_line.iniStyle=z;
this.cursor_pointer_line.hilightStyle=N;T.addGroup(this.cursor_pointer,ad);this.levelTipsGroup=T.createGroup(B);
this.levelTipOffsetX=0;if(this.infoTips!=null){for(var m in this.infoTips){if(parseInt(m)<0||parseInt(m)>this.totalLevels-1){continue;
}var q;if(this.X==0){if(this.anchorPosition==3||this.anchorPosition==6){q=this.drawLevelTip(T,m,this.infoTips[m],this.backgroundStyle,this.levelCursors[m].X,this.levelCursors[m].Y+0.7*ac,12,"left");
if(this.levelTipOffsetX<q.offsetX){this.levelTipOffsetX=q.offsetX;}}else{q=this.drawLevelTip(T,m,this.infoTips[m],this.backgroundStyle,this.levelCursors[m].X+r,this.levelCursors[m].Y+0.7*ac,12,"right");
}}else{if(this.X>this.parentMapWidth/2){q=this.drawLevelTip(T,m,this.infoTips[m],this.backgroundStyle,this.levelCursors[m].X,this.levelCursors[m].Y+0.7*ac,12,"left");
}else{q=this.drawLevelTip(T,m,this.infoTips[m],this.backgroundStyle,this.levelCursors[m].X+r,this.levelCursors[m].Y+0.7*ac,12,"right");
}}this.delegate("mouseover",q,function(d){T.bringToTop(d.target.parentNode);});this.delegate("click",q,function(d){ab.currentLevel=parseInt(d.delegateTarget.level);
ab.graphics.setLeftTop(ab.cursor_pointer,0,ab.levelCursors[ab.currentLevel].Y);ab.map.setMapZoomLevel(ab.currentLevel);
});this.graphics.addGroup(q,this.levelTipsGroup);}}if(this.enableZoomLevelInfoTip){T.addGroup(this.levelTipsGroup,ad);
T.setVisible(this.levelTipsGroup,false);}this.zoomLevel_scopeRectangle=T.drawRectangle({x:H,y:G+r,width:r,height:M},OM.$.extend({},n),{group:ad});
this.zoomLevel_scopeRectangle._x=H;this.zoomLevel_scopeRectangle._y=G+r;for(var V=0;V<parseFloat(this.totalLevels);
V++){this.levelCursors[V].Y=this.currentLevel*ac-V*ac;}var t=H;var s=G+r+this.barHeight;var J=T.drawRectangle({x:t,y:s,rx:r/4,ry:r/4,width:r,height:r},OM.$.extend({},A),{group:w});
J.queryType="#zoomOutRect#bgStyle";var S=H+r/2;var Q=G+0.2*r+r+this.barHeight;var W=T.drawPath([[S-0.3*r,Q+0.3*r,S+0.3*r,Q+0.3*r]],OM.$.extend({},this.lineStyle_),{group:w});
W.queryType="#zoomOutSub#lineStyle_#hilight";W.iniStyle=z;W.hilightStyle=N;T.addGroup(ad,D);T.addGroup(P,D);
T.addGroup(w,D);this.delegate("click",P,function(){var d=ab.currentLevel;if(d<ab.totalLevels-1){ab.currentLevel=d+1;
ab.renderCursor(1);ab.map.zoomIn();}});this.delegate("tap",P,function(){var d=ab.currentLevel;if(d<ab.totalLevels-1){ab.currentLevel=d+1;
ab.renderCursor(1);ab.map.zoomIn();}});this.delegate("click",w,function(){var d=ab.currentLevel;if(d>0){ab.currentLevel=d-1;
ab.renderCursor(-1);ab.map.zoomOut();}});this.delegate("tap",w,function(){var d=ab.currentLevel;if(d>0){ab.currentLevel=d-1;
ab.renderCursor(-1);ab.map.zoomOut();}});var l;this.delegate("mouseover",ad,function(d){if(!ab.enableZoomLevelInfoTip){return;
}clearTimeout(l);ab.graphics.setVisible(ab.levelTipsGroup,true);});this.delegate("mouseout",ad,function(d){l=setTimeout(function(){ab.graphics.setVisible(ab.levelTipsGroup,false);
},600);});var g=null;var u=T.getLeftTop(this.cursor_pointer);var o=false;var e=null;var I=this.zoomLevel_scopeRectangle;
this.delegate("mousedown",I,function(d){e=d.target;g=d.clientY;u=T.getLeftTop(ab.cursor_pointer);o=true;
d.stopPropagation();}).delegate("mousemove",I,function(ae){var ah=ab.cursor_pointer._y+ab.graphics.getLeftTop(ab.cursor_pointer).y;
var d=ah+2*ab.d;if(ae.userY>ah&&ae.userY<d){ab.cursor_pointer_line.applyStyle(ab.lineStyle_mouseover);
}else{ab.cursor_pointer_line.applyStyle(ab.lineStyle_);}if(o==false){return;}var af=ae.clientY;var ai=0;
var ag=u.y+(af-g);if(ag>ab.levelCursors[0].Y){ag=ab.levelCursors[0].Y;}else{if(ag<ab.levelCursors[ab.totalLevels-1].Y){ag=ab.levelCursors[ab.totalLevels-1].Y;
}}ab.graphics.setLeftTop(ab.cursor_pointer,ai,ag);ae.stopPropagation();}).delegate("mouseup",I,function(ae){if(ae.target!=e){return;
}var d=ab.totalLevels-Math.round((ae.clientY-ab.baseY)/ab.d);if(d<0){ab.currentLevel=0;}else{if(d>ab.totalLevels-1){ab.currentLevel=ab.totalLevels-1;
}else{ab.currentLevel=d;}}ab.graphics.setLeftTop(ab.cursor_pointer,0,ab.levelCursors[ab.currentLevel].Y);
o=false;ab.map.setMapZoomLevel(ab.currentLevel);e=null;}).delegate("mouseout",I,function(ae){ab.cursor_pointer_line.applyStyle(ab.lineStyle_);
var af=ab.graphics.getLeftTop(ab.cursor_pointer);if(af.y==ab.levelCursors[ab.currentLevel].Y){return;
}var d=Math.round((ab.levelCursors[0].Y-af.y)/ab.d);if(d<0){ab.currentLevel=0;}else{if(d>ab.totalLevels-1){ab.currentLevel=ab.totalLevels-1;
}else{ab.currentLevel=d;}}ab.graphics.setLeftTop(ab.cursor_pointer,0,ab.levelCursors[ab.currentLevel].Y);
o=false;ab.map.setMapZoomLevel(ab.currentLevel);ae.stopPropagation();}).delegate("click",I,function(ae){if(ae.target!=e){return;
}var d=ab.totalLevels-Math.round((ae.clientY-ab.baseY)/ab.d);if(d<0){ab.currentLevel=0;}else{if(d>ab.totalLevels-1){ab.currentLevel=ab.totalLevels-1;
}else{ab.currentLevel=d;}}ab.graphics.setLeftTop(ab.cursor_pointer,0,ab.levelCursors[ab.currentLevel].Y);
ab.map.setMapZoomLevel(ab.currentLevel);});return this.zoomBar;},NavigationPanel:function(I){var O=this;
var W=this.map;var N=this.graphics;var J=this.size;var g=this.baseStyle;var E=this.backgroundStyle;var l=this.backgroundStyle_;
var M=this.lineStyle_mouseover;var r=this.lineStyle;var A=this.ScopeStyle;var Q=this.map.getMapContext();
var B=Q.getDeviceHeight()+Q.getDeviceWidth();var V=0;var U=0;var K=J*3;var w=K*0.4;var T=K*0.45;var G=K*0.48;
var u=K*0.14;var C=K*0.2;var t=K*0.1;var q=V+K/2;var o=U+K/2;var z=this.navigationPanel=N.createGroup(g);
var D=z.container_ellipse=N.drawEllipse({cx:q,cy:o,width:K,height:K},OM.$.extend({},E),{group:z});D.queryType="#npEllipse#bgStyle";
var n=N.createGroup();n.queryType="#centerBtn#hilightable";var F=N.drawEllipse({cx:q,cy:o,width:K*0.15,height:K*0.15},OM.$.extend({},l),{group:n});
F.queryType="#centerBtnEllipse#bgStyle_";var H=N.drawEllipse({cx:q,cy:o,width:K*0.05,height:K*0.05},OM.$.extend({},l),{group:n});
H.queryType="#centerPoint#lineStyle#hilight";H.iniStyle=l;H.hilightStyle=M;N.addGroup(n,z);var L=function(X,R,Y){for(var S=0;
S<X.length;S++){X[S].x=X[S].x+R;X[S].y=X[S].y+Y;}return X;};var e=function(ah,Z,al,Y,X,ab){var ac=Z;var aa=al;
var ap=Math.atan(aa/(ac-aa));var ak=aa/Math.sin(ap);var af=(ah/180)*Math.PI;var am=af-ap;var ad=af;var an=af+ap;
var ag=[];var ai={};var ao={};var aj={};var ae={};ai.x=ak*Math.cos(am);ai.y=ak*Math.sin(am);ao.x=ac*Math.cos(ad);
ao.y=ac*Math.sin(ad);aj.x=ak*Math.cos(an);aj.y=ak*Math.sin(an);ae.x=(ac-1.7*aa)*Math.cos(ad);ae.y=(ac-1.7*aa)*Math.sin(ad);
ag.push(ai);ag.push(ao);ag.push(aj);if(ab==O.getPathFormulation){ag.push(ae);}ag=L(ag,Y,X);return ab(ag);
};var P=function(Y){var X=[];var R=[];for(var S=0;S<Y.length;S++){R[2*S]=Y[S].x;R[2*S+1]=Y[S].y;}X[0]=R;
return X;};var m=function(Z,aa){var Y=[];var X=Z.length-1;if(aa){X=aa;}for(var S=0;S<X;S++){var R=[];
R[0]=Z[S].x;R[1]=Z[S].y;R[2]=Z[S+1].x;R[3]=Z[S+1].y;Y[S]=R;}return Y;};var s=function(ac,aa){var Z=ac.radius;
var ad=ac.size;var X=ac.radius_scope;var ab=ac.size_scope;this.createDirection=function(aj,ae,af){var ai=N.createGroup(g);
ai.queryType="#directionGroup#pannable#hilightable";ai.direction=aj;ai.panX=af.x;ai.panY=af.y;var ah=N.drawPath(e(ae,Z,ad,q,o,m),OM.$.extend({},r),{group:ai});
ah.queryType="#triangle#linestyle#hilight";ah.iniStyle=r;ah.hilightStyle=M;var ag=N.drawPath(e(ae,X,ab,q,o,P),OM.$.extend({},A),{group:ai});
ag.queryType="#triangleScope";return ai;};for(var Y=0;Y<ac.data.length;Y++){var R=ac.data[Y];var S=this.createDirection(R.direction,R.degree,R.panDist);
N.addGroup(S,aa);}};var d={right:{data:[{direction:"east",degree:0,panDist:{x:B*(-0.25),y:B*0}},{direction:"south",degree:90,panDist:{x:B*0,y:B*(-0.25)}},{direction:"west",degree:180,panDist:{x:B*(0.25),y:B*0}},{direction:"north",degree:270,panDist:{x:B*0,y:B*(0.25)}}],radius:w,size:u,radius_scope:G,size_scope:C},bevel:{data:[{direction:"southeast",degree:45,panDist:{x:B*(-0.18),y:B*(-0.18)}},{direction:"southwest",degree:135,panDist:{x:B*(0.18),y:B*(-0.18)}},{direction:"northwest",degree:225,panDist:{x:B*(0.18),y:B*(0.18)}},{direction:"northeast",degree:315,panDist:{x:B*(-0.18),y:B*(0.18)}}],radius:T,size:t,radius_scope:T,size_scope:t}};
if(!(I.directions&&I.directions==4)){s(d.bevel,z);}s(d.right,z);this.delegate("click",n,function(){W.backToHomeMap();
});this.delegate("click","pannable",function(X){var Y=X.delegateTarget;var S=Y.panX;var R=Y.panY;W.pan(S,R,true);
});this.delegate("mouseover","hilightable",function(R){var X=R.delegateTarget;for(var S=0;S<X.childrenCount;
S++){var Y=X.getChildAt(S);if(Y.queryType&&Y.queryType.indexOf("hilight")!=-1){Y.applyStyle(Y.hilightStyle);
}}});this.delegate("mouseout","hilightable",function(R){var X=R.delegateTarget;for(var S=0;S<X.childrenCount;
S++){var Y=X.getChildAt(S);if(Y.queryType&&Y.queryType.indexOf("hilight")!=-1){Y.applyStyle(Y.iniStyle);
}}});return this.navigationPanel;},drawLevelTip:function(t,e,g,l,q,o,w,s){var r=t.createGroup({opacity:1});
r.level=e;r.contentText=g;var d=OM.$.extend({},l);d.fillOpacity=0.4;d.filter=null;var n=12;var u;var m;
if(s=="right"){u=t.drawText({x:q+n,y:o+w,fontSize:w,fontFamily:"Verdana,Tahoma",textValue:g},{group:r,id:"levelTipText"+e});
m=t.getWidthHeight(u);t.drawPath([[q,o,q+n,o+m.h+1,q+n+m.w+4,o+m.h+1,q+n+m.w+4,o,q+n,o,q,o]],OM.$.extend({},d),{group:r,id:"levelTipArrow"});
}else{u=t.drawText({x:q-n,y:o+w,fontSize:w,fontFamily:"Verdana,Tahoma",textValue:g},{group:r,id:"levelTipText"+e});
m=t.getWidthHeight(u);t.setLeftTop(u,-m.w,0);t.drawPath([[q,o,q-n,o+m.h+1,q-n-m.w-4,o+m.h+1,q-n-m.w-4,o,q-n,o,q,o]],OM.$.extend({},d),{group:r,id:"levelTipArrow"});
}t.bringToTop(u);r.offsetX=n+m.w+4;return r;},remove:function(){var d=this.map;this._super();d.deleteListener(OM.event.MapEvent.MAP_RESIZED,this._adjustBaseXY,this);
d.deleteListener(OM.event.MapEvent.I_MAP_CENTER_ZOOM,this.setZoomLevel,this);if(this.anchored){d.deleteListener(OM.event.MapEvent.MAP_RESIZED,this._adjustAnchorPosition,this);
}this.map.graphics.clearGroup(this.defaultGroup);this.map.navigationPanelBar=null;}});OM.control.NavigationPanelBar.STYLE_FULL=1;
OM.control.NavigationPanelBar.STYLE_ZOOM_ONLY=2;OM.control.NavigationPanelBar.STYLE_ZOOM_BUTTONS_ONLY=3;
OM.control.NavigationPanelBar.STYLE_PAN_ONLY=4;OM.control.NavigationPanelBar.ORIENTATION_VERTICAL=1;OM.control.NavigationPanelBar.ORIENTATION_HORIZONTAL=2;
OM.control.CopyRight=OM.control.MapDecoration.extend({initialize:function(d){this._super();this.anchorPosition=OM.control.MapDecoration.POSITION_LOWER_CENTER;
this.anchored=true;this.fontSize=15;this.textValue="";this.type="CopyRight";if(d){this.textValue=d.textValue?d.textValue:"";
this.anchorPosition=d.anchorPosition?d.anchorPosition:OM.control.MapDecoration.POSITION_LOWER_CENTER;
this.fontSize=d.fontSize?d.fontSize:15;this.fontFamily=d.fontFamily?d.fontFamily:"Tahoma";}this.fontStyle={x:0,y:0,fontSize:this.fontSize,fontFamily:this.fontFamily,textValue:this.textValue};
},setStyle:function(d){if(!d){return;}if(d.fontSize){this.fontSize=d.fontSize;}if(d.fontFamily){this.fontFamily=d.fontFamily;
}},display:function(e,d){this._super(e,d);this.graphics.drawText({x:0,y:0,fontSize:this.fontSize,fontFamily:this.fontFamily,textValue:this.textValue},{group:this.defaultGroup});
this.width=this.graphics.getWidthHeight(this.defaultGroup).w;this.height=this.graphics.getWidthHeight(this.defaultGroup).h*0.65;
if(this.anchored){this.setAnchorPosition();this.map.on(OM.event.MapEvent.MAP_RESIZED,this.setAnchorPosition,this);
}},remove:function(){if(this.anchored){this.map.deleteListener(OM.event.MapEvent.MAP_RESIZED,this.setAnchorPosition,this);
}this.map.graphics.clearGroup(this.defaultGroup);this.map.CopyRight=null;},adjustAnchorPosition:function(){if(this.graphics){this.graphics.setLeftTop(this.defaultGroup,this.X,this.Y+this.height);
}},setAnchorPosition:function(e,d,g){this._super(e,d,g);this.realPos=null;}});OM.control.ScaleBar=OM.control.MapDecoration.extend({initialize:function(d){this._super();
this.anchored=true;this.anchorPosition=OM.control.MapDecoration.POSITION_LOWER_LEFT;this.format="BOTH";
this.maxLength=165;this.transformToGeodetic=false;this.fontSize=12;this.thickness=2;this.scalebar_color="#000000";
this.topScaleBarHost={};this.bottomScaleBarHost={};this.type="ScalrBar";if(d){this.format=d.format?d.format:"BOTH";
this.anchorPosition=d.anchorPosition?d.anchorPosition:OM.control.MapControl.POSITION_LOWER_LEFT;}},updateScale:function(){if(!this.map){return;
}var d=this;var e=function(l){var m=l.fpsLength;var o=l.metricLength;var n=l.fpsText;var g=l.metricText;
if(d.format==="METRIC"){d.topScaleBarHost.length=o;d.topScaleBarHost.text=g;}else{if(d.format==="IMPERIAL"){d.topScaleBarHost.length=m;
d.topScaleBarHost.text=n;}else{d.topScaleBarHost.length=m;d.topScaleBarHost.text=n;d.bottomScaleBarHost.length=o;
d.bottomScaleBarHost.text=g;}}d.renderLength(d,d.topIniWidth,d.bottomIniWidth);d.renderText(d);};this.decideScale(this.map,this.maxLength,e);
},setStyle:function(d){if(!d){return;}if(d.size){this.fontSize=d.size;}if(d.color){this.scalebar_color=d.color;
}if(d.thickness){this.thickness=d.thickness;}if(d.width){this.maxLength=d.width;}},display:function(l,e){this._super(l,e);
var d=this;var m=this.map;if(!m.displayed){return;}m.ScaleBar=this;var g=function(q){var r=q.fpsLength;
var t=q.metricLength;var s=q.fpsText;var o=q.metricText;if(d.format==="METRIC"){d.topScaleBarHost.length=t;
d.topScaleBarHost.text=o;d.topIniWidth=t;d.graphics.addGroup(d.topScaleBar(d.graphics),d.defaultGroup);
}else{if(d.format==="IMPERIAL"){d.topScaleBarHost.length=r;d.topScaleBarHost.text=s;d.topIniWidth=r;d.graphics.addGroup(d.topScaleBar(d.graphics),d.defaultGroup);
}else{d.topScaleBarHost.length=r;d.topScaleBarHost.text=s;d.topIniWidth=r;d.bottomScaleBarHost.length=t;
d.bottomScaleBarHost.text=o;d.bottomIniWidth=t;d.graphics.addGroup(d.topScaleBar(d.graphics),d.defaultGroup);
d.graphics.addGroup(d.bottomScaleBar(d.graphics),d.defaultGroup);d.graphics.setLeftTop(d.bottomScaleBarGroup,0,d.fontSize);
}}};this.decideScale(m,this.maxLength,g);this.width=this.maxLength;this.height=this.graphics.getWidthHeight(this.defaultGroup).h;
var n=OM.event.MapEvent;if(this.anchored){this.setAnchorPosition();m.on(n.MAP_RESIZED,this.setAnchorPosition,this);
}m.on(n.I_MAP_CENTER_ZOOM,this.updateScale,this);m.on(n.I_MAP_DRAD_END,this.updateScale,this);},topScaleBar:function(d){this.topScaleBarGroup=d.createGroup({opacity:1});
this.topScaleBar_start_mark=d.drawPath([[0,0,0,0+this.fontSize+this.thickness]],{stroke:this.scalebar_color,strokeThickness:this.thickness},{group:this.topScaleBarGroup,id:"topScaleBar_start_mark"});
this.topScaleBar_line=d.drawRectangle({x:0,y:0+this.fontSize,width:this.topScaleBarHost.length,height:this.thickness},{fill:this.scalebar_color},{group:this.topScaleBarGroup,id:"topScaleBar_line"});
this.topScaleBar_text=d.drawText({x:0+3,y:0+this.fontSize-this.thickness,fontSize:this.fontSize,fontWeight:"BOLD",fontFamily:"Tahoma",textValue:this.topScaleBarHost.text},{group:this.topScaleBarGroup,id:"topScaleBar_text"});
this.topScaleBar_end_mark=d.drawPath([[0+this.topScaleBarHost.length-1,0,0+this.topScaleBarHost.length-1,0+this.fontSize+this.thickness/2]],{stroke:this.scalebar_color,strokeThickness:this.thickness},{group:this.topScaleBarGroup,id:"topScaleBar_end_mark"});
return this.topScaleBarGroup;},bottomScaleBar:function(d){this.bottomScaleBarGroup=d.createGroup({opacity:1});
this.bottomScaleBar_start_mark=d.drawPath([[0,0,0,0+this.fontSize+this.thickness]],{stroke:this.scalebar_color,strokeThickness:this.thickness},{group:this.bottomScaleBarGroup,id:"bottomScaleBar_start_mark"});
this.bottomScaleBar_line=d.drawRectangle({x:0,y:0,width:this.bottomScaleBarHost.length,height:this.thickness},{fill:this.scalebar_color},{group:this.bottomScaleBarGroup,id:"bottomScaleBar_line"});
this.bottomScaleBar_text=d.drawText({x:0+3,y:0+this.fontSize+this.thickness,fontSize:this.fontSize,fontWeight:"BOLD",fontFamily:"Tahoma",textValue:this.bottomScaleBarHost.text},{group:this.bottomScaleBarGroup,id:"bottomScaleBar_text"});
this.bottomScaleBar_end_mark=d.drawPath([[0+this.bottomScaleBarHost.length-1,0+this.thickness/2,0+this.bottomScaleBarHost.length-1,0+this.fontSize+this.thickness]],{stroke:this.scalebar_color,strokeThickness:this.thickness},{group:this.bottomScaleBarGroup,id:"bottomScaleBar_end_mark"});
return this.bottomScaleBarGroup;},renderLength:function(e,g,d){if(!e){return;}if(e.topScaleBarGroup){e.topScaleBar_line.applyStyle({width:e.topScaleBarHost.length});
e.graphics.setLeftTop(e.topScaleBar_end_mark,e.topScaleBarHost.length-g,0);}if(e.bottomScaleBarGroup){e.bottomScaleBar_line.applyStyle({width:e.bottomScaleBarHost.length});
e.graphics.setLeftTop(e.bottomScaleBar_end_mark,e.bottomScaleBarHost.length-d,0);}},renderText:function(d){if(!d){return;
}if(d.topScaleBarGroup){d.topScaleBar_text.applyStyle({textValue:d.topScaleBarHost.text});}if(d.bottomScaleBarGroup){d.bottomScaleBar_text.applyStyle({textValue:d.bottomScaleBarHost.text});
}},round125:function(g){var d=g;if(d>1){var e=0;while(d>=10){d=d/10;e=e+1;}if(d>=5){d=5;}else{if(d>=2){d=2;
}else{d=1;}}while(e>0){d=d*10;e=e-1;}}return d;},decideScale:function(d,t,g){var l;var m;var s;var n;
var z=this;var o=function(){m=z.round125(l);if(m>=1000){var A=z.round125(l/1000);var D=l/1000;n=Math.round(z.maxLength*A/D);
s=A+" "+OM.Messages.getString("kilometers");}else{n=Math.round(z.maxLength*m/l);s=m+" "+OM.Messages.getString("meters");
}var E=l/1609.344;var C=l*3.28084;var H;var F;if(E>=1){var I=z.round125(E);H=Math.round(z.maxLength*I/E);
F=I+" "+OM.Messages.getString("miles");}else{var G=z.round125(C);H=Math.round(z.maxLength*G/C);F=G+" "+OM.Messages.getString("feet");
}var B={};B.fpsLength=H;B.metricLength=n;B.fpsText=F;B.metricText=s;return B;};var u=t/2;var r=d.getScreenPointLocation(d.getMapContext().getDeviceWidth()/2-u,d.getMapContext().getDeviceHeight()/2);
var q=d.getScreenPointLocation(d.getMapContext().getDeviceWidth()/2+u,d.getMapContext().getDeviceHeight()/2);
var w=new OM.geometry.LineString([r.getX(),r.getY(),q.getX(),q.getY()],r.srid);var e=function(A){l=A;
g(o());};l=OM.util.GeomUtil.getLength(w,e,{unit:"METER"});return;},remove:function(){this._super();var d=this.map;
var e=OM.event.MapEvent;if(this.anchored){d.deleteListener(e.MAP_RESIZED,this._setAnchorPosition,this);
}d.deleteListener(e.I_MAP_CENTER_ZOOM,this.updateScale,this);d.deleteListener(e.I_MAP_DRAD_END,this.updateScale,this);
this.map.graphics.clearGroup(this.defaultGroup);this.map.ScaleBar=null;}});OM.control.OverviewMap=OM.control.MapDecoration.extend({initialize:function(d){this.type="OverviewMap";
this.isHtml=true;this.visible=true;this.mainmap=null;this.submap=null;this.layer=null;this.rectangleFeature=null;
this.overFeatureLayer=null;this.cursorStyleDragging=null;this.cursorStyleDefault=null;this.scaleRatio=null;
this.rectangleStyle=d.rectStyle||new OM.style.Color({strokeThickness:1,stroke:"#f0ff00",fill:"#ff0000",fillOpacity:0.3});
this.actionOnMainMap=false;this.actionOnSubMap=false;this.collapsible=true;},display:function(e,d){this.minimized=false;
this._super(e,d);this.overviewMapDIV=this.$DecorationDiv[0];OM.$(this.overviewMapDIV).mousemove(function(g){g.stopPropagation();
}).mousedown(function(g){g.stopPropagation();}).mousewheel(function(g){g.stopPropagation();});this.mainmap=this.map;
if(!this.mainmap.displayed){return;}this.doinit();this.collapse();},doinit:function(){this.submap=new OM.Map(this.overviewMapDIV,{mapviewerURL:this.mainmap.mapviewerURL,over:true});
if(this.mainmap.overviewLayer!=null){this.layer=this.mainmap.overviewLayer.clone("over_"+this.mainmap.overviewLayer.name,true);
}if(this.layer){this.submap.addLayer(this.layer);}this.overFeatureLayer=this.submap.getDefaultFeatureLayer();
var d=this.mainmap.getMapContext();var l=this.submap.getMapContextToken();l.universe=d.getUniverse().clone();
this.submap.setMapCenter(d.getCenterPoint().clone());this.submap.setMapZoomLevel(d.getZoomLevel()-this.calMapZoomDiff());
this.submap.enableMapAction.drag=false;this.submap.enableMapAction.click=false;this.submap.enableMapAction.dbclick=false;
this.submap.enableMapAction.mousewheel=false;var g=this;var e=function(){var m=g.mainmap.getMapWindowBoundingBox();
g.rectangleFeature=new OM.layer.EditableFeature("overview_rectangle",m,{renderingStyle:g.rectangleStyle});
g.overFeatureLayer.addFeature(g.rectangleFeature);g.rectangleFeature.on(OM.event.LayerEvent.FEATURE_MOVED,g.endDragRect,g);
if(m.getWidth()>=g.submap.getMapWindowBoundingBox().getWidth()){g.rectangleFeature.setVisible(false);
}};this.submap.on(OM.event.MapEvent.MAP_INITIALIZED,e);this.submap.init();this.afterRestore=function(){if(g.layer&&(g.layer.layerType==OM.LayerTypes.EXTERNAL)){g.setCenterAndZoomlevel();
g.submap.refreshMap();}else{g.setCenterAndZoomlevel();}};this.on(OM.event.MapDecorationEvent.AFTER_RESTORE,this.afterRestore);
},clean:function(){},resize:function(){this._super();var d=this.mainmap.getMapContext().getDeviceWindow();
this.width=Math.round(d.w*0.3);this.height=Math.round(d.h*0.3);this.$DecorationDiv.width(this.width);
this.$DecorationDiv.height(this.height);this.setAnchorPosition(6);var e=this.submap.getMapContextToken();
e.deviceWindow.w=this.width;e.deviceWindow.h=this.height;this.submap.redrawMap();this.setRectangleFeature();
},endDragRect:function(d){var g=this.rectangleFeature.geo.getCenter();this.mainmap.setMapCenter(g);this.setRectangleFeature();
},remove:function(){this._super();this.rectangleFeature=null;this.overFeatureLayer=null;this.layer=null;
if(this.submap){this.submap.destroyMap();}this.rectangleStyle=null;this.overviewMapDIV=null;this.mainmap=null;
this.submap=null;this.map=null;this._display=null;this.resize=null;this.refreshMainMap=null;this.endDragRect=null;
this.setRectangleFeature=null;this.styleChange=null;this.layerAdd=null;this.layerDel=null;},setRectangleFeature:function(){var d=this.mainmap.getMapWindowBoundingBox();
if(d.getWidth()>=this.submap.getMapWindowBoundingBox().getWidth()){this.rectangleFeature.setVisible(false);
}else{this.rectangleFeature.setGeometry(d);this.rectangleFeature.setVisible(true);}},styleChange:function(l){var d=l.affectLayer;
if(this.layer&&("over_"+d.name==this.layer.name&&d.layerType==this.layer.layerType)){var g=l.newStyle;
if(g&&g.styleType=="HeatMap"&&g.containerVectorLayer){g=g.clone();g.containerVectorLayer=g.containerVectorLayer.clone("over_"+g.containerVectorLayer.name,true,true);
}this.layer.setRenderingStyle(g,l.attributes);}},nsdpMapped:function(n){var g=n.affectLayer;if(this.layer&&("over_"+g.name==this.layer.name&&g.layerType==this.layer.layerType)){this.layer.clearFeatureShapes();
this.layer.featureArray=[];var d=g.featureArray.length;for(var m=0;m<d;m++){var l=g.featureArray[m].clone();
this.layer.featureArray.push(l);}}this.layer.redraw();},layerAdd:function(d){},layerDel:function(d){var g=d.affectedLayer;
if(g&&this.layer&&this.layer.name==("over_"+g.name)&&g.layerType==this.layer.layerType){if(this.layer.copyFeatures){this.mainmap.overviewLayer.deleteListener(OM.event.LayerEvent.FEATURES_LOADED,this.layer.copyFeatures);
}this.submap.removeLayer(this.layer);this.mainmap.overviewLayer=null;this.layer=null;}},setCenterAndZoomlevel:function(g){if(this.minimized){return;
}var d=this.mainmap.getMapContext();this.submap.setMapCenterAndZoomLevel(d.getCenterPoint(),d.getZoomLevel()-this.calMapZoomDiff());
this.setRectangleFeature();},calMapZoomDiff:function(){var e=null;var d=this.mainmap.getMapContext();
var m=d.getUniverse();if(this.scaleRatio>1){e=m.getZoomLevels()[d.getZoomLevel()].resolution*this.scaleRatio;
}else{var l=this.mainmap.getMapWindowBoundingBox().getWidth();e=l/(Math.round(d.getDeviceWidth()*0.3)/2);
}for(var g=0;g<d.getZoomLevel();g++){if(m.getZoomLevels()[g+1].resolution<=e&&m.getZoomLevels()[g].resolution>=e){return d.getZoomLevel()-g;
}}if(m.getZoomLevels()[0].resolution<e){return d.getZoomLevel();}},setOverviewMapOptions:function(d){if(d.scaleRatio&&d.scaleRatio>1){if(this.scaleRatio==d.scaleRatio){return;
}this.scaleRatio=d.scaleRatio;if(this.submap&&this.submap.displayed&&this.mainmap){this.submap.setMapZoomLevel(this.mainmap.getMapContext().getZoomLevel()-this.calMapZoomDiff());
}}if(d.overviewLayer){this.mainmap.overviewLayer=d.overviewLayer;if(this.submap.displayed){this.submap.removeLayer(this.layer);
this.layer=d.overviewLayer.clone("over_"+d.overviewLayer.name,true);this.submap.addLayer(this.layer);
}}if(d.panelOptions){if(d.panelOptions.style){this.rectangleStyle=d.panelOptions.style;if(this.submap.displayed){this.rectangleFeature.setRenderingStyle(this.rectangleStyle);
}}if(d.panelOptions.MouseCursorStyle!=null){var e=d.panelOptions.MouseCursorStyle;if(e.cursorType&&e.cursorStyle&&e.cursorType=="dragging"){this.cursorStyleDragging=e.cursorStyle;
}if(e.cursorType&&e.cursorStyle&&e.cursorType=="default"){}}}if(d.display!=null){this.setVisible(d.display);
}if(d.collapse!=null){if(d.collapse){this.collapse();}else{this.restore();}}},refreshMainMap:function(g){var d=this;
new function(){if(!d.actionOnMainMap){d.actionOnSubMap=true;var e=d.submap.getMapContext();d.mainmap.setMapCenterAndZoomLevel(e.getCenterPoint(),e.getZoomLevel()+d.calMapZoomDiff());
d.actionOnSubMap=false;}d.setRectangleFeature();}();},getMapConfig:function(){if(!this.overviewTileLayer.config){MVi18n.reportError("MVOverviewMap.getMapConfig","MAPVIEWER-05526");
}else{return this.overviewTileLayer.config;}},getZoomLevel:function(){return this.submap.getZoomLevel();
},errLoadLayer:function(){var d=this.mainmap.overviewLayer;this.layer=d.clone("over_"+d.name,true);this.submap.inited=false;
if(!this.submap.displayed){this.submap.addLayer(this.layer);this.submap.init();}},collapse:function(){this._super();
if(this.mainmap.copyRight&&this.mainmap.copyRight.realPos){var d=this.mainmap.copyRight;d.setAnchorPosition(6,d.realPos.x,d.realPos.y);
}},restore:function(){this._super();if(this.mainmap.copyRight&&this.mainmap.copyRight.anchorPosition==6){var d=this.mainmap.copyRight;
d.setAnchorPosition(5,0,5);d.realPos={x:d.anchorOffsetX,y:d.anchorOffsetY};}}});OM.control.ToolButton=OM.Class.extend({mixin:OM.event.EventSource,initialize:function(l,e,g){this.btID=l;
this.btType=e;this.btName=g&&g.buttonName;this.btIcon=g&&g.buttonIcon;this.btSelectedIcon=g&&g.buttonSelectedIcon;
this.btState=OM.control.ToolButton.UP;this.tip=g&&g.tooltip;this.parentToolBar=null;this.btDiv=document.createElement("div");
this.btImg=document.createElement("img");this.tipDiv=document.createElement("div");this.width=g&&g.width;
this.height=g&&g.height;var d=this;d.initButton();var m=function(r){if(d.btType!=OM.control.ToolButton.SEPARATOR){OM.$(d.parentToolBar.toolBarDecorationDiv).css("cursor","pointer");
if(d.tip){d.parentToolBar.toolBarDecorationDiv.appendChild(d.tipDiv);d.tipDiv.innerHTML=d.tip;OM.$(d.tipDiv).css({position:"absolute",display:"inline","border-color":"black","border-width":"1px","border-style":"solid","background-color":"rgb(255, 255, 225)","font-size":"14px",padding:"2px",left:d.btDiv.parentNode.offsetLeft+5,top:d.btDiv.parentNode.offsetTop+30});
}}else{OM.$(d.parentToolBar.toolBarDecorationDiv).css("cursor","default");}};var q=function(r){OM.$(d.tipDiv).css({display:"none"});
if((d.btType==OM.control.ToolButton.COMMAND)&&(d.btState==OM.control.ToolButton.DOWN)){d.reset();}r.stopPropagation();
};var o=function(r){var s=new OM.event.ToolbarEvent(OM.event.ToolbarEvent.BUTTON_STATE_CHANGE,d);s.btID=d.btID;
d.fire(s.type,s);r.stopPropagation();if(d.btType==OM.control.ToolButton.COMMAND){d.btImg.setAttribute("src",d.btSelectedIcon);
d.btState=OM.control.ToolButton.DOWN;var s=new OM.event.ToolbarEvent(OM.event.ToolbarEvent.BUTTON_DOWN,d);
s.btID=d.btID;d.fire(s.type,s);}else{if(d.btType==OM.control.ToolButton.TOGGLE){if(d.btState==OM.control.ToolButton.UP){d.btImg.setAttribute("src",d.btSelectedIcon);
d.btState=OM.control.ToolButton.DOWN;var s=new OM.event.ToolbarEvent(OM.event.ToolbarEvent.BUTTON_DOWN,d);
s.btID=d.btID;d.fire(s.type,s);}else{d.btImg.setAttribute("src",d.btIcon);d.btState=OM.control.ToolButton.UP;
var s=new OM.event.ToolbarEvent(OM.event.ToolbarEvent.BUTTON_UP,d);s.btID=d.btID;d.fire(s.type,s);}}}};
var n=function(r){if((d.btType==OM.control.ToolButton.COMMAND)&&(d.btState==OM.control.ToolButton.DOWN)){d.reset();
}r.stopPropagation();};if(!OM.browser.touchSupported){OM.$(this.btImg).mouseover(m).mouseout(q).mousedown(o).mouseup(n);
}else{OM.$(this.btImg).bind("touchstart",function(r){r.preventDefault();r.stopPropagation();o(r);});OM.$(this.btImg).bind("touchend",function(r){r.preventDefault();
r.stopPropagation();n(r);});}},initButton:function(){this.btDiv.appendChild(this.btImg);OM.$(this.tipDiv).css({display:"none"});
OM.$(this.btDiv).css({"border-color":"#ffffe1","background-color":"#ffffe1","border-width":"0px","border-style":"solid","font-size":"14px","white-space":"nowrap",padding:"2px"});
if(this.btType!=OM.control.ToolButton.SEPARATOR){this.btImg.setAttribute("src",this.btIcon);if(this.width){this.btImg.setAttribute("width",this.width);
}if(this.height){this.btImg.setAttribute("height",this.height);}}},destroy:function(){OM.$(this.btDiv).empty();
this.btDiv=null;this.btImg=null;this.tipDiv=null;},setToolTip:function(d){this.tip=d;},reset:function(g){if(this.tool&&g){this.tool.clear();
}if(this.btState==OM.control.ToolButton.DOWN){this.btImg.setAttribute("src",this.btIcon);this.btState=OM.control.ToolButton.UP;
if(this.tool&&(this.tool.getStatus()==OM.tool.Tool.STARTED)){this.tool.clear();}var d=new OM.event.ToolbarEvent(OM.event.ToolbarEvent.BUTTON_UP,this);
d.btID=this.btID;this.fire(d.type,d);}}});OM.control.ToolButton.COMMAND=0;OM.control.ToolButton.TOGGLE=1;
OM.control.ToolButton.SEPARATOR=2;OM.control.ToolButton.UP=0;OM.control.ToolButton.DOWN=1;OM.control.ButtonGroup=OM.Class.extend({initialize:function(){this.toolButtons=[];
this.toolBar=null;var d=this;this.onToolButtonStateChange=function(n){var m=n.btID;var g=false;if(m.substring(m.lastIndexOf("bt_")+3)=="clear"){g=true;
}if(d.toolButtons){for(var l in d.toolButtons){if(m!=l&&(d.toolButtons[l] instanceof OM.control.ToolButton)){(d.toolButtons[l]).reset(g);
}}}};},add:function(d){this.toolButtons[d.btID]=d;d.group=this;d.on(OM.event.ToolbarEvent.BUTTON_STATE_CHANGE,this.onToolButtonStateChange);
if(this.toolBar){this.toolBar.addButton(d);}}});OM.control.ToolBar=OM.control.MapDecoration.extend({initialize:function(n,g){if(g&&g.orientation!=undefined&&g.orientation==OM.control.ToolBar.VERTICAL){this.direction=g.orientation;
}else{this.direction=OM.control.ToolBar.HORIZONTAL;}this.innerID=n;this.map=null;this.toolBarDecoration=null;
this.toolBarDecorationDiv=null;this.toolBarTB=null;this.left=0.35;this.top=0.05;var e=this;var d=OM.gv.toolButtonW;
var l=OM.gv.toolButtonH;if(OM.browser.touchSupported){d=d*1.5;l=l*1.5;}this.addedBuiltInbts=g.builtInButtons;
this.enableBuiltInBts=[false,false,false,false,false,false];this.builtInBts=[];this.allToolBts=[];this.toBeAddedBts=[];
this.builtInButtonGroup=new OM.control.ButtonGroup();this.buttonGroups=[this.builtInButtonGroup];this.toolBarDecoration=new OM.control.MapDecoration('<div id="div_'+e.innerID+'" style="background: white;"></div>',{offsetX:this.left,offsetY:this.top,draggable:true,contentStyle:{"border-style":"solid","border-color":"#ffffff","border-width":"2px",backgroundColor:"#ffffff",filter:"alpha(Opacity=80)","-moz-opacity":"0.8",opacity:"1"}});
this.toolBarDecoration.type="ToolBar";this.toolBarDecoration.clean=function(){};this.builtInBtSelected=function(t){var q=t.btID;
if(q==n+"_bt_clear"){for(var o in e.allToolBts){if(e.allToolBts[o].tool){var s=e.allToolBts[o].btID;if((s==n+"_bt_redline"||s==n+"_bt_distance"||s==n+"_bt_circle"||s==n+"_bt_rectangle")){e.allToolBts[o].tool.clear();
}}}}else{if((q==n+"_bt_redline")||(q==n+"_bt_distance")||(q==n+"_bt_circle")||(q==n+"_bt_rectangle")||(q==n+"_bt_zoom")){for(var r=0;
r<e.builtInBts.length;r++){if(e.builtInBts[r].btID==q){e.builtInBts[r].tool.start();}}}}};this.builtInBtUnSelected=function(q){var o=null;
if(q.btID){o=e.allToolBts[q.btID];}else{if(q.target.bt){o=q.target.bt;}else{return;}}o.reset();};this.clearTools=function(){for(var o=0;
o<e.builtInBts.length;o++){e.builtInBts[o].reset();}};var m=function(){e.toolBarTB=document.createElement("Table");
e.toolBarTB.id="tb_"+e.innerID;e.toolBarTB.style.backgroundColor="rgb(242, 237, 242)";e.toolBarTB.cellSpacing=1;
e.toolBarTB.cellPadding=0;e.toolBarTB.style.border="0px solid #7F9DB9";e.toolBarTB.style.width="100%";
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_clear",OM.control.ToolButton.COMMAND,{buttonIcon:OM.gv.resourcePath()+"tbicons/clear.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_clear.gif",width:d,height:l,tooltip:"clear"}));
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_circle",OM.control.ToolButton.TOGGLE,{buttonIcon:OM.gv.resourcePath()+"tbicons/circle.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_circle.gif",width:d,height:l,tooltip:"circle",buttonName:OM.control.ToolBar.BUILTIN_CIRCLE}));
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_rectangle",OM.control.ToolButton.TOGGLE,{buttonIcon:OM.gv.resourcePath()+"tbicons/rectangle.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_rectangle.gif",width:d,height:l,tooltip:"rectangle",buttonName:OM.control.ToolBar.BUILTIN_RECTANGLE}));
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_redline",OM.control.ToolButton.TOGGLE,{buttonIcon:OM.gv.resourcePath()+"tbicons/redline.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_redline.gif",width:d,height:l,tooltip:"redline",buttonName:OM.control.ToolBar.BUILTIN_REDLINE}));
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_distance",OM.control.ToolButton.TOGGLE,{buttonIcon:OM.gv.resourcePath()+"tbicons/distance.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_distance.gif",width:d,height:l,tooltip:"distance",buttonName:OM.control.ToolBar.BUILTIN_DISTANCE}));
e.builtInBts.push(new OM.control.ToolButton(n+"_bt_zoom",OM.control.ToolButton.TOGGLE,{buttonIcon:OM.gv.resourcePath()+"tbicons/zoom.gif",buttonSelectedIcon:OM.gv.resourcePath()+"tbicons/p_zoom.gif",width:d,height:l,tooltip:"zoom",buttonName:OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM}));
for(var o=0;o<e.builtInBts.length;o++){e.builtInBts[o].on(OM.event.ToolbarEvent.BUTTON_DOWN,e.builtInBtSelected);
e.builtInButtonGroup.add(e.builtInBts[o]);}}();},setPosition:function(e,d){this.left=e;this.top=d;if(this.toolBarDecoration){this.toolBarDecoration.setPosition(this.left,this.top);
}},setVisible:function(d){if(this.toolBarDecoration){this.toolBarDecoration.setVisible(d);}},setDraggable:function(d){if(this.toolBarDecoration){this.toolBarDecoration.setDraggable(d);
}},isVisible:function(){if(this.toolBarDecoration){return this.toolBarDecoration.isVisible();}},initBuiltInTools:function(){this.toolBarDecorationDiv=document.getElementById("div_"+this.innerID);
this.toolBarDecorationDiv.appendChild(this.toolBarTB);this.builtInBts[OM.control.ToolBar.BUILTIN_CIRCLE].tool=new OM.tool.CircleTool(this.map);
this.builtInBts[OM.control.ToolBar.BUILTIN_CIRCLE].tool.bt=this.builtInBts[OM.control.ToolBar.BUILTIN_CIRCLE];
this.builtInBts[OM.control.ToolBar.BUILTIN_CIRCLE].tool.on(OM.event.ToolEvent.TOOL_END,this.builtInBtUnSelected);
this.builtInBts[OM.control.ToolBar.BUILTIN_RECTANGLE].tool=new OM.tool.RectangleTool(this.map);this.builtInBts[OM.control.ToolBar.BUILTIN_RECTANGLE].tool.bt=this.builtInBts[OM.control.ToolBar.BUILTIN_RECTANGLE];
this.builtInBts[OM.control.ToolBar.BUILTIN_RECTANGLE].tool.on(OM.event.ToolEvent.TOOL_END,this.builtInBtUnSelected);
this.builtInBts[OM.control.ToolBar.BUILTIN_REDLINE].tool=new OM.tool.RedlineTool(this.map);this.builtInBts[OM.control.ToolBar.BUILTIN_REDLINE].tool.bt=this.builtInBts[OM.control.ToolBar.BUILTIN_REDLINE];
this.builtInBts[OM.control.ToolBar.BUILTIN_REDLINE].tool.on(OM.event.ToolEvent.TOOL_END,this.builtInBtUnSelected);
this.builtInBts[OM.control.ToolBar.BUILTIN_DISTANCE].tool=new OM.tool.DistanceTool(this.map);this.builtInBts[OM.control.ToolBar.BUILTIN_DISTANCE].tool.bt=this.builtInBts[OM.control.ToolBar.BUILTIN_DISTANCE];
this.builtInBts[OM.control.ToolBar.BUILTIN_DISTANCE].tool.on(OM.event.ToolEvent.TOOL_END,this.builtInBtUnSelected);
this.builtInBts[OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM].tool=new OM.tool.MarqueeZoomTool(this.map,OM.tool.MarqueeZoomTool.ONE_TIME);
this.builtInBts[OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM].tool.bt=this.builtInBts[OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM];
this.builtInBts[OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM].tool.on(OM.event.ToolEvent.TOOL_END,this.builtInBtUnSelected);
this.enableBuiltInButton(this.addedBuiltInbts);},enableBuiltInButton:function(e){for(var d=0;d<e.length;
d++){if(e[d]==OM.control.ToolBar.BUILTIN_ALL){for(var d=0;d<this.enableBuiltInBts.length;d++){if(!this.enableBuiltInBts[d]){this.enableBuiltInBts[d]=true;
}}break;}else{if(e[d]<this.enableBuiltInBts.length&&e[d]>=0){this.enableBuiltInBts[0]=true;this.enableBuiltInBts[e[d]]=true;
}}}for(var d=0;d<this.builtInBts.length;d++){if(this.enableBuiltInBts[d]){this.addButton(this.builtInBts[d]);
}}},removeButton:function(n){if(!n){return;}for(var d=this.toBeAddedBts.length-1;d>=0;d--){if(this.toBeAddedBts[d]==n){this.toBeAddedBts.splice(d,1);
}}if(!this.map){return;}delete this.allToolBts[n.btID];if(n.group){delete n.group.toolButtons[n.btID];
n.group=null;}if(this.direction==OM.control.ToolBar.HORIZONTAL){var e=this.toolBarTB.firstChild.firstChild;
if(e.childNodes.length==0){return;}else{var l=e.childNodes;for(var g=0;g<l.length;g++){if(l[g].id=="_td_"+n.btID){e.deleteCell(g);
}}}}else{if(this.toolBarTB.firstChild.childNodes.length==0){return;}else{var l=this.toolBarTB.firstChild.childNodes;
for(var g=0;g<l.length;g++){if(l[g].id=="_tr_"+n.btID){this.toolBarTB.firstChild.deleteRow(g);}}}}},addButton:function(e){if(!this.map){this.toBeAddedBts.push(e);
return;}if(e.btType==OM.control.ToolButton.SEPARATOR){if(this.direction==OM.control.ToolBar.HORIZONTAL){e.btImg.setAttribute("src",OM.gv.resourcePath()+"tbicons/bk_v.png");
}else{e.btImg.setAttribute("src",OM.gv.resourcePath()+"tbicons/bk_h.png");}}var d=null;var g=null;if(this.direction==OM.control.ToolBar.HORIZONTAL){if(this.toolBarTB.childNodes.length==0){d=this.toolBarTB.insertRow(0);
}else{d=this.toolBarTB.firstChild.firstChild;}g=d.insertCell(d.childNodes.length);g.id="_td_"+e.btID;
}else{if(this.toolBarTB.childNodes.length==0){d=this.toolBarTB.insertRow(0);}else{d=this.toolBarTB.insertRow(this.toolBarTB.firstChild.childNodes.length);
}d.id="_tr_"+e.btID;g=d.insertCell(0);}e.parentToolBar=this;g.appendChild(e.btDiv);this.allToolBts[e.btID]=e;
},initCustomBts:function(){for(var d=0;d<this.toBeAddedBts.length;d++){this.addButton(this.toBeAddedBts[d]);
}},getBuiltInTool:function(d){if(this.builtInBts[d]){return this.builtInBts[d].tool;}else{return null;
}},addSeparator:function(d){var e=new OM.control.ToolButton(d,OM.control.ToolButton.SEPARATOR);this.addButton(e);
},removeSeparator:function(e){for(var d=this.toBeAddedBts.length-1;d>=0;d--){if(this.toBeAddedBts[d].btID==e){this.removeButton(this.toBeAddedBts[d]);
break;}}},destroy:function(){this.map=null;this.toolBarDecoration=null;this.toolBarDecorationDiv=null;
this.allToolBts=null;for(var d=0;d<this.builtInBts&&this.builtInBts.length;d++){this.builtInBts[d].destroy();
this.builtInBts[d]=null;}this.builtInBts=null;this.DrawingButtonGroup=null;this.buttonGroups=null;this.buttonsToAdd=null;
}});OM.control.ToolBar.VERTICAL=0;OM.control.ToolBar.HORIZONTAL=1;OM.control.ToolBar.BUILTIN_CLEAR=0;
OM.control.ToolBar.BUILTIN_CIRCLE=1;OM.control.ToolBar.BUILTIN_RECTANGLE=2;OM.control.ToolBar.BUILTIN_REDLINE=3;
OM.control.ToolBar.BUILTIN_DISTANCE=4;OM.control.ToolBar.BUILTIN_MARQUEE_ZOOM=5;OM.control.ToolBar.BUILTIN_ALL=6;
OM.control.Magnifier=OM.control.MapDecoration.extend({initialize:function(d){this._super();this.draggable=true;
this.collapsible=true;this.innerID=null;this.width=d.width?d.width:150;this.height=d.height?d.height:150;
this.zoomIncrement=d.zoomIncrement?d.zoomIncrement:1;this.anchorPosition=d.anchorPosition?d.anchorPosition:1;
if(d.collapsible==false){this.collapsible=false;}if(d.draggable==false){this.draggable=false;}this.left=d.offsetX?d.offsetX:20;
this.top=d.offsetY?d.offsetY:20;this.type="Magnifier";this.isHtml=true;this.mainmap=null;this.submap=null;
this.layer=null;this.overFeatureLayer=null;this.cursorStyleDragging=null;this.cursorStyleDefault=null;
this.scaleRatio=null;this.actionOnMainMap=false;this.actionOnSubMap=false;this.mapWidth=0;this.mapHeight=0;
this.zommLevel=0;},display:function(e,d){if(!OM.browser.touchSupported){this.defaultStyle={"border-style":"solid",width:this.width,height:this.height,"border-color":"black","border-width":"1px 1px 1px 1px",padding:"1px","font-size":"16px",color:"#000000",opacity:"1"};
}else{this.defaultStyle={"border-style":"solid",width:this.width,height:this.height,"border-color":"#CFDCEB","border-width":"1px 1px 1px 1px",padding:"1px","font-size":"16px",color:"#000000",opacity:"1"};
}this.hideStyle={"border-style":"solid",width:this.width,height:this.height,"border-color":"#CFDCEB","border-width":"1px 1px 1px 1px",padding:"1px","font-size":"16px",background:"yellow",opacity:"0","z-index":"9999999999",position:"absolute",left:"0px",top:"0px"};
this._super(e,d);this.MagnifierMapDIV=this.$Content;this.mainmap=this.map;this.doinit();},centerAndZoomlevel:function(d){if(!this.actionOnSubMap){this.actionOnMainMap=true;
this.setCenterAndZoomlevel(d);this.actionOnMainMap=false;}},resize:function(){this.setAnchorPosition(this.anchorPosition);
this.moveX=parseFloat(this.$DecorationDiv.css("left"),10);this.moveY=parseFloat(this.$DecorationDiv.css("top"),10);
this.moveX=(this.moveX+this.width/2)*this.mainmap.getMapContext().getDeviceWidth()/this.mapWidth-this.width/2;
this.moveY=(this.moveY+this.height/2)*this.mainmap.getMapContext().getDeviceHeight()/this.mapHeight-this.height/2;
this.$DecorationDiv.css({left:this.moveX});this.$DecorationDiv.css({top:this.moveY});this.refreshSubMap();
this.mapWidth=this.mainmap.getMapContext().getDeviceWidth();this.mapHeight=this.mainmap.getMapContext().getDeviceHeight();
},refreshSubMap:function(g){var d=this;new function(){var n=d.mainmap.getMapContext();var q=n.getDeviceWidth()/2-d.moveX-d.width/2;
var o=n.getDeviceHeight()/2-d.moveY-d.height/2;var l=n.getZoomLevel();var s=n.getUniverse().getZoomLevels()[l];
var t=q*s.resolution;var r=o*s.resolution*s.stretchRatio;var e=n.getCenterPoint();var m=new OM.geometry.Point(e.getX()-t,e.getY()+r,e.getSRID());
var u=n.getUniverse().getZoomLevelNumber();if((l+d.zoomIncrement)>=u){d.submap.setMapCenterAndZoomLevel(m,u-1);
}else{d.submap.setMapCenterAndZoomLevel(m,l+d.zoomIncrement);}d.X=-t;d.Y=r;};},remove:function(){this.overFeatureLayer=null;
this.layer=null;if(this.submap){this.submap.destroyMap();}this.MagnifierMapDIV=null;this.mainmap=null;
this.submap=null;this.map=null;this.display=null;this.centerAndZoomlevel=null;this.resize=null;this.refreshSubMap=null;
},doinit:function(){this.mainmap.on(OM.event.MapEvent.MAP_RESIZED,this.resize,this);this.setAnchorPosition(this.anchorPosition,5,5);
this.submap=new OM.Map(this.MagnifierMapDIV,{mapviewerURL:this.mainmap.mapviewerURL,magnifier:true});
this.mapWidth=this.mainmap.getMapContext().getDeviceWidth();this.mapHeight=this.mainmap.getMapContext().getDeviceHeight();
this.zoomLevel=this.mainmap.getMapContext().getZoomLevel();for(var z=0;z<this.mainmap.divLayers.length;
z++){var o=this.mainmap.divLayers[z];var B=o.name;var A=o.clone("clone_"+B);this.submap.addLayer(A);}for(var z=2;
z<this.mainmap.svgLayers.length;z++){var u=this.mainmap.svgLayers[z];var D=u.name;if(D!=="ii_oracle_maps_internal_editing"&&D!=="ii_oracle_maps_internal_others"){var m=u.clone("clone_"+D);
this.submap.addLayer(m);}}this.overFeatureLayer=this.submap.getDefaultFeatureLayer();var e=this.mapWidth/2-this.X-this.width/2;
var l=this.mapHeight/2-this.Y-this.height/2;var t=this.mainmap.getMapContext();var r=t.getZoomLevel();
var g=t.getUniverse().getZoomLevels()[r];var q=e*g.resolution;var d=l*g.resolution*g.stretchRatio;var C=t.getCenterPoint();
var s=new OM.geometry.Point(C.getX()-q,C.getY()+d,C.getSRID());if((this.mainmap.getMapContext().getZoomLevel()+this.zoomIncrement)>=this.mainmap.getMapContext().getUniverse().getZoomLevelNumber()){this.submap.setMapCenterAndZoomLevel(s,this.mainmap.getMapContext().getUniverse().getZoomLevelNumber()-1);
}else{this.submap.setMapCenterAndZoomLevel(s,this.mainmap.getMapContext().getZoomLevel()+this.zoomIncrement);
}this.submap.enableMapAction.mouse=false;var w=this;this.flag=false;this.submap.init();this.mapdown=false;
if(!OM.browser.touchSupported){this.map.$oracleMapDiv.mousedown(function(E){w.mapdown=true;});this.map.$oracleMapDiv.mouseup(function(E){w.mapdown=false;
});this.map.$oracleMapDiv.mousemove(function(E){if(w.mapdown){w.refreshSubMap(E);}});this.$DecorationDiv.mousedown(function(E){OM.$(this).css("cursor","default");
if(w.draggable){OM.$(this).css("cursor","move");}w.flag=true;w.map.$oracleMapDiv.mousemove(function(I){if(w.flag){var M=w.mapWidth/2-w.moveX-w.width/2;
var L=w.mapHeight/2-w.moveY-w.height/2;var K=w.mainmap.getMapContext();var H=K.getZoomLevel();var G=K.getUniverse().getZoomLevels()[H];
var O=M*G.resolution;var N=L*G.resolution*G.stretchRatio;var F=K.getCenterPoint();var J=new OM.geometry.Point(F.getX()-O,F.getY()+N,F.getSRID());
var P=K.getUniverse().getZoomLevelNumber();if((H+w.zoomIncrement)>=P){w.submap.setMapCenterAndZoomLevel(J,P-1);
}else{w.submap.setMapCenterAndZoomLevel(J,H+w.zoomIncrement);}w.X=-O;w.Y=N;}});}).mouseup(function(){OM.$(this).css("cursor","default");
});w.submap.$oracleMapDiv.mouseup(function(E){w.flag=false;});}if(OM.browser.touchSupported){this.$DecorationDiv.bind("touchstart",function(E){w.touchStart(E);
});this.map.$oracleMapDiv.bind("touchmove",function(E){w.touchMove(E);});this.$DecorationDiv.bind("touchend",function(E){w.touchEnd(E);
});}var n=OM.event.MapEvent;this.mainmap.on(n.I_MAP_CENTER_ZOOM,this.refreshSubMap,this);this.mainmap.on(n.MAP_RECENTERED,this.refreshSubMap,this);
if(OM.browser.touchSupported){this.map.$oracleMapDiv.bind("touchstart",function(E){w.mapdown=true;});
this.map.$oracleMapDiv.bind("touchmove",function(E){if(w.mapdown){w.refreshSubMap(E);}});this.map.$oracleMapDiv.bind("touchend",function(E){w.mapdown=false;
});}},touchStart:function(d){this.flag=true;},touchMove:function(l){if(this.flag){var q=this.mapWidth/2-this.touchMoveX-this.width/2;
var o=this.mapHeight/2-this.touchMoveY-this.height/2;this.submap.$oracleMapDiv.css("cursor","pointer");
var n=this.mainmap.getMapContext();var g=n.getZoomLevel();var e=n.getUniverse().getZoomLevels()[g];var s=q*e.resolution;
var r=o*e.resolution*e.stretchRatio;var d=n.getCenterPoint();var m=new OM.geometry.Point(d.getX()-s,d.getY()+r,d.getSRID());
if((this.mainmap.getMapContext().getZoomLevel()+this.zoomIncrement)>=this.mainmap.getMapContext().getUniverse().getZoomLevelNumber()){this.submap.setMapCenterAndZoomLevel(m,this.mainmap.getMapContext().getUniverse().getZoomLevelNumber()-1);
}else{this.submap.setMapCenterAndZoomLevel(m,this.mainmap.getMapContext().getZoomLevel()+this.zoomIncrement);
}this.X=-s;this.Y=r;}},touchEnd:function(d){this.flag=false;},setCenterAndZoomlevel:function(d){if(this.minimized){return;
}this.submap.setMapCenterAndZoomLevel(this.mainmap.getMapContext().getCenterPoint(),this.mainmap.getMapContext().getZoomLevel()+1);
this.setRectangleFeature();}});OM.control.LayerControl=OM.control.MapDecoration.extend({initialize:function(d){this._super();
this.draggable=true;this.collapsible=true;d=d?d:{};d.position=d.position?d.position:{};this.left=d.offsetX?d.offsetX:20;
this.top=d.offsetY?d.offsetY:20;d.contentStyle=d.contentStyle?d.contentStyle:{};this.width=parseInt(d.contentStyle.minWidth)?parseInt(d.contentStyle.minWidth):150;
this.maxHeight=parseInt(d.contentStyle.maxHeight)?parseInt(d.contentStyle.maxHeight):500;d.titleStyle=d.titleStyle?d.titleStyle:{};
this.title_font_size=d.titleStyle.font_size?d.titleStyle.font_size:11;this.title_font_family=d.titleStyle.font_family?d.titleStyle.font_family:"Tahoma";
this.content_font_size=d.contentStyle.font_size?d.contentStyle.font_size:11;this.content_font_family=d.contentStyle.font_family?d.contentStyle.font_family:"Tahoma";
this.anchorPosition=d.anchorPosition?d.anchorPosition:1;if(d.collapsible==false){this.collapsible=false;
}if(d.draggable==false){this.draggable=false;}this.type="LayerControl";this.isHtml=true;this.mainmap=null;
this.layer=null;},display:function(e,d){this.defaultStyle={"border-style":"solid",width:this.width,"border-color":"black","border-width":"0px",margin:"0",padding:"0px","font-size":"16px",color:"#000000",opacity:"0.7"};
this.titleStyle={background:"url(../../images/overview_panel_header_ena.png)",width:this.width-6,padding:"0","padding-left":"6px",margin:"0","font-size":this.title_font_size,"font-weight":"bold","font-color":"#333333",cursor:"move","font-family":this.title_font_family,opacity:"0.7"};
this._super(e,d);this.panelDIV=this.$Content;this.mainmap=this.map;this.doinit();},remove:function(){this._super();
this.map=null;this._display=null;this.resize=null;this.$DecorationDiv.remove();this.$DecorationBtnDiv.remove();
},resize:function(){this.setAnchorPosition(this.anchorPosition);},doinit:function(){var n=0;var s=0;var L=0;
var F=0;var G=0;var N=0;var e="";var P="";var Y="";var u="";var E="";var I="";var W=this;var C=false;
ck1=false;ck2=false;ck3=false;ck4=false;chkAll=true;var S=0;var T=false;var d=W.width;var M=this.$title.height();
this.v_isDrag=false;var Z=0;var m=new Array();var o;var J=this.width;this.setAnchorPosition(this.anchorPosition,5,5);
this.mapWidth=this.map.getMapContext().getDeviceWidth();this.mapHeight=this.map.getMapContext().getDeviceHeight();
this.map.on(OM.event.MapEvent.MAP_RESIZED,this.resize,this);var r=this.mainmap.typeArray.slice(3);var D=r.length;
for(var ae=D-1;ae>=1;ae--){if(r[ae-1]==r[ae]){r.splice(ae,1);}}var U=[];for(var ae=0,D=r.length;ae<D;
ae++){!RegExp(r[ae],"g").test(U.join(","))&&(U.push(r[ae]));}r=U;this.$Dom=OM.$("<div id='content'></div>");
this.$Dom.css({position:"absolute",border:"0px solid","overflow-y":"auto","overflow-x":"hidden"});this.panelDIV.append(this.$Dom);
var H={};var B={};for(var ae=0;ae<this.mainmap.svgLayers.length;ae++){var ai=this.mainmap.svgLayers[ae].name;
var Q=this.mainmap.getLayerByName(ai).themeName;H[ai]=Q;B[ai]=this.mainmap.getLayerByName(ai).getDataSouce();
}for(var ae=0;ae<r.length;ae++){S++;var af=document.createElement("div");af.id="dom"+S;af.setAttribute("style","position:absolute");
af.setAttribute("style","padding-top:10px;padding-left:9px;height:20px;width:"+(this.width-9+2)+"px;background:#F5F5F9;border: 0px solid #C6CAD5");
var l=document.createElement("img");l.setAttribute("name",r[ae]);l.setAttribute("type","checkbox");l.setAttribute("value",r[ae]);
l.setAttribute("checked","true");l.src="../../images/checkMark_readonly.png";l.setAttribute("style","padding-left:6px;display:none;");
var q=document.createElement("img");q.src="../../images/zoomin.gif";q.alt=r[ae];this.typeCheckBoxEvent(l,"click");
if(OM.browser.touchSupported){this.typeCheckBoxEvent(l,"touchstart");}var ah=document.createElement("text");
ah.id="typeText"+S;ah.setAttribute("style","padding-left:3px;cursor:default;font-weight:600;font-size:"+this.content_font_size+";font-family:"+this.content_font_family);
var g=document.createTextNode(r[ae]);ah.appendChild(g);OM.$(ah).mouseover(function(){});OM.$(q).toggle(function(aj){OM.$("img[name = "+this.alt+"]")[0].setAttribute("style","padding-left:3px;display:inline;");
OM.$("."+this.alt).css({display:""});W.adjustSize();this.src="../../images/zoomout.gif";},function(aj){OM.$("img[name = "+this.alt+"]")[0].setAttribute("style","display:none");
OM.$("."+this.alt).css({display:"none"});OM.$(".style_"+this.alt).css({display:"none"});W.adjustSize();
this.src="../../images/zoomin.gif";});if(OM.browser.touchSupported){var O=true;OM.$(q).bind("touchstart",function(aj){if(O){OM.$("img[name = "+this.alt+"]")[0].setAttribute("style","padding-left:3px;display:inline;");
OM.$("."+this.alt).css({display:""});W.adjustSize();this.src="../../images/zoomout.gif";O=false;}else{OM.$("img[name = "+this.alt+"]")[0].setAttribute("style","display:none");
OM.$("."+this.alt).css({display:"none"});OM.$(".style_"+this.alt).css({display:"none"});W.adjustSize();
this.src="../../images/zoomin.gif";O=true;}});}af.appendChild(q);af.appendChild(l);af.appendChild(ah);
W.$Dom.append(af);for(var ad=this.mainmap.nameArray[r[ae]].length-1;ad>=0;ad--){if(r[ae]=="undefined"&&ad<3){continue;
}var ab=document.createElement("div");ab.id="item"+S+ad;ab.className="item "+r[ae];ab.setAttribute("style","display:none;padding-left:20px;height:20px;width:"+(this.width-20+2)+";background:#F5F5F9;border-top:0px solid white");
ab.setAttribute("draggable","false");var A=document.createElement("img");A.setAttribute("name","item_"+r[ae]);
A.setAttribute("type","checkbox");A.setAttribute("value",this.mainmap.nameArray[r[ae]][ad]);A.className=this.mainmap.nameArray[r[ae]][ad];
A.setAttribute("checked","true");A.setAttribute("style","padding-left:6px;padding-top:6px");A.src="../../images/checkMark_readonly.png";
OM.$(A).mouseover(function(aj){aj.stopPropagation();});this.itemCheckBoxEvent(A,"click");if(OM.browser.touchSupported){this.itemCheckBoxEvent(A,"touchstart");
}var t=document.createElement("text");t.id="itemText"+S+ad;var X=this.mainmap.nameArray[r[ae]][ad].length*7;
t.setAttribute("style","padding-left:3px;cursor:default;position:absolute;padding-top:5px;font-size:"+this.content_font_size+";font-family:"+this.content_font_family);
var w=document.createTextNode(this.mainmap.nameArray[r[ae]][ad]);t.appendChild(w);ab.appendChild(A);ab.appendChild(t);
var aa="";OM.$(t).mouseover(function(aj){OM.$(this).css({cursor:"pointer","font-weight":"600"});aj.stopPropagation();
}).bind("mouseout touchend",function(aj){OM.$(this).css({cursor:"default","font-weight":"normal"});aj.stopPropagation();
});OM.$(t).toggle(function(aj){OM.$("#style"+OM.$(this).attr("id")).css({display:""});var ak=this;OM.util.HttpRequest.send("/mapviewer/omserver",{xml_request:'<non_map_request><get_theme_info data_source="'+B[OM.$(this).text()]+'" theme="'+H[OM.$(this).text()]+'"/></non_map_request>'},function(al){aa=OM.$(al).find("theme_style[label='false']").attr("name");
OM.$("#styleText"+OM.$(ak).attr("id")).text(aa);OM.$("#img"+OM.$(ak).attr("id"))[0].src="/mapviewer/omserver?sty="+aa;
if(W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).customImg){OM.$("#img"+OM.$(ak).attr("id"))[0].src=W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).customImg;
}if(W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).getRenderingStyle()){OM.$("#img"+OM.$(ak).attr("id"))[0].src=W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).getRenderingStyle().src;
}},"xml");W.adjustSize();},function(aj){OM.$("#style"+OM.$(this).attr("id")).css({display:"none"});W.adjustSize();
});if(OM.browser.touchSupported){var K=true;OM.$(t).bind("touchstart",function(aj){aj.stopPropagation();
if(K){OM.$("#style"+OM.$(this).attr("id")).css({display:""});var ak=this;OM.util.HttpRequest.send("mapviewer/omserver",{xml_request:'<non_map_request><get_theme_info data_source="'+B[OM.$(this).text()]+'" theme="'+H[OM.$(this).text()]+'"/></non_map_request>'},function(al){aa=OM.$(al).find("theme_style[label='false']").attr("name");
OM.$("#styleText"+OM.$(ak).attr("id")).text(aa);OM.$("#img"+OM.$(ak).attr("id"))[0].src="/mapviewer/omserver?sty="+aa;
if(W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).customImg){OM.$("#img"+OM.$(ak).attr("id"))[0].src=W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).customImg;
}if(W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).getRenderingStyle()){OM.$("#img"+OM.$(ak).attr("id"))[0].src=W.map.getLayerByName(OM.$("#img"+OM.$(ak).attr("id")).attr("value")).getRenderingStyle().src;
}},"xml");W.adjustSize();K=false;}else{OM.$("#style"+OM.$(this).attr("id")).css({display:"none"});W.adjustSize();
K=true;}});}var z=document.createElement("div");z.id="styleitemText"+S+ad;z.setAttribute("style","display:none;padding-left:40px;height:20;width:"+(this.width-40+2)+";background:#ECF9FF;border-top:0px solid white");
z.className="style style_"+r[ae]+" style_"+this.mainmap.nameArray[r[ae]][ad];var ac=document.createElement("text");
ac.id="styleTextitemText"+S+ad;ac.setAttribute("style"," line-height:20px;position:absolute;height:20;width:1000px;padding-left:10px;font-size:"+this.font_size+";font-family:"+this.font_family);
var ag=document.createTextNode(aa);var q=document.createElement("img");q.id="imgitemText"+S+ad;q.setAttribute("style","width:18px;height:18px;");
q.setAttribute("value",this.mainmap.nameArray[r[ae]][ad]);z.appendChild(q);ac.appendChild(ag);z.appendChild(ac);
W.$Dom.append(ab);W.$Dom.append(z);}OM.$("#dom"+(ae+1)).bind("mouseup touchstart",function(){OM.$(this).css({cursor:"default"});
if(T){e=this.id;Y="item "+OM.$(this).find("img[name]").attr("name");E="styleitemText"+this.id.substring(4);
var aq=arguments[0]||window.event;this.$preDiv=OM.$("#"+P);this.$aftDiv=OM.$("#"+e);this.$preStyleDiv=OM.$("#"+I);
this.$aftStyleDiv=OM.$("#"+E);this.$temp=this.$aftDiv.next();var ao=this.$preDiv.attr("class");ao=ao.substring(5);
var al=OM.$(".item."+ao).length;if(ao==OM.$(this).find("img[name]").attr("name")){return;}if(al==1){OM.$("img[name="+ao+"]").parent().find("img").css("display","none");
}else{OM.$("img[name="+ao+"]").parent().find("img").css({display:"inline"});}var ak=OM.$(".item."+OM.$(this).find("img[name]").attr("name")).length;
if(ak==0){OM.$("img[name="+OM.$(this).find("img[name]").attr("name")+"]").parent().find("img").css({display:"inline"});
}else{}this.$preDiv.insertAfter(this.$aftDiv);this.$preStyleDiv.insertAfter(this.$preDiv);this.$preDiv.attr("class",Y);
Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);T=false;OM.$("img[class][type='checkbox']").each(function(){m.push(OM.$(this).attr("value"));
});var an=m.length;for(var aj=m.length-1;0<=aj;aj--){W.map.getLayerByName(m[aj]).setZIndex(an+1-aj);}OM.$("img[class][type='checkbox']").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){W.map.getLayerByName(OM.$(this).attr("value")).setVisible(false);
}});m=new Array();o=new Array();var ap=Y.substring(5);var am=u.substring(5);OM.$("img[name = item_"+ap+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck2=true;
}OM.$("img[name = "+ap+"]")[0].src="../../images/checkMark_readonly.png";});if(ck2){OM.$("img[name = "+ap+"]")[0].src="../../images/checkMark_NS_readonly.png";
ck2=false;}OM.$("img[name = item_"+am+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck4=true;
}OM.$("img[name ="+am+"]")[0].src="../../images/checkMark_NS_readonly.png";});if(!ck4){OM.$("img[name ="+am+"]")[0].src="../../images/checkMark_readonly.png";
ck4=false;}}});OM.$("div[id^='item']").each(function(){OM.$(this)[0].onmousedown=function(aj){if(aj.which==3){alert("right click event!");
}else{var al=parseInt(aj.clientY)-parseInt(W.top)-parseInt(M);T=true;P=this.id;I="styleitemText"+this.id.substring(4);
u=OM.$(this).attr("class");var ak=arguments[0]||window.event;L=ak.clientY;N=ak.clientX;}};});var O=false;
var V=false;OM.$("div[id^='item']").bind("touchstart",function(ak){if(!O){var aj=OM.util.DomUtil;var al=[];
var ao=aj.getTouchesPosition(event);al.push(ao);var an=parseInt(ak.clientY)-parseInt(W.top)-parseInt(M);
T=true;P=this.id;I="styleitemText"+this.id.substring(4);u=OM.$(this).attr("class");var am=arguments[0]||window.event;
L=al[0].y;N=al[0].x;O=true;OM.$(this).css({background:"#B8DFFD"});}}).bind("touchend",function(){if(O){V=true;
}else{V=false;}});OM.$("#"+ah.id).mouseover(function(){var aj=OM.$("#"+this.id).parent().parent().attr("id");
}).mouseout(function(){});OM.$("div[id^='item']").click(function(){OM.$(this).css({background:"#B8DFFD"});
OM.$(this).css({cursor:"n-resize"});}).mouseover(function(){OM.$(this).css({background:"#B8DFFD"});OM.$(this).css({cursor:"n-resize"});
}).mouseout(function(){OM.$(this).css({background:"#ECF9FF"});OM.$(this).css({cursor:"default"});}).bind("mouseup touchstart",function(){if(!OM.browser.touchSupported){V=true;
}if(V){OM.$("div[id^='item']").css({cursor:"default"});OM.$("div[id^='item']").css({background:"#ECF9FF"});
if(T){e=this.id;Y=OM.$(this).attr("class");E="styleitemText"+this.id.substring(4);if(!OM.browser.touchSupported){var at=arguments[0]||window.event;
}this.$preDiv=OM.$("#"+P);this.$aftDiv=OM.$("#"+e);var al=this.$preDiv.attr("class");al=al.substring(5);
var am=OM.$(".item."+al).length;if(am==1){OM.$("img[name="+al+"]").parent().find("img").css("display","none");
}else{OM.$("img[name="+al+"]").parent().find("img").css({display:"inline"});}var aj=OM.$(".item."+Y.substring(5)).length;
if(aj!=0){OM.$("img[name="+Y.substring(5)+"]").parent().find("img").css({display:"inline"});}this.$preStyleDiv=OM.$("#"+I);
this.$aftStyleDiv=OM.$("#"+E);if(this.$preDiv[0]==this.$aftDiv[0]){if(OM.browser.touchSupported){var ar=OM.util.DomUtil;
var aw=[];var aq=ar.getTouchesPosition(event);aw.push(aq);G=aw[0].x;}else{G=at.clientX;}s=G-N;if(s>0){}if(s<-10){}}else{OM.$("#"+af.id).css({background:"#ECF9FF"});
if(OM.browser.touchSupported){var ar=OM.util.DomUtil;var aw=[];var aq=ar.getTouchesPosition(event);aw.push(aq);
F=aw[0].y;}else{F=at.clientY;}n=F-L;this.$temp=this.$aftDiv.next();this.$temp1=this.$preDiv.next();if(P==e){}else{if(n>0){if(!this.$aftDiv[0].nextSibling&&this.$aftDiv[0].previousSibling!=this.$preDiv[0]){this.$tt=OM.$(this.$aftDiv[0].previousSibling);
this.$aftDiv.insertBefore(this.$preDiv);this.$preDiv.insertAfter(this.$tt);this.$preStyleDiv.insertAfter(this.$preDiv);
this.$aftStyleDiv.insertAfter(this.$aftDiv);this.$preDiv.attr("class",Y);Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);
this.$preDiv.css({background:"#ECF9FF"});this.$aftDiv.css({background:"#ECF9FF"});}else{var av=parseInt(this.$aftDiv[0].id.substring(4));
var au=parseInt(this.$preDiv[0].id.substring(4));if(this.$preDiv.next().next()[0].id==this.$aftDiv[0].id){this.$aftDiv.insertBefore(this.$preDiv);
this.$preDiv.insertBefore(this.$temp);this.$preStyleDiv.insertAfter(this.$preDiv);this.$aftStyleDiv.insertAfter(this.$aftDiv);
this.$preDiv.attr("class",Y);Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);this.$preDiv.css({background:"#ECF9FF"});
this.$aftDiv.css({background:"#ECF9FF"});}else{this.$preDiv.insertBefore(this.$aftDiv);this.$aftDiv.insertAfter(this.$temp);
this.$preStyleDiv.insertAfter(this.$preDiv);this.$aftStyleDiv.insertAfter(this.$aftDiv);this.$preDiv.attr("class",Y);
Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);this.$preDiv.css({background:"#ECF9FF"});
this.$aftDiv.css({background:"#ECF9FF"});}}}if(n<0){if(!this.$aftDiv[0].previousSibling&&this.$aftDiv[0].nextSibling!=this.$preDiv[0]){this.$qq=OM.$(this.$aftDiv[0].nextSibling);
this.$aftDiv.insertBefore(this.$preDiv);this.$preDiv.insertBefore(this.$qq);this.$preStyleDiv.insertAfter(this.$preDiv);
this.$aftStyleDiv.insertAfter(this.$aftDiv);this.$preDiv.attr("class",Y);Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);
this.$preDiv.css({background:"#ECF9FF"});this.$aftDiv.css({background:"#ECF9FF"});}else{this.$preDiv.insertBefore(this.$aftDiv);
this.$aftDiv.insertAfter(this.$temp);this.$preStyleDiv.insertAfter(this.$preDiv);this.$aftStyleDiv.insertAfter(this.$aftDiv);
this.$preDiv.attr("class",Y);Y=Y.replace(" ","_");OM.$("#"+P).children().eq(0).attr("name",Y);this.$preDiv.css({background:"#ECF9FF"});
this.$aftDiv.css({background:"#ECF9FF"});}}}o=new Array(m.length);OM.$("img[class][type='checkbox']").each(function(){m.push(OM.$(this).attr("value"));
});var ak=m.length;for(var an=m.length-1;0<=an;an--){W.map.getLayerByName(m[an]).setZIndex(ak+1-an);}OM.$("img[class][type='checkbox']").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){W.map.getLayerByName(OM.$(this).attr("value")).setVisible(false);
}});m=new Array();o=new Array();var ap=OM.$(this).attr("class").substring(5);var ao=u.substring(5);OM.$("img[name = item_"+ap+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck3=true;
}OM.$("img[name ="+ap+"]")[0].src="../../images/checkMark_readonly.png";});if(ck3){OM.$("img[name ="+ap+"]")[0].src="../../images/checkMark_NS_readonly.png";
ck3=false;}OM.$("img[name = item_"+ao+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck4=true;
}OM.$("img[name ="+ao+"]")[0].src="../../images/checkMark_NS_readonly.png";});if(!ck4){OM.$("img[name ="+ao+"]")[0].src="../../images/checkMark_readonly.png";
ck4=false;}}}T=false;O=false;}});}if(this.$Dom.height()>this.maxHeight){this.$Dom.height(this.maxHeight);
}else{}var R=document.createElement("div");R.id="v_drag";R.setAttribute("style","cursor: e-resize;z-index:5000000;position:absolute;top:0px;left:"+this.width+"px;height:"+this.$title.height()+"px;width:2px;background:#E0E0E0;border:0px solid gray");
this.panelDIV[0].appendChild(R);OM.$("#v_drag").mousedown(function(aj){W.v_isDrag=true;Z=aj.clientX;}).mouseup(function(aj){W.v_isDrag=false;
J=d;});this.panelDIV.mouseup(function(aj){W.v_isDrag=false;J=d;});OM.$("#v_drag").mouseout(function(aj){W.$title.css({background:"url(../../images/overview_panel_header_ena.png)"});
});this.map.$oracleMapDiv[0].onmousemove=function(aj){if(W.v_isDrag){var aj=window.event?window.event:aj;
d=(aj.clientX-Z)+J;if(d>W.width){OM.$("#content div").width(d-9+2);OM.$(".item").width(d-20+2);OM.$(".style").width(d-49+9+2);
W.panelDIV.width(d);OM.$("#v_drag")[0].style.left=d+"px";W.$title.width(d-6);}else{d=W.width;}}};this.map.$oracleMapDiv[0].onmouseup=function(aj){W.v_isDrag=false;
J=d;};this.$title.mouseup(function(aj){aj.stopPropagation();W.v_isDrag=false;J=d;OM.$(this).css({background:"url(../../images/overview_panel_header_ovr.png)"});
}).mouseover(function(aj){if(!W.draggable){OM.$(this).css({cursor:"default"});}if(W.dragging){OM.$(this).css({background:"url(../../images/overview_panel_header_dwn.png)"});
}else{OM.$(this).css({background:"url(../../images/overview_panel_header_ovr.png)"});}}).mousedown(function(aj){OM.$(this).css({background:"url(../../images/overview_panel_header_dwn.png)"});
}).mouseout(function(aj){if(W.dragging){OM.$(this).css({background:"url(../../images/overview_panel_header_dwn.png)"});
}else{OM.$(this).css({background:"url(../../images/overview_panel_header_ena.png)"});}});if(OM.browser.touchSupported){this.$title.bind("touchend",function(aj){aj.stopPropagation();
W.v_isDrag=false;J=d;OM.$(this).css({background:"url(../../images/overview_panel_header_ena.png)"});}).bind("touchstart",function(aj){OM.$(this).css({background:"url(../../images/overview_panel_header_dwn.png)"});
});}OM.$("img[class][type='checkbox'][checked='true']").each(function(){m.push(OM.$(this).attr("value"));
});m=new Array();this.$DecorationDiv.mousemove(function(aj){if(T){}});this.height=this.$Dom.height();
this.setAnchorPosition(this.anchorPosition,5,5);},typeCheckBoxEvent:function(d,e){var l=this;var g=true;
OM.$(d).bind(e,function(){OM.$("img[name = item_"+this.name+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){g=false;
}});if(g){chkAll=false;OM.$(this)[0].setAttribute("checked","false");OM.$(this)[0].src="../../images/checkMark_NS_readonly.png";
OM.$("img[name = item_"+this.name+"]").attr("src","../../images/checkMark_NS_readonly.png");OM.$("img[name = item_"+this.name+"]").each(function(){OM.$(this)[0].setAttribute("checked","false");
l.map.getLayerByName(OM.$(this).attr("value")).setVisible(false);});g=false;}else{chkAll=true;OM.$(this)[0].setAttribute("checked","true");
OM.$(this)[0].src="../../images/checkMark_readonly.png";OM.$("img[name = item_"+this.name+"]").attr("src","../../images/checkMark_readonly.png");
OM.$("img[name = item_"+this.name+"]").each(function(){OM.$(this)[0].setAttribute("checked","true");l.map.getLayerByName(OM.$(this).attr("value")).setVisible(true);
});g=true;}});},itemCheckBoxEvent:function(d,g){var l=this;var e=true;OM.$(d).bind(g,function(m){m.stopPropagation();
if(OM.$(this)[0].getAttribute("checked")=="true"){e=true;}else{e=false;}if(e){if(!chkAll){OM.$(this)[0].setAttribute("checked","true");
var n=this.name.substr(5);OM.$(this)[0].src="../../images/checkMark_readonly.png";OM.$("img[name = "+this.name+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck1=true;
}if(OM.$(this)[0].getAttribute("checked")=="true"){OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_readonly.png";
}else{OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";return;}});if(ck1){OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";
ck1=false;}if(l.map.getLayerByName(OM.$(this).attr("value"))){l.map.getLayerByName(OM.$(this).attr("value")).setVisible(true);
}else{OM.$("img[class][type='checkbox'][checked=true]").each(function(){array.push(OM.$(this).attr("value"));
});var q=array.length;for(var o=array.length-1;0<=o;o--){l.map.getLayerByName(array[o]).setZIndex(q+1-o);
}array=new Array();}}else{OM.$(this)[0].setAttribute("checked","false");var n=this.name.substr(5);OM.$(this)[0].src="../../images/checkMark_NS_readonly.png";
OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";l.map.getLayerByName(OM.$(this).attr("value")).setVisible(false);
}e=false;}else{if(!chkAll&&OM.$(this)[0].getAttribute("checked")=="true"){OM.$(this)[0].setAttribute("checked","false");
var n=this.name.substr(5);OM.$(this)[0].src="../../images/checkMark_NS_readonly.png";OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";
l.map.getLayerByName(OM.$(this).attr("value")).setVisible(false);}else{OM.$(this)[0].setAttribute("checked","true");
var n=this.name.substr(5);OM.$(this)[0].src="../../images/checkMark_readonly.png";OM.$("img[name = "+this.name+"]").each(function(){if(OM.$(this)[0].getAttribute("checked")=="false"){ck1=true;
}if(OM.$(this)[0].getAttribute("checked")=="true"){OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_readonly.png";
}else{OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";return;}});if(ck1){OM.$("img[name = "+n+"]")[0].src="../../images/checkMark_NS_readonly.png";
ck1=false;}if(l.map.getLayerByName(OM.$(this).attr("value"))){l.map.getLayerByName(OM.$(this).attr("value")).setVisible(true);
}else{OM.$("img[class][type='checkbox'][checked=true]").each(function(){array.push(OM.$(this).attr("value"));
});var q=array.length;for(var o=array.length-1;0<=o;o--){l.map.getLayerByName(array[o]).setZIndex(q+1-o);
}array=new Array();}}e=true;}});},adjustSize:function(){if(this.$Dom.height()>this.maxHeight+1){this.$Dom.height(this.maxHeight);
}else{}OM.$("#v_drag").height(this.$title.height());}});OM.control.MapTypeControl=OM.control.MapDecoration.extend({initialize:function(d,o,l){this.map=d;
this.tileLayer=o;this.enableTypes=l?l.enableTypes:null;this.type=l?l.type:null;var m=this;this.addListener=function(){OM.$("#div_type").bind("click touchend",function(u){var t=u.target;
t.style.backgroundImage="url('"+OM.gv.resourcePath()+"button_bg_dwn.png')";t.style.color="#000000";t.style.borderColor="#e0e3e8 #606974 #606974 #e0e3e8";
if(m.tileLayer){m.tileLayer.setMapType(m.enableTypes[t.id]);var s=document.getElementById(m.type);if(m.type!=t.id){s.style.backgroundImage="url('"+OM.gv.resourcePath()+"button_bg_ena.png')";
s.style.color="#003d5b";s.style.borderColor="#e0e3e8 #606974 #606974 #e0e3e8";}m.type=t.id;}}).mouseover(function(t){var s=t.target;
if(s.id!=m.type){s.style.backgroundImage="url('"+OM.gv.resourcePath()+"button_bg_ovr.png')";s.style.color="#000000";
}}).mouseout(function(t){var s=t.target;if(s.id!=m.type){s.style.backgroundImage="url('"+OM.gv.resourcePath()+"button_bg_ena.png')";
s.style.color="#003d5b";}});};if(!this.infoDecoration){var e="background-image:url("+OM.gv.resourcePath()+"button_bg_ena.png);background-position:top; background-repeat:repeat-x; width:60px;display: block; padding: 1px 5px 3px 6px; margin:0; text-align:center; text-decoration:none;border-color:#e0e3e8 #606974 #606974 #e0e3e8; border-style:solid; border-width:1px; font-family:Tahoma; font-size:11px; color: #003d5b;";
var q="background-image:url("+OM.gv.resourcePath()+"button_bg_dwn.png);background-position:top; background-repeat:repeat-x; width:60px;display: block; padding: 1px 5px 3px 6px; margin:0; text-align:center; text-decoration:none;border-color:#4e555e #8f9aac #8f9aac #4e555e; border-style:solid; border-width:1px; font-family:Tahoma; font-size:11px; color: #000000;";
var g="";var n=0;for(var r in this.enableTypes){if(this.enableTypes[r]){if(r==this.type){g=g+'<td><a style="'+q+'" id="'+r+'" href="javascript:void(0);"> '+r+"</a></td>";
}else{g=g+'<td><a style="'+e+'" id="'+r+'" href="javascript:void(0);"> '+r+"</a></td>";}n+=60;}}if(n>0){this.infoDecoration=new OM.control.MapDecoration('<div id="div_type" style="background: white;"><table width=100% cellspacing=0 cellpadding=0><tr>'+g+"</tr></table></div>",{mapType:"mapTypeControl",offsetX:10,offsetY:10,draggable:false,height:20,contentStyle:{"border-style":"solid","border-color":"#ffffff",border:"0px",backgroundColor:"#ffffff",filter:"alpha(Opacity=80)","-moz-opacity":"0.8"}});
this.infoDecoration.setAnchorPosition(3);this.map.addMapDecoration(this.infoDecoration);this.addListener();
}}},destory:function(){if(this.infoDecoration){this.map.removeMapDecoration(this.infoDecoration);}}});
OM.filter.Filter=OM.Class.extend({initialize:function(){this.filterMode=OM.filter.Filter.CLIENT_SIDE;
this.sql=null;},setFilterMode:function(d){this.filterMode=OM.filter.Filter.CLIENT_SIDE;},evaluate:function(d){return this.invokeClient(d);
},invokeClient:function(d){return false;}});OM.filter.Filter.SERVER_SIDE="server_side";OM.filter.Filter.CLIENT_SIDE="client_side";
OM.filter.Equals=OM.filter.Filter.extend({initialize:function(d,e){this._super();this.filterType="equalsFilter";
this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]==this.filterValue){return true;
}else{return false;}}});OM.filter.NotEquals=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="notEqualsFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]!=this.filterValue){return true;
}else{return false;}}});OM.filter.GreaterThan=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="greaterThanFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]>this.filterValue){return true;
}else{return false;}}});OM.filter.GreaterThanOrEquals=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="greaterThanOrEqualsFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;
},invokeClient:function(d){var e=d.attributes[this.filterAttribute];if(!e){return false;}if(isNaN(e)){e=parseFloat(e);
}if(e>=this.filterValue){return true;}else{return false;}}});OM.filter.LessThan=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="lessThanFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;},invokeClient:function(d){if(d.attributes&&d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]<this.filterValue){return true;
}else{return false;}}});OM.filter.LessThanOrEquals=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="lessThanOrEqualsFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;
},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]<=this.filterValue){return true;
}else{return false;}}});OM.filter.Between=OM.filter.Filter.extend({initialize:function(e,d,g){this._super();
this.filterType="betweenFilter";this.filterAttribute=e?e.toUpperCase():"";this.lowValue=parseFloat(d);
this.highValue=parseFloat(g);},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&parseFloat(d.attributes[this.filterAttribute])>=this.lowValue&&parseFloat(d.attributes[this.filterAttribute])<=this.highValue){return true;
}else{return false;}}});OM.filter.Like=OM.filter.Filter.extend({initialize:function(d,e){this._super();
this.filterType="likeFilter";this.filterAttribute=d?d.toUpperCase():"";this.filterValue=e;},invokeClient:function(d){if(d.attributes[this.filterAttribute]){return this.executeLikeReg(this.filterValue,d.attributes[this.filterAttribute]);
}else{return false;}},executeLikeReg:function(g,m){if(g==m){return true;}var l=new String(g);var d=new String(m);
if(l.indexOf("_")!=-1){l=l.replace(/\_/g,".");}if(l.indexOf("%")!=-1){l=l.replace(/\%/g,"[a-zA-Z0-9.@!#$^&*() \\s]+");
}var e=new RegExp(l);if(d.match(e)!=null&&d.match(e)==d.toString()){return true;}else{return false;}}});
OM.filter.InsidePolygon=OM.filter.Filter.extend({initialize:function(d){this._super();this.filterType="InsidePolygonFilter";
this.filterGeom=d;this.filterMBR=this.filterGeom.getMBR();},invokeClient:function(e){if(e.geo){if(e.geo.srid!=this.filterGeom.srid){var g=this;
this.filterGeom.transform(e.geo.srid,function(m){var n=g.filterGeom=m;g.evaluate(e);});}else{var d=e.geo.type;
var l=this.filterGeom.type;mbr=e.getGeometry().getMBR();if(l=="Rectangle"){if(mbr.getMinX()>=this.filterGeom.getMinX()&&mbr.getMaxX()<=this.filterGeom.getMaxX()&&mbr.getMinY()>=this.filterGeom.getMinY()&&mbr.getMaxY()<=this.filterGeom.getMaxY()){return true;
}}else{if(l=="Polygon"){if(mbr.getMinX()>=this.filterMBR.getMinX()&&mbr.getMaxX()<=this.filterMBR.getMaxX()&&mbr.getMinY()>=this.filterMBR.getMinY()&&mbr.getMaxY()<=this.filterMBR.getMaxY()){if(this.geomInPolygon(e.geo,this.filterGeom)){return true;
}}}else{if(l=="MultiPolygon"){if(mbr.getMinX()>=this.filterMBR.getMinX()&&mbr.getMaxX()<=this.filterMBR.getMaxX()&&mbr.getMinY()>=this.filterMBR.getMinY()&&mbr.getMaxY()<=this.filterMBR.getMaxY()){if(this.geomInPolygon(e.geo,this.filterGeom)){return true;
}}}}}return false;}}else{return false;}},pointInsidePolygonRing:function(q,o,n){var l=[];var g=[];var r=n[0].length/2;
for(var e=0;e<r;e++){l[e]=parseFloat(n[0][e*2]);g[e]=parseFloat(n[0][e*2+1]);}var e,d,m=0;for(e=0,d=r-1;
e<r;d=e++){if(((g[e]>o)!=(g[d]>o))&&(q<(l[d]-l[e])*(o-g[e])/(g[d]-g[e])+l[e])){m=!m;}}return m;},pointInPolygon:function(s,r,q){var o=q;
var n=o.getType();var m=0;if(n==="Polygon"){m=this.pointInsidePolygonRing(s,r,o.coordinates);}else{if(n==="MultiPolygon"){var e=o.coordinates;
var l=e.length;for(var g=0;g<l;g++){var d=this.pointInsidePolygonRing(s,r,e[g]);if(d){m=d;break;}}}}return m;
},geomInPolygon:function(d,m){var l,e;if(d.type=="Point"||d.type=="OrientedPoint"){l=d.coordinates;if(this.pointInPolygon(l[0],l[1],this.filterGeom)){return true;
}return false;}else{if(d.type=="MultiPoint"||d.type=="MultiOrientedPoint"){e=d.coordinates;for(var g=0;
g<e.length;g++){l=e[g];if(!this.pointInPolygon(l[0],l[1],m)){return false;}}return true;}else{if(d.type=="Rectangle"){l=d.coordinates;
l.push(l[0],l[3],l[2],l[1]);if(!this._geomInPolygon(l,m)){return false;}return true;}else{if(d.type=="LineString"){l=d.coordinates;
if(!this._geomInPolygon(l,m)){return false;}return true;}else{if(d.type=="MultiLineString"){e=d.coordinates;
for(var g=0;g<e.length;g++){l=e[g];if(!this._geomInPolygon(l,m)){return false;}}return true;}else{if(d.type=="Polygon"){l=d.coordinates[0];
if(!this._geomInPolygon(l,m)){return false;}return true;}else{if(d.type=="MultiPolygon"){e=d.coordinates;
for(var g=0;g<e.length;g++){l=e[g][0];if(!this._geomInPolygon(l,m)){return false;}}return true;}}}}}}}return false;
},_geomInPolygon:function(m,n){var g=m.length/2;for(var e=0,d=g-1;e<g;e++){if(!this.pointInPolygon(m[e*2],m[e*2+1],n)){return false;
}var l={coordinates:[m[e*2],m[e*2+1],m[d*2],m[d*2+1]]};if(this.segmentCrossPolygon(l,n)){return false;
}}return true;},segmentCrossPolygon:function(e,d){if(!this.proxy){this.proxy=new OM.filter.AnyInteract(this.filterGeom);
}return this.proxy.segmentCrossPolygon(e,d);}});OM.filter.All=OM.filter.Filter.extend({initialize:function(d){this._super();
this.filterType="allFilter";this.filterArray=d;},invokeClient:function(e){for(var d=0;d<this.filterArray.length;
d++){if(this.filterArray[d].evaluate(e)==false){return false;}}return true;}});OM.filter.And=OM.filter.Filter.extend({initialize:function(e,d){this._super();
this.filterType="andFilter";this.filter1=e;this.filter2=d;},invokeClient:function(l){var g=this.filter1.evaluate(l);
var e=this.filter2.evaluate(l);var d=g&e;return d;}});OM.filter.Any=OM.filter.Filter.extend({initialize:function(d){this._super();
this.filterType="anyFilter";this.filterArray=d;},invokeClient:function(e){for(var d=0;d<this.filterArray.length;
d++){if(this.filterArray[d].evaluate(e)==true){return true;}}return false;}});OM.filter.In=OM.filter.Filter.extend({initialize:function(e,d){this._super();
this.filterType="inFilter";this.filterAttribute=e?e.toUpperCase():"";this.filterArray=d;},invokeClient:function(e){if(e.attributes[this.filterAttribute]){for(var d=0;
d<this.filterArray.length;d++){if(e.attributes[this.filterAttribute]==this.filterArray[d]){return true;
}}return false;}else{return false;}}});OM.filter.IsNotNull=OM.filter.Filter.extend({initialize:function(d){this._super();
this.filterType="isNotNullFilter";this.filterAttribute=d?d.toUpperCase():"";},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]!=null){return true;
}else{return false;}}});OM.filter.IsNull=OM.filter.Filter.extend({initialize:function(d){this._super();
this.filterType="isNullFilter";this.filterAttribute=d?d.toUpperCase():"";},invokeClient:function(d){if(d.attributes[this.filterAttribute]&&d.attributes[this.filterAttribute]==null){return true;
}else{return false;}}});OM.filter.Not=OM.filter.Filter.extend({initialize:function(d){this._super();this.filterType="notFilter";
this.negateFilter=d;},invokeClient:function(d){return !this.negateFilter.evaluate(d);}});OM.filter.Or=OM.filter.Filter.extend({initialize:function(e,d){this._super();
this.filterType="orFilter";this.filter1=e;this.filter2=d;},invokeClient:function(l){var g=this.filter1.evaluate(l);
var e=this.filter2.evaluate(l);var d=g||e;return d;}});OM.filter.Xor=OM.filter.Filter.extend({initialize:function(e,d){this._super();
this.filterType="xorFilter";this.filter1=e;this.filter2=d;},invokeClient:function(l){var g=this.filter1.evaluate(l);
var e=this.filter2.evaluate(l);var d=g^e;return d;}});OM.filter.AnyInteract=OM.filter.Filter.extend({initialize:function(d){this._super();
this.filterType="AnyInteractFilter";this.filterGeom=d;this.filterMBR=this.filterGeom.getMBR();this.sqlStr=null;
},invokeClient:function(m){if(m.geo){if(m.geo.srid!=this.filterGeom.srid){var n=this;this.filterGeom.transform(m.geo.srid,function(q){var r=q;
var s=q.getMBR();n.filterGeom=q;n.filterMBR=n.filterGeom.getMBR();var o=m.getGeometry().getMBR();if(o.getMinX()>s.getMinX()&&o.getMaxX()<s.getMaxX()&&o.getMinY()>s.getMinY()&&o.getMaxY()<s.getMaxY()){this._AnyInteractWithPolygon(m.geo,this.filterGeom);
}return false;});}else{var l=m.getGeometry();var g=l.getMBR();var d=l.type;var e=this.filterGeom.type;
if(g==null||g==undefined){return false;}if(!(g.getMaxX()<this.filterMBR.getMinX()||g.getMinX()>this.filterMBR.getMaxX()||g.getMaxY()<this.filterMBR.getMinY()||g.getMinY()>this.filterMBR.getMaxY())){if(e=="Polygon"||e=="Rectangle"||e=="MultiPolygon"){return this._AnyInteractWithPolygon(l,this.filterGeom);
}else{if(d=="Polygon"||d=="Rectangle"||d=="MultiPolygon"){return this._AnyInteractWithPolygon(this.filterGeom,l);
}else{if((e=="LineString"||e=="MultiLineString")&&(d=="LineString"||d=="MultiLineString")){return this.isInteractLine(l,this.filterGeom);
}else{if((e=="LineString"||e=="MultiLineString")){return this.isPointOnLine(l,this.filterGeom);}else{if((d=="LineString"||d=="MultiLineString")){return this.isPointOnLine(this.filterGeom,l);
}else{return this.isSamePoints(this.filterGeom,l);}}}}}}return false;}}else{return false;}},_AnyInteractWithPolygon:function(e,d){if(this.intersectWithPolygon(e,d)){return true;
}if(this.hasPointsInPolygon(e,d)){return true;}return false;},intersectWithPolygon:function(q,r){var o=q.type;
var s,m,g,e,d,n,n,l;if(o=="Point"||o=="OrientedPoint"){return this.pointInPolygon(q.getX(),q.getY(),r);
}else{if(o=="MultiPoint"||o=="OrientedMultiPoint"){s=q.coordinates;for(e=0,m=s.length;e<m;e++){if(this.pointInPolygon(s[e][0],s[e][1],r)){return true;
}}return false;}else{if(o=="LineString"){s=q.coordinates;for(e=0,m=s.length/2;e<m-1;e++){g={coordinates:[s[e*2],s[e*2+1],s[(e+1)*2],s[(e+1)*2+1]]};
if(this.segmentCrossPolygon(g,r)){return true;}}return false;}else{if(o=="MultiLineString"){n=q.coordinates;
l=n.length;for(h=0;h<l;h++){s=n[h];for(e=0,m=s.length/2;e<m-1;e++){g={coordinates:[s[e*2],s[e*2+1],s[(e+1)*2],s[(e+1)*2+1]]};
if(this.segmentCrossPolygon(g,r)){return true;}}}return false;}else{if(o=="Rectangle"){s=q.coordinates;
s.push(s[0],s[3],s[2],s[1]);m=s.length/2;for(e=0,d=m-1;e<m;d=e++){g={coordinates:[s[e*2],s[e*2+1],s[d*2],s[d*2+1]]};
if(this.segmentCrossPolygon(g,r)){return true;}}return false;}else{if(o=="Polygon"){s=q.coordinates[0];
m=s.length/2;for(e=0,d=m-1;e<m;d=e++){g={coordinates:[s[e*2],s[e*2+1],s[d*2],s[d*2+1]]};if(this.segmentCrossPolygon(g,r)){return true;
}}return false;}else{if(o=="MultiPolygon"){n=q.coordinates;l=n.length;for(h=0;h<l;h++){s=n[h][0];polygonCount=s.length/2;
for(e=0,d=polygonCount-1;e<polygonCount;d=e++){g={coordinates:[s[e*2],s[e*2+1],s[d*2],s[d*2+1]]};if(this.segmentCrossPolygon(g,r)){return true;
}}}return false;}}}}}}}return false;},segmentCrossPolygon:function(t,A){var d=A.coordinates;if(A.type=="Rectangle"){var z=A.coordinates;
var o=z[0];var n=z[1];var g=z[2];var e=z[3];var q=t.coordinates;if(q[0]>=o&&q[0]<=g&&q[1]>=n&&q[1]<=e||q[2]>=o&&q[2]<=g&&q[3]>=n&&q[3]<=e){return true;
}else{d=[[[o,n,g,n,g,e,o,e,o,n]]];}}if(A.type=="Polygon"){d=[d];}for(var l=0,u=d.length;l<u;l++){var B=d[l][0];
var C=B.length/2;for(var s=0,r=C-1;s<C;r=s++){var w={coordinates:[B[s*2],B[s*2+1],B[r*2],B[r*2+1]]};if(this.segmentsStraddle(t,w)){return true;
}}}return false;},segmentsStraddle:function(s,r){if(!this.rectangleScopeOverlap(s,r)){return false;}var m={x:s.coordinates[0]-r.coordinates[0],y:s.coordinates[1]-r.coordinates[1]};
var o={x:s.coordinates[2]-r.coordinates[0],y:s.coordinates[3]-r.coordinates[1]};var l={x:r.coordinates[2]-r.coordinates[0],y:r.coordinates[3]-r.coordinates[1]};
var n={x:r.coordinates[0]-s.coordinates[0],y:r.coordinates[1]-s.coordinates[1]};var q={x:r.coordinates[2]-s.coordinates[0],y:r.coordinates[3]-s.coordinates[1]};
var d={x:s.coordinates[2]-s.coordinates[0],y:s.coordinates[3]-s.coordinates[1]};var g=this.crossProduct(m,l)*this.crossProduct(l,o);
var e=this.crossProduct(n,d)*this.crossProduct(d,q);if(g>=0&&e>=0){return true;}else{return false;}},crossProduct:function(e,d){return Math.round((e.x*d.y-e.y*d.x)*100000)/100000;
},rectangleScopeOverlap:function(e,d){var g=function(s,r){var q={};if(s>=r){q.max=s;q.min=r;}else{q.max=r;
q.min=s;}return q;};var o=g(e.coordinates[0],e.coordinates[2]);var m=g(e.coordinates[1],e.coordinates[3]);
var n=g(d.coordinates[0],d.coordinates[2]);var l=g(d.coordinates[1],d.coordinates[3]);if(o.max<n.min||o.min>n.max||m.max<l.min||m.min>l.max){return false;
}return true;},hasPointsInPolygon:function(n,q){var m=n.type;var e,s,o,t,g,l,r;if(m=="Point"||m=="OrientedPoint"){return this.pointInPolygon(n.getX(),n.getY(),q);
}else{if(m=="MultiPoint"||m=="MultiOrientedPoint"){for(e=0,num=n.coordinates.length/2;e<num;e++){if(this.pointInPolygon(n.coordinates[e*2],n.coordinates[e*2+1],q)){return true;
}}return false;}else{if(n.type=="LineString"){for(e=0,t=n.coordinates.length/2;e<t;e++){if(this.pointInPolygon(n.coordinates[e*2],n.coordinates[e*2+1],q)){return true;
}}return false;}else{if(n.type=="MultiLineString"){for(g=0,l=n.coordinates.length;g<l;g++){r=n.coordinates[g];
for(e=0,t=r.length/2;e<t;e++){if(this.pointInPolygon(r[e*2],r[e*2+1],q)){return true;}}}return false;
}else{if(n.type=="Rectangle"){var d=n.coordinates;if(this.pointInPolygon(d[0],d[1],q)||this.pointInPolygon(d[2],d[3],q)||this.pointInPolygon(d[0],d[3],q)||this.pointInPolygon(d[2],d[1],q)){return true;
}else{return false;}}else{if(n.type=="Polygon"){for(e=0,o=n.coordinates[0].length/2;e<o;e++){if(this.pointInPolygon(n.coordinates[0][e*2],n.coordinates[0][e*2+1],q)){return true;
}}return false;}else{if(n.type=="MultiPolygon"){for(g=0,l=n.coordinates.length;g<l;g++){r=n.coordinates[g][0];
for(e=0,o=r.length/2;e<o;e++){if(this.pointInPolygon(r[e*2],r[e*2+1],q)){return true;}}}return false;
}}}}}}}},pointInPolygon:function(n,l,e){var m;var d;if(e.type=="Polygon"){m=e.coordinates[0];d=this._pointInPolygon(n,l,m);
}else{if(e.type=="Rectangle"){m=[e.getMinX(),e.getMinY(),e.getMaxX(),e.getMinY(),e.getMaxX(),e.getMaxY(),e.getMinX(),e.getMaxY(),e.getMinX(),e.getMinY()];
d=this._pointInPolygon(n,l,m);}else{if(e.type=="MultiPolygon"){var o=e.coordinates;for(var g=0;g<o.length;
g++){m=o[g][0];d=this._pointInPolygon(n,l,m);if(d){return true;}}}}}if(!d){return this.isPointOnLine({coordinates:[n,l],type:"Point"},e);
}else{return true;}},_pointInPolygon:function(l,g,r){var n=[];var m=[];var q=r.length/2;for(var e=0;e<q;
e++){n[e]=parseFloat(r[e*2]);m[e]=parseFloat(r[e*2+1]);}var e,d,o=0;for(e=0,d=q-1;e<q;d=e++){if(((m[e]>g)!=(m[d]>g))&&(l<(n[d]-n[e])*(g-m[e])/(m[d]-m[e])+n[e])){o=!o;
}}return o;},isInteractLine:function(e,d){var q=this.getSegments(e);var o=this.getSegments(d);for(var n=0,m=q.length;
n<m;n++){for(var l=0,g=o.length;l<g;l++){if(this.segmentsStraddle(q[n],o[l])){return true;}}}return false;
},getSegments:function(r){var o=r.type;var q=r.coordinates;var l=[];var e,m,g,n,d;if(o=="LineString"){for(e=0,m=q.length/2;
e<m-1;e++){l.push({coordinates:[q[e*2],q[e*2+1],q[(e+1)*2],q[(e+1)*2+1]]});}}else{if(o=="MultiLineString"){for(g=0,n=q.length;
g<n;g++){d=q[g];for(e=0,m=d.length/2;e<m-1;e++){l.push({coordinates:[d[e*2],d[e*2+1],d[(e+1)*2],d[(e+1)*2+1]]});
}}}else{if(o=="Polygon"){q=q[0];for(e=0,m=q.length/2;e<m-1;e++){l.push({coordinates:[q[e*2],q[e*2+1],q[(e+1)*2],q[(e+1)*2+1]]});
}}else{if(o=="MultiPolygon"){for(g=0,n=q.length;g<n;g++){d=q[g][0];for(e=0,m=d.length/2;e<m-1;e++){l.push({coordinates:[d[e*2],d[e*2+1],d[(e+1)*2],d[(e+1)*2+1]]});
}}}else{if(o=="Rectangle"){l.push({coordinates:[q[0],q[1],q[2],q[1]]});l.push({coordinates:[q[2],q[1],q[2],q[3]]});
l.push({coordinates:[q[2],q[3],q[0],q[3]]});l.push({coordinates:[q[0],q[3],q[0],q[1]]});}}}}}return l;
},isPointOnLine:function(d,e){var n=this.getSegments(e);var q=d.coordinates;if(d.type=="Point"||d.type=="OrientedPoint"){q=[q];
}for(var o=0,m=q.length;o<m;o++){for(var l=0,g=n.length;l<g;l++){if(this.isPointOnSegment(q[o][0],q[o][1],n[l])){return true;
}}}return false;},isPointOnSegment:function(e,n,l){var m=l.coordinates;var g={x:e-m[0],y:n-m[1]};var d={x:m[2]-m[0],y:m[3]-m[1]};
if(this.crossProduct(g,d)!==0){return false;}if(Math.min(m[0],m[2])<=e&&e<=Math.max(m[0],m[2])&&Math.min(m[1],m[3])<=n&&n<=Math.max(m[1],m[3])){return true;
}else{return false;}},isSamePoints:function(s,r){var l=s.coordinates;var g=r.coordinates;if(s.type=="Point"||s.type=="OrientedPoint"){l=[l];
}if(r.type=="Point"||r.type=="OrientedPoint"){g=[g];}for(var q=0,n=l.length;q<n;q++){for(var o=0,m=g.length;
o<m;o++){var e=l[q];var d=g[o];if(e[0]==d[0]&&e[1]==d[1]){return true;}}}return false;}});OM.template.TemplateConfig=OM.Class.extend({initialize:function(e){this.url=e;
this.baseFolder=e.substring(0,e.length-"config.json".length);var d={};OM.$.ajax({url:e,async:false,dataType:"json",success:function(g){d=g;
}});this.config=d;},vectorLayerList:function(){var d=this.config;var g=[];if(d.vectorLayers){for(var e=0;
e<d.vectorLayers.length;e++){g.push(d.vectorLayers[e].dn);}}return g;},tileLayerList:function(){var d=this.config;
var g=[];if(d.tileLayers){for(var e=0;e<d.tileLayers.length;e++){g.push(d.tileLayers[e].dn);}}return g;
},getTileLayer:function(d){if(!this.config.vectorLayers){return null;}var q=this.getTileLayerConfig(d);
if(q==null){return null;}var e=null;if(d=="google_maps"){e=new OM.layer.GoogleTileLayer("google_maps");
}else{if(d=="oracle_maps"){e=new OM.layer.ElocationTileLayer("oracle_maps");}else{if(d=="nokia_maps"){var n=q.key;
var r=q.secondary_key;var o=null;if(q.mapTypes){var m=q.mapTypes.split(",");o="";for(var g=0;g<m.length;
g++){if(g>0){o+=";";}o+="OM.layer.NokiaTileLayer.TYPE_"+m[g].toUpperCase();}}e=new OM.layer.NokiaTileLayer("nokia_maps",{key:n,appID:r,mapTyleList:o});
}else{if(d=="bing_maps"){var l="<your_nokia_key>";e=new OM.layer.BingTileLayer("bing_maps",{key:q.key});
}}}}return e;},getVectorLayer:function(e,g){if(!this.config.vectorLayers){return null;}var d=this.getVectorLayerConfig(g);
if(d==null){return null;}var n={type:OM.layer.VectorLayer.TYPE_DATAPACK,dataPackUrl:d.uri};var l=new OM.layer.VectorLayer(e,{def:n});
if(d.styles){var m=d.styles;if(m.normal){l.setRenderingStyle(this.getStyle(m.normal));}if(m.selected){l.setSelectStyle(this.getStyle(m.selected));
}if(m.mouseOver){l.enableFeatureHover(true);l.setHoverStyle(this.getStyle(m.mouseOver));}}if(d.nsdp){l.setNSDP(d.nsdp);
}return l;},getStyle:function(E){var C=this.config;if(!C.styles){return null;}var o=C.styles;var B=null;
for(var z=0;z<o.length;z++){if(o[z].dn==E){var m=o[z].type;switch(m){case"color":B=new OM.style.Color(o[z].def);
break;case"marker":B=new OM.style.Marker(o[z].def);break;case"pulse_animation":B=new OM.style.PulseAnimation(o[z].def);
break;case"color_animation":B=new OM.style.AnimationColor(o[z].def);break;case"line":B=new OM.style.Line(o[z].def);
break;case"text":B=new OM.style.Text(o[z].def);break;case"heat_map":var A=o[z].container;var t=o[z].dn+" "+A;
var s=this.getVectorLayer(t,A);var d=o[z].def;d.containerVectorLayer=s;B=new OM.style.HeatMap(d);break;
case"bar_chart":var g=o[z].barArr;var u=g.length;var q=[];for(var w=0;w<u;w++){q.push(new OM.style.Bar(g[w].name,g[w].color));
}var r=o[z].def;r.bars=q;B=new OM.style.BarChart(r);break;case"pie_chart":var D=o[z].pieArr;var n=D.length;
var e=[];for(var w=0;w<n;w++){e.push(new OM.style.PieSlice(D[w].name,D[w].color));}var l=o[z].def;l.pieSlices=e;
B=new OM.style.PieChart(l);break;}break;}}return B;},getConfig:function(){return this.config;},initMap:function(g){var m=this.config;
if(!m.init){return;}var e=m.init;if(e.tileLayer){g.addLayer(this.getTileLayer(e.tileLayer));}else{if(e.customUniverse){var u=e.customUniverse;
var r=u.bounds;var s=new OM.universe.Universe({srid:u.srid,bounds:new OM.geometry.Rectangle(r[0],r[1],r[2],r[3],r[4]),numberOfZoomLevels:u.numberOfZoomLevels});
g.getMapContextToken().universe=s;}else{return;}}if(e.layers){g.removeAllFeatureLayers();var o=e.layers;
for(var q=0;q<o.length;q++){g.addLayer(this.getVectorLayer(o[q],o[q]));}}if(e.center){var n=e.center[0];
var l=e.center[1];var t=g.getMapContext().getUniverse().srid;var d=new OM.geometry.Point(n,l,t);g.setMapCenter(d);
}if(e.zoomLevel){g.setMapZoomLevel(e.zoomLevel);}if(e.copyright){g.addMapDecoration(new OM.control.CopyRight(e.copyright));
}if(e.navigation){g.addMapDecoration(new OM.control.NavigationPanelBar(e.navigation));}},getVectorLayerConfig:function(d){var e=this.indexOfVectorLayer(d);
if(e==-1){return null;}else{return this.config.vectorLayers[e];}},getTileLayerConfig:function(d){var e=this.tileLayerList();
var g=e.indexOf(d);if(g==-1){return null;}return this.config.tileLayers[g];},indexOfVectorLayer:function(e){var d=this.vectorLayerList();
var l=d.indexOf(e);if(l==-1){var o=this.config.vectorLayers;for(var g=0;g<o.length;g++){var n=o[g];if(!n.cn){continue;
}var m=n.cn;l=m.indexOf(e);if(l!=-1){l=g;break;}}}return l;}});OM.template.Template=OM.Class.extend({initialize:function(d){this.name="default";
if(d&&d.name){this.name=d.name;}this.config=null;if(!d.url){throw"url not specified";}this.config=new OM.template.TemplateConfig(d.url);
},getConfig:function(){return this.config;},getVectorLayer:function(t,I,G){if(!this.config){return null;
}var q=this.config.getVectorLayer(t,I);if(q==null){return null;}if(!(G&&(G instanceof Array)&&G.length>0)){return q;
}var d=this.config.getVectorLayerConfig(I);var m=d.uri;var H=null;OM.$.ajax({url:m,async:false,dataType:"json",success:function(K){H=K;
}});if(H==null){return null;}var g=H.features;var E=g.length;var o=H.attr_names;var F=H.srs;var n=[];
for(var C=0;C<E;C++){var s=g[C];find:for(var B=0;B<G.length;B++){var u=G[B].toUpperCase();for(var A=0;
A<o.length;A++){var z=o[A].toUpperCase();if(s.properties[z].toUpperCase()==u){var l=s.geometry;l.srid=F;
var w=(typeof s._id!=="undefined")?s._id:C;var J=OM.geometry.Geometry.createGeometry(l,F);var e=new OM.Feature(w,J,{attributes:s.properties});
e.srid=F;e.label_box=s.label_box;n.push(e);break find;}}}}var r={type:OM.layer.VectorLayer.TYPE_LOCAL,features:n};
var D=new OM.layer.VectorLayer(t,{def:r});return D;},getTileLayer:function(d){if(!this.config){return null;
}return this.config.getTileLayer(d);},getStyle:function(d){if(!this.config){return null;}return this.config.getStyle(d);
},setupMapControls:function(d){this.config.initMap(d);},getVectorLayerNames:function(){return this.config.vectorLayerList();
},getTileLayerNames:function(){return this.config.tileLayerList();},getChildLayerNames:function(e){if(!this.config){return null;
}var g=[];var d=this.config.getVectorLayerConfig(e);if(d!=null&&d.cl){g=d.cl;}return g;},getParentLayerNames:function(e){if(!this.config){return null;
}var g=[];var d=this.config.getVectorLayerConfig(e);if(d!=null&&d.pl){g=d.pl;}return g;},getChildLayer:function(t,d,g,r){if(!this.config){return null;
}var s=this.config.getVectorLayerConfig(d);if(s==null||!s.cl){return null;}var q=s.cl;if(typeof g=="string"){var o=q.indexOf(g);
if(o==-1){var e=this.config.indexOfVectorLayer(g);if(e==-1){return null;}var n=false;for(var m=0;m<q.length;
m++){var l=this.config.indexOfVectorLayer(q[m]);if(e==l){n=true;break;}}if(n){return this.getVectorLayer(t,g,r);
}else{return null;}}else{return this.getVectorLayer(t,g,r);}}else{if(typeof g=="number"){if(g<0||g>=q.length){return null;
}else{return this.getVectorLayer(t,q[g],r);}}}return null;}});(function($){var menu,shadow,trigger,content,hash,currentTarget;var defaults={menuStyle:{listStyle:'none',padding:'1px',margin:'0px',backgroundColor:'#fff',border:'1px solid #999',width:'100px'},itemStyle:{margin:'0px',color:'#000',display:'block',cursor:'default',padding:'3px',border:'1px solid #fff',backgroundColor:'transparent'},itemHoverStyle:{border:'1px solid #0a246a',backgroundColor:'#b6bdd2'},eventPosX:'pageX',eventPosY:'pageY',shadow:true,onContextMenu:null,onShowMenu:null};$.fn.contextMenu=function(id,options){if(!menu){menu=$('<div id="jqContextMenu"></div>').hide().css({position:'absolute',zIndex:'500'}).appendTo('body').bind('click',function(e){e.stopPropagation()})}if(!shadow){shadow=$('<div></div>').css({backgroundColor:'#000',position:'absolute',opacity:0.2,zIndex:499}).appendTo('body').hide()}hash=hash||[];hash.push({id:id,menuStyle:$.extend({},defaults.menuStyle,options.menuStyle||{}),itemStyle:$.extend({},defaults.itemStyle,options.itemStyle||{}),itemHoverStyle:$.extend({},defaults.itemHoverStyle,options.itemHoverStyle||{}),bindings:options.bindings||{},shadow:options.shadow||options.shadow===false?options.shadow:defaults.shadow,onContextMenu:options.onContextMenu||defaults.onContextMenu,onShowMenu:options.onShowMenu||defaults.onShowMenu,eventPosX:options.eventPosX||defaults.eventPosX,eventPosY:options.eventPosY||defaults.eventPosY});var index=hash.length-1;$(this).bind('contextmenu',function(e){var bShowContext=(!!hash[index].onContextMenu)?hash[index].onContextMenu(e):true;if(bShowContext)display(index,this,e,options);return false});return this};function display(index,trigger,e,options){var cur=hash[index];content=$('#'+cur.id).find('ul:first').clone(true);content.css(cur.menuStyle).find('li').css(cur.itemStyle).hover(function(){$(this).css(cur.itemHoverStyle)},function(){$(this).css(cur.itemStyle)}).find('img').css({verticalAlign:'middle',paddingRight:'2px'});menu.html(content);if(!!cur.onShowMenu)menu=cur.onShowMenu(e,menu);$.each(cur.bindings,function(id,func){$('#'+id,menu).bind('click',function(e){hide();func(trigger,currentTarget)})});menu.css({'left':e[cur.eventPosX],'top':e[cur.eventPosY]}).show();if(cur.shadow)shadow.css({width:menu.width(),height:menu.height(),left:e.pageX+2,top:e.pageY+2}).show();$(document).one('click',hide)}function hide(){menu.hide();shadow.hide()}$.contextMenu={defaults:function(userDefaults){$.each(userDefaults,function(i,val){if(typeof val=='object'&&defaults[i]){$.extend(defaults[i],val)}else defaults[i]=val})}}})(OM.$);OM.$(function(){OM.$('div.contextMenu').hide()});